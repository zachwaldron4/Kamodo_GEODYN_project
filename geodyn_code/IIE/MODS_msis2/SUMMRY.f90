!$SUMMRY
      SUBROUTINE SUMMRY(AA,II,LL,MJDSB ,FSECB ,MJDSEP,FSECEP,MJDSND,    &
     &      FSECND,H     ,HV    ,NSAT  ,AREA  ,XMASS ,ISATNO,           &
     &      ETUTC ,XYZCUR,CKEPLR,RMSPOS,LCONVG,PERCNT,PARML0,UTDT)
!********1*********2*********3*********4*********5*********6*********7**
! SQMMRY           00/00/00            0000.0    PGMR - ?
!
!
! FUNCTION:
!
! I/O PARAMETERS:
!
!   NAME    I/O  A/S   DESCRIPTION OF PARAMETERS
!   ------  ---  ---   ------------------------------------------------
!   AA      I/O   A
!   II      I/O   A
!   LL      I/O   A
!   MJDSB              SATELLITE EPOCH TIME IN MJD SECONDS. THIS
!                      IS THE RESET (START) TIME IF THE EPOCH AND
!                      START TIME ARE NOT THE SAME.
!   FSECB              FRACTION OF SECONDS OF SATELLITE EPOCH.
!   MJDSEP             ORIGINAL EPOCH TIME IN MJD SECONDS.
!   FSECEP             FRACTION OF SECONDS OF ORIGINAL EPOCH.
!   MJDSND             DATA STOP TIME FROM EPOCH CARD IN MJD SECS.
!   FSECND             FRACTION OF SECONDS OF DATA STOP TIME.
!   H                  INTEGRATION STEP SIZE FOR ORBIT.
!   HV                 INTEGRATION STEP SIZE FOR VAR. EQ.
!   NSAT               NUMBER OF SATELLITES IN EACH SET.
!   AREA               S/C CROSS SECTIONAL AREA.
!   XMASS              S/C MASS.
!   ISATNO             SATELLITE ID'S.
!   ETUTC              ARRAY OF ET-UTC TIME DIFFERENCES.
!   XYZCUR             CURRENT CARTESIAN SATELLITE ELEMENTS.
!   CKEPLR             CURRENT KEPLERIAN SATELLITE ELEMENTS.
!   RMSPOS             RMS POSITION AND VELOCITY
!   LCONVG
!   PERCNT
!   PARML0
!
! COMMENTS:
!
!********1*********2*********3*********4*********5*********6*********7**
      IMPLICIT DOUBLE PRECISION (A-H,O-Z),LOGICAL(L)
      SAVE
      INCLUDE 'COMMON_DECL.inc'
      COMMON/ARCPAR/MAXSEL,NSEL,MAXDEL,NDEL,MAXMET,NMETDT,NSATID,       &
     &              IATDEN,ISATEQ,ITRMAX,ITRMIN,ITRMX2,                 &
     &              MJDSRF,MREFSY,NTDDR,NBTOTL,IDRAGM,IMRNUT,           &
     &              NXARCP
      COMMON/ARCPR /FSECRF,XARCPR
      COMMON/BIHTBL/IA1UTC,JA1UTC,IPOLA1,JPOLA1,IFLUXS,JFLUXS,IFLXAP,   &
     &              JFLXAP,IFLXKP,JFLXKP,IIONO,JIONO,                   &
     &              NVR(6),NUTC  ,IBIH  ,JBIH  ,                        &
     &              IFLUX ,JFLUX ,IBHSYS,IBHDAT,IBHTIM,IFLXSF,          &
     &              IBIHTL(2),IBIHHR,JBIHHR,NXBIHT
      COMMON/CEBARC/NEBIAS,NBIASE,NXCEBA
      COMMON/CGRAV/GM,AE,AESQ,FE,FFSQ32,FSQ32,XK2,XK3,XLAM,SIGXK2,      &
     &      SIGXK3,SIGLAM,RATIOM(2),AU,RPRESS
      COMMON/CITER /NINNER,NARC,NGLOBL
      COMMON/CITERL/LSTGLB,LSTARC,LSTINR,LNADJ ,LITER1,LSTITR,          &
     &              LOBORB,LRESID,LFREEZ,LSAVEF,LHALT,LADJPI,LADJCI
      COMMON/CLIGHT/VLIGHT,ERRLIM,XCLITE
      COMMON/CLVIEW/LNPRNT(18),NXCLVI
      COMMON/CNIARC/NSATA,NSATG,NSETA,NEQNG,NMORDR,NMORDV,NSORDR,       &
     &              NSORDV,NSUMX,NXDDOT,NSUMPX,NPXDDT,NXBACK,NXI,       &
     &              NXILIM,NPXPF,NINTIM,NSATOB,NXBCKP,NXTIMB,           &
     &              NOBSBK,NXTPMS,NXCNIA
      COMMON/CORA01/KFSEC0,KFSECB,KFSEC ,KFSECV,KH    ,KHV   ,KCTOL ,   &
     &              KRSQ  ,KVMATX,KCPP  ,KCPV  ,KCCP  ,KCCV  ,KCCPV ,   &
     &              KCCVV ,KXPPPP,KX    ,KPX   ,KSUMX ,KXDDOT,KSUMPX,   &
     &              KPXDDT,KAB   ,KPN   ,KAORN ,KSINLM,KCOSLM,KTANPS,   &
     &              KCRPAR,KVRARY,KXM   ,KXNP1 ,KXPRFL,KXM2  ,KXNNP1,   &
     &              KWRK  ,KFI   ,KGE   ,KB0DRG,KBDRAG,KAPGM ,KAPLM ,   &
     &              KCN   ,KSN   ,KSTID ,KTIDE ,KSTDRG,KSTSRD,KSTACC,   &
     &              KLGRAV,KGM   ,KAE   ,KFPL  ,KFEQ  ,KPLNPO,KPLNVL,   &
     &              KXEPOC,KCD   ,KCDDOT,KCR   ,KGENAC,KACN  ,KASN  ,   &
     &              KTHDRG,KCKEP ,KCKEPN,KXNRMZ,KXNRMC,KFSCEP,KFSCND,   &
     &              KAREA ,KXMASS,KRMSPO,KTCOEF,KTXQQ ,KTIEXP,KTXMM ,   &
     &              KTXLL1,KTXSN1,KTS2QQ,KT2M2H,KT2MHJ,KTXKK ,KTSCRH,   &
     &              KPXPK ,KAESHD,KCSAVE,KSSAVE,KCGRVT,KSGRVT,KXDTMC,   &
     &              KDNLT ,KTXSN2,KTNORM,KTWRK1,KTWRK2,KUNORM,KAERLG,   &
     &              KSINCO,KPARLG,KCONST,KBFNRM,KTDNRM,KCSTHT,KTPSTR,   &
     &              KTPSTP,KTPFYW,KPLMGM,KTPXAT,KEAQAT,KEAFSS,KEAINS,   &
     &              KACS  ,KECS  ,KSOLNA,KSOLNE,KSVECT,KSFLUX,KFACTX,   &
     &              KFACTY,KADIST,KGEOAN,KPALB ,KALBCO,KEMMCO,KCNAUX,   &
     &              KSNAUX,KPPER ,KACOSW,KBSINW,KACOFW,KBCOFW,KANGWT,   &
     &              KWT   ,KPLNDX,KPLANC,KTGACC,KTGDRG,KTGSLR,KWTACC,   &
     &              KWTDRG,KWTSLR,KTMACC,KTMDRG,KTMSLR,KATTUD,KDYACT,   &
     &              KACCBT,KACPER,KXDDNC,KXDDAO,KXNC  ,KXPPNC,KSMXNC,   &
     &              KXDDTH,KPDDTH,KXSSBS,KCPPNC,KEXACT,KXACIN,KXACOB,   &
     &              KPXHDT,KTPXTH,KPACCL,KTXSTA,KDELXS,KSMRNC,KPRX  ,   &
     &              KSMRNP,KDSROT,KXUGRD,KYUGRD,KZUGRD,KSUMRC,KXDDRC,   &
     &              KTMOS0,KTMOS, KTMOSP,KSMXOS,KSGTM1,KSGTM2,KSMPNS,   &
     &              KXGGRD,KYGGRD,KZGGRD,KXEGRD,KYEGRD,KZEGRD,KSSDST,   &
     &              KSDINS,KSDIND,KSSDSR,KSSDDG,KTATHM,KTAINS,KTAFSS,   &
     &              KSRAT ,KTRAT ,KHLDV ,KHLDA1,KHLDA4,KHLDA7,KQAST1,   &
     &              KQAST2,KQAST3,KQAST4,KQAST5,KQAST6,NXCA01
      COMMON/CORA02/KFSCTB,KFSCTC,KFSCTE,KDSECT,                        &
     &              KFSECT,KS    ,KCIP  ,KCIV  ,                        &
     &       KXTN  ,KXSM  ,KXTK  ,KXSJ  ,KXTI  ,KXTKP ,                 &
     &       KVTN  ,KVSM  ,KVTK  ,KVSJ  ,KVTI  ,KVTKP ,                 &
     &       KSATLT,KSATLN,KSATH ,KCOSTH,KSINTH,                        &
     &       KPXPFM,KPXPFK,KPXPFJ,KTRBF ,KFSTRC,                        &
     &       KFSTRE,KDSCTR,KFSCVS,KXSMBF,KXSKBF,KXSJBF,                 &
     &       KRSSV1,KRSSV2,KRSSV3,KTPMES,KACOEF,KACTIM,                 &
     &       KXTNPC,KXSMPC,KXTKPC,KXSJPC,KXTIPC,KXTKPP,                 &
     &       KRLRNG,KASTO,KASTP,NXCA02
      COMMON/CORA03/KRFMT ,KROTMT,KSRTCH,KCFSC ,KTHG  ,KCOSTG,KSINTG,   &
     &              KDPSI ,KEPST ,KEPSM ,KETA  ,KZTA  ,KTHTA ,KEQN  ,   &
     &              KDPSR ,KSL   ,KH2   ,KL2   ,KXPUT ,KYPUT ,KUT   ,   &
     &              KSPCRD,KSPSIG,KSTAIN,KSXYZ ,KSPWT ,KDXSDP,KDPSDP,   &
     &              KXLOCV,KSTNAM,KA1UT ,KPLTIN,KPLTVL,KPLTDV,KPUTBH,   &
     &              KABCOF,KSPEED,KANGFC,KSCROL,KSTVEL,KSTVDV,KTIMVL,   &
     &              KSTEL2,KSTEH2,KSL2DV,KSH2DV,                        &
     &              KAPRES, KASCAL, KASOFF,KXDOTP,KSAVST,               &
     &              KANGT , KSPDT , KCONAM,KGRDAN,KUANG ,KFAMP ,        &
     &              KOFACT, KOTSGN,KWRKRS,KANFSD,KSPDSD,KPRMFS,KSCRFR,  &
     &              KCOSAS,KSINAS,KDXTID,KALCOF,KSTANF,KNUTIN,KNUTMD,   &
     &              KPDPSI,KPEPST,KDXDNU,KDPSIE,KEPSTE,NXCA03
      COMMON/CORA04/KABIAS,KABSTR,KABSTP,KCBIAS,KCBSTR,KCBSTP,          &
     &       KRNM  ,KRKM  ,KRKJ  ,KRIJ  ,KRKPM ,                        &
     &       KRRNM ,KRRKM ,KRRKJ ,KRRIJ ,KRRKPM,                        &
     &       KURNM ,KURKM ,KURKJ ,KURIJ ,KURKPM,                        &
     &       KPRRNM,KPRRKM,KPRRKJ,KPRRIJ,KPRRKP,                        &
     &       KPMPXI,KPMPXE,KRA   ,KRELV ,KUHAT ,KWORK ,KTMPCR,KU    ,   &
     &       KS0   ,KS1   ,KXTP  ,KPXSXP,KPXDXP,KXUTDT,KRPOLE,KPXPOL,   &
     &       KXDPOL,KOBBUF,KOBSC ,KRESID,KSIGMA,KRATIO,KELEVS,          &
     &       KPMPA ,KPXSLV,KTPRTL,                                      &
     &       KFRQOF,KXYZOF,KFRQST,KFRQSA,KSTDLY,KSADLY,KXYZCG,KSCMRA,   &
     &       KEBVAL,KEBSIG,KEBNAM,KBTWB ,KTBTWA,KBTWD ,KPMPE ,          &
     &       KFSEB1,KFSEB2,KSTAMT,KPXSPA,KDIAGN,KOBOUT,KGRLT1,KGRLT2,   &
     &       KGRLT3,KGRLT4,KGRLT5,KPSTAT,KRSUNS,KCHEMR,KCHMOR,KEPOSR,   &
     &       KCHEMT,KCHMOT,KEPOST,KCHCBS,KCPOSS,KSCRTM,KXSTT ,KXSTR ,   &
     &       KXSS  ,KRANGT,KRANGR,KCHB1 ,KCHB2 ,KCHBV1,KCHBV2,KCHEB ,   &
     &       KSSTFQ,KSSTCC,KSSTSS,KSSTWT,KRLCOR,KWVLBI,KQUINF,KBRTS ,   &
     &       KBRTSV,KLRARC,KXEPBF,KXEPBR,KPRCBD,KPRTBD,KXPMPA,KXL,      &
     &       KXSIG ,KXEDTS,KXALO1,KXALO2,KXYOF2,KDLATF,KDLATS,KDLONF,   &
     &       KDLONS,KPF   ,KPS   ,                                      &
     &       KXOBSV,KXOBSW,KXEDSW,                                      &
     &       KXSIGW,KPSF  ,KDNUM ,KCNUM ,KFCOR ,KCOSAR,KSINAR,KSABIA,   &
     &       KSBTM1,KSBTM2,KYAWBS,KVLOUV,KACMAG,KOBSTR,                 &
     &       KPRL1 ,KPRL2, KRL1  ,KT1SE ,KTCP  ,                        &
     &       KRATDR,KFQT1S,KFQT1E,KT1STR,KFTTSE,KFRSTR,KFRRAT,KSV1  ,   &
     &       KSV2  ,KTSLOV,                                             &
     &       KGLGR1,KGLGR2,KGLFR1,KGLFR2,                               &
     &       KARGR1,KARGR2,KARFR1,KARFR2,                               &
     &       KRDS1L,KFT1AV,KDFQP ,KFREQ1,KFREQ3,KSAVD1,KSAVD2,          &
     &       KANTOU,KFM3CF,KF2CF,KTMG,KLTMG,KX2TIM,KX2OBS,KXRNDX,KX2SCR,&
     &       KALTWV,KXXBM ,KX2PAR,KATIME,KPMPAT,KPMATT,KX2PAT,          &
     &       KPXEXI,KPXEPA,KPV,KPXEP2,KX2COF,KACOF2,KACOF3,KBCOF,KBCOF2,&
     &       KDDDA ,KX2AUX,KX2VPR,KX2VPA,KEXTRA,KVARAY,KATROT,KATPER,   &
     &       KLTAR ,KXHOLD,KANTBL,KPHC  ,KOFDRV,KGNAME,KGRSIZ,KGRCNT,   &
     &       KGRDAT,KACCDT,KCTBTI,KCTBWE,KCTCTM,KANTUV,KANTOR,KW1PU ,   &
     &       KPYSQH,KSIGSP,KXYOF3,KXVTM1,KXDIST,KXDST0,KTMSE ,KDSDP ,   &
     &       KEXCST,KEXCDT,KEXCGX,KEXCGY,KEXCGZ,KIMNDX,KIMOBS,KIMTIM,   &
     &       KIMSAT,KM2VPA,KDCDD ,KDWNWT,KDPOR ,KC2PAR,KBOUNC,KBPART,   &
     &       NXCA04
      COMMON/CORA06/KPRMV ,KPNAME,KPRMV0,KPRMVC,KPRMVP,KPRMSG,KPARVR,   &
     &              KPRML0,KPDLTA,KSATCV,KSTACV,KPOLCV,KTIDCV,KSUM1 ,   &
     &              KSUM2 ,KGPNRA,KGPNRM,KPRSG0,KCONDN,KVELCV,          &
     &              KSL2CV,KSH2CV,KTIEOU,KPRMDF,NXCA06
      COMMON/CORI01/KMJDS0,KMJDSB,KMJDSC,KMJDSV,KIBACK,KIBAKV,KIORDR,   &
     &              KIORDV,KNOSTP,KNOCOR,KNSAT ,KN3   ,KNEQN ,KNEQN3,   &
     &              KNH   ,KNHV  ,KNSTPS,KNSTPV,KICPP ,KICPV ,KICCP ,   &
     &              KICCV ,KICCPV,KICCVV,KISUMX,KIXDDT,KISMPX,KIPXDD,   &
     &              KNMAX ,KNTOLD,KNTOLO,KICNT ,KISNT ,KMM   ,KKK   ,   &
     &              KJJ   ,KHH   ,KIBDY ,KSIGN1,KSIGN2,KLL   ,KQQ   ,   &
     &              KIORFR,KIPDFR,KITACC,KJSAFR,KJSPFR,KMJDEP,KMJDND,   &
     &              KNVSTP,KNSTRN,KNDARK,KTIPPT,KTJBDY,                 &
     &              KICNTA,KISNTA,KISHDP,KIPTC ,KIPTS ,KIGTSR,KIXTMC,   &
     &              KTIPTT,KTNOSD,KTQNDX,KTLL1 ,KTJJBD,KTITDE,KTCNTR,   &
     &              KTNN  ,KITACX,KNMOVE,KPANEL,KPLPTR,KNADAR,KNADSP,   &
     &              KNADDF,KNADEM,KNADTA,KNADTC,KNADTD,KNADTF,KNADTX,   &
     &              KITPMD,KSCATT,KITPAT,KILTPX,KEASBJ,KEANMP,KEANAN,   &
     &              KEAPMP,KEAPAN,KEAMJS,KEAPPP,KEAAAA,KICNTT,KISNTT,   &
     &              KTPGRC,KTPGRS,KTPC  ,KTPS  ,KALCAP,KEMCAP,KNSEG ,   &
     &              KICNTP,KISNTP,KNRDGA,KNRDDR,KNRDSR,KIRDGA,KIRDRG,   &
     &              KIRSLR,KSTRTA,KSTRTD,KSTRTS,KDYNPE,KACCPE,KIBCKN,   &
     &              KNRAT ,KIXDDN,KISMXN,KDXDDN,KDSMXN,KICPPN,KACSID,   &
     &              KNEQNH,KHRFRC,KPTFBS,KPTFSB,KIPXDA,KIACCP,KXSTAT,   &
     &              KPXST ,KSALST,KMAPLG,KNMBUF,KSTEPS,KSGMNT,KSATIN,   &
     &              KMEMST,KNEQNI,KBUFIN,KWEMGA,KWEMDR,KTPATS,KTANMP,   &
     &              KTAPPP,KTAMJS,KTASID,KGPSID,KNSSVA,KPNALB,KBRAX1,   &
     &              KBRAX2,KBRAX3,NXCI01
      COMMON/CORL01/KLORBT,KLORBV,KLNDRG,KLBAKW,KLSETS,KLAFRC,KLSTSN,   &
     &              KLSNLT,KLAJDP,KLAJSP,KLAJGP,KLTPAT,KEALQT,KLRDGA,   &
     &              KLRDDR,KLRDSR,KFHIRT,KLSURF,KHRFON,KLTPXH,KSETDN,   &
     &              KTALTA,NXCL01
      COMMON/CONSTR/PI,TWOPI,DEGRAD,SECRAD,SECDAY
      COMMON/CPARTL/LPART ,LPARTI,NXPARL
      COMMON/CSBSAT/KR,KRT,KZT,KXY2,KUZ,KUZSQ,KTEMP,KC3,KTHETG
      COMMON/CUNIT9/L9SET ,L9RES ,L9RSST,L9RSTY,L9EBS ,L9APAR,L9SUMP,   &
     &              L9GPAR,L9UPDT,L9LAST,L9OUT ,NXUNT9
      COMMON/CVIEW /IOUT6 ,ILINE6,IPAGE6,MLINE6,                        &
     &              IOUT8 ,ILINE8,IPAGE8,MLINE8,                        &
     &              IOUT9 ,ILINE9,IPAGE9,MLINE9,                        &
     &              IOUT10,ILIN10,IPAG10,MLIN10,                        &
     &              IOUT15,ILIN15,IPAG15,MLIN15,                        &
     &              IOUT16,ILIN16,IPAG16,MLIN16,                        &
     &              IOUT7 ,NXCVUE
      COMMON/EMAT  /EMTNUM,EMTPRT,EMTCNT,VMATRT,VMATS,VMATFR,FSCVMA,    &
     &              XEMAT
      COMMON/EPHMPT/NTOT,NTOTS,NNPDPR,NUTORD,IBODDG(8),IGRPDG(4),       &
     &              NENPD,INRCD(2),KPLAN(11),NINEP,NEPHMR,NEPHEM,       &
     &              IBHINT,NINTBH,NXEPHP
      COMMON/G2EINF/G2EVER,G2EDAT,G2ERTM
      COMMON/G2SINC/GRVDES(9),XG2SIC
      COMMON/G2SINF/G2SVER,G2SDAT,G2SRTM,G2SCOM,TDFVER,TDFRTM,SETCDS,   &
     &              GPCKSM,GPDEG ,GPORD ,XG2SIN
      COMMON/IBODPT/IBDCF(999),IBDSF(999),IBDGM(999),IBDAE(999),    &
     &              IBDPF(999),                                     &
     &              ICBDCF,ICBDSF,ICBDGM,ICBDAE,ICBDPF,             &
     &              ITBDCF,ITBDSF,ITBDGM,ITBDAE,ITBDPF,NXBDPT
      COMMON/NPCOM /NPNAME,NPVAL(92),NPVAL0(92),IPVAL(92),IPVAL0(92),   &
     &              MPVAL(28),MPVAL0(28),NXNPCM
      COMMON/NPCOMX/IXARC ,IXSATP,IXDRAG,IXSLRD,IXACCL,IXGPCA,IXGPSA,   &
     &              IXAREA,IXSPRF,IXDFRF,IXEMIS,IXTMPA,IXTMPC,IXTIMD,   &
     &              IXTIMF,IXTHTX,IXTHDR,IXOFFS,IXBISA,IXFAGM,IXFAFM,   &
     &              IXATUD,IXRSEP,IXACCB,IXDXYZ,IXGPSBW,IXCAME,IXBURN,  &
     &              IXGLBL,IXGPC ,IXGPS, IXTGPC,IXTGPS,IXGPCT,IXGPST,   &
     &              IXTIDE,IXETDE,IXOTDE,IXOTPC,IXOTPS,IXLOCG,IXKF  ,   &
     &              IXGM  ,IXSMA ,IXFLTP,IXFLTE,IXPLTP,IXPLTV,IXPMGM,   &
     &              IXPMJ2,IXVLIT,IXEPHC,IXEPHT,IXH2LV,IXL2LV,IXOLOD,   &
     &              IXPOLX,IXPOLY,IXUT1 ,IXPXDT,IXPYDT,IXUTDT,IXVLBI,   &
     &              IXVLBV,IXXTRO,IXBISG,IXSSTF,IXFGGM,IXFGFM,IXLNTM,   &
     &              IXLNTA,IX2CCO,IX2SCO,IX2GM ,IX2BDA,IXRELP,IXJ2SN,   &
     &              IXGMSN,IXPLNF,IXPSRF,IXANTD,IXTARG,                 &
     &              IXSTAP,IXSSTC,IXSSTS,IXSTAV,IXSTL2,                 &
     &              IXSTH2,IXDPSI,IXEPST,IXCOFF,IXTOTL,NXNPCX
      COMMON/PLMINI/ IYMDP0(5),IHMP0(5),MJDP0(5),IMNUNT(5)
      COMMON/PLMINR/ RMNMIN(5),SECP0(5),FSECP0(5),                      &
     &               XMNCHG(5),XINT(5),XJDT1(5),XJDT2(5),               &
     &               XKEP1(6,5),XKEP2(6,5)
      COMMON/PLMONI/IMNNUM(5,2),NXPLMI
      COMMON/TITLEC/TITLEG(10,3),TITLEA(10,10),XTITLE
      COMMON/TITLER/TITLEN,XTITLR
      COMMON/UNITS/IUNT11,IUNT12,IUNT13,IUNT19,IUNT30,IUNT71,IUNT72,    &
     &             IUNT73,IUNT05,IUNT14,IUNT65,IUNT88,IUNT21,IUNT22,    &
     &             IUNT23,IUNT24,IUNT25,IUNT26
      DIMENSION AA(1),II(1),LL(1),PARML0(3,1)
      DIMENSION MJDSB (NSETA),FSECB (NSETA),MJDSEP(NSETA),FSECEP(NSETA),&
     &          MJDSND(NSETA),FSECND(NSETA),H     (NSETA),HV    (NSETA),&
     &          NSAT  (NSETA),AREA  (NSATA),XMASS (NSATA),ISATNO(NSATA)
      DIMENSION IEPYMD(1),IEPHM(1),IYMD(2),IHM(2),IYMDRF(1),IHMRF(1)
      DIMENSION FSEC(3),EPSEC(1),SEC(2),REFSEC(1)
      DIMENSION UTDT(1)
      DIMENSION XYZCUR(6,NSATA),CKEPLR(6,NSATA),ETUTC(1),RMSPOS(2,NSATA)
      CHARACTER(8)      :: XGPARM
      DIMENSION REFSYS(4),IYATDN(4),IXGPAR(51),NXGPAR(51),NAGPAR(51),   &
     &   GPNAM(51),XGPARM(51),IXAPAR(8)
      DIMENSION XYZ(6),AEI(6),MUNITS(6),KUNITS(6)
      DIMENSION RATNAM(8),RATES(8),RUNITS(8)
      DIMENSION DUM(3),DUM1(3,2,1)
      EQUIVALENCE (IXGPAR(1),IXGPC),(IXAPAR(1),IXSATP)
      DATA C360/360.0D0/
      DATA ZERO/0.0D0/,ONE/1.0D0/,HUNDRD/1.0D2/,C1D6/1.0D6/
      CHARACTER(8)      :: REFSYS
      DATA REFSYS/'UNKNOWN ','MIXED 79','PRE-1979','POST1979'/
      DATA IYATDN/9999,1971,1977,1987/
      DATA MGTYPE/51/
      CHARACTER(8)      :: GPNAM
      DATA GPNAM/'C COEF  ','S COEF  ','CCOEF TP','SCOEF TP',           &
     &           'CCOEFDYN','SCOEFDYN','K TIDES ','E TIDES ',           &
     &           'O TIDES ','OTPF C  ','OTPF S  ','LOCAL G ',           &
     &           'FIG A AX','GM      ','S.M.A.  ','P. FLAT.','E. FLAT.',&
     &           'PLANET P','PLANET V','PLMOONGM','PLMOONJ2',           &
     &           'V-LIGHT ','EPCOR CB','EPCOR TB','H2 TIDE ','L2 TIDE ',&
     &           'OCEAN LO','POLE X  ','POLE Y  ','UT1     ',           &
     &           'POLE XDT','POLE YDT','UT1 DOT ','QUAS POS','QUAS VEL',&
     &           'PLANOR  ','BIASES  ','SSTF    ','FANTOM G','FANTOM F',&
     &           'LEN.TH.M','LEN.TH.U','PLANET T','STA.POS.','SEASUR C',&
     &           'SEASUR S','STA VEL.','STA. L2 ','STA. H2 ','NUT DPSI',&
     &           'NUT EPST'/

      DATA MATYPE/8/
      CHARACTER(8)      :: SUNLIT, CSHADOW, SUNBEG
      DATA SUNLIT/'SUNLIGHT'/,CSHADOW/' SHADOW '/
      CHARACTER(8)      :: XYZ
      DATA XYZ/'X POS  =','Y POS  =','Z POS  =',                        &
     &         'X VEL  =','Y VEL  =','Z VEL  ='/
      CHARACTER(8)      :: MUNITS
      DATA MUNITS/' M  ',' M  ',' M  ',' M/S',' M/S',' M/S'/
      CHARACTER(8)      :: AEI
      DATA AEI/'S.M.A. =','ECCEN. =','INCLIN =',                        &
     &         'NODE   =','PERG   =','MEAN   ='/
      CHARACTER(8)      :: KUNITS
      DATA KUNITS/' M  ','    ',' DEG',' DEG',' DEG',' DEG'/
      CHARACTER(8)      :: ARC, GLOBAL
      DATA ARC/'   ARC  '/,GLOBAL/' GLOBAL '/
      CHARACTER(8)      :: RATNAM
      DATA RATNAM/'APOGEE =','ASC NODE','PERIGEE=','ARG PERG',          &
     &            'PERIOD =','PERIOD  ','DRAG   =','S-M AXIS'/
      CHARACTER(8)      :: RUNITS
      DATA RUNITS/'METERS  ','DEG/DAY ','METERS  ','DEG/DAY ',          &
     &            'MINUTES ','SEC/DAY ','M/DAY**2','M/DAY   '/
!
!**********************************************************************
! START OF EXECUTABLE CODE ********************************************
!**********************************************************************
!
!
! WRITE ARC SUMMARY PAGE TO UNIT 6 PRINT FILE
!
! PAGE HEADING
      IPAGE6=IPAGE6+1
      ILINE6=1
      WRITE(IOUT6,10000) NARC,NINNER,NGLOBL,IPAGE6
! PROGRAM VERSIONS AND RUN TIMES
      DATE2E=G2ERTM/C1D6
      TIME2E=MOD(G2ERTM,C1D6)
      DATE2S=G2SRTM/C1D6
      TIME2S=MOD(G2SRTM,C1D6)
      DATTDF=TDFRTM/C1D6
      TIMTDF=MOD(TDFRTM,C1D6)
      ILINE6=ILINE6+4
      WRITE(IOUT6,10100) G2EVER,G2EDAT,DATE2E,TIME2E,                   &
     &                   G2SVER,G2EDAT,DATE2S,TIME2S,                   &
     &                   TDFVER,       DATTDF,TIMTDF
! TABLE DATES AND B.I.H. REFERENCE SYSTEM
      IRFSYS=1
      IF(IBHSYS.GE.0.AND.IBHSYS.LT.3) IRFSYS=IBHSYS+2
      ILINE6=ILINE6+6
      WRITE(IOUT6,10200) IBHDAT,IBHTIM,REFSYS(IRFSYS),                  &
     &   IFLUXS,IFLXKP,IPOLA1,IA1UTC,                                   &
     &   JFLUXS,JFLXKP,JPOLA1,JA1UTC
      WRITE(IUNT88,10200) IBHDAT,IBHTIM,REFSYS(IRFSYS),                 &
     &   IFLUXS,IFLXKP,IPOLA1,IA1UTC,                                   &
     &   JFLUXS,JFLXKP,JPOLA1,JA1UTC
! GRAVITY MODEL
      ILINE6=ILINE6+5
      EQFLAT=ONE/FE
      WRITE(IOUT6,10300) GM,VLIGHT,AE,EQFLAT,GPCKSM,GRVDES
      WRITE(IUNT88,10300) GM,VLIGHT,AE,EQFLAT,GPCKSM,GRVDES
! JPL EPHEMERIS VERSION
      ILINE6=ILINE6+2
      WRITE(IOUT6,10400) NEPHEM
      IF(NEPHEM.GT.1000) THEN
          NEPHMO=NEPHEM-1000
          WRITE(IOUT6,10477) NEPHMO
          WRITE(IOUT6,10478)
          WRITE(IOUT6,10479)
          WRITE(IOUT6,10480)
      ENDIF
      WRITE(IUNT88,10400) NEPHEM
      IF(NEPHEM.GT.1000) THEN
          NEPHMO=NEPHEM-1000
          WRITE(IUNT88,10477) NEPHMO
          WRITE(IUNT88,10478)
          WRITE(IUNT88,10479)
          WRITE(IUNT88,10480)
      ENDIF
! ATMOSPHERIC DENSITY MODEL
      JATDEN=1
      IATDN=IATDEN/10
      IF(IATDN.GT.1.AND.IATDN.LE.4) JATDEN=IATDN
      ILINE6=ILINE6+1
!!!!      IF(JATDEN.NE.4) GOTO 900
!!!!      WRITE(IOUT6,10550) IYATDN(JATDEN)
!!!!      GOTO 950
!!!!  900 WRITE(IOUT6,10500) IYATDN(JATDEN)
!!!!      WRITE(IUNT88,10500) IYATDN(JATDEN)
      IF(IATDN.EQ.2) WRITE(6,10551)
      IF(IATDN.EQ.4) WRITE(6,10552)
      IF(IATDN.EQ.5) WRITE(6,10553)
!      IF(IATDN.EQ.6) WRITE(6,10554)
  950 CONTINUE
! GLOBAL PARAMETER SUMMARY
      NGTYPE=0
      DO 1000 N=1,MGTYPE
      I=IXGPAR(N)
      NP=NPVAL(I)
      IF(NP.LE.0) GO TO 1000
      NGTYPE=NGTYPE+1
      XGPARM(NGTYPE)=GPNAM(N)
      NXGPAR(NGTYPE)=NP
      NAGPAR(NGTYPE)=NPVAL0(I)
 1000 END DO
      NLINES=6+(NGTYPE+2)/3
      ILINE6=ILINE6+NLINES
      IF(ILINE6.LE.MLINE6) GO TO 1100
      IPAGE6=IPAGE6+1
      ILINE6=1
      WRITE(IOUT6,20000) NARC,NGLOBL,IPAGE6
 1100 CONTINUE
      WRITE(IOUT6,10600)
      DO 1200 I1=1,NGTYPE,3
      I2=MIN(I1+2,NGTYPE)
      WRITE(IOUT6,10700) (XGPARM(I),NXGPAR(I),NAGPAR(I),I=I1,I2)
 1200 END DO
! ARC TITLE CARDS
      NARTTL=INT(TITLEN)
      ILINE6=ILINE6+2+NARTTL
      IF(ILINE6.LE.MLINE6) GO TO 1400
      IPAGE6=IPAGE6+1
      ILINE6=4+NARTTL
      WRITE(IOUT6,20000) NARC,NGLOBL,IPAGE6
 1400 CONTINUE
      WRITE(IOUT6,10780)
      DO 1450 J=1,NARTTL
      WRITE(IOUT6,10790) (TITLEA(I,J),I=1,9)
 1450 END DO
! ARC PARAMETER SUMMARY
      IBEG=IXARC
      IEND=IXGLBL-1
      ILINE6=ILINE6+23
      IF(ILINE6.LE.MLINE6) GO TO 1600
      IPAGE6=IPAGE6+1
      ILINE6=10
      WRITE(IOUT6,20000) NARC,NGLOBL,IPAGE6
 1600 CONTINUE
      WRITE(IOUT6,70800)
      WRITE(IOUT6,70101)
      WRITE(IOUT6,70111)
      WRITE(IOUT6,70203)(NPVAL(IJ),NPVAL0(IJ),IJ=IBEG,IEND)
! CONVERGENCE TEST RESULTS
      ILINE6=ILINE6+2
      IF(ILINE6.LE.MLINE6) GO TO 1700
      IPAGE6=IPAGE6+1
      ILINE6=3
      WRITE(IOUT6,20000) NARC,NGLOBL,IPAGE6
 1700 CONTINUE
      IF(     LCONVG) WRITE(IOUT6,10900) PERCNT,NINNER
      IF(.NOT.LCONVG) WRITE(IOUT6,10910) PERCNT,NINNER
! CONVERT REFERENCE TIME FROM MJDS IN E.T. TO YMD IN UTC
      FSEC(1)=FSECRF
      CALL UTCET(.FALSE.,1,MJDSRF,FSEC,EPSEC,ETUTC)
      CALL YMDHMS(MJDSRF,EPSEC,IYMDRF,IHMRF,REFSEC,1)
! WRITE COORDINATE SYSTEM REFERENCE EPOCH
      ILINE6=ILINE6+2
      IF(ILINE6.LE.MLINE6) GO TO 1900
      IPAGE6=IPAGE6+1
      ILINE6=3
      WRITE(IOUT6,20000) NARC,NGLOBL,IPAGE6
 1900 CONTINUE
      WRITE(IOUT6,11000) IYMDRF,IHMRF,REFSEC
!
      IF(.NOT.L9SUMP) GO TO 3000
!
! WRITE ARC SUMMARY PAGE TO TERMINAL VIEW FILE
!
! PAGE HEADING
      IPAGE9=IPAGE9+1
      ILINE9=1
      WRITE(IOUT9,10009) NARC,NINNER,NGLOBL,IPAGE9
! PROGRAM VERSIONS AND RUN TIMES
      ILINE9=ILINE9+4
      WRITE(IOUT9,10100) G2EVER,G2EDAT,DATE2E,TIME2E,                   &
     &                   G2SVER,G2EDAT,DATE2S,TIME2S,                   &
     &                   TDFVER,       DATTDF,TIMTDF
! TABLE DATES AND B.I.H. REFERENCE SYSTEM
      ILINE9=ILINE9+6
      WRITE(IOUT9,10200) IBHDAT,IBHTIM,REFSYS(IRFSYS),                  &
     &   IFLUXS,IFLXKP,IPOLA1,IA1UTC,                                   &
     &   JFLUXS,JFLXKP,JPOLA1,JA1UTC
! GRAVITY MODEL
      ILINE9=ILINE9+5
      WRITE(IOUT9,10300) GM,VLIGHT,AE,EQFLAT,GPCKSM,GRVDES
! JPL EPHEMERIS VERSION
      ILINE9=ILINE9+2
      WRITE(IOUT9,10400) NEPHEM
      IF(NEPHEM.GT.1000) THEN
          NEPHMO=NEPHEM-1000
          WRITE(IOUT9,10477) NEPHMO
          WRITE(IOUT9,10478)
          WRITE(IOUT9,10479)
          WRITE(IOUT9,10480)
      ENDIF
! ATMOSPHERIC DENSITY MODEL
      ILINE9=ILINE9+1
      IF(JATDEN.NE.4) GOTO 2010
      WRITE(IOUT9,10550) IYATDN(JATDEN)
      WRITE(IUNT88,10550) IYATDN(JATDEN)
      GOTO 2020
 2010 WRITE(IOUT9,10500) IYATDN(JATDEN)
 2020 CONTINUE
! GLOBAL PARAMETER SUMMARY
      NLINES=6+(NGTYPE+2)/3
      ILINE9=ILINE9+NLINES
      IF(ILINE9.LE.MLINE9) GO TO 2100
      IPAGE9=IPAGE9+1
      ILINE9=1
      WRITE(IOUT9,20009) NARC,NGLOBL,IPAGE9
 2100 CONTINUE
      WRITE(IOUT9,10600)
      DO 2200 I1=1,NGTYPE,3
      I2=MIN(I1+2,NGTYPE)
      WRITE(IOUT9,10700) (XGPARM(I),NXGPAR(I),NAGPAR(I),I=I1,I2)
 2200 END DO
! ARC TITLE CARDS
      NARTTL=INT(TITLEN)
      ILINE9=ILINE9+2+NARTTL
      IF(ILINE9.LE.MLINE9) GO TO 2400
      IPAGE9=IPAGE9+1
      ILINE9=4+NARTTL
      WRITE(IOUT9,20009) NARC,NGLOBL,IPAGE9
 2400 CONTINUE
      WRITE(IOUT9,10780)
      DO 2450 J=1,NARTTL
      WRITE(IOUT9,10790) (TITLEA(I,J),I=1,9)
 2450 END DO
! ARC PARAMETER SUMMARY
      ILINE9=ILINE9+8
      IF(ILINE9.LE.MLINE9) GO TO 2600
      IPAGE9=IPAGE9+1
      ILINE9=10
      WRITE(IOUT9,20009) NARC,NGLOBL,IPAGE9
 2600 CONTINUE
      IBEG=IXARC
      IEND=IXGLBL-1
      WRITE(IOUT9,70800)
      WRITE(IOUT9,70101)
      WRITE(IOUT9,70111)
      WRITE(IOUT9,70203)(NPVAL(IJ),NPVAL0(IJ),IJ=IBEG,IEND)
!
! CONVERGENCE TEST RESULTS
      ILINE9=ILINE9+2
      IF(ILINE9.LE.MLINE9) GO TO 2700
      IPAGE9=IPAGE9+1
      ILINE9=3
      WRITE(IOUT9,20009) NARC,NGLOBL,IPAGE9
 2700 CONTINUE
      IF(     LCONVG) WRITE(IOUT9,10900) PERCNT,NINNER
      IF(.NOT.LCONVG) WRITE(IOUT9,10910) PERCNT,NINNER
! WRITE COORDINATE SYSTEM REFERENCE EPOCH
      ILINE9=ILINE9+2
      IF(ILINE9.LE.MLINE9) GO TO 2900
      IPAGE9=IPAGE9+1
      ILINE9=3
      WRITE(IOUT9,20009) NARC,NGLOBL,IPAGE9
 2900 CONTINUE
      WRITE(IOUT9,11000) IYMDRF,IHMRF,REFSEC
!
 3000 CONTINUE
!
! LOOP ON EACH SATELLITE SET PRINTING EPOCH TIMES AND INTEGRATION STEPS
!
      ISAT=0
      DO 4000 ISET=1,NSETA
! CONVERT EPOCH TIME FROM MJDS IN E.T. TO YMD IN UTC
      CALL UTCET(.FALSE.,1,MJDSB(ISET),FSECB(ISET),FSEC(1),ETUTC)
      CALL YMDHMS(MJDSB(ISET),FSEC(1),IEPYMD,IEPHM,EPSEC,1)
! CONVERT ORIGINAL EPOCH TIME FROM MJDS IN E.T. TO YMD IN UTC
      CALL UTCET(.FALSE.,1,MJDSEP(ISET),FSECEP(ISET),FSEC(2),ETUTC)
      CALL YMDHMS(MJDSEP(ISET),FSEC(2),IYMD(1),IHM(1),SEC(1),1)
! CONVERT STOP TIME FROM MJDS IN E.T. TO YMD IN UTC
      CALL UTCET(.FALSE.,1,MJDSND(ISET),FSECND(ISET),FSEC(3),ETUTC)
      CALL YMDHMS(MJDSND(ISET),FSEC(3),IYMD(2),IHM(2),SEC(2),1)
! WRITE TIMES AND INTEGRATION STEPSIZES TO PRINTER
      NLINE6=ILINE6+11
      IF(NLINE6.LE.MLINE6) GO TO 3100
      IPAGE6=IPAGE6+1
      ILINE6=1
      WRITE(IOUT6,20000) NARC,NGLOBL,IPAGE6
 3100 CONTINUE
      ILINE6=ILINE6+3
      WRITE(IOUT6,11100) IEPYMD,IEPHM,EPSEC,                            &
     &   (IYMD(I),IHM(I),SEC(I),I=1,2),H(ISET),HV(ISET)
      IF(.NOT.L9SUMP) GO TO 3300
! WRITE TIMES AND INTEGRATION STEPSIZES TO TERMINAL VIEW FILE
      NLINE9=ILINE9+11
      IF(NLINE9.LE.MLINE9) GO TO 3200
      IPAGE9=IPAGE9+1
      ILINE9=1
      WRITE(IOUT9,20009) NARC,NGLOBL,IPAGE9
 3200 CONTINUE
      ILINE9=ILINE9+3
      WRITE(IOUT9,11100) IEPYMD,IEPHM,EPSEC,                            &
     &   (IYMD(I),IHM(I),SEC(I),I=1,2),H(ISET),HV(ISET)
 3300 CONTINUE
      NSTEPS=II(KNOSTP+ISET-1)
      NOCORR=II(KNOCOR+ISET-1)
      IF( NSTEPS .GT. 0 ) THEN
         AVGCOR=DBLE(NOCORR)/DBLE(NSTEPS)
      ELSE
         AVGCOR = ZERO
      ENDIF
      NSTEPV=II(KNVSTP+ISET-1)
       !WRITE(6,'(/A,1x,I10)')  'SUMMRY: NSTEPS ',NSTEPS
       !WRITE(6,'(A,1x,I10)')   'SUMMRY: NOCORR ',NOCORR
       !WRITE(6,'(A,1x,E15.7)') 'SUMMRY: AVGCOR ',AVGCOR
       !WRITE(6,'(A,1x,I10)')   'SUMMRY: NSTEPV ',NSTEPV
!
! LOOP ON EACH SATELLITE PRINTING ELEMENTS IN CARTESIAN AND KEPLERIAN
!
      NSATS=NSAT(ISET)
      DO 4000 ISATS=1,NSATS
      ISAT=ISAT+1
      LSUNLT=LL(KLSNLT+ISAT-1)
      NTRANS=II(KNSTRN+ISAT-1)
      NDARKS=II(KNDARK+ISAT-1)
      IF( NSTEPS .GT. 0 ) THEN
         DARKNS=HUNDRD*DBLE(NDARKS)/DBLE(NSTEPS)
      ELSE
         DARKNS = ZERO
      ENDIF
      SUNBEG=CSHADOW
      IF(LSUNLT) SUNBEG=SUNLIT
! WRITE SATELLITE INFORMATION TO PRINTER
      ILINE6=ILINE6+12
      IF(ILINE6.LE.MLINE6) GO TO 3400
      IPAGE6=IPAGE6+1
      ILINE6=13
      WRITE(IOUT6,20000) NARC,NGLOBL,IPAGE6
 3400 CONTINUE
      WRITE(IOUT6,11200) ISATNO(ISAT),AREA(ISAT),XMASS(ISAT),           &
     &   NSTEPS,AVGCOR,NSTEPV,SUNBEG,NTRANS,DARKNS,                     &
     &   (XYZ(I),XYZCUR(I,ISAT),MUNITS(I),                              &
     &    AEI(I),CKEPLR(I,ISAT),KUNITS(I),I=1,6),                       &
     &   (RMSPOS(I,ISAT),I=1,2)
!
! CALCULATION OF GEOCENTRIC LATITUDE(GEOLAT), LONGITUDE
!  (GEOLNG) & HEIGHT USING CARTESIAN COORDINATES AND
!  GREENWICH HOUR ANGLE TRANSFORMATIONS
!
      IF(ICBDGM.EQ.3) THEN
      CALL GRHRAN(MJDSEP(ISET),FSECEP(ISET),.TRUE.,.FALSE.,             &
     &    AA(KEQN),AA(KSRTCH),AA(KTHETG),AA(KCOSTH),AA(KSINTH),         &
     &    1,AA,II,AA(KXUTDT),.FALSE.,DUM,DUM1)
      ELSE
      CALL ROTXTR(MJDSEP(ISET),FSECEP(ISET),.FALSE.,AA(KEQN),           &
     &    AA(KSRTCH),AA(KTHETG),AA(KCOSTH),AA(KSINTH),1,AA,             &
     &      AA(KACOSW),AA(KBSINW),AA(KANGWT),AA(KWT),AA(KACOFW),        &
     &      AA(KBCOFW),II,1)
      ENDIF
!
! USE OF GREENWICH HOUR ANGLE TO CALCULATE POSITION MATRIX
!  IN THE TRANSFORMATION OF CARTESIAN COORDINATES TO PSEUDO
!  BODY-FIXED COORDINATES IN THE CALCULATION OF GEOCENTRIC
!  LATITUDE, LONGITUDE AND HEIGHT
!
      GHA=AA(KTHETG)
      XTMP=(COS(GHA)*XYZCUR(1,ISAT) + SIN(GHA)*XYZCUR(2,ISAT) +         &
     &     0 * XYZCUR(3,ISAT))
      YTMP=(-SIN(GHA)*XYZCUR(1,ISAT)+ COS(GHA)*XYZCUR(2,ISAT) +         &
     &     0 * XYZCUR(3,ISAT))
      ZTMP=(0 * XYZCUR(1,ISAT) + 0 * XYZCUR(2,ISAT) +                   &
     &     1 * XYZCUR(3,ISAT))
      RADIUS=SQRT((XTMP)**2 + (YTMP)**2 + (ZTMP)**2)
      GEOLAT=(ASIN(ZTMP/RADIUS))/DEGRAD
      GEOLNG=(ATAN2(YTMP,XTMP))/DEGRAD
      IF(GEOLNG.LT.ZERO) GEOLNG=GEOLNG+C360
      HEIGHT=RADIUS-AE
      WRITE(IOUT6,11225)
      WRITE(IOUT6,11250) GEOLAT,GEOLNG,HEIGHT
!
      ILINE6=ILINE6+(NRATES+3)/2+5
      IF(ILINE6.LE.MLINE6) GO TO 3500
      IPAGE6=IPAGE6+1
      ILINE6=1+(NRATES+3)/2
      WRITE(IOUT6,20000) NARC,NGLOBL,IPAGE6
 3500 CONTINUE
! OBTAIN ANALYTIC RATES
      CALL SUMCMP(AA,II,LL,ISAT      ,II(KMJDS0),AA(KFSEC0),II(KMJDSV), &
     &          AA(KFSECV),                                             &
     &          AA(KHV   ),II(KMJDSC),AA(KFSEC ),AA(KH    ),II(KNEQN ), &
     &          II(KNSAT ),AA(KPRMVC),NRATES    ,RATES     )
      WRITE(IOUT6,11300) (RATNAM(I),RATES(I),RUNITS(I),I=1,NRATES)
      IF(.NOT.L9SUMP) GO TO 4000
! WRITE SATELLITE INFORMATION TO TERMINAL VIEW FILE
      ILINE9=ILINE9+12
      IF(ILINE9.LE.MLINE9) GO TO 3700
      IPAGE9=IPAGE9+1
      ILINE9=13
      WRITE(IOUT9,20009) NARC,NGLOBL,IPAGE9
 3700 CONTINUE
      WRITE(IOUT9,11200) ISATNO(ISAT),AREA(ISAT),XMASS(ISAT),           &
     &   NSTEPS,AVGCOR,NSTEPV,SUNBEG,NTRANS,DARKNS,                     &
     &   (XYZ(I),XYZCUR(I,ISAT),MUNITS(I),                              &
     &    AEI(I),CKEPLR(I,ISAT),KUNITS(I),I=1,6),                       &
     &   (RMSPOS(I,ISAT),I=1,2)
      WRITE(IOUT9,11225)
      WRITE(IOUT9,11250) GEOLAT,GEOLNG,HEIGHT
      ILINE9=ILINE9+(NRATES+3)/2+5
      IF(ILINE9.LE.MLINE9) GO TO 3800
      IPAGE9=IPAGE9+1
      ILINE9=1+(NRATES+3)/2
      WRITE(IOUT9,20009) NARC,NGLOBL,IPAGE9
 3800 CONTINUE
      WRITE(IOUT9,11300) (RATNAM(I),RATES(I),RUNITS(I),I=1,NRATES)
 4000 CONTINUE
!
!     ....PRINT THE TIME OF CLOSEST APPROACH TO PHOBOS, AND DISTANCE
!
      IF(NPVAL(IXPMGM).GT.0) THEN
      DO 4010 IMN=1,NPVAL(IXPMGM)
      CALL UTCET(.FALSE.,1,MJDP0(IMN),FSECP0(IMN),FSEC(1),ETUTC)
      CALL YMDHMS(MJDP0(IMN),FSEC(1),IYMDP0(IMN),IHMP0(IMN),SECP0(IMN), &
     &            1)
!
      WRITE(IOUT6,*) ' '
      WRITE(IOUT6,*) '********************************************'
      WRITE(IOUT6,*) '********************************************'
      WRITE(IOUT6,*) ' '
      WRITE(IOUT6,*) 'TIME OF CLOSEST APPROACH TO MOON #:',IMNNUM(IMN,1)
      WRITE(IOUT6,*) IYMDP0(IMN),IHMP0(IMN),SECP0(IMN)
      WRITE(IOUT6,*) ' '
      WRITE(IOUT6,*) 'MINIMUM DISTANCE FROM SATELLITE TO MOON #:',      &
     &                IMNNUM(IMN,1)
      WRITE(IOUT6,*) RMNMIN(IMN), '    (METERS) '
      WRITE(IOUT6,*) ' '
      WRITE(IOUT6,*) '********************************************'
      WRITE(IOUT6,*) '********************************************'
      WRITE(IOUT6,*) ' '
      ILINE6 = ILINE6 + 13
      IF(ILINE6 .GT. MLINE6) THEN
         IPAGE6=IPAGE6+1
         ILINE6=1+(NRATES+3)/2
         WRITE(IOUT6,20000) NARC,NGLOBL,IPAGE6
      ENDIF
!
!
      WRITE(IOUT9,*) ' '
      WRITE(IOUT9,*) '********************************************'
      WRITE(IOUT9,*) '********************************************'
      WRITE(IOUT9,*) ' '
      WRITE(IOUT9,*) 'TIME OF CLOSEST APPROACH TO MOON #:',IMNNUM(IMN,1)
      WRITE(IOUT9,*) IYMDP0(IMN),IHMP0(IMN),SECP0(IMN)
      WRITE(IOUT9,*) ' '
      WRITE(IOUT9,*) 'MINIMUM DISTANCE FROM SATELLITE TO MOON #:',      &
     &                IMNNUM(IMN,1)
      WRITE(IOUT9,*) RMNMIN(IMN), '    (METERS) '
      WRITE(IOUT9,*) ' '
      WRITE(IOUT9,*) '********************************************'
      WRITE(IOUT9,*) '********************************************'
      WRITE(IOUT9,*) ' '
      ILINE9 = ILINE9 + 13
      IF( ILINE9 .GT. MLINE9) THEN
         IPAGE9=IPAGE9+1
         ILINE9=1+(NRATES+3)/2
         WRITE(IOUT9,20009) NARC,NGLOBL,IPAGE9
      ENDIF
 4010 END DO
      ENDIF
!
      IF(EMTNUM.LE.ZERO.OR..NOT.LSTITR) GO TO 9900
      IF(LNPRNT(12)) GO TO 9900
!
! OUTPUT E-MATRIX LABELS TO UNIT6
      IF(LPARTI) GOTO 8900
      K1=1
      NARCPR=NPVAL0(IXARC)
      IF(NARCPR.LE.0) GO TO 8500
! ARC PARAMETER LABELS
      I1=IPVAL0(IXARC)
      I2=I1+NARCPR-1
      NLINE6=ILINE6+6
      IF(NLINE6.LE.MLINE6) GO TO 8100
      IPAGE6=IPAGE6+1
      NLINE6=8
      WRITE(IOUT6,20000) NARC,NGLOBL,IPAGE6
 8100 CONTINUE
      ILINE6=NLINE6-1
      WRITE(IOUT6,19000) ARC   ,EMTNUM
      DO 8300 J1=I1,I2,7
      J2=MIN(J1+6,I2)
      ILINE6=ILINE6+1
      IF(ILINE6.LE.MLINE6) GO TO 8200
      IPAGE6=IPAGE6+1
      ILINE6=8
      WRITE(IOUT6,20000) NARC,NGLOBL,IPAGE6
      WRITE(IOUT6,19100) ARC
 8200 CONTINUE
      WRITE(IOUT6,19200) K1,(PARML0(1,J),J=J1,J2)
      K1=K1+7
 8300 END DO
      K1=NARCPR+1
 8500 CONTINUE
      NGLBPR=NPVAL0(IXGLBL)
      IF(NGLBPR.LE.0) GO TO 8900
! GLOBAL PARAMETER LABELS
      I1=IPVAL0(IXGLBL)
      I2=I1+NGLBPR-1
      NLINE6=ILINE6+6
      IF(NLINE6.LE.MLINE6) GO TO 8600
      IPAGE6=IPAGE6+1
      NLINE6=8
      WRITE(IOUT6,20000) NARC,NGLOBL,IPAGE6
 8600 CONTINUE
      ILINE6=NLINE6-1
      WRITE(IOUT6,19000) GLOBAL,EMTNUM
      DO 8800 J1=I1,I2,7
      J2=MIN(J1+6,I2)
      ILINE6=ILINE6+1
      IF(ILINE6.LE.MLINE6) GO TO 8700
      IPAGE6=IPAGE6+1
      ILINE6=8
      WRITE(IOUT6,20000) NARC,NGLOBL,IPAGE6
      WRITE(IOUT6,19100) GLOBAL
 8700 CONTINUE
      WRITE(IOUT6,19200) K1,(PARML0(1,J),J=J1,J2)
      K1=K1+7
 8800 END DO
 8900 CONTINUE
!
      IF(.NOT.L9SUMP) GO TO 9900
!
! OUTPUT E-MATRIX LABELS TO UNIT9
      IF(LPARTI) GOTO 9900
      K1=1
      IF(NARCPR.LE.0) GO TO 9500
! ARC PARAMETER LABELS
      I1=IPVAL0(IXARC)
      I2=I1+NARCPR-1
      NLINE9=ILINE9+6
      IF(NLINE9.LE.MLINE9) GO TO 9100
      IPAGE9=IPAGE9+1
      NLINE9=8
      WRITE(IOUT9,20009) NARC,NGLOBL,IPAGE9
 9100 CONTINUE
      ILINE9=NLINE9-1
      WRITE(IOUT9,19009) ARC   ,EMTNUM
      DO 9300 J1=I1,I2,4
      J2=MIN(J1+3,I2)
      ILINE9=ILINE9+1
      IF(ILINE9.LE.MLINE9) GO TO 9200
      IPAGE9=IPAGE9+1
      ILINE9=8
      WRITE(IOUT9,20009) NARC,NGLOBL,IPAGE9
      WRITE(IOUT9,19109) ARC
 9200 CONTINUE
      WRITE(IOUT9,19209) K1,(PARML0(1,J),J=J1,J2)
      K1=K1+4
 9300 END DO
      K1=NARCPR+1
 9500 CONTINUE
      IF(NGLBPR.LE.0) GO TO 9900
! GLOBAL PARAMETER LABELS
      I1=IPVAL0(IXGLBL)
      I2=I1+NGLBPR-1
      NLINE9=ILINE9+6
      IF(NLINE9.LE.MLINE9) GO TO 9600
      IPAGE9=IPAGE9+1
      NLINE9=8
      WRITE(IOUT9,20009) NARC,NGLOBL,IPAGE9
 9600 CONTINUE
      ILINE9=NLINE9-1
      WRITE(IOUT9,19009) GLOBAL,EMTNUM
      DO 9800 J1=I1,I2,4
      J2=MIN(J1+3,I2)
      ILINE9=ILINE9+1
      IF(ILINE9.LE.MLINE9) GO TO 9700
      IPAGE9=IPAGE9+1
      ILINE9=8
      WRITE(IOUT9,20009) NARC,NGLOBL,IPAGE9
      WRITE(IOUT9,19109) GLOBAL
 9700 CONTINUE
      WRITE(IOUT9,19209) K1,(PARML0(1,J),J=J1,J2)
      K1=K1+4
 9800 END DO
 9900 CONTINUE
! SET PAGE LENGTH TO MAXIMUM SO THAT NEXT LINE WILL CAUSE PAGE FAULT
      ILINE6=MLINE6
      IF(.NOT.L9SUMP) RETURN
! SET PAGE LENGTH TO MAXIMUM SO THAT NEXT LINE WILL CAUSE PAGE FAULT
      ILINE9=MLINE9
      RETURN
10000 FORMAT('1ARC',I3,' SUMMARY FOR INNER ITER.',I3,' OF GLOBAL ITER.',&
     &   I2,58X,'UNIT  6 PAGE NO.',I6)
10009 FORMAT('1ARC',I3,' SUMMARY FOR INNER ITER.',I3,' OF GLOBAL ITER.',&
     &   I2, 4X,'UNIT  9 PAGE NO.',I4)
10100 FORMAT(1X/                                                        &
     &  ' GEODYN II-E VERSION',F8.2,'  CREATED',F11.0,                  &
     &     ' RUN TIME',F11.0, F8.0/                                     &
     &  ' GEODYN II-S VERSION',F8.2,'  CREATED',F11.0,                  &
     &    '  RUN TIME',F11.0, F8.0/                                     &
     &  1X ,7X ,'TDF  VERSION',F8.2,   15X          ,                   &
     &    '  RUN TIME',F11.0, F8.0)
10200 FORMAT(1X/' TABLES FILE CREATED',2I7,' WITH POLE/UT1 IN ',A8,     &
     &   ' REFERENCE SYSTEM.'/1X /                                      &
     &  1X ,11X,'SOLAR FLUX  MAG. FLUX  POLE/A.1-UT1/EOPS   A.1-UTC'/   &
     &   ' START DATES',2X,I6,6X,I6,7X,I8,9X,I6/                        &
     &   '  END  DATES',2X,I6,6X,I6,7X,I8,9X,I6)
10300 FORMAT(1X/' GM (M**3/S**2)    =',1PD22.14,'  LIGHT VEL.=',        &
     &   0PF17.6,' (M/S)'/' SEMI-MAJ AXIS (M) =',1PD22.14,              &
     &   '  1/FLATTENING =',0PF17.9/' GRAVITY MODEL CHECKSUM =',G24.16, &
     &   '  MODEL DESCRIPTION:'/2X,'"',9A8,'"')
10400 FORMAT(1X/' JPL PLANETARY EPHEMERIS VERSION: DE-',I4)
10477 FORMAT(1X,'THIS IS A DERIVATIVE OF THE DE',I3,' EPHEMERIS')
10478 FORMAT(1X,'THE ORIGINAL NUTATIONS HAVE BEEN REPLACED WITH')
10479 FORMAT(1X,'WITH MHB2000 NUTATIONS. THIS ALSO MEANS THAT ')
10480 FORMAT(1X,'"Sp" WERE USED IN EFIXED TO INERTIAL COMPUTATIONS.')
10500 FORMAT(' ATMOSPHERIC DENSITY MODEL  USED: JAACHIA',I5)
10550 FORMAT(' ATMOSPHERIC DENSITY MODEL  USED: FRENCH DRAG MODEL',I5)
10551 FORMAT(' ATMOSPHERIC DENSITY MODEL  USED: JAACHIA 71')
10552 FORMAT(' ATMOSPHERIC DENSITY MODEL  USED: FRENCH DTM')
10553 FORMAT(' ATMOSPHERIC DENSITY MODEL  USED: Modified to be MSIS2')
!10554 FORMAT(' ATMOSPHERIC DENSITY MODEL  USED: MSIS2')
10600 FORMAT(1X/' GLOBAL PARAMETER SUMMARY'/1X /                        &
     & 2(' PARAM.',4X,2('NO.',5X)),' PARAM.',4X,'NO.',5X,               &
     & 'NO.',3X/2(' TYPE',6X,'PARAM.  ESTIM.  '),' TYPE',6X,            &
     & 'PARAM.  ESTIM.'/1X )
10700 FORMAT(1X,2(A8,2X,2(I5,3X),1X),A8,2X,I5,3X,I5)
10780 FORMAT(1X/' ARC TITLE CARDS (COLUMNS 1-72) :')
10790 FORMAT(1X,'"',9A8,'"')
10800 FORMAT(1X/' ARC PARAMETER SUMMARY'/1X /                           &
     & 1X ,11X,'SAT    ATMO.  SOLAR  GEN.   ARC    ATTI-  MEAS.  B-SUB'/&
     & 1X ,11X,'ORBIT  DRAG   RAD.   ACCEL  GRAV.  TUDE   BIAS   EBIAS'/&
     &   ' MODELLED',8I7/' ADJUSTED',8I7/1X )
10900 FORMAT(1X/' CONVERGENCE WITHIN',F5.1,' PERCENT AFTER',I3,         &
     &   ' ITERATIONS')
10910 FORMAT(1X/' FAILED',F5.1,' PERCENT CONVERGENCE AFTER',I3,         &
     &   ' ITERATIONS')
11000 FORMAT(1X/' COORDINATE SYSTEM REFERENCE EPOCH',I8,I5,F8.4)
11100 FORMAT(1X/' START',I8,I5,F8.4,'EPOCH',I8,I5,F8.4,                 &
     &            '  END',I8,I5,F8.4/                                   &
     &   ' INTEGRATION STEP SIZE -- ORBIT(SEC) =',F11.3,2X,             &
     &   'VAR.EQ.(SEC) =',F11.3)
11200 FORMAT(1X/' SAT. ID =',I8,'  AREA(M**2) =',F12.5,'  MASS(KG) =',  &
     & F12.3,/1X ,I8,' ORBIT INTEGRATION STEPS  --  AVERAGE NUMBER OF ',&
     &  'CORRECTIONS =',F7.4/1X ,I8,' VARIATIONAL EQUATION INTEGRATION',&
     &  ' STEPS --  ORBIT STARTS IN ',A8/1X ,I8,' TRANSITIONS BETWEEN ',&
     &   'SHADOW AND SUNLIGHT  --',F6.1,' PERCENT IN SHADOW',           &
     &   6(/1X ,A8,G24.16,A4,4X,A8,G24.16,A4)/                          &
     &   1X ,'RMS POS=',F20.6,5X,'M',6X,'RMS VEL=',F20.6,5X,'M/S')
11225 FORMAT(                                                           &
     & 1X/' THE FOLLOWING ARE GEOCENTRIC LATITUDE AND GEOCENTRIC',      &
     &  ' LONGITUDE AND AN'/ ' APPROXIMATE HEIGHT FROM THE SEMI-MAJOR', &
     &  ' AXIS OF THE CENTRAL BODY')
11250 FORMAT(1X' LATITUDE =',F8.3,1X,'DEG',3X,'LONGITUDE =',F8.3,1X,    &
     & 'DEG',3X,'HEIGHT =',F20.3,1X,'M')
11300 FORMAT(4(/1X ,A8,F20.3,1X,A8,3X,A8,' RATE =',F13.6,1X,A8))
19000 FORMAT(1X/' E-MATRIX',A8,'PARAMETER LABELS FOR E-MATRIX NO.',     &
     &   F18.1/1X /' SEQ. NO. ',7(' PARAMETER LABEL ')/1X )
19009 FORMAT(1X/' E-MATRIX',A8,'PARAMETER LABELS FOR E-MATRIX NO.',     &
     &   F18.1/1X /' SEQ. NO. ',4(' PARAMETER LABEL ')/1X )
19100 FORMAT(1X/' E-MATRIX',A8,'PARAMETER LABELS CONTINUED'/1X /        &
     & ' SEQ. NO. ',7(' PARAMETER LABEL ')/1X )
19109 FORMAT(1X/' E-MATRIX',A8,'PARAMETER LABELS CONTINUED'/1X /        &
     & ' SEQ. NO. ',4(' PARAMETER LABEL ')/1X )
19200 FORMAT(1X,I8,1X,7(F16.0,1X))
19209 FORMAT(1X,I8,1X,4(F16.0,1X))
20000 FORMAT('1ARC',I3,' SUMMARY CONTINUATION  FOR  GLOBAL ITERATION ', &
     &   I2,56X,'UNIT  6 PAGE NO.',I6)
20009 FORMAT('1ARC',I3,' SUMMARY CONTINUATION  FOR  GLOBAL ITERATION ', &
     &   I2, 4X,'UNIT  9 PAGE NO.',I4)
! ** FORMATS **
!
70101 FORMAT(//,1X,26X,'ARC PARAMETER SUMMARY '//)
70111 FORMAT(21X,5X,'MODELLED',5X,'ADJUSTED'/)
70203 FORMAT(1X,'TOTAL FOR ARC',10X,I6,5X,I6/                           &
     &       1X,'ORBIT ELEMS  ',10X,I6,5X,I6/                           &
     &       1X,'DRAG         ',10X,I6,5X,I6/                           &
     &       1X,'SOLAR RAD    ',10X,I6,5X,I6/                           &
     &       1X,'GEN ACCEL    ',10X,I6,5X,I6/                           &
     &       1X,'C COEF ARC   ',10X,I6,5X,I6/                           &
     &       1X,'S COEF ARC   ',10X,I6,5X,I6/                           &
     &       1X,'AREA         ',10X,I6,5X,I6/                           &
     &       1X,'SPEC REFL    ',10X,I6,5X,I6/                           &
     &       1X,'DIFF REFL    ',10X,I6,5X,I6/                           &
     &       1X,'EMISSIVITY   ',10X,I6,5X,I6/                           &
     &       1X,'TEMP A       ',10X,I6,5X,I6/                           &
     &       1X,'TEMP C       ',10X,I6,5X,I6/                           &
     &       1X,'DECAY TIME D ',10X,I6,5X,I6/                           &
     &       1X,'DECAY TIME F ',10X,I6,5X,I6/                           &
     &       1X,'YAW RATE     ',10X,I6,5X,I6/                           &
     &       1X,'THERMAL DRAG ',10X,I6,5X,I6/                           &
     &       1X,'ANT OFFSET   ',10X,I6,5X,I6/                           &
     &       1X,'ARC BIAS     ',10X,I6,5X,I6/                           &
     &       1X,' FANTOM ARC G',10X,I6,5X,I6/                           &
     &       1X,' FANTOM ARC F',10X,I6,5X,I6/                           &
     &       1X,'ATTITUDE     ',10X,I6,5X,I6/                           &
     &       1X,'DYN XOV RSEP ',10X,I6,5X,I6/                           &
     &       1X,'ACCLRM BIAS  ',10X,I6,5X,I6/                           &
     &       1X,'DELTA STATE  ',10X,I6,5X,I6/                           &
     &       1X,'GPS BOX WING ',10X,I6,5X,I6/                           &
     &       1X,'CAMERA DISTOR',10X,I6,5X,I6/                           &
     &       1X,'FINIT BURN   ',10X,I6,5X,I6/)

70800 FORMAT(/)
      END
