      SUBROUTINE OA(TBEST,XS1,XS2,XS3,VS1,VS2,VS3,AA,II,OATS)
      IMPLICIT DOUBLE PRECISION  (A-H,O-Z),LOGICAL(L)
      SAVE
!
      COMMON/CBDSTA/BDSTAT(7,999),XBDSTA
      COMMON/CREFMT/REFMT(9)
      DIMENSION AA(1),II(1)
!
      MJDSEC=TBEST
      FSEC=TBEST-DBLE(MJDSEC)
      CALL PLANPO(MJDSEC,FSEC,LVELP,LBARYC,AA,II)
      S1=REFMT(1)*BDSTAT(1,8)+REFMT(2)*BDSTAT(2,8)+REFMT(3)*BDSTAT(3,8)
      S2=REFMT(4)*BDSTAT(1,8)+REFMT(5)*BDSTAT(2,8)+REFMT(6)*BDSTAT(3,8)
      S3=REFMT(7)*BDSTAT(1,8)+REFMT(8)*BDSTAT(2,8)+REFMT(9)*BDSTAT(3,8)
      R=SQRT(S1*S1+S2*S2+S3*S3)
      S1=S1/R
      S2=S2/R
      S3=S3/R
!
!         Z1-3 = VECTOR FROM S/C TO CENTER OF EARTH
!         Y1-3 = VECTOR NORMAL TO  ORBIT PLANE (Y = Z X VSAT)
!         X1-3 = VECTOR TANGENT TO ORBIT PLANE (X = Y X Z)
!
! ZAXIS ROTATION
      ZMAG = SQRT(XS1**2+XS2**2+XS3**2)
      Z1 =-XS1/ZMAG
      Z2 =-XS2/ZMAG
      Z3 =-XS3/ZMAG
!
! YAXIS ROTATION
      Y1 = Z2*VS3-Z3*VS2
      Y2 = Z3*VS1-Z1*VS3
      Y3 = Z1*VS2-Z2*VS1
      YMAG = SQRT(Y1**2+Y2**2+Y3**2)
      Y1 = Y1/YMAG
      Y2 = Y2/YMAG
      Y3 = Y3/YMAG
!
! XAXIS ROTATION
      X1 = Y2*Z3-Y3*Z2
      X2 = Y3*Z1-Y1*Z3
      X3 = Y1*Z2-Y2*Z1
      XMAG = SQRT(X1**2+X2**2+X3**2)
      X1 = X1/XMAG
      X2 = X2/XMAG
      X3 = X3/XMAG
!
! COMPUTE UNIT VECTOR DEFINING ZERO ORBIT ANGLE (YTOD X SUN)
!
      VORB01 = Y2*S3-Y3*S2
      VORB02 = Y3*S1-Y1*S3
      VORB03 = Y1*S2-Y2*S1
      VORBMG = SQRT(VORB01**2+VORB02**2+VORB03**2)
      VORB01 = VORB01/VORBMG
      VORB02 = VORB02/VORBMG
      VORB03 = VORB03/VORBMG
!
! COMPUTE NEW ORBIT ANGLE
!     POSITIVE IN COUNTER-CLOCKWISE DIRECTION WHEN LOOKING DOWN ON ORBIT
!     RELATIVE TO VORB0
      VEC1 = VORB02*Z3-VORB03*Z2
      VEC2 = VORB03*Z1-VORB01*Z3
      VEC3 = VORB01*Z2-VORB02*Z1
      SINOMG  = VEC1*Y1+VEC2*Y2+VEC3*Y3
      COSOMG  = -Z1*VORB01-Z2*VORB02-Z3*VORB03
      SOMEGG = ATAN2(SINOMG,COSOMG)
      IF(SOMEGG.LT.ZERO) SOMEGG=SOMEGG+2.D0*ACOS(-1.D0)
!
!  CONVERT TO SECONDS
      OATS=SOMEGG*86400/(2.D0*ACOS(-1.D0))
      RETURN
      END
