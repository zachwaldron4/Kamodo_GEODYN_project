      SUBROUTINE RMPGRL(XINT,MJDSBL,TSTART,TEND,MJDRMP,TRAMP,FRAMP,     &
     &                  FDRAMP,NRAMPS,NM)
      IMPLICIT DOUBLE PRECISION (A-H,O-Z),LOGICAL(L)
      DIMENSION XINT(NM),TSTART(NM),TEND(NM)
      DIMENSION TRAMP(1000,2),FRAMP(NRAMPS),FDRAMP(NRAMPS)
!
      DX0=DBLE(MJDSBL-MJDRMP)
!
      DO 100 I=1,NM
      IRAMP1=1
      TIME=DBLE(MJDSBL)+TSTART(I)
      DO 10 J=IRAMP1,NRAMPS
      TIMEX=DBLE(MJDRMP)+TRAMP(J,1)
      TIMEY=DBLE(MJDRMP)+TRAMP(J,2)
      IF(TIME.GE.TIMEX.AND.TIME.LE.TIMEY) GO TO 20
   10 END DO
      WRITE(6,6000)
      WRITE(6,6000)
      WRITE(6,6001)
      WRITE(6,6002) TIME
      WRITE(6,6003)
      STOP
   20 CONTINUE
      IRAMP1=J
!
      TIME=DBLE(MJDSBL)+TEND(I)
      DO 30 J=IRAMP1,NRAMPS
      TIMEX=DBLE(MJDRMP)+TRAMP(J,1)
      TIMEY=DBLE(MJDRMP)+TRAMP(J,2)
      IF(TIME.GE.TIMEX.AND.TIME.LE.TIMEY) GO TO 40
   30 END DO
      WRITE(6,6000)
      WRITE(6,6000)
      WRITE(6,6001)
      WRITE(6,6002) TIME
      WRITE(6,6003)
      STOP
   40 CONTINUE
      IRAMP2=J
!
      NPD=1+IRAMP2-IRAMP1
! 1ST PERIOD
      IF(NPD.EQ.1) THEN
        DX=DX0+(TSTART(I)+TEND(I))/2.D0-TRAMP(IRAMP1,1)
        FREQ=FRAMP(IRAMP1)+DX*FDRAMP(IRAMP1)
        W=TEND(I)-TSTART(I)
        XINT(I)=W*FREQ
        GO TO 100
      ELSE
        DX=(DX0+TSTART(I)+TRAMP(IRAMP1,2))/2.D0-TRAMP(IRAMP1,1)
        FREQ=FRAMP(IRAMP1)+DX*FDRAMP(IRAMP1)
        W=-DX0+TRAMP(IRAMP1,2)-TSTART(I)
         XINT(I)=W*FREQ
      ENDIF
! LAST PERIOD
      DX=(DX0+TEND(I)+TRAMP(IRAMP2,1))/2.D0-TRAMP(IRAMP2,1)
      FREQ=FRAMP(IRAMP2)+DX*FDRAMP(IRAMP2)
      W=DX0+TEND(I)-TRAMP(IRAMP2,1)
      XINT(I)=XINT(I)+W*FREQ
      IF(NPD.EQ.2) GO TO 100
      IRAMP3=IRAMP1+1
      IRAMP4=IRAMP2-1
      DO 60 IRAMP=IRAMP3,IRAMP4
      DX=(TRAMP(IRAMP,2)-TRAMP(IRAMP,1))/2.D0
      FREQ=FRAMP(IRAMP)+DX*FDRAMP(IRAMP)
      W=TRAMP(IRAMP,2)-TRAMP(IRAMP,1)
      XINT(I)=XINT(I)+W*FREQ
   60 END DO
  100 END DO
      RETURN
 6000 FORMAT(' ')
 6001 FORMAT(' EXECUTION TERMINATING IN SUBROUTINE RMPGRL')
 6002 FORMAT(' MEASUREMRNT TIME: ',F15.2,' CAN NOT BE MATCHED TO')
 6003 FORMAT(' A RAMP PERIOD')
      END
