!$CHNTM
      SUBROUTINE CHNTM(IPTTMB,PXEPAN,PXEPA,NDM1,NDM2,NDM3,LNPNM,NM,     &
     &                 LAVOID)
!********1*********2*********3*********4*********5*********6*********7**
! CHNAT              00/00/00            0000.0    PGMR -DAVE ROWLANDS
!
! FUNCTION:
!              CHAIN AND INSERT PARTIALS OF ECF COORDINATES WRT TIME TAG
!              (ATTUTUDE TIME TAG AND OBSERVATION TIME TAG)
!              INTO THE THE ARRAY OF ARRAY OF PARTIALS OF ECF COORDINATE
!              WRT ALL ADJUSTING PARAMETERS. ROUTINE IS CALLED FOR EACH
!              ECF COORDINATE.
!
!     IPTTMB - POINTERS FOR PARTIALS OF TIMING BIASES
!     PXEPAN - PARTIALS OF ECF COORDINATE WRT TIMING BIASES
!     PXEPA  - PARTIALS OF ECF COORDINATE WRT ALL ADJUSTING PARAMTERS
!     NDM1   - FIRST DIMENSION OF PXEPA ARRAY (NADJST IF LNPNM IS TRUE
!              NM OTHERWISE)
!     NDM2   - SECOND DIMENSION OF PXEPA ARRAY (NM IF LNPNM IS TRUE
!              NADJST OTHERWISE)
!     NDM3   - FIRST DIMENSION OF PXEPAN ARRAY (GREATER THAN OR EQ MN)
!     LNPNM  - IF TRUE PARTIALS HAVE NADJST  AS FIRST DIMENSION
!     NM     - NUMBER OF TIMES BEING USED
!
!********1*********2*********3*********4*********5*********6*********7**
!
      IMPLICIT DOUBLE PRECISION (A-H,O-Z),LOGICAL(L)
      SAVE
!
      COMMON/NPCOM /NPNAME,NPVAL(92),NPVAL0(92),IPVAL(92),IPVAL0(92),   &
     &              MPVAL(28),MPVAL0(28),NXNPCM
      COMMON/NPCOMX/IXARC ,IXSATP,IXDRAG,IXSLRD,IXACCL,IXGPCA,IXGPSA,   &
     &              IXAREA,IXSPRF,IXDFRF,IXEMIS,IXTMPA,IXTMPC,IXTIMD,   &
     &              IXTIMF,IXTHTX,IXTHDR,IXOFFS,IXBISA,IXFAGM,IXFAFM,   &
     &              IXATUD,IXRSEP,IXACCB,IXDXYZ,IXGPSBW,IXCAME,IXBURN,  &
     &              IXGLBL,IXGPC ,IXGPS, IXTGPC,IXTGPS,IXGPCT,IXGPST,   &
     &              IXTIDE,IXETDE,IXOTDE,IXOTPC,IXOTPS,IXLOCG,IXKF  ,   &
     &              IXGM  ,IXSMA ,IXFLTP,IXFLTE,IXPLTP,IXPLTV,IXPMGM,   &
     &              IXPMJ2,IXVLIT,IXEPHC,IXEPHT,IXH2LV,IXL2LV,IXOLOD,   &
     &              IXPOLX,IXPOLY,IXUT1 ,IXPXDT,IXPYDT,IXUTDT,IXVLBI,   &
     &              IXVLBV,IXXTRO,IXBISG,IXSSTF,IXFGGM,IXFGFM,IXLNTM,   &
     &              IXLNTA,IX2CCO,IX2SCO,IX2GM ,IX2BDA,IXRELP,IXJ2SN,   &
     &              IXGMSN,IXPLNF,IXPSRF,IXANTD,IXTARG,                 &
     &              IXSTAP,IXSSTC,IXSSTS,IXSTAV,IXSTL2,                 &
     &              IXSTH2,IXDPSI,IXEPST,IXCOFF,IXTOTL,NXNPCX
!
      DIMENSION PXEPAN(NDM3,2)
      DIMENSION PXEPA(NDM1,NDM2)
      DIMENSION IPTTMB(2)
      DIMENSION LAVOID(1)
!
!
!**********************************************************************
! START OF EXECUTABLE CODE ********************************************
!**********************************************************************
!
!
      IF(LNPNM) GO TO 300
      DO 200 K=1,2
      IPT1=IPTTMB(K)
      IF(IPT1.LE.0) GO TO 200
      LAVOID(IPT1) =.FALSE.
      DO 100 I=1,NM
      PXEPA(I,IPT1)=PXEPAN(I,K)
  100 END DO
  200 END DO
      RETURN
!
  300 CONTINUE
      DO 500 K=1,2
      IPT1=IPTTMB(K)
      IF(IPT1.LE.0) GO TO 500
      LAVOID(IPT1) =.FALSE.
      DO 400 I=1,NM
      PXEPA(IPT1,I)=PXEPAN(I,K)
  400 END DO
  500 END DO
      RETURN
      END
