!$START
      SUBROUTINE START(LORBIT,LNDRAG,IORDER,H,                          &
     &   MJDSEC,FSEC,NSAT,N3,NEQN,NEQN3,IOL1,CIPV,                      &
     &   CIVV,XP,X,SUMX,XDDOT,PX,SUMPX,PXDDOT,XDDTMC,                   &
     &   DNLT,TOPXAT,LTPXAT,AA,II,LL,ISATID,UTDT,XDDTNC,PXDDTH,         &
     &   LFHIRT,LSURFF,XDDTAC,PXDDAC,NEQNA,IPTFBS,NPRMAC,DYNTIM,        &
     &   NPERDY,EXACCT,EXACIN,EXACOB,LACCELS,ACCTIM,ACCPER,NPERAC,      &
     &   SUMRC,XDDRC,                                                   &
     &   TMOS0,TMOS,TMOSP,SUMXOS,SUMPOS,XDDTOS,PDDTOS,NSTEPS,NEQNI,HOS )
!********1*********2*********3*********4*********5*********6*********7**
! START            82/08/27            8208.0    PGMR - TOMA MARTIN
!
! FUNCTION:  USE A MULTI-STEP PROCEDURE WITH TAYLOR SERIES
!            FIRST APPROXIMATION TO START THE NUMERICAL
!            INTEGRATION PROCESS AND PRODUCE SUFFICIENT
!            BACK VALUES FOR THE COWELL INTEGRATOR TO CONTINUE
!            THE INTEGRATION.
!
! I/O PARAMETERS:
!
!   NAME    I/O  A/S   DESCRIPTION OF PARAMETERS
!   ------  ---  ---   ------------------------------------------------
!   LORBIT   I    S    LOGICAL SWITCH INDICATING ORBIT-ONLY
!                      INTEGRATION WHEN .TRUE.
!   LNDRAG   I    S    LOGICAL SWITCH INDICATING THAT THE
!                      FORCING FUNCTION IS VELOCITY INDEPENDENT
!                      WHEN .TRUE.
!   IORDER   I    S    ORDER OF COWELL INTEGRATION FOR ORBIT
!   H        I    S    INTEGRATION STEP SIZE IN SECONDS FOR ORBIT
!   MJDSEC   I    S    CURRENT DATE AND INTEGRAL SECONDS OF TIME O
!                      ORBIT INTEGRATION
!   FSEC     I    S    CURRENT FRACTIONAL SECONDS OF ORBIT TIME
!   NSAT     I    S    NUMBER OF SATELLITES OF LIKE CHARACTERISTICS
!                      TO BE SIMULATANEOUSLY INTEGRATED
!   N3       I    S    NSAT*3
!   NEQN     I    S    NUMBER OF FORCE MODEL VARIATIONAL EQUATIONS
!   NEQN3    I    S    NEQN*N3
!   IOL1     I    S    IORDER - 1
!   CIPV     I    A    COWELL COEFFICIENTS FOR INTERPOLATING
!                      POSITION
!   CIVV     I    A    COWELL COEFFICIENTS FOR INTERPOLATING
!                      VELOCITY
!   XP       I    A    PREDICTED S/C POS. AND VEL.
!   X        O    A    CORRECTED SC POS. AND VEL.
!   SUMX     O    A    INTEGRATION SUMS FOR ORBIT
!   XDDOT    O    A    ORBIT ACCELERATIONS
!   PX,PX3   O    A    CORRECTED VARIATIONAL EQUATIONS
!   SUMPX    O    A    INTEGRATION SUMS FOR VAR. EQ.
!   PXDDOT   O    A    VARIATIONAL ACCELERATIONS
!   XDDTMC   O    A    ORBIT ACCELERATIONS DUE TO POINT MASS
!   DNLT     O    A    CHANGE IN NODE DUE TO LENSE THIRRING
!                      INITIALIZED TO ZERO
!   AA      I/O   A    REAL DYNAMIC ARRAY
!   II      I/O   A    INTEGER DYNAMIC ARRAY
!   LL      I/O   A    LOGICAL DYNAMIC ARRAY
!   TOPXAT   O    A    TOPEX ATT. BACK VALUES (BETAPRIME & ORBIT ANGLE)
!   LTPXAT   O    A    TOPEX ATT. BACK VALUES (RAMPING LOGICALS)
!   PXDDT3   O    A    VARIATIONAL ACCELERATIONS
!   ISATID   I         SAT ID ARRAY
!   XDDTNC   O         SMALL FORCE ACCELERATIONS (ACCELEROMETRY
!                      COMPUTED AND/OR SEPARATELY INTEGRATED)
!   PXDDTH   O         ARRAY TO HOLD THE EXPLICIT (NON INTEGRATED)
!                      FORCE MODEL PARTIALS
!   LFHIRT   I    A    ARRAY OF LOGICAL FLAGS. EACH ELEMENT
!                      CORRESPONDS TO A FORCE MODEL COMPONENT.
!                      THE ARRAY DESCRIBES WHICH COMPONENTS ARE
!                      INTEGRATED AT A HIGH RATE.
!   LSURFF   I    A    ARRAY OF LOGICAL FLAGS. EACH ELEMENT
!                      CORRESPONDS TO A FORCE MODEL COMPONENT.
!                      THE ARRAY DESCRIBES WHICH COMPONENTS ARE
!                      INTEGRATED AT A HIGH RATE.
!
!                      ACCELEROMETRY
!   PXDDAC   O    A    PARTIAL DERIVATIVES OF XDDTAC
!   NEQNA    I    S    NUMBER OF ADJUSTING ACCELEROMTER PARTIALS
!   IPTFBS   I    A    MAPPING ARRAY ; EXPLICIT PARTIAL ARRAY TO
!                      COMPUTED ACCELERATION PARTIAL ARRAY
!   NPRMAC   I    A    NUMBER OF PARMETERS IN EACH FORCE MODEL
!                      GROUP CATEGORY YO BE MAPPED BY IPTFBS
!   DYNTIM   I    A    USER REQUESTED START AND STOP TIMES FOR
!                      DYNAMIC ACCELERATION ACCELEROMETER PERIODS
!   NPERDY   I    A    NUMBER OF USER REQUESTED
!                      DYNAMIC ACCELERATION ACCELEROMETER PERIODS
!
! COMMENTS:
!
!
!********1*********2*********3*********4*********5*********6*********7**
      IMPLICIT DOUBLE PRECISION (A-H,O-Z),LOGICAL(L)
      SAVE
      DIMENSION CIPV(IOL1,IORDER),CIVV(IOL1,IORDER),                    &
     &   XP(N3,2),X(N3,2),SUMX(N3,2,2),XDDOT(N3,IOL1,2),                &
     &   PX(NEQN3,2),  SUMPX(NEQN3,2,2),                                &
     &   PXDDOT(NEQN3,IOL1,2),XDDTMC(N3,1),DNLT(N3),                    &
     &   AA(1),II(1),LL(1),ISATID(1),XDDTNC(N3,IOL1,2),                 &
     &   SUMRC(NSAT,2),XDDRC(NSAT,IOL1)
      DIMENSION S(20),B(20),FSECS(20),FSECSS(20)
      DIMENSION TOPXAT(2*NSAT,IOL1),LTPXAT(3*NSAT,IOL1)
      DIMENSION PXDDTH(NEQN3,IOL1)
      DIMENSION LFHIRT(NHRATE),LSURFF(NSURF),IPTFBS(MXFMG)
      DIMENSION NPRMAC(MXHRG)
      DIMENSION XDDTAC(3,NFSCAC,NSAT,IOL1),PXDDAC(NEQNA,N3,IOL1)
      DIMENSION DYNTIM(MDYNPD,2,NSAT),NPERDY(NSAT)
      DIMENSION EXACCT(2,NSAT),EXACIN(NSAT),EXACOB(MACOBS,NSAT)
      DIMENSION ACCTIM(MBAPPD,2,NSAT),ACCPER(MBAPPD,NSAT),NPERAC(NSAT)
      DIMENSION UTDT(MINTIM,4)
      DIMENSION XRC(2)
      DIMENSION TMOS0(1),TMOS(1),TMOSP(1),OS(1)
      DIMENSION SUMXOS(3,2,1)
      DIMENSION SUMPOS(NEQNI,3,2,1)
      DIMENSION XDDTOS(3,NSTEPS,1)
      DIMENSION PDDTOS(NEQNI,3,NSTEPS,1)
      DIMENSION HOS(1)
      DIMENSION XDDBRN(3)
      DIMENSION DUM(3),DUM1(3,2,1)

      COMMON/ACCLRM/MDYNPD,MBAPPD,MACOBS,IDYNSC(200),MDYNST,IACCSC(200),&
     &              MACCSC,NACPRM(200),NATPRM(200),NXCLRM
      COMMON/ARCPAR/MAXSEL,NSEL,MAXDEL,NDEL,MAXMET,NMETDT,NSATID,       &
     &              IATDEN,ISATEQ,ITRMAX,ITRMIN,ITRMX2,                 &
     &              MJDSRF,MREFSY,NTDDR,NBTOTL,IDRAGM,IMRNUT,           &
     &              NXARCP
      COMMON/CEGREL/LGRELE,LRLCLK,LGRELR,LXPCLK,LBPCLK,NXEGRL
      COMMON/CNIGLO/MINTIM,MSATG3,MEQNG ,MEQNG3,MSATG ,MSATOB,MSATA ,   &
     &              MSATA3,MSETA ,MINTVL,MSORDR,MSORDV,NMXORD,          &
     &       MCIPV ,MXBACK,MXI   ,MPXPF ,MAXAB ,MSETDG,MXSATD,          &
     &       MXDEGS,MXDRP ,MXDRPA,MXSRP ,MXSRPA,MXGAP ,MSATDR,          &
     &       MSATSR,MSATGA,MXDRPD,MXSRPD,MXGAPD,MXBCKP,MXTPMS,          &
     &       NSTAIN,NXCNIG
      COMMON/CONTRL/LSIMDT,LOBS  ,LORB  ,LNOADJ,LNADJL,LORFST,LORLST,   &
     &              LORALL,LORBOB,LOBFST,LOBLST,LOBALL,LPREPO,LORBVX,   &
     &              LORBVK,LACC3D,LSDATA,LCUTOT,LACCEL,LDYNAC,LFRCAT,   &
     &              LNIAU, NXCONT
      COMMON/CORA01/KFSEC0,KFSECB,KFSEC ,KFSECV,KH    ,KHV   ,KCTOL ,   &
     &              KRSQ  ,KVMATX,KCPP  ,KCPV  ,KCCP  ,KCCV  ,KCCPV ,   &
     &              KCCVV ,KXPPPP,KX    ,KPX   ,KSUMX ,KXDDOT,KSUMPX,   &
     &              KPXDDT,KAB   ,KPN   ,KAORN ,KSINLM,KCOSLM,KTANPS,   &
     &              KCRPAR,KVRARY,KXM   ,KXNP1 ,KXPRFL,KXM2  ,KXNNP1,   &
     &              KWRK  ,KFI   ,KGE   ,KB0DRG,KBDRAG,KAPGM ,KAPLM ,   &
     &              KCN   ,KSN   ,KSTID ,KTIDE ,KSTDRG,KSTSRD,KSTACC,   &
     &              KLGRAV,KGM   ,KAE   ,KFPL  ,KFEQ  ,KPLNPO,KPLNVL,   &
     &              KXEPOC,KCD   ,KCDDOT,KCR   ,KGENAC,KACN  ,KASN  ,   &
     &              KTHDRG,KCKEP ,KCKEPN,KXNRMZ,KXNRMC,KFSCEP,KFSCND,   &
     &              KAREA ,KXMASS,KRMSPO,KTCOEF,KTXQQ ,KTIEXP,KTXMM ,   &
     &              KTXLL1,KTXSN1,KTS2QQ,KT2M2H,KT2MHJ,KTXKK ,KTSCRH,   &
     &              KPXPK ,KAESHD,KCSAVE,KSSAVE,KCGRVT,KSGRVT,KXDTMC,   &
     &              KDNLT ,KTXSN2,KTNORM,KTWRK1,KTWRK2,KUNORM,KAERLG,   &
     &              KSINCO,KPARLG,KCONST,KBFNRM,KTDNRM,KCSTHT,KTPSTR,   &
     &              KTPSTP,KTPFYW,KPLMGM,KTPXAT,KEAQAT,KEAFSS,KEAINS,   &
     &              KACS  ,KECS  ,KSOLNA,KSOLNE,KSVECT,KSFLUX,KFACTX,   &
     &              KFACTY,KADIST,KGEOAN,KPALB ,KALBCO,KEMMCO,KCNAUX,   &
     &              KSNAUX,KPPER ,KACOSW,KBSINW,KACOFW,KBCOFW,KANGWT,   &
     &              KWT   ,KPLNDX,KPLANC,KTGACC,KTGDRG,KTGSLR,KWTACC,   &
     &              KWTDRG,KWTSLR,KTMACC,KTMDRG,KTMSLR,KATTUD,KDYACT,   &
     &              KACCBT,KACPER,KXDDNC,KXDDAO,KXNC  ,KXPPNC,KSMXNC,   &
     &              KXDDTH,KPDDTH,KXSSBS,KCPPNC,KEXACT,KXACIN,KXACOB,   &
     &              KPXHDT,KTPXTH,KPACCL,KTXSTA,KDELXS,KSMRNC,KPRX  ,   &
     &              KSMRNP,KDSROT,KXUGRD,KYUGRD,KZUGRD,KSUMRC,KXDDRC,   &
     &              KTMOS0,KTMOS, KTMOSP,KSMXOS,KSGTM1,KSGTM2,KSMPNS,   &
     &              KXGGRD,KYGGRD,KZGGRD,KXEGRD,KYEGRD,KZEGRD,KSSDST,   &
     &              KSDINS,KSDIND,KSSDSR,KSSDDG,KTATHM,KTAINS,KTAFSS,   &
     &              KSRAT ,KTRAT ,KHLDV ,KHLDA1,KHLDA4,KHLDA7,KQAST1,   &
     &              KQAST2,KQAST3,KQAST4,KQAST5,KQAST6,NXCA01
      COMMON/CORA03/KRFMT ,KROTMT,KSRTCH,KCFSC ,KTHG  ,KCOSTG,KSINTG,   &
     &              KDPSI ,KEPST ,KEPSM ,KETA  ,KZTA  ,KTHTA ,KEQN  ,   &
     &              KDPSR ,KSL   ,KH2   ,KL2   ,KXPUT ,KYPUT ,KUT   ,   &
     &              KSPCRD,KSPSIG,KSTAIN,KSXYZ ,KSPWT ,KDXSDP,KDPSDP,   &
     &              KXLOCV,KSTNAM,KA1UT ,KPLTIN,KPLTVL,KPLTDV,KPUTBH,   &
     &              KABCOF,KSPEED,KANGFC,KSCROL,KSTVEL,KSTVDV,KTIMVL,   &
     &              KSTEL2,KSTEH2,KSL2DV,KSH2DV,                        &
     &              KAPRES, KASCAL, KASOFF,KXDOTP,KSAVST,               &
     &              KANGT , KSPDT , KCONAM,KGRDAN,KUANG ,KFAMP ,        &
     &              KOFACT, KOTSGN,KWRKRS,KANFSD,KSPDSD,KPRMFS,KSCRFR,  &
     &              KCOSAS,KSINAS,KDXTID,KALCOF,KSTANF,KNUTIN,KNUTMD,   &
     &              KPDPSI,KPEPST,KDXDNU,KDPSIE,KEPSTE,NXCA03
      COMMON/CORA06/KPRMV ,KPNAME,KPRMV0,KPRMVC,KPRMVP,KPRMSG,KPARVR,   &
     &              KPRML0,KPDLTA,KSATCV,KSTACV,KPOLCV,KTIDCV,KSUM1 ,   &
     &              KSUM2 ,KGPNRA,KGPNRM,KPRSG0,KCONDN,KVELCV,          &
     &              KSL2CV,KSH2CV,KTIEOU,KPRMDF,NXCA06
      COMMON/CORA07/KELEVT,KSRFEL,KTINT,KFSCSD,KXTIM,KFSDM,             &
     & KSGM1,KSGM2,KNOISE,KEPHMS,NXCA07
      COMMON/CORI01/KMJDS0,KMJDSB,KMJDSC,KMJDSV,KIBACK,KIBAKV,KIORDR,   &
     &              KIORDV,KNOSTP,KNOCOR,KNSAT ,KN3   ,KNEQN ,KNEQN3,   &
     &              KNH   ,KNHV  ,KNSTPS,KNSTPV,KICPP ,KICPV ,KICCP ,   &
     &              KICCV ,KICCPV,KICCVV,KISUMX,KIXDDT,KISMPX,KIPXDD,   &
     &              KNMAX ,KNTOLD,KNTOLO,KICNT ,KISNT ,KMM   ,KKK   ,   &
     &              KJJ   ,KHH   ,KIBDY ,KSIGN1,KSIGN2,KLL   ,KQQ   ,   &
     &              KIORFR,KIPDFR,KITACC,KJSAFR,KJSPFR,KMJDEP,KMJDND,   &
     &              KNVSTP,KNSTRN,KNDARK,KTIPPT,KTJBDY,                 &
     &              KICNTA,KISNTA,KISHDP,KIPTC ,KIPTS ,KIGTSR,KIXTMC,   &
     &              KTIPTT,KTNOSD,KTQNDX,KTLL1 ,KTJJBD,KTITDE,KTCNTR,   &
     &              KTNN  ,KITACX,KNMOVE,KPANEL,KPLPTR,KNADAR,KNADSP,   &
     &              KNADDF,KNADEM,KNADTA,KNADTC,KNADTD,KNADTF,KNADTX,   &
     &              KITPMD,KSCATT,KITPAT,KILTPX,KEASBJ,KEANMP,KEANAN,   &
     &              KEAPMP,KEAPAN,KEAMJS,KEAPPP,KEAAAA,KICNTT,KISNTT,   &
     &              KTPGRC,KTPGRS,KTPC  ,KTPS  ,KALCAP,KEMCAP,KNSEG ,   &
     &              KICNTP,KISNTP,KNRDGA,KNRDDR,KNRDSR,KIRDGA,KIRDRG,   &
     &              KIRSLR,KSTRTA,KSTRTD,KSTRTS,KDYNPE,KACCPE,KIBCKN,   &
     &              KNRAT ,KIXDDN,KISMXN,KDXDDN,KDSMXN,KICPPN,KACSID,   &
     &              KNEQNH,KHRFRC,KPTFBS,KPTFSB,KIPXDA,KIACCP,KXSTAT,   &
     &              KPXST ,KSALST,KMAPLG,KNMBUF,KSTEPS,KSGMNT,KSATIN,   &
     &              KMEMST,KNEQNI,KBUFIN,KWEMGA,KWEMDR,KTPATS,KTANMP,   &
     &              KTAPPP,KTAMJS,KTASID,KGPSID,KNSSVA,KPNALB,KBRAX1,   &
     &              KBRAX2,KBRAX3,NXCI01
      COMMON/CORI07/KSMSA1,KSMSA2,KSMSA3,KSMST1,KSMST2,KSMST3,KSMTYP,   &
     &              KSMT1,KSMT2,KMSDM,KIOUT,KISUPE,NXCI07
      COMMON/CORL01/KLORBT,KLORBV,KLNDRG,KLBAKW,KLSETS,KLAFRC,KLSTSN,   &
     &              KLSNLT,KLAJDP,KLAJSP,KLAJGP,KLTPAT,KEALQT,KLRDGA,   &
     &              KLRDDR,KLRDSR,KFHIRT,KLSURF,KHRFON,KLTPXH,KSETDN,   &
     &              KTALTA,NXCL01
      COMMON/CRDDIM/NDCRD2,NDCRD3,NDCRD4,NDCRD5,NDCRD6,NDCRD7,          &
     &              NDCRD8,NDCRD9,NXCRDM
      COMMON/IBODPT/IBDCF(999),IBDSF(999),IBDGM(999),IBDAE(999),    &
     &              IBDPF(999),                                     &
     &              ICBDCF,ICBDSF,ICBDGM,ICBDAE,ICBDPF,             &
     &              ITBDCF,ITBDSF,ITBDGM,ITBDAE,ITBDPF,NXBDPT
      COMMON/IEPHM2/ISUPL,ICBODY,ISEQB(2),MAXDEG,ITOTSE,IREPL(988), &
     &              NXEPH2
      COMMON/LCBODY/LEARTH,LMOON,LMARS
      COMMON/LEPHM2/LXEPHM
      COMMON/LSTRT/LSTART
      COMMON/NEQINT/NINTOT,MEMTOT,NEQNIM,NXNEQS
      COMMON/NFORCE/NHRATE,NSURF,MPXHDT,MXHRG,MXFMG,NFSCAC,NXFORC
      COMMON/SETPPT/JSPDRG(3),JSPSRD(3),JSPGA(3),JCSAT
!
      DATA ZERO/0.0D0/,ONE/1.0D0/
      DATA MAXMUM/20/
      DATA XRC/2*0.D0/
!
!***********************************************************************
! START OF EXECUTABLE CODE *********************************************
!***********************************************************************
!
!
      NRAT=1
      LHIRAT=.FALSE.
      LALLA=.TRUE.
!
      N=N3/3
      DO 15 I=1,N
      DNLT(I)=ZERO
   15 END DO
!      LSTART=.TRUE.
      N6=N3*2
      NEQN6=NEQN3*2
      IOL2=IOL1-1
      IEVEN=MOD(IOL1,2)
      MF=IOL2/2-IEVEN
      MB=MF+1+IEVEN
      MID=MB+1
      MF1=MF+1
      ISH=H
      FSH=H-ISH
      H2=H**2
!   CALCULATE TIMES AT WHICH FORCE MODEL MUST BE EVALUATED
!   STORE EPOCH TIME
      FSECS(MID)=FSEC
!   COMPUTE TIMES OF BACK VALUES
      DO 40 I=1,MB
      J=MID-I
      FSEC=FSEC-H
   40 FSECS(J)=FSEC
!   COMPUTE TIMES OF FORWARD VALUES
      FSEC=FSECS(MID)
      DO 50 I=1,MF
      J=I+MID
      FSEC=FSEC+H
   50 FSECS(J)=FSEC
!   GET QUANTITIES NEEDED FOR COORDINATE SYSTEM EVALUATIONS
      ISN0=0
      ISN1=1
      IF(H.GT.ZERO) GO TO 55
      ISN0=IOL1+1
      ISN1=-1
   55 DO 57 I=1,IOL1
   57 FSECSS(I)=FSECS(I*ISN1+ISN0)
!
      IF(ICBDGM.EQ.3) THEN
      CALL BUFEAR(MJDSEC,FSECS(1),MJDSEC,FSECS(IOL1),ISN1,              &
     &   IDUM1,DUM2,LRECAL,AA,II)
      ELSE
      CALL BUFXTR(MJDSEC,FSECS(1),MJDSEC,FSECS(IOL1),ISN1,              &
     &   IDUM1,DUM2,LRECAL,AA)
!
      IF(LXEPHM) THEN
      DO IJ=1,ICBODY
      CALL BUFSUP(AA,MJDSEC,FSECS(1),MJDSEC,FSECS(IOL1),                &
     &II(KISUPE),AA(KEPHMS),IJ,1)
      ENDDO
      ENDIF
!
      ENDIF
!
      IF(.NOT.LRECAL) GO TO 60
      WRITE(6,999)
      STOP
   60 CONTINUE
!
      IF(ICBDGM.EQ.3) THEN
      CALL PRECSS(MJDSEC,FSECSS,AA(KETA),AA(KZTA),AA(KTHTA),            &
     &   AA(KSRTCH),IOL1)
      CALL NUVECT(MJDSEC,FSECSS,AA(KDPSI),AA(KEPST),AA(KEPSM),IOL1,     &
     &   AA(KSRTCH))
      CALL NPVECT(MJDSEC,FSECSS,AA(KDPSI),AA(KEPST),AA(KEPSM),AA(KETA), &
     &   AA(KTHTA),AA(KZTA),IOL1,AA(KSRTCH),AA(KROTMT),AA(KEQN),        &
     &   NDCRD2,.FALSE.,                                                &
     &   AA(KPDPSI),AA(KPEPST),AA(KNUTIN),AA(KNUTMD),.FALSE.,           &
     &   AA(KDXDNU),AA(KDPSIE),AA(KEPSTE),DUM,DUM1)
      CALL GRHRAN(MJDSEC,FSECSS,.FALSE.,.FALSE.,AA(KEQN),AA(KSRTCH),    &
     & AA(KTHG),AA(KCOSTG),AA(KSINTG),IOL1,AA,II,UTDT(1,1),.FALSE.,DUM, &
     & DUM1)
      ELSE
! NEW SUBROUTINE FOR MARS NUTATION CALCULATION
          IF(LMARS.AND.IMRNUT.EQ.1) THEN
      CALL PRMCSS(MJDSEC,FSECSS,AA(KETA),AA(KZTA),AA(KTHTA),            &
     &   AA(KSRTCH),IOL1)
      CALL NUVMCT(MJDSEC,FSECSS,AA(KDPSI),AA(KEPST),AA(KEPSM),IOL1,     &
     &   AA(KSRTCH))
      CALL NPVMCT(MJDSEC,FSECSS,AA(KDPSI),AA(KEPST),AA(KEPSM),AA(KETA), &
     &   AA(KTHTA),AA(KZTA),IOL1,AA(KSRTCH),AA(KROTMT),AA(KEQN),        &
     &   NDCRD2,.FALSE.)
      CALL MM2EJ2(MJDSEC,FSECSS,AA(KROTMT),NDCRD2,AA(KSRTCH),.TRUE.)
!
      CALL ROTMTR(MJDSEC,FSECSS,.FALSE.,AA(KEQN),AA(KSRTCH),            &
     &   AA(KTHG),AA(KCOSTG),AA(KSINTG),IOL1,AA,II)
          ELSE
      CALL PRXCSS(MJDSEC,FSECSS,AA(KETA),AA(KZTA),AA(KTHTA),            &
     &   AA(KSRTCH),IOL1,AA(KDPSI),AA(KEPST),AA(KEPSM),AA,1)
      CALL NUVXCT(MJDSEC,FSECSS,AA(KDPSI),AA(KEPST),AA(KEPSM),IOL1,     &
     &   AA(KSRTCH))
      CALL NPVXCT(MJDSEC,FSECSS,AA(KDPSI),AA(KEPST),AA(KEPSM),AA(KETA), &
     &   AA(KTHTA),AA(KZTA),IOL1,AA(KSRTCH),AA(KROTMT),AA(KEQN),        &
     &   NDCRD2,.FALSE.)
      CALL ROTXTR(MJDSEC,FSECSS,.FALSE.,AA(KEQN),AA(KSRTCH),            &
     &   AA(KTHG),AA(KCOSTG),AA(KSINTG),IOL1,AA,                        &
     &      AA(KACOSW),AA(KBSINW),AA(KANGWT),AA(KWT),AA(KACOFW),        &
     &      AA(KBCOFW),II,1)
      ENDIF
      ENDIF
!
! EVALUATE FORCES AT EPOCH
      MIDD=MID*ISN1+ISN0

      CALL F123(MJDSEC,FSECS(MID),X,XDDOT(1,MID,1),PXDDOT(1,MID,1),NSAT,&
     &   NEQN,MIDD,XDDTMC,TOPXAT(1,MID),LTPXAT(1,MID),AA,II,LL,ISATID,  &
     &   LFHIRT,LSURFF,XDDTNC(1,MID,1),XDDTAC(1,1,1,MID),               &
     &   PXDDAC(1,1,MID),                                               &
     &   NEQNA,IPTFBS,NPRMAC,LHIRAT,LALLA,ONE,DYNTIM,NPERDY,LACCELS,    &
     &   EXACCT,EXACIN,EXACOB,ACCTIM,ACCPER,NPERAC,II(KIACCP),          &
     &   AA(KPACCL),NRAT,XDDRC(1,MID),1,DUM,DUM)
      CALL F123(MJDSEC,FSECS(MID),X,XDDOT(1,MID,1),PXDDOT(1,MID,1),NSAT,&
     &   NEQN,MIDD,XDDTMC,TOPXAT(1,MID),LTPXAT(1,MID),AA,II,LL,ISATID,  &
     &   LFHIRT,LSURFF,XDDTNC(1,MID,1),XDDTAC(1,1,1,MID),               &
     &   PXDDAC(1,1,MID),                                               &
     &   NEQNA,IPTFBS,NPRMAC,LHIRAT,LALLA,ONE,DYNTIM,NPERDY,LACCELS,    &
     &   EXACCT,EXACIN,EXACOB,ACCTIM,ACCPER,NPERAC,II(KIACCP),          &
     &   AA(KPACCL),NRAT,XDDRC(1,MID),2,DUM,DUM)
      CALL F123(MJDSEC,FSECS(MID),X,XDDOT(1,MID,1),PXDDOT(1,MID,1),NSAT,&
     &   NEQN,MIDD,XDDTMC,TOPXAT(1,MID),LTPXAT(1,MID),AA,II,LL,ISATID,  &
     &   LFHIRT,LSURFF,XDDTNC(1,MID,1),XDDTAC(1,1,1,MID),               &
     &   PXDDAC(1,1,MID),                                               &
     &   NEQNA,IPTFBS,NPRMAC,LHIRAT,LALLA,ONE,DYNTIM,NPERDY,LACCELS,    &
     &   EXACCT,EXACIN,EXACOB,ACCTIM,ACCPER,NPERAC,II(KIACCP),          &
     &   AA(KPACCL),NRAT,XDDRC(1,MID),3,DUM,DUM)
      HQ=H
      CALL F(MJDSEC,FSECS(MID),X,XDDOT(1,MID,1),PXDDOT(1,MID,1),NSAT,   &
     &   NEQN,MIDD,XDDTMC,TOPXAT(1,MID),LTPXAT(1,MID),AA,II,LL,ISATID,  &
     &   LFHIRT,LSURFF,XDDTNC(1,MID,1),XDDTAC(1,1,1,MID),               &
     &   PXDDAC(1,1,MID),                                               &
     &   NEQNA,IPTFBS,NPRMAC,LHIRAT,LALLA,ONE,DYNTIM,NPERDY,LACCELS,    &
     &   EXACCT,EXACIN,EXACOB,ACCTIM,ACCPER,NPERAC,II(KIACCP),          &
     &   AA(KPACCL),NRAT,XDDRC(1,MID),DUM,DUM,LQ1,IPSBRN,LQ2,XDDBRN,HQ)
      IF(LQ1.OR.LQ2) THEN
        WRITE(6,60000)
        WRITE(6,60001)
        STOP
      ENDIF
!     IF(.NOT.LORBIT) THEN
!        DO IQP=1,NEQN3
!           PXDDTH(IQP,MID)=PXDDOT(IQP,MID,1)
!        ENDDO
!     ENDIF
! SAVE THE LOGICAL FLAG FOR SUMMARY INDICATING IF IN SUNLIGHT AT EPOCH
      DO 70 N=1,NSAT
      LL(KLSNLT+JCSAT+N-1)=LL(KLSTSN+JCSAT+N-1)
   70 END DO
!
      DO 100 N=1,N3
      XDDOT(N,MID,2)=XDDOT(N,MID,1)
      XDDTNC(N,MID,2)=XDDTNC(N,MID,1)
  100 END DO
      IF(LORBIT)GO TO 300
! EVALUATE FORCE MODEL PARTIAL DERIVATIVE ACCELERATIONS
!   INITIALIZE PARTIALS OF STATE VECTOR WRT FORCE PARAMETERS
      DO 130 NN=1,2
      DO 130 N=1,NEQN3
      PX(N,NN)=ZERO
  130 CONTINUE
! INITIALIZE PARTIALS OF STATE VECTOR WRT TO INITIAL ELEMENTS
      NOFFST=NEQN*3
      DO 150 N=1,NEQN3,NOFFST
      PX(N,1)=ONE
      PX(N+NEQN+1,1)=ONE
      PX(N+2*NEQN+2,1)=ONE
      PX(N+3,2)=ONE
      PX(N+NEQN+4,2)=ONE
      PX(N+2*NEQN+5,2)=ONE
  150 END DO
      CALL VEVAL(X,PX,PXDDOT(1,MID,1),AA,II,LL,NSAT,NEQN,.TRUE.,        &
     &   LNDRAG)
!
      DO 200 N=1,NEQN3
      PXDDOT(N,MID,2)=PXDDOT(N,MID,1)
  200 END DO
!
!
  300 CONTINUE
! PREDICT FORWARD USING TAYLOR SERIES
      CALL TAYLOR(LORBIT,H,1,MID,MF,IOL1,NSAT,                          &
     &   N3,N6,NEQN,NEQN3,NEQN6,MJDSEC,FSECS,                           &
     &   XP,X,XDDOT,PX,PXDDOT,ISN0,ISN1,LNDRAG,XDDTMC,TOPXAT,           &
     &   LTPXAT,AA,II,LL,ISATID,                                        &
     &   LFHIRT,LSURFF,XDDTNC,XDDTAC,PXDDAC,                            &
     &   NEQNA,IPTFBS,NPRMAC,LHIRAT,LALLA,DYNTIM,NPERDY,EXACCT,         &
     &   EXACIN,EXACOB,LACCELS,ACCTIM,ACCPER,NPERAC,XDDRC)
! PREDICT BACKWARD USING TAYLOR SERIES
      HMINUS=-H
      CALL TAYLOR(LORBIT,HMINUS,-1,MID,MB,IOL1,NSAT,                    &
     &   N3,N6,NEQN,NEQN3,NEQN6,MJDSEC,FSECS,                           &
     &   XP,X,XDDOT,PX,PXDDOT,ISN0,ISN1,LNDRAG,XDDTMC,TOPXAT,           &
     &   LTPXAT,AA,II,LL,ISATID,                                        &
     &   LFHIRT,LSURFF,XDDTNC,XDDTAC,PXDDAC,                            &
     &   NEQNA,IPTFBS,NPRMAC,LHIRAT,LALLA,DYNTIM,NPERDY,EXACCT,         &
     &   EXACIN,EXACOB,LACCELS,ACCTIM,ACCPER,NPERAC,XDDRC)
! COMPUTE INTERPOLATOR COEFFICIENTS FOR EACH TIME
      IS=-IOL1
      DO 600 I=1,IOL1
      IS=IS+1
      S(I)=IS
  600 END DO
      CALL COEFV(S,B,IOL1,IORDER,CIPV,CIVV)
! BEGIN ITERATIVE CONVERGENCE OF STARTING SUMS
      INDS=1
      INDSAV=2
      KOUNT=0
 1000 CONTINUE
      KOUNT=KOUNT+1
      LSUMER=.TRUE.
! INITIALIZE EPOCH STATE AND PARTIAL DERIVATIVE ARRAYS
      CALL START0(LORBIT,N3,N6,NEQN,NEQN6,NSAT,XP,X,PX,PX,ONE)
! COMPUTE POSITION AND VELOCITY SUMS
      CALL STARTS(IORDER,IOL1,IOL2,H,H2,N3,MF1,MID,                     &
     &   XP,SUMX(1,1,INDS),CIPV,CIVV,XDDOT(1,1,INDS))
! COMPUTE RELATIVISTIC CLOCK SUMS
      IF(LXPCLK) THEN
        CALL STARTS(IORDER,IOL1,IOL2,H,H2,NSAT,MF1,MID,                 &
     &              XRC,SUMRC(1,1),CIPV,CIVV,XDDRC(1,1))
      ENDIF
! COMPUTE SUMS FOR POSITION AND VELOCITY PARTIALS
      CALL STARTS(IORDER,IOL1,IOL2,H,H2,NEQN3,MF1,MID,                  &
     &   PX,SUMPX(1,1,INDS),CIPV,CIVV,PXDDOT(1,1,INDS))
 2000 CONTINUE
! DETERMINE IF LOCAL ERROR IN STARTING SUMS HAS REACHED
!     DESIRED ACCURACY
      IF(KOUNT.GT.1) THEN
      LSUMER=.FALSE.
      CALL STARTE(LSUMER,SUMX,N6,KOUNT)
      IF(LORBIT)GO TO 3000
      CALL STARTE(LSUMER,SUMPX,NEQN6,KOUNT)
 3000 CONTINUE
      ENDIF
      IF(.NOT.LSUMER) GO TO 7000
! LOOP OVER EACH TIME STEP
      DO 6000 IORD=1,IOL1
      IC=IORDER-IORD
      IF(IC.EQ.MID)GO TO 5000
! RECOMPUTE POSITION AND VELOCITY USING SUMS
      NK=-IORD
      CALL STARTC(IORDER,IOL1,IOL2,H,H2,N3,NK,IC,                       &
     &   XP,SUMX(1,1,INDS),CIPV,CIVV,XDDOT(1,1,INDS))
! RECOMPUTE ACCELERATION
      ICC=IC*ISN1+ISN0

      CALL F123(MJDSEC,FSECS(IC),XP,XDDOT(1,IC,INDSAV),                 &
     &   PXDDOT(1,IC,INDSAV),NSAT,NEQN,ICC,XDDTMC,                      &
     &   TOPXAT(1,IC),LTPXAT(1,IC),AA,II,LL,ISATID,LFHIRT,              &
     &   LSURFF,XDDTNC(1,IC,INDSAV),XDDTAC(1,1,1,IC),PXDDAC(1,1,IC),    &
     &   NEQNA,IPTFBS,NPRMAC,LHIRAT,LALLA,ONE,DYNTIM,NPERDY,LACCELS,    &
     &   EXACCT,EXACIN,EXACOB,ACCTIM,ACCPER,NPERAC,II(KIACCP),          &
     &   AA(KPACCL),NRAT,XDDRC(1,IC),1,DUM,DUM)
      CALL F123(MJDSEC,FSECS(IC),XP,XDDOT(1,IC,INDSAV),                 &
     &   PXDDOT(1,IC,INDSAV),NSAT,NEQN,ICC,XDDTMC,                      &
     &   TOPXAT(1,IC),LTPXAT(1,IC),AA,II,LL,ISATID,LFHIRT,              &
     &   LSURFF,XDDTNC(1,IC,INDSAV),XDDTAC(1,1,1,IC),PXDDAC(1,1,IC),    &
     &   NEQNA,IPTFBS,NPRMAC,LHIRAT,LALLA,ONE,DYNTIM,NPERDY,LACCELS,    &
     &   EXACCT,EXACIN,EXACOB,ACCTIM,ACCPER,NPERAC,II(KIACCP),          &
     &   AA(KPACCL),NRAT,XDDRC(1,IC),2,DUM,DUM)
      CALL F123(MJDSEC,FSECS(IC),XP,XDDOT(1,IC,INDSAV),                 &
     &   PXDDOT(1,IC,INDSAV),NSAT,NEQN,ICC,XDDTMC,                      &
     &   TOPXAT(1,IC),LTPXAT(1,IC),AA,II,LL,ISATID,LFHIRT,              &
     &   LSURFF,XDDTNC(1,IC,INDSAV),XDDTAC(1,1,1,IC),PXDDAC(1,1,IC),    &
     &   NEQNA,IPTFBS,NPRMAC,LHIRAT,LALLA,ONE,DYNTIM,NPERDY,LACCELS,    &
     &   EXACCT,EXACIN,EXACOB,ACCTIM,ACCPER,NPERAC,II(KIACCP),          &
     &   AA(KPACCL),NRAT,XDDRC(1,IC),3,DUM,DUM)
      HQ=H
      CALL F(MJDSEC,FSECS(IC),XP,XDDOT(1,IC,INDSAV),                    &
     &   PXDDOT(1,IC,INDSAV),NSAT,NEQN,ICC,XDDTMC,                      &
     &   TOPXAT(1,IC),LTPXAT(1,IC),AA,II,LL,ISATID,LFHIRT,              &
     &   LSURFF,XDDTNC(1,IC,INDSAV),XDDTAC(1,1,1,IC),PXDDAC(1,1,IC),    &
     &   NEQNA,IPTFBS,NPRMAC,LHIRAT,LALLA,ONE,DYNTIM,NPERDY,LACCELS,    &
     &   EXACCT,EXACIN,EXACOB,ACCTIM,ACCPER,NPERAC,II(KIACCP),          &
     &   AA(KPACCL),NRAT,XDDRC(1,IC),DUM,DUM,LQ1,IPSBRN,LQ2,XDDBRN,HQ)
      IF(LQ1.OR.LQ2) THEN
        WRITE(6,60000)
        WRITE(6,60001)
        STOP
      ENDIF
      IF(LORBIT)GO TO 4000
!      DO IQP=1,NEQN3
!         PXDDTH(IQP,IC)=PXDDOT(IQP,IC,INDSAV)
!      ENDDO
! RECOMPUTE PARTIAL DERIVATIVES
      CALL STARTC(IORDER,IOL1,IOL2,H,H2,NEQN3,NK,IC,                    &
     &   PX,SUMPX(1,1,INDS),CIPV,CIVV,PXDDOT(1,1,INDS))
! RECOMPUTE PARTIAL DERIVATIVE ACCELERATIONS
      CALL VEVAL(XP,PX,PXDDOT(1,IC,INDSAV),AA,II,LL,NSAT,NEQN,.TRUE.,   &
     &   LNDRAG)
 4000 CONTINUE
 5000 CONTINUE
 6000 END DO
      IND=INDS
      INDS=INDSAV
      INDSAV=IND
      IF(KOUNT.LT.MAXMUM)GO TO 1000
      WRITE(6,6666) KOUNT
 6666 FORMAT('-   START; KOUNT=',I6)
!     CALL ERROR
 7000 CONTINUE
      FSEC=FSECS(IOL1)
      ISEC=FSEC
      FSEC=FSEC-ISEC
      MJDSEC=MJDSEC+ISEC
      IF(INDS.EQ.1) THEN
!      LSTART=.FALSE.
       GO TO 7250
!      RETURN
      ENDIF
! SHIFT ACCELERATIONS AND SUMS
      DO 7100 N=1,N6
      SUMX(N,1,1)=SUMX(N,1,2)
 7100 END DO
      N3IOL1=N3*IOL1
!
      DO 7200 N=1,N3IOL1
      XDDOT(N,1,1)=XDDOT(N,1,2)
      XDDTNC(N,1,1)=XDDTNC(N,1,2)
 7200 END DO
 7250 CONTINUE
!
!
       IF(NINTOT.GT.0) THEN
      TMOS0(1)=DBLE(MJDSEC)+FSEC
      TMOS(1)=DBLE(MJDSEC)+FSEC
!     write(6,*)' dbg START fill up TMOS0 TMOS ',TMOS0(1),TMOS(1)
!     HOS(1)=H
!     write(6,*)' dbg START fill up HOS ',HOS(1)
!
! THE NEXT TWO LOOPS ONLY WORK IF THERE IS ONE SAT PER SET
      DO  N=1,N6
         SUMXOS(N,1,1)=SUMX(N,1,1)
!     write(6,*)' compute SUMXOS start ',SUMXOS(N,1,1),N
      ENDDO
      N3IOL1=N3*IOL1
      DO N=1,N3IOL1
         XDDTOS(N,1,1)=XDDOT(N,1,1)
      ENDDO
       ENDIF
!
!
      IF(LORBIT)THEN
!      LSTART=.FALSE.
      RETURN
      ENDIF
      IF(INDS.EQ.1) GO TO 7450
      N3IOL1=NEQN3*IOL1
!
      DO 7300 N=1,N3IOL1
      PXDDOT(N,1,1)=PXDDOT(N,1,2)
!     PXDDOT(N,1,2)=PXDDTH(N,1)
 7300 END DO
!
!
      DO 7400 N=1,NEQN6
      SUMPX(N,1,1)=SUMPX(N,1,2)
 7400 END DO
 7450 CONTINUE
!
       IF(NINTOT.GT.0) THEN
      TMOSP(1)=DBLE(MJDSEC)+FSEC
!     XNEQN(1)=DFLOAT(NEQN)+.001D0
!
! THE NEXT TWO LOOPS ONLY WORK IF THERE IS ONE SAT PER SET
!
      DO N=1,IOL1
        KPT=0
        DO J=1,3
          DO K=1,NEQN
             PDDTOS(K,J,N,1)=PXDDOT(K+KPT,N,1)
          ENDDO
          KPT=KPT+NEQN
        ENDDO
      ENDDO
!
        JPT=0
      DO J=1,3
         DO N=1,NEQN
           SUMPOS(N,J,1,1)=SUMPX(N+JPT,1,1)
           SUMPOS(N,J,2,1)=SUMPX(N+JPT,2,1)
!        write(6,*)' dbg START SUMPOS ',SUMPOS(N,J,1,1),N
!        write(6,*)' dbg START SUMPOS ',SUMPOS(N,J,2,1),N
         ENDDO
         JPT=JPT+NEQN
      ENDDO
      ENDIF
!
  999 FORMAT('-TERMINATION IN START;STEPSIZE AND/OR ORDER TOO LARGE')
!      LSTART=.FALSE.
      RETURN
60000 FORMAT(' EXECUTION REMINATING IN START ')
60001 FORMAT(' A FINTE BURN ENCOUNTERED DURING STARTING PROCEDURE ')
      END
