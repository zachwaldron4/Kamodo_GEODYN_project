
      SUBROUTINE TRQMAT(GM2,XPS,TRQP,TRQS,AA,II,NCCALL,MJDSEC,FSEC)
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
      IMPLICIT DOUBLE PRECISION (A-H,O-Z),LOGICAL(L)
      COMMON/AXIS/LINTAX
      COMMON/CONSTR/PI,TWOPI,DEGRAD,SECRAD,SECDAY
      COMMON/DPLNOR/DXGEO1,DXGEO2,DXFRC1,DXFRC2,XPLNOR
      COMMON/CITERL/LSTGLB,LSTARC,LSTINR,LNADJ ,LITER1,LSTITR,          &
     &              LOBORB,LRESID,LFREEZ,LSAVEF,LHALT,LADJPI,LADJCI
      COMMON/TRQANG/DTQDAN(3,3,2)
      DIMENSION XPS(3),XDDP(3),XDDS(3),TRQP(3),TRQS(3)
      DIMENSION XTRQ(3,2),XTRQ0(3,2)
      DIMENSION DXSDXA(3,3)
      DIMENSION AA(1),II(1)
      DIMENSION DUM(3)
!
      DO I=1,18
       DTQDAN(I,1,1)=0.D0
      ENDDO
      IF(.NOT.LSTINR.OR..NOT.LINTAX) RETURN
!
      DO I=1,3
       XTRQ0(I,1)=TRQP(I)
       XTRQ0(I,2)=TRQS(I)
      ENDDO
!
!
      DO 100 IAP=1,6
      DENOM=DXFRC1*DEGRAD
      IND=1
      IF(IAP.GT.3) IND=2
      JAP=IAP
      IF(IAP.GT.3) JAP=IAP-3
      IF(IAP.EQ.3.OR.IAP.EQ.6) DENOM=DXFRC2*DEGRAD
      CALL FASTIN(GM2,XPS,XDDP,XDDS,XTRQ,XTRQ(1,2),DXSDXA,             &
                  IAP,AA,II,NCCALL,MJDSEC,FSEC,DUM,DUM,1,1)
      DTQDAN(1,JAP,IND)=(XTRQ(1,IND)-XTRQ0(1,IND))/DENOM
      DTQDAN(2,JAP,IND)=(XTRQ(2,IND)-XTRQ0(2,IND))/DENOM
      DTQDAN(3,JAP,IND)=(XTRQ(3,IND)-XTRQ0(3,IND))/DENOM
  100 CONTINUE
      RETURN
      END
