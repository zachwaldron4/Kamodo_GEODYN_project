!$STATPV
      SUBROUTINE STATPV(AA,II,LL,LDNPOL,LPOLAD,MJDSN,FSECN,NM,XMN,      &
     &   NINTPL,NMP,INDP,PXPOLE,RPOLE,S,XDPOLE,XTP,PXSPXP,PXSPLV,NINTP2,&
     & LCET,ISTA,LVLBI,LYARA,ISNUMB,PXSPXD,COSTHG,SINTHG,SCRTCH,UTDT,S1,&
     & FSECT,DXDNUT,LNUTAD)
!********1*********2*********3*********4*********5*********6*********7**
! STATPV            11/04/04            1104.0    PGMR - M. BLACKBURN
!
! FUNCTION:  CALLS INPOLP AND TRUEPV ONE MEASUREMENT AT A TIME IN ORDER
!            TO ALLOW FOR
!
! I/O PARAMETERS:
!
!   NAME    I/O  A/S   DESCRIPTION OF PARAMETERS
!   ------  ---  ---   ------------------------------------------------
!   LDNPOL   I    S    DIURNAL POLAR MOTION LOGICAL INDICATOR
!   LPOLAD   I    S    CREATE POLAR MOTION PARTIALS LOGICAL INDICATOR
!   MJDSN    I    S    MJD SEC OF TIME(S) FOR WHICH ENDPOINT MATRIX
!                      (OR ACTUAL MATRICES ARE TO BE FOUND)
!   FSECN    I    A    REMAINING SECONDS FROM MJDSC
!   NM       I    S    NUMBER OF TIMES AT WHICH INTERPOLATION WILL
!                      BE PERFORMED (IF LINTRP=.FALSE.,NM=1)
!   XMN      I    A    STATION MEAN X,Y,Z (IF PARTIALS ARE REQUESTED)
!   NINTPL        S    NUMBER OF INTERPOLATION INTERVALS REQUIRED
!   NMP           A    NUMBER OF MEASUREMENTS IN EACH INTERPOLATION
!                      INTERVAL
!   INDP          A    POLAR MOTION INTERVAL->ADJUSTED PARAMETER
!                      POINTER
!   PXPOLE        A    PARTIALS OF THE TRUE POLE STATION LOCATION
!                      W.R.T. THE POLAR MOTION X & Y PARAMETERS AT
!                      EACH END OF EACH INTERPOLATION INTERVAL
!   RPOLE         A    POLAR MOTION ROTATION MATRICES AT EACH END
!                      OF EACH INTERPOLATION INTERVAL
!   S             A    INTERPOLATION FRACTIONS
!   XDPOLE             PARTIALS OF THE TRUE POLE STATION RATE
!                      W.R.T. THE POLAR MOTION X & Y PARAMETERS AT
!                      EACH END OF EACH INTERPOLATION INTERVAL
!   XTP      O         TRUE POLE STATION COORDINATES FOR EACH OF "NM"
!                      MEASUREMENT TIMES
!   PXSPXP   O         PARTIALS OF TRUE POLE STATION COORDINATES
!                      W.R.T. POLAR MOTION FOR EACH OF "NM"
!                      MEASUREMENT TIMES
!   PXSPLV
!   NINTP2   I         NINTPL*2
!   COSTHG   I         COSINE OF GREENWICH HR ANGLE
!   SINTHG   I         SINE OF GREENWICH HR ANGLE
!   LCET     I         RETURN TRUE STATION COORDINATES CORRECTED
!                      FOR SOLID EARTH TIDES IF TRUE
!   ISTA
!
! COMMENTS:
!
!
!********1*********2*********3*********4*********5*********6*********7**
      IMPLICIT DOUBLE PRECISION (A-H,O-Z),LOGICAL(L)
      SAVE
!
      COMMON/CORA03/KRFMT ,KROTMT,KSRTCH,KCFSC ,KTHG  ,KCOSTG,KSINTG,   &
     &              KDPSI ,KEPST ,KEPSM ,KETA  ,KZTA  ,KTHTA ,KEQN  ,   &
     &              KDPSR ,KSL   ,KH2   ,KL2   ,KXPUT ,KYPUT ,KUT   ,   &
     &              KSPCRD,KSPSIG,KSTAIN,KSXYZ ,KSPWT ,KDXSDP,KDPSDP,   &
     &              KXLOCV,KSTNAM,KA1UT ,KPLTIN,KPLTVL,KPLTDV,KPUTBH,   &
     &              KABCOF,KSPEED,KANGFC,KSCROL,KSTVEL,KSTVDV,KTIMVL,   &
     &              KSTEL2,KSTEH2,KSL2DV,KSH2DV,                        &
     &              KAPRES, KASCAL, KASOFF,KXDOTP,KSAVST,               &
     &              KANGT , KSPDT , KCONAM,KGRDAN,KUANG ,KFAMP ,        &
     &              KOFACT, KOTSGN,KWRKRS,KANFSD,KSPDSD,KPRMFS,KSCRFR,  &
     &              KCOSAS,KSINAS,KDXTID,KALCOF,KSTANF,KNUTIN,KNUTMD,   &
     &              KPDPSI,KPEPST,KDXDNU,KDPSIE,KEPSTE,NXCA03
      COMMON/CORI03/KICRD ,KICON ,KISTNO,KINDPI,KMJDPL,KIPOLC,          &
     &              KNDOLA,KIOLPA,KKIOLA,KIP0OL,KNDOLM,KIOLPM,          &
     &              KKIOLM,KIPVOL,KICNL2,KICNH2,                        &
     &              KSTMJD, KNUMST, KITAST, KSTNRD, KICNV,              &
     &              KTIDES,KFODEG,KFOORD,KRDEGR,KRORDR,                 &
     &              KPHINC,KDOODS,KOTFLG,KJDN  ,KPTDN ,                 &
     &              KATIND,KPRESP,KMP2RS,KSITE,KPTOLS,NXCI03
      COMMON/CORA04/KABIAS,KABSTR,KABSTP,KCBIAS,KCBSTR,KCBSTP,          &
     &       KRNM  ,KRKM  ,KRKJ  ,KRIJ  ,KRKPM ,                        &
     &       KRRNM ,KRRKM ,KRRKJ ,KRRIJ ,KRRKPM,                        &
     &       KURNM ,KURKM ,KURKJ ,KURIJ ,KURKPM,                        &
     &       KPRRNM,KPRRKM,KPRRKJ,KPRRIJ,KPRRKP,                        &
     &       KPMPXI,KPMPXE,KRA   ,KRELV ,KUHAT ,KWORK ,KTMPCR,KU    ,   &
     &       KS0   ,KS1   ,KXTP  ,KPXSXP,KPXDXP,KXUTDT,KRPOLE,KPXPOL,   &
     &       KXDPOL,KOBBUF,KOBSC ,KRESID,KSIGMA,KRATIO,KELEVS,          &
     &       KPMPA ,KPXSLV,KTPRTL,                                      &
     &       KFRQOF,KXYZOF,KFRQST,KFRQSA,KSTDLY,KSADLY,KXYZCG,KSCMRA,   &
     &       KEBVAL,KEBSIG,KEBNAM,KBTWB ,KTBTWA,KBTWD ,KPMPE ,          &
     &       KFSEB1,KFSEB2,KSTAMT,KPXSPA,KDIAGN,KOBOUT,KGRLT1,KGRLT2,   &
     &       KGRLT3,KGRLT4,KGRLT5,KPSTAT,KRSUNS,KCHEMR,KCHMOR,KEPOSR,   &
     &       KCHEMT,KCHMOT,KEPOST,KCHCBS,KCPOSS,KSCRTM,KXSTT ,KXSTR ,   &
     &       KXSS  ,KRANGT,KRANGR,KCHB1 ,KCHB2 ,KCHBV1,KCHBV2,KCHEB ,   &
     &       KSSTFQ,KSSTCC,KSSTSS,KSSTWT,KRLCOR,KWVLBI,KQUINF,KBRTS ,   &
     &       KBRTSV,KLRARC,KXEPBF,KXEPBR,KPRCBD,KPRTBD,KXPMPA,KXL,      &
     &       KXSIG ,KXEDTS,KXALO1,KXALO2,KXYOF2,KDLATF,KDLATS,KDLONF,   &
     &       KDLONS,KPF   ,KPS   ,                                      &
     &       KXOBSV,KXOBSW,KXEDSW,                                      &
     &       KXSIGW,KPSF  ,KDNUM ,KCNUM ,KFCOR ,KCOSAR,KSINAR,KSABIA,   &
     &       KSBTM1,KSBTM2,KYAWBS,KVLOUV,KACMAG,KOBSTR,                 &
     &       KPRL1 ,KPRL2, KRL1  ,KT1SE ,KTCP  ,                        &
     &       KRATDR,KFQT1S,KFQT1E,KT1STR,KFTTSE,KFRSTR,KFRRAT,KSV1  ,   &
     &       KSV2  ,KTSLOV,                                             &
     &       KGLGR1,KGLGR2,KGLFR1,KGLFR2,                               &
     &       KARGR1,KARGR2,KARFR1,KARFR2,                               &
     &       KRDS1L,KFT1AV,KDFQP ,KFREQ1,KFREQ3,KSAVD1,KSAVD2,          &
     &       KANTOU,KFM3CF,KF2CF,KTMG,KLTMG,KX2TIM,KX2OBS,KXRNDX,KX2SCR,&
     &       KALTWV,KXXBM ,KX2PAR,KATIME,KPMPAT,KPMATT,KX2PAT,          &
     &       KPXEXI,KPXEPA,KPV,KPXEP2,KX2COF,KACOF2,KACOF3,KBCOF,KBCOF2,&
     &       KDDDA ,KX2AUX,KX2VPR,KX2VPA,KEXTRA,KVARAY,KATROT,KATPER,   &
     &       KLTAR ,KXHOLD,KANTBL,KPHC  ,KOFDRV,KGNAME,KGRSIZ,KGRCNT,   &
     &       KGRDAT,KACCDT,KCTBTI,KCTBWE,KCTCTM,KANTUV,KANTOR,KW1PU ,   &
     &       KPYSQH,KSIGSP,KXYOF3,KXVTM1,KXDIST,KXDST0,KTMSE ,KDSDP ,   &
     &       KEXCST,KEXCDT,KEXCGX,KEXCGY,KEXCGZ,KIMNDX,KIMOBS,KIMTIM,   &
     &       KIMSAT,KM2VPA,KDCDD ,KDWNWT,KDPOR ,KC2PAR,KBOUNC,KBPART,   &
     &       NXCA04
      COMMON/CSBSAT/KR,KRT,KZT,KXY2,KUZ,KUZSQ,KTEMP,KC3,KTHETG
      COMMON/COBGLO/MABIAS,MCBIAS,MPVECT,MINTPL,MPARAM,MSTA,MOBBUF,     &
     &       MNPITR,MWIDTH,MSIZE ,MPART ,MBUF  ,NXCOBG
      COMMON/SETDI /NSETDP,NFRSED,NFRSDI,NFRSLN,NXSETI
      COMMON/INPOL /NMN(500),NINTVN
      COMMON/NUTINF/NNUT,NNUTAA,NXNUTA
      COMMON/NUTFAC/SYNT
      COMMON/NUTHLD /NUTLST
      DIMENSION FSECN(NM),NMP(1),INDP(1),RPOLE(3,3,1),PXPOLE(3,2,1),    &
     &XMN(3),IPTT(2),S(NM),NPNTPL(1),XTP(NM,3),PXSPXP(NM,3,2),          &
     &COSTHG(NM),SINTHG(NM),ISTA(1),PXSPXD(NM,3,2),XT(3),FSECT(NM)
      DIMENSION PXSPLV(NM,3,NSETDP)

      DIMENSION XDPOLE(3,2,MINTPL)
      DIMENSION SCRTCH(NM,11)
      DIMENSION UTDT(NM),S1(NM)
      DIMENSION AA(1),II(1),LL(1)
      DIMENSION TV(1,3,2),TVD(1,3,2),TVL(1,3,200)
      DIMENSION TN(3,2,2),DXDNUT(3,2,NM)
!
!
!
!***********************************************************************
! START OF EXECUTABLE CODE *********************************************
!***********************************************************************
!
      DO N=1,500
      NMN(N)=0
      ENDDO

      DO N=1,NM

      CALL GRHRAN(MJDSN,FSECN(N),.TRUE.,.TRUE.,AA(KEQN-1+N),SCRTCH(N,1),&
     &     AA(KTHETG+N-1),COSTHG(N),SINTHG(N),1,AA,II,UTDT(1),.TRUE.,   &
     &     XMN,TN)

! OBTAIN POLAR MOTION ROTATION MATRICES AND PARTIAL DERIVATIVE MATRICES
      CALL INPOLE(AA(KA1UT),AA(KDPSR),AA(KXPUT),AA(KYPUT),.FALSE.,      &
     &   LDNPOL,LPOLAD,MJDSN,FSECN(N),1,XMN,II(KINDPI),NINTPL,NMP, &
     &   INDP,PXPOLE,RPOLE,S(N),XDPOLE,AA(KXDOTP))


      S(N)=1.D0
      S1(N)=1.D0
      NMN(N)=NINTVN
      CALL TRUEPV(S(N),S1(N),NMP,INDP,RPOLE,PXPOLE,LPOLAD,XMN,XT,       &
     &   TV,TVL,1,NINTPL,NINTP2,MJDSN,       &
     &   FSECT(N),COSTHG(N),SINTHG(N),LCET,AA(KROTMT+N-1),              &
     &   AA(KSTAIN),AA(KPLTDV),AA(KPLTVL),ISTA,AA(KSTVEL),AA(KTIMVL),   &
     &   AA(KPMPXE-1+N),AA(KPMPXI-1+N),II(KICNL2),II(KICNH2),LVLBI,     &
     &   AA,LYARA,  &
     &   ISNUMB,II,XDPOLE,TVD)


      IF(LPOLAD) THEN
      DO JJ=1,3
      DO KK=1,2
      PXSPXP(N,JJ,KK)=TV(1,JJ,KK)
      PXSPXD(N,JJ,KK)=TVD(1,JJ,KK)
      ENDDO
      ENDDO
      ENDIF
      IF(NSETDP.GT.0) THEN
      DO JJ=1,3
      DO MM=1,NSETDP
      PXSPLV(N,JJ,MM)=TVL(1,JJ,MM)
      ENDDO
      ENDDO
      ENDIF

      IF(LNUTAD) THEN
      DO JJ=1,3
      DO KK=1,2
      DXDNUT(JJ,KK,N)=TN(JJ,KK,1)*SYNT + TN(JJ,KK,2)*(SYNT-1.D0)
      ENDDO
      ENDDO
      ENDIF



      XTP(N,1)=XT(1)
      XTP(N,2)=XT(2)
      XTP(N,3)=XT(3)

      ENDDO

      RETURN
      END
