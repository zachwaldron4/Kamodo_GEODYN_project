!$YAWFO
      SUBROUTINE YAWFO(NSATA,ISATN,EPOCH)
      IMPLICIT DOUBLE PRECISION (A-H,O-Z), LOGICAL (L)
      SAVE
!
      COMMON/DTMGDN/TGTYMD,TMGDN1,TMGDN2,REPDIF,XTMGN
      CHARACTER*80 CARD,BLANK
      COMMON/GPSBET/BETCUT,BETGPS(200)
      COMMON/SPOLY/XSSAT,SNPOLY,XSSATD(200),XSPOLY(6,2000)
      COMMON/UNITS/IUNT11,IUNT12,IUNT13,IUNT19,IUNT30,IUNT71,IUNT72,    &
     &             IUNT73,IUNT05,IUNT14,IUNT65,IUNT88,IUNT21,IUNT22,    &
     &             IUNT23,IUNT24,IUNT25,IUNT26
      COMMON/YAWNFO/YAWRP(200),YAWR(200),YAWRR(200),YAWBTP(200),        &
     &              YAWBID(200)
      DIMENSION ISATN(NSATA)
      DIMENSION IDSAT(200),NUMP(200),IBTYPE(8,200),ENDTIM(8,200)
      DATA IDSAT/200*0/,NUMP/200*0/
!
      DLTA41=86400.D0*(30000.D0-TMGDN2)
!
      DO 5 I=1,80
      BLANK(I:I)=' '
    5 END DO
!
! GPS10, SVN10 (data from yaw_bias_table)
      IDSAT(1)=8410121
      NUMP(1)=1
      IBTYPE(1,1)= 0
      ENDTIM(1,1)=999999999999.0
!
! GPS13, SVN13 (data from yaw_bias_table)
      IDSAT(2)=8913022
      NUMP(2)=6
      IBTYPE(1,2)= 0
      ENDTIM(1,2)=  1640563200.0 +DLTA41
      IBTYPE(2,2)= 1
      ENDTIM(2,2)=  1719532800.0 +DLTA41
      IBTYPE(3,2)= 2
      ENDTIM(3,2)=  1719623400.0 +DLTA41
      IBTYPE(4,2)=-2
      ENDTIM(4,2)=  1731283200.0 +DLTA41
      IBTYPE(5,2)= 2
      ENDTIM(5,2)=  1827187200.0 +DLTA41
      IBTYPE(6,2)= 4
      ENDTIM(6,2)=999999999999.0
!
! GPS14, SVN14 (data from yaw_bias_table)
      IDSAT(3)=8914142
      NUMP(3)=6
      IBTYPE(1,3)= 0
      ENDTIM(1,3)=  1706310180.0 +DLTA41
      IBTYPE(2,3)= 1
      ENDTIM(2,3)=  1706925600.0 +DLTA41
      IBTYPE(3,3)= 2
      ENDTIM(3,3)=  1712023200.0 +DLTA41
      IBTYPE(4,3)= 1
      ENDTIM(4,3)=  1722211200.0 +DLTA41
      IBTYPE(5,3)=-2
      ENDTIM(5,3)=  1722468120.0 +DLTA41
      IBTYPE(6,3)= 2
      ENDTIM(6,3)=999999999999.0
!
! GPS15, SVN15 (data from yaw_bias_table)
      IDSAT(4)=9015152
      NUMP(4)=6
      IBTYPE(1,4)= 0
      ENDTIM(1,4)=  1685577600.0 +DLTA41
      IBTYPE(2,4)= 1
      ENDTIM(2,4)=  1717804800.0 +DLTA41
      IBTYPE(3,4)=-2
      ENDTIM(3,4)=  1717960560.0 +DLTA41
      IBTYPE(4,4)= 2
      ENDTIM(4,4)=  1845244800.0 +DLTA41
      IBTYPE(5,4)= 0
      ENDTIM(5,4)=  1893444420.0 +DLTA41
      IBTYPE(6,4)= 2
      ENDTIM(6,4)=999999999999.0
!
! GPS16, SVN16 (data from yaw_bias_table)
      IDSAT(5)=8916162
      NUMP(5)=8
      IBTYPE(1,5)= 0
      ENDTIM(1,5)=  1685577600.0 +DLTA41
      IBTYPE(2,5)= 1
      ENDTIM(2,5)=  1704402000.0 +DLTA41
      IBTYPE(3,5)= 0
      ENDTIM(3,5)=  1706301300.0 +DLTA41
      IBTYPE(4,5)= 1
      ENDTIM(4,5)=  1706968800.0 +DLTA41
      IBTYPE(5,5)=-1
      ENDTIM(5,5)=  1712023200.0 +DLTA41
      IBTYPE(6,5)= 1
      ENDTIM(6,5)=  1722412800.0 +DLTA41
      IBTYPE(7,5)=-2
      ENDTIM(7,5)=  1722500160.0 +DLTA41
      IBTYPE(8,5)= 2
      ENDTIM(8,5)=999999999999.0
!
! GPS17, SVN17 (data from yaw_bias_table)
      IDSAT(6)=8917172
      NUMP(6)=4
      IBTYPE(1,6)= 0
      ENDTIM(1,6)=  1685577600.0 +DLTA41
      IBTYPE(2,6)= 1
      ENDTIM(2,6)=  1717960560.0 +DLTA41
      IBTYPE(3,6)=-2
      ENDTIM(3,6)=  1718113500.0 +DLTA41
      IBTYPE(4,6)= 2
      ENDTIM(4,6)=999999999999.0
!
! GPS18, SVN18 (data from yaw_bias_table)
      IDSAT(7)=9018182
      NUMP(7)=5
      IBTYPE(1,7)= 0
      ENDTIM(1,7)=  1706310180.0+DLTA41
      IBTYPE(2,7)= 1
      ENDTIM(2,7)=  1710633600.0+DLTA41
      IBTYPE(3,7)= 2
      ENDTIM(3,7)=  1710776520.0+DLTA41
      IBTYPE(4,7)=-2
      ENDTIM(4,7)=  1726508700.0+DLTA41
      IBTYPE(5,7)= 2
      ENDTIM(5,7)=999999999999.0
!
! GPS19, SVN19 (data from yaw_bias_table)
      IDSAT(8)=8919192
      NUMP(8)=6
      IBTYPE(1,8)= 0
      ENDTIM(1,8)=  1685577600.0+DLTA41
      IBTYPE(2,8)= 1
      ENDTIM(2,8)=  1715040000.0+DLTA41
      IBTYPE(3,8)= 2
      ENDTIM(3,8)=  1715133840.0+DLTA41
      IBTYPE(4,8)=-2
      ENDTIM(4,8)=  1715220240.0+DLTA41
      IBTYPE(5,8)= 1
      ENDTIM(5,8)=  1729036800.0+DLTA41
      IBTYPE(6,8)= 2
      ENDTIM(6,8)=999999999999.0
!
! GPS20, SVN20 (data from yaw_bias_table)
      IDSAT(9)=9020202
      NUMP(9)=5
      IBTYPE(1,9)= 0
      ENDTIM(1,9)=  1706310180.0+DLTA41
      IBTYPE(2,9)= 1
      ENDTIM(2,9)=  1719532800.0+DLTA41
      IBTYPE(3,9)= 2
      ENDTIM(3,9)=  1719664560.0+DLTA41
      IBTYPE(4,9)=-2
      ENDTIM(4,9)=  1731283200.0+DLTA41
      IBTYPE(5,9)= 2
      ENDTIM(5,9)=999999999999.0
!
! GPS21, SVN21 (data from yaw_bias_table)
      IDSAT(10)=9021212
      NUMP(10)=6
      IBTYPE(1,10)= 0
      ENDTIM(1,10)=  1685577600.0+DLTA41
      IBTYPE(2,10)= 1
      ENDTIM(2,10)=  1706774400.0+DLTA41
      IBTYPE(3,10)=-1
      ENDTIM(3,10)=  1706814000.0+DLTA41
      IBTYPE(4,10)= 1
      ENDTIM(4,10)=  1722211200.0+DLTA41
      IBTYPE(5,10)=-2
      ENDTIM(5,10)=  1722326400.0+DLTA41
      IBTYPE(6,10)= 2
      ENDTIM(6,10)=999999999999.0
!
! GPS22, SVN22 (data from yaw_bias_table)
      IDSAT(11)=9322223 !9300702
      NUMP(11)=5
      IBTYPE(1,11)= 0
      ENDTIM(1,11)=  1685577600.0+DLTA41
      IBTYPE(2,11)= 1
      ENDTIM(2,11)=  1719532800.0+DLTA41
      IBTYPE(3,11)= 2
      ENDTIM(3,11)=  1719782100.0+DLTA41
      IBTYPE(4,11)=-2
      ENDTIM(4,11)=  1731283200.0+DLTA41
      IBTYPE(5,11)= 2
      ENDTIM(5,11)=999999999999.0
!
! GPS23, SVN23 (data from yaw_bias_table)
      IDSAT(12)=9023233 !9023232
      NUMP(12)=7
      IBTYPE(1,12)= 0
      ENDTIM(1,12)=  1640563200.0+DLTA41
      IBTYPE(2,12)= 1
      ENDTIM(2,12)=  1706940000.0+DLTA41
      IBTYPE(3,12)=-1
      ENDTIM(3,12)=  1706983200.0+DLTA41
      IBTYPE(4,12)= 1
      ENDTIM(4,12)=  1722211200.0+DLTA41
      IBTYPE(5,12)=-2
      ENDTIM(5,12)=  1722420300.0+DLTA41
      IBTYPE(6,12)= 2
      ENDTIM(6,12)=  1926288000.0+DLTA41
      IBTYPE(7,12)=-3.5
      ENDTIM(7,12)=999999999999.0
!
! GPS24, SVN24 (data from yaw_bias_table)
      IDSAT(13)=9124243 !9124242
      NUMP(13)=4
      IBTYPE(1,13)= 0
      ENDTIM(1,13)=  1640563200.0+DLTA41
      IBTYPE(2,13)= 1
      ENDTIM(2,13)=  1717632000.0+DLTA41
      IBTYPE(3,13)=-2
      ENDTIM(3,13)=  1717736340.0+DLTA41
      IBTYPE(4,13)= 2
      ENDTIM(4,13)=999999999999.0
!
! GPS25, SVN25 (data from yaw_bias_table)
      IDSAT(14)=9225253 !9225252
      NUMP(14)=6
      IBTYPE(1,14)= 0
      ENDTIM(1,14)=  1685577600.0+DLTA41
      IBTYPE(2,14)= 1
      ENDTIM(2,14)=  1715040000.0+DLTA41
      IBTYPE(3,14)= 2
      ENDTIM(3,14)=  1715202900.0+DLTA41
      IBTYPE(4,14)=-2
      ENDTIM(4,14)=  1715289300.0+DLTA41
      IBTYPE(5,14)= 1
      ENDTIM(5,14)=  1729036800.0+DLTA41
      IBTYPE(6,14)= 2
      ENDTIM(6,14)=999999999999.0
!
! GPS26, SVN26 (data from yaw_bias_table)
      IDSAT(15)=9226263 !9226262
      NUMP(15)=5
      IBTYPE(1,15)= 0
      ENDTIM(1,15)=  1685577600.0+DLTA41
      IBTYPE(2,15)= 1
      ENDTIM(2,15)=  1710806400.0+DLTA41
      IBTYPE(3,15)= 2
      ENDTIM(3,15)=  1710942000.0+DLTA41
      IBTYPE(4,15)=-2
      ENDTIM(4,15)=  1726693200.0+DLTA41
      IBTYPE(5,15)= 2
      ENDTIM(5,15)=999999999999.0
!
! GPS27, SVN27 (data from yaw_bias_table)
      IDSAT(16)=9227273 !9227272
      NUMP(16)=6
      IBTYPE(1,16)= 0
      ENDTIM(1,16)=  1685577600.0+DLTA41
      IBTYPE(2,16)= 1
      ENDTIM(2,16)=  1715040000.0+DLTA41
      IBTYPE(3,16)= 2
      ENDTIM(3,16)=  1715137080.0+DLTA41
      IBTYPE(4,16)=-2
      ENDTIM(4,16)=  1715223480.0+DLTA41
      IBTYPE(5,16)= 1
      ENDTIM(5,16)=  1729036800.0+DLTA41
      IBTYPE(6,16)= 2
      ENDTIM(6,16)=999999999999.0
!
! GPS28, SVN28 (data from yaw_bias_table)
      IDSAT(17)=9228283 !9228282
      NUMP(17)=4
      IBTYPE(1,17)= 0
      ENDTIM(1,17)=  1685577600.0+DLTA41
      IBTYPE(2,17)= 1
      ENDTIM(2,17)=  1711238400.0+DLTA41
      IBTYPE(3,17)=-2
      ENDTIM(3,17)=  1711394400.0+DLTA41
      IBTYPE(4,17)= 2
      ENDTIM(4,17)=999999999999.0
!
! GPS29, SVN29 (data from yaw_bias_table)
      IDSAT(18)=9229293 !9229292
      NUMP(18)=3
      IBTYPE(1,18)= 0
      ENDTIM(1,18)=  1685577600.0+DLTA41
      IBTYPE(2,18)= 1
      ENDTIM(2,18)=  1704402000.0+DLTA41
      IBTYPE(3,18)= 2
      ENDTIM(3,18)=999999999999.0
!
! GPS30, SVN30 (data from yaw_bias_table)
      IDSAT(19)=9630303 !9630302
      NUMP(19)=1
      IBTYPE(1,19)= 2
      ENDTIM(1,19)=999999999999.0
!
! GPS31, SVN31 (data from yaw_bias_table)
      IDSAT(20)=9331313 !9331312
      NUMP(20)=4
      IBTYPE(1,20)= 0
      ENDTIM(1,20)=  1685577600.0+DLTA41
      IBTYPE(2,20)= 1
      ENDTIM(2,20)=  1711238400.0+DLTA41
      IBTYPE(3,20)=-2
      ENDTIM(3,20)=  1711335600.0+DLTA41
      IBTYPE(4,20)= 2
      ENDTIM(4,20)=999999999999.0
!
! GPS32, SVN32 (data from yaw_bias_table)
      IDSAT(21)=9232013 !9232012
      NUMP(21)=5
      IBTYPE(1,21)= 0
      ENDTIM(1,21)=  1685577600.0+DLTA41
      IBTYPE(2,21)= 1
      ENDTIM(2,21)=  1710892800.0+DLTA41
      IBTYPE(3,21)= 2
      ENDTIM(3,21)=  1711042200.0+DLTA41
      IBTYPE(4,21)=-2
      ENDTIM(4,21)=  1726637040.0+DLTA41
      IBTYPE(5,21)= 2
      ENDTIM(5,21)=999999999999.0
!
! GPS33, SVN33 (data from yaw_bias_table)
      IDSAT(22)=9633033 !9633032
      NUMP(22)=1
      IBTYPE(1,22)= 2
      ENDTIM(1,22)=999999999999.0
!
! GPS34, SVN34 (data from yaw_bias_table)
      IDSAT(23)=9334043 !9334042
      NUMP(23)=4
      IBTYPE(1,23)= 0
      ENDTIM(1,23)=  1685577600.0+DLTA41
      IBTYPE(2,23)= 1
      ENDTIM(2,23)=  1717632000.0+DLTA41
      IBTYPE(3,23)=-2
      ENDTIM(3,23)=  1717798020.0+DLTA41
      IBTYPE(4,23)= 2
      ENDTIM(4,23)=999999999999.0
!
! GPS35, SVN35 (data from yaw_bias_table)
      IDSAT(24)=9335053 !9335052
      NUMP(24)=5
      IBTYPE(1,24)= 0
      ENDTIM(1,24)=  1685577600.0+DLTA41
      IBTYPE(2,24)= 1
      ENDTIM(2,24)=  1719532800.0+DLTA41
      IBTYPE(3,24)= 2
      ENDTIM(3,24)=  1719658980.0+DLTA41
      IBTYPE(4,24)=-2
      ENDTIM(4,24)=  1731283200.0+DLTA41
      IBTYPE(5,24)= 2
      ENDTIM(5,24)=999999999999.0
!
! GPS36, SVN36 (data from yaw_bias_table)
      IDSAT(25)=9436063 !9436062
      NUMP(25)=4
      IBTYPE(1,25)= 0
      ENDTIM(1,25)=  1685577600.0+DLTA41
      IBTYPE(2,25)= 1
      ENDTIM(2,25)=  1711497600.0+DLTA41
      IBTYPE(3,25)=-2
      ENDTIM(3,25)=  1711655100.0+DLTA41
      IBTYPE(4,25)= 2
      ENDTIM(4,25)=999999999999.0
!
! GPS37, SVN37 (data from yaw_bias_table)
      IDSAT(26)=9337073 !9337072
      NUMP(26)=4
      IBTYPE(1,26)= 0
      ENDTIM(1,26)=  1685577600.0+DLTA41
      IBTYPE(2,26)= 1
      ENDTIM(2,26)=  1711238400.0+DLTA41
      IBTYPE(3,26)=-2
      ENDTIM(3,26)=  1711335600.0+DLTA41
      IBTYPE(4,26)= 2
      ENDTIM(4,26)=999999999999.0
!
! GPS38, SVN38 (data from yaw_bias_table)
      IDSAT(27)=9738082 !9738082
      NUMP(27)=1
      IBTYPE(1,27)= 2
      ENDTIM(1,27)=999999999999.0
!
! GPS39, SVN39 (data from yaw_bias_table)
      IDSAT(28)=9339093 !9339092
      NUMP(28)=6
      IBTYPE(1,28)= 0
      ENDTIM(1,28)=  1685577600.0+DLTA41
      IBTYPE(2,28)= 1
      ENDTIM(2,28)=  1715040000.0+DLTA41
      IBTYPE(3,28)= 2
      ENDTIM(3,28)=  1715148900.0+DLTA41
      IBTYPE(4,28)=-2
      ENDTIM(4,28)=  1715235300.0+DLTA41
      IBTYPE(5,28)= 1
      ENDTIM(5,28)=  1729036800.0+DLTA41
      IBTYPE(6,28)= 2
      ENDTIM(6,28)=999999999999.0
!
! GPS40, SVN40 (data from yaw_bias_table)
      IDSAT(29)=9640103 !9640102
      NUMP(29)=1
      IBTYPE(1,29)= 2
      ENDTIM(1,29)=999999999999.0
!
!
!
!
!
      XSSAT=0.D0
      SNPOLY=0.D0
!
      DO 100 I=1,200
      YAWRP(I)=-1.D0
      YAWR(I)=0.D0
      YAWRR(I)=0.D0
      YAWBTP(I)=0.D0
      YAWBID(I)=0.D0
      XSSATD(I)=-1.D0
  100 END DO
!
! 1685577600 secs= 19509 days (from 2430000.5)= MJD 49509 =Jun. 5,1994
!
!     IF(EPOCH.LT.1685577600.D0) THEN
!
       CKEPOC=1685577600.D0+DLTA41
      IF(EPOCH.LT.CKEPOC) THEN
        WRITE(6,6000)
        WRITE(6,6000)
        WRITE(6,6000)
        WRITE(6,6001)
        WRITE(6,6002)
        WRITE(6,6000)
        WRITE(6,6000)
        WRITE(6,6000)
       RETURN
      ENDIF
!
!
! SET ALL BIAS RATE TYPES EQUAL TO 2, IF AFTER NOV 16, 1995
!
!     IF(EPOCH.GT.1731283200.D0) THEN
!
           CKEPOC=1731283200.D0+DLTA41
      IF(EPOCH.GT.CKEPOC) THEN
         DO 150 I=1,NSATA
         YAWBTP(I)=2.D0
         YAWBID(I)=DBLE(ISATN(I))
  150    CONTINUE
      ELSE
         DO 200 I=1,NSATA
         DO 175 J=1,200
         IF(ISATN(I).EQ.IDSAT(J)) THEN
           NUMX=NUMP(J)
           DO 160 K=1,NUMX
           IF(EPOCH.LE.ENDTIM(K,J)) THEN
             YAWBTP(I)=DBLE(IBTYPE(K,J))
             YAWBID(I)=DBLE(ISATN(I))
             GO TO 200
           ENDIF
  160      CONTINUE
           GO TO 200
         ENDIF
  175    CONTINUE
  200    CONTINUE
      ENDIF
!
! CHECK FOR YAW RATES (GPSSHD RUN) OR
! POLYNOMIALS (DATA REDUCTION RUN)
! ONE OR THE OTHER
      REWIND 14
      LGPSHZ=.FALSE.
!
  300 CONTINUE
!
! READ TILL FIND GPSSHD OR YAWPOL
!
      READ(14,5000,END=1000) CARD
!
! GPSSHD CARD ENCOUNTERED
!
      IF(CARD(1:6).EQ.'GPSSHD') THEN
         LGPSHZ=.TRUE.
         IF(CARD(45:59).NE.BLANK(45:59)) THEN
            READ(CARD(45:59),5003) CUT
            IF(CUT.GT.0.D0) BETCUT=CUT
         ENDIF
  400    CONTINUE
         READ(14,5000,END=1000) CARD
         IF(CARD(1:6).NE.'YAWRAT') GO TO 1000
         READ(CARD(18:24),5001) IDSATX
         DO 410 I=1,NSATA
         IF(ISATN(I).EQ.IDSATX) THEN
           YAWRP(I)=1.D0
           READ(CARD(25:59),5002) YAWR(I),YAWRR(I)
           GO TO 400
         ENDIF
  410    CONTINUE
         GO TO 400
      ENDIF
!
! YAWPOL CARD ENCOUNTERED
!
      IF(CARD(1:6).EQ.'YAWPOL') THEN
         CALL GSPOLY(NSATA,ISATN)
         GO TO 1000
      ENDIF
      GO TO 300
!
 1000 CONTINUE
      NPOLY=SNPOLY+.005D0
      IF(.NOT.LGPSHZ.AND.NPOLY.LT.1) THEN
        WRITE(6,6000)
        WRITE(6,6000)
        WRITE(6,6000)
        WRITE(6,6003)
        WRITE(6,6004)
        WRITE(6,6000)
        WRITE(6,6000)
        WRITE(6,6000)
      ENDIF
      RETURN
 5000 FORMAT(A80)
 5001 FORMAT(I7)
 5002 FORMAT(D20.8,D15.3)
 5003 FORMAT(D15.3)
 6000 FORMAT(' ')
 6001 FORMAT(' EPOCH OF INTEREST IS BEFORE JUNE 6,1994 ')
 6002 FORMAT(' NO SPECIAL YAW STEERING WILL BE COMPUTED')
 6003 FORMAT(' NO SPECIAL YAW STEERING SELECTED')
 6004 FORMAT(' THROUGH THE USE OF YAW SHADOW/NOON POLYNOMIALS')
      END
