      SUBROUTINE GSPOLY(NSATA,ISATN)
      IMPLICIT DOUBLE PRECISION (A-H,O-Z),LOGICAL(L)
      CHARACTER*80 CARD
      CHARACTER*9 DIG
      COMMON/SPOLY/XSSAT,SNPOLY,XSSATD(200),XSPOLY(6,2000)
      COMMON/YAWNFO/YAWRP(200),YAWR(200),YAWRR(200),YAWBTP(200),        &
     &              YAWBID(200)
      DIMENSION ISATN(NSATA)
!
      NSAT=0
      NPOLY=0
      DIG='123456789'
      CONV=ACOS(-1.D0)/180.D0
!
!
!
  100 CONTINUE
      READ(14,5000,END=500) CARD
!
! CHECK TO MAKE SURE THAT THIS IS A VALID YAWPOL CARD
!
      DO 110 I=1,9
      IF(CARD(1:1).EQ.DIG(I:I)) GO TO 120
  110 END DO
      GO TO 500
  120 CONTINUE
      LOK=.FALSE.
      IF(CARD(79:79).EQ.'S') LOK=.TRUE.
      IF(CARD(79:79).EQ.'P') LOK=.TRUE.
      IF(CARD(79:79).EQ.'N') LOK=.TRUE.
      IF(.NOT.LOK) GO TO 500
!
! SEEMS TO BE A VALID YAWPOL CARD
!
      READ(CARD,5001) ISATD,TSTART,TEND,A0,A1,A2
      DO 130 I=1,NSATA
      IF(ISATD.NE.ISATN(I)) GO TO 130
      TEST=ABS(YAWBTP(I))
      IF(TEST.LT..01D0) GO TO 100
      GO TO 140
  130 END DO
      GO TO 100
  140 CONTINUE
      NPOLY=NPOLY+1
      A0=A0*CONV
      A1=A1*CONV
      A2=A2*CONV
      XSPOLY(1,NPOLY)=DBLE(ISATD)
      XSPOLY(2,NPOLY)=TSTART
      XSPOLY(3,NPOLY)=TEND
      XSPOLY(4,NPOLY)=A0
      XSPOLY(5,NPOLY)=A1
      XSPOLY(6,NPOLY)=A2
      GO TO 100
  500 CONTINUE
!
!
      IF(NPOLY.LE.0) THEN
         WRITE(6,6000)
         WRITE(6,6000)
         WRITE(6,6000)
         WRITE(6,6001)
         WRITE(6,6002)
         WRITE(6,6000)
         WRITE(6,6000)
         WRITE(6,6000)
         RETURN
      ENDIF
!
! CHECK TO MAKE SURE THAT
! YAW POLYNOMIALS ARE SORTED BY SATID AND BY TIME
      LSATO=.FALSE.
      LTIMO=.FALSE.
      ISATDP=-99
      ITIMP=-99
      DO 600 I=1,NPOLY
      ISATD=XSPOLY(1,I)+.01D0
      ITIM=XSPOLY(2,I)+.01D0
      IF(ISATDP.NE.ISATD) THEN
         DO 530 J=1,NSATA
         IF(ISATD.NE.ISATN(J)) GO TO 530
         IF(XSSATD(J).GT.0.D0) LSATO=.TRUE.
         XSSATD(J)=1.D0
         GO TO 540
  530    CONTINUE
      ELSE
         IF(ITIM.LT.ITIMP) LTIMO=.TRUE.
      ENDIF
  540 CONTINUE
      ITIMP=ITIM
      ISATDP=ISATD
  600 END DO
      IF(LSATO.OR.LTIMO) THEN
         WRITE(6,6000)
         WRITE(6,6000)
         WRITE(6,6000)
         WRITE(6,6001)
         WRITE(6,6003)
         IF(LSATO) WRITE(6,6004)
         IF(LTIMO) WRITE(6,6005)
         WRITE(6,6000)
         WRITE(6,6000)
         WRITE(6,6000)
        RETURN
      ENDIF
!
!
      SNPOLY=DBLE(NPOLY)
      XSSAT=DBLE(NSAT)
      WRITE(6,6000)
      WRITE(6,6000)
      WRITE(6,6000)
      WRITE(6,6006)
      WRITE(6,6007) NSAT,NPOLY
      WRITE(6,6000)
      WRITE(6,6000)
      WRITE(6,6000)
      RETURN
 5000 FORMAT(A80)
 5001 FORMAT(I7,2X,F13.1,2X,F13.1,3(2X,F11.6),2X,A2)
 6000 FORMAT(' ')
 6001 FORMAT(' YAW POLYNOMIALS WERE INPUT ON UNIT 5, BUT NO ')
 6002 FORMAT(' MATCHES WERE FOUND ')
 6003 FORMAT(' PROBLEMS WERE FOUND: ')
 6004 FORMAT(' SATELLITE IDS NOT BUNCHED  ')
 6005 FORMAT(' OUT OF TIME ORDER WITHIN SATID  ')
 6006 FORMAT(' SPECIAL YAW STEERING SELECTED FROM INPUT ON UNIT 5')
 6007 FORMAT(' THERE ARE ',I3,' SATELLITES AND ',I6,' POLYNOMIALS')
      END
