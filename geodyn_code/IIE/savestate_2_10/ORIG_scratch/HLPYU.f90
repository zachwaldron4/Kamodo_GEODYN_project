      SUBROUTINE HLPYU(MTYPE2,XLOCV)
!********1*********2*********3*********4*********5*********6*********7**
! HLYPU                                          PGMR - D. ROWLANDS
!
!
! FUNCTION:  INITIALIZE (AND IN SOME CASES FILL IN) THE PYUA COMMON
!            BLOCK. SUBROUTINE OFFDEL ALSO SUPPLIES INFORMATION
!            TO THE PYUA COMMON BLOCK. THE PYUA COMMON BLOCK CONTAINS
!            INFORMATION NEED FOR GPS CORRECTIONS INCLUDING:
!                (1) PHASE WIND UP CORRECTION
!                (2) ANTENNA MAP CORRECTIOINS
!                (3) ANTENNA FRAME EDITING (ANTCUT)
!
! I/O PARAMETERS:
!
!   NAME    I/O  A/S   DESCRIPTION OF PARAMETERS
!   ------  ---  ---   ------------------------------------------------
!   MTYPE2    I    S    GEODYN MEASUREMENT TYPE
!   XLOCV    I    A    ARRAY CONTAINING EAST, NORTH, VERTICAL UNIT
!                      VECTORS FOR ALL STATIONS
!
! COMMENTS:
!
!********1*********2*********3*********4*********5*********6*********7**
      IMPLICIT DOUBLE PRECISION (A-H,O-Z),LOGICAL(L)
!
      COMMON/CBLOKI/MJDSBL,MTYPE ,NM    ,JSTATS,NPSEG ,JSATNO(3),ITSYS ,&
     &       NHEADB,NELEVS,ISTAEL(12),INDELV(3,4),JSTANO(3),ITARNO,     &
     &       KTARNO
      COMMON/CNIGLO/MINTIM,MSATG3,MEQNG ,MEQNG3,MSATG ,MSATOB,MSATA ,   &
     &              MSATA3,MSETA ,MINTVL,MSORDR,MSORDV,NMXORD,          &
     &       MCIPV ,MXBACK,MXI   ,MPXPF ,MAXAB ,MSETDG,MXSATD,          &
     &       MXDEGS,MXDRP ,MXDRPA,MXSRP ,MXSRPA,MXGAP ,MSATDR,          &
     &       MSATSR,MSATGA,MXDRPD,MXSRPD,MXGAPD,MXBCKP,MXTPMS,          &
     &       NSTAIN,NXCNIG
      COMMON/ELRTNX/NELVS,NELVC,IELSTA(6),IELSAT(6),IELSA2(6),          &
     &       INDXEL(5,4)
      COMMON/PYUA  /XGPSTB,WVL3,VHIGH(3,3,4),VLOW(3,3,4),PYUSQ(5),      &
     &              VISATH(4),VISATL(4),XANTSL(4),XCUTSL(4),XANTSH(4)
!
      DIMENSION STAINF(NSTAIN,1),XLOCV(3,3,1)
!
      DO IQP=1,4
        XANTSL(IQP)=-9999
        XCUTSL(IQP)=-90.D0
      ENDDO
      IF(MTYPE2.EQ.39.OR.MTYPE2.EQ.51) THEN
         VISATL(1)=JSATNO(1)
      ENDIF
      IF(XGPSTB.LT.0.D0) RETURN
!
!ddr mods
      IF(MTYPE2.EQ.65) THEN
!
         ISEQ=1
         DO J=1,3
         DO I=1,3
         VHIGH(I,J,ISEQ)=0.D0
         ENDDO
         ENDDO
! DEFAULT VALUES FOR HIGH AND LOW SATELLITE ANTENNA VECTORS
! IF POSSIBLE VALUES WILL BE RESET IN OFFDEL
         VHIGH(1,1,ISEQ)=1.D0
         VHIGH(2,2,ISEQ)=1.D0
         VHIGH(3,3,ISEQ)=1.D0
         VLOW(1,1,ISEQ)=1.D0
         VLOW(2,2,ISEQ)=-1.D0
         VLOW(3,3,ISEQ)=-1.D0
         VISATH(ISEQ)=JSATNO(2)
         VISATL(ISEQ)=JSATNO(1)
!
         ISEQ=2
         DO J=1,3
         DO I=1,3
         VHIGH(I,J,ISEQ)=0.D0
         ENDDO
         ENDDO
! DEFAULT VALUES FOR HIGH AND LOW SATELLITE ANTENNA VECTORS
! IF POSSIBLE VALUES WILL BE RESET IN OFFDEL
         VHIGH(1,1,ISEQ)=1.D0
         VHIGH(2,2,ISEQ)=1.D0
         VHIGH(3,3,ISEQ)=1.D0
         VLOW(1,1,ISEQ)=1.D0
         VLOW(2,2,ISEQ)=-1.D0
         VLOW(3,3,ISEQ)=-1.D0
         VISATH(ISEQ)=JSATNO(3)
         VISATL(ISEQ)=JSATNO(1)
        RETURN
      ENDIF
!ddr mods

      IF(MTYPE2.EQ.85) THEN
!
!        IELSAT(1)=INMSAT(2)
!        IELSTA(1)=INMSTA(1)
         ISEQ=1
         DO J=1,3
         DO I=1,3
         VHIGH(I,J,ISEQ)=0.D0
         VLOW(I,J,ISEQ)=XLOCV(I,J,IELSTA(ISEQ))
         ENDDO
         ENDDO
! DEFAULT VALUES FOR HIGH SATELLITE ANTENNA VECTORS
! IF POSSIBLE VALUES WILL BE RESET IN OFFDEL
! (LOW) RECEIVER IS A STATION
         VHIGH(1,1,ISEQ)=1.D0
         VHIGH(2,2,ISEQ)=1.D0
         VHIGH(3,3,ISEQ)=1.D0
         VISATH(ISEQ)=JSATNO(2)
         VISATL(ISEQ)=-9999999
!
!        IELSAT(2)=INMSAT(3)
!        IELSTA(2)=INMSTA(1)
         ISEQ=2
         DO J=1,3
         DO I=1,3
         VHIGH(I,J,ISEQ)=0.D0
         VLOW(I,J,ISEQ)=XLOCV(I,J,IELSTA(ISEQ))
         ENDDO
         ENDDO
! DEFAULT VALUES FOR HIGH SATELLITE ANTENNA VECTORS
! IF POSSIBLE VALUES WILL BE RESET IN OFFDEL
! (LOW) RECEIVER IS A STATION
         VHIGH(1,1,ISEQ)=1.D0
         VHIGH(2,2,ISEQ)=1.D0
         VHIGH(3,3,ISEQ)=1.D0
         VISATH(ISEQ)=JSATNO(3)
         VISATL(ISEQ)=-9999999
!
!        IELSAT(3)=INMSAT(2)
!        IELSA2(3)=INMSAT(1)
         ISEQ=3
         DO J=1,3
         DO I=1,3
         VHIGH(I,J,ISEQ)=0.D0
         ENDDO
         ENDDO
! DEFAULT VALUES FOR HIGH AND LOW SATELLITE ANTENNA VECTORS
! IF POSSIBLE VALUES WILL BE RESET IN OFFDEL
         VHIGH(1,1,ISEQ)=1.D0
         VHIGH(2,2,ISEQ)=1.D0
         VHIGH(3,3,ISEQ)=1.D0
         VLOW(1,1,ISEQ)=1.D0
         VLOW(2,2,ISEQ)=-1.D0
         VLOW(3,3,ISEQ)=-1.D0
         VISATH(ISEQ)=JSATNO(2)
         VISATL(ISEQ)=JSATNO(1)
!
!        IELSAT(4)=INMSAT(3)
!        IELSA2(4)=INMSAT(1)
         ISEQ=4
         DO J=1,3
         DO I=1,3
         VHIGH(I,J,ISEQ)=0.D0
         ENDDO
         ENDDO
! DEFAULT VALUES FOR HIGH AND LOW SATELLITE ANTENNA VECTORS
! IF POSSIBLE VALUES WILL BE RESET IN OFFDEL
         VHIGH(1,1,ISEQ)=1.D0
         VHIGH(2,2,ISEQ)=1.D0
         VHIGH(3,3,ISEQ)=1.D0
         VLOW(1,1,ISEQ)=1.D0
         VLOW(2,2,ISEQ)=-1.D0
         VLOW(3,3,ISEQ)=-1.D0
         VISATH(ISEQ)=JSATNO(3)
         VISATL(ISEQ)=JSATNO(1)
        RETURN
      ENDIF
      IF(MTYPE2.EQ.87.OR.MTYPE2.EQ.41) THEN
!
!        IELSAT(1)=INMSAT(1)
!        IELSTA(1)=INMSTA(1)
         ISEQ=1
         DO J=1,3
         DO I=1,3
         VHIGH(I,J,ISEQ)=0.D0
         VLOW(I,J,ISEQ)=XLOCV(I,J,IELSTA(ISEQ))
         ENDDO
         ENDDO
! DEFAULT VALUES FOR HIGH SATELLITE ANTENNA VECTORS
! (LOW) RECEIVER IS A STATION
! IF POSSIBLE VALUES WILL BE RESET IN OFFDEL
         VHIGH(1,1,ISEQ)=1.D0
         VHIGH(2,2,ISEQ)=1.D0
         VHIGH(3,3,ISEQ)=1.D0
         VISATH(ISEQ)=JSATNO(1)
         VISATL(ISEQ)=-9999999
         IF(MTYPE2.EQ.41) RETURN
!
!        IELSAT(2)=INMSAT(2)
!        IELSTA(2)=INMSTA(1)
         ISEQ=2
         DO J=1,3
         DO I=1,3
         VHIGH(I,J,ISEQ)=0.D0
         VLOW(I,J,ISEQ)=XLOCV(I,J,IELSTA(ISEQ))
         ENDDO
         ENDDO
! DEFAULT VALUES FOR HIGH SATELLITE ANTENNA VECTORS
! (LOW) RECEIVER IS A STATION
! IF POSSIBLE VALUES WILL BE RESET IN OFFDEL
         VHIGH(1,1,ISEQ)=1.D0
         VHIGH(2,2,ISEQ)=1.D0
         VHIGH(3,3,ISEQ)=1.D0
         VISATH(ISEQ)=JSATNO(2)
         VISATL(ISEQ)=-9999999
!
!        IELSAT(3)=INMSAT(1)
!        IELSTA(3)=INMSTA(2)
         ISEQ=3
         DO J=1,3
         DO I=1,3
         VHIGH(I,J,ISEQ)=0.D0
         VLOW(I,J,ISEQ)=XLOCV(I,J,IELSTA(ISEQ))
         ENDDO
         ENDDO
! DEFAULT VALUES FOR HIGH SATELLITE ANTENNA VECTORS
! (LOW) RECEIVER IS A STATION
! IF POSSIBLE VALUES WILL BE RESET IN OFFDEL
         VHIGH(1,1,ISEQ)=1.D0
         VHIGH(2,2,ISEQ)=1.D0
         VHIGH(3,3,ISEQ)=1.D0
         VISATH(ISEQ)=JSATNO(1)
         VISATL(ISEQ)=-9999999
!
!        IELSAT(4)=INMSAT(2)
!        IELSTA(4)=INMSTA(2)
         ISEQ=4
         DO J=1,3
         DO I=1,3
         VHIGH(I,J,ISEQ)=0.D0
         VLOW(I,J,ISEQ)=XLOCV(I,J,IELSTA(ISEQ))
         ENDDO
         ENDDO
! DEFAULT VALUES FOR HIGH SATELLITE ANTENNA VECTORS
! (LOW) RECEIVER IS A STATION
! IF POSSIBLE VALUES WILL BE RESET IN OFFDEL
         VHIGH(1,1,ISEQ)=1.D0
         VHIGH(2,2,ISEQ)=1.D0
         VHIGH(3,3,ISEQ)=1.D0
         VISATH(ISEQ)=JSATNO(2)
         VISATL(ISEQ)=-9999999
        RETURN
      ENDIF
      RETURN
      END
