!$EDIST
        FUNCTION EDIST(MJDX)
      IMPLICIT DOUBLE PRECISION (A-H,O-Z),LOGICAL(L)
      SAVE
        DOUBLE PRECISION MJDX
      COMMON/CONSTR/PI,TWOPI,DEGRAD,SECRAD,SECDAY
!
! FUNCTION to CALCULATE EARTH DISTANCE IN AU GIVEN MJD
!
        T = MJDX - 15020.D0
        TJ = T/365.25D+02
        XM = 358.47583D0 +0.9856002670D0*T-1.5D-04*TJ**2-3.0D-6*TJ
        E=1.675104D-02-4.180D-5*TJ-1.26D-07*TJ**2
        XM=MOD(XM,360.0D0)*DEGRAD
        EC1=XM
        DO 600 J=1,5
        EC=XM+E*SIN(EC1)
        IF(ABS(EC-EC1).LE.1.0D-05)GOTO 700
        EC1=EC
  600   CONTINUE
  700   AU=1.0D0-E*COS(EC)
        EDIST=AU
        RETURN
      END
