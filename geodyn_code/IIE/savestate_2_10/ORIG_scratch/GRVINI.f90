!$GRVINI
      SUBROUTINE GRVINI(IGTSRT,PARMV,IPTC,IPTS,CSAVE,SSAVE,CGRVTM,      &
     &                  SGRVTM,IPTRUA,C,S)
!********1*********2*********3*********4*********5*********6*********7**
! GRVTINI          88/09/14            0000.0    PGMR - WFE/WX
!
! FUNCTION: INITIALIZES POINTERS AND ARRAYS FOR TIME DEPENDENT GRAVITY
!           AND DYNAMIC POLAR MOTION OPTIONS
!
! I/O PARAMETERS:
!
!   NAME    I/O  A/S   DESCRIPTION OF PARAMETERS
!   ------  ---  ---   ------------------------------------------------
!   IGTSRT   I    A    INDEX ARRAY FOR TIME DEPENDENT GRAVITY
!   PARMV    I    A    PARAMETERS ARRAY PASSED FROM IIS
!   IPTC     O    A    POINTER TO THE C INDEX ARRAY
!   IPTS     O    A    POINTER TO THE S INDEX ARRAY
!   CSAVE    O    A    PREVIOUS C COEFFICIENTS ARRAY
!   SSAVE    O    A    PREVIOUS S COEFFICIENTS ARRAY
!   CGRVTM   O    A    LOAD PARMV ARRAY FOR C COEF WITH ADJUSTED
!                      PARAMETERS FIRST, THEN UNADJUSTED
!                      PARAMETERS
!   SGRVTM   O    A    LOAD PARMV ARRAY FOR S COEF WITH ADJUSTED
!                      PARAMETERS FIRST, THEN UNADJUSTED
!                      PARAMETERS
!   IPTRUA   I    A    INDICES POINTING FROM UNADJUSTED PARAMETERS TO
!                      ADJUSTED PARAMETERS
!   C             A    CURRENT VALUE FOR C COEFFICIENTS
!   S             A    CURRENT VALUE FOR S COEFFICIENTS
!
! COMMENTS: IGTSRT STORED IS STORED IN THE FOLLOWING ORDER
!            Cdot,Ac,Bc,OMEGAc,Sdot,As,Bs,OMEGAs
!
!           ASSUMPTION: NUMBER OF A     = NCPD
!                       NUMBER OF B     = NCPD
!                       NUMBER OF OMEGA = NCPD
!
!*********1*********2*********3*********4*********5*********6*********7
      IMPLICIT DOUBLE PRECISION (A-H,O-Z),LOGICAL(L)
      SAVE
!
      COMMON/CLGVTM/LGVTM,LDPM,LGVTPM,LOPT,LCSDPM,L_MP_IERS2003,        &
     &              L_CS_IERS2003,L_MP_IERS2010,L_CS_IERS2010
      COMMON/CGVTMI/NCDT,NSDT,NCPD,NSPD,NCDTA,NSDTA,NCPDA,NSPDA,NGRVTM, &
     &       KCDT,KCPDA,KCPDB,KSDT,KSPDA,KSPDB,KOMGC,KOMGS,KCOMGC,      &
     &       KSOMGC,KCOMGS,KSOMGS,NXGVTI
      COMMON/CORA01/KFSEC0,KFSECB,KFSEC ,KFSECV,KH    ,KHV   ,KCTOL ,   &
     &              KRSQ  ,KVMATX,KCPP  ,KCPV  ,KCCP  ,KCCV  ,KCCPV ,   &
     &              KCCVV ,KXPPPP,KX    ,KPX   ,KSUMX ,KXDDOT,KSUMPX,   &
     &              KPXDDT,KAB   ,KPN   ,KAORN ,KSINLM,KCOSLM,KTANPS,   &
     &              KCRPAR,KVRARY,KXM   ,KXNP1 ,KXPRFL,KXM2  ,KXNNP1,   &
     &              KWRK  ,KFI   ,KGE   ,KB0DRG,KBDRAG,KAPGM ,KAPLM ,   &
     &              KCN   ,KSN   ,KSTID ,KTIDE ,KSTDRG,KSTSRD,KSTACC,   &
     &              KLGRAV,KGM   ,KAE   ,KFPL  ,KFEQ  ,KPLNPO,KPLNVL,   &
     &              KXEPOC,KCD   ,KCDDOT,KCR   ,KGENAC,KACN  ,KASN  ,   &
     &              KTHDRG,KCKEP ,KCKEPN,KXNRMZ,KXNRMC,KFSCEP,KFSCND,   &
     &              KAREA ,KXMASS,KRMSPO,KTCOEF,KTXQQ ,KTIEXP,KTXMM ,   &
     &              KTXLL1,KTXSN1,KTS2QQ,KT2M2H,KT2MHJ,KTXKK ,KTSCRH,   &
     &              KPXPK ,KAESHD,KCSAVE,KSSAVE,KCGRVT,KSGRVT,KXDTMC,   &
     &              KDNLT ,KTXSN2,KTNORM,KTWRK1,KTWRK2,KUNORM,KAERLG,   &
     &              KSINCO,KPARLG,KCONST,KBFNRM,KTDNRM,KCSTHT,KTPSTR,   &
     &              KTPSTP,KTPFYW,KPLMGM,KTPXAT,KEAQAT,KEAFSS,KEAINS,   &
     &              KACS  ,KECS  ,KSOLNA,KSOLNE,KSVECT,KSFLUX,KFACTX,   &
     &              KFACTY,KADIST,KGEOAN,KPALB ,KALBCO,KEMMCO,KCNAUX,   &
     &              KSNAUX,KPPER ,KACOSW,KBSINW,KACOFW,KBCOFW,KANGWT,   &
     &              KWT   ,KPLNDX,KPLANC,KTGACC,KTGDRG,KTGSLR,KWTACC,   &
     &              KWTDRG,KWTSLR,KTMACC,KTMDRG,KTMSLR,KATTUD,KDYACT,   &
     &              KACCBT,KACPER,KXDDNC,KXDDAO,KXNC  ,KXPPNC,KSMXNC,   &
     &              KXDDTH,KPDDTH,KXSSBS,KCPPNC,KEXACT,KXACIN,KXACOB,   &
     &              KPXHDT,KTPXTH,KPACCL,KTXSTA,KDELXS,KSMRNC,KPRX  ,   &
     &              KSMRNP,KDSROT,KXUGRD,KYUGRD,KZUGRD,KSUMRC,KXDDRC,   &
     &              KTMOS0,KTMOS, KTMOSP,KSMXOS,KSGTM1,KSGTM2,KSMPNS,   &
     &              KXGGRD,KYGGRD,KZGGRD,KXEGRD,KYEGRD,KZEGRD,KSSDST,   &
     &              KSDINS,KSDIND,KSSDSR,KSSDDG,KTATHM,KTAINS,KTAFSS,   &
     &              KSRAT ,KTRAT ,KHLDV ,KHLDA1,KHLDA4,KHLDA7,KQAST1,   &
     &              KQAST2,KQAST3,KQAST4,KQAST5,KQAST6,NXCA01
      COMMON/DYNPOL/DPMEP ,DPMXP ,DPMYP ,DPMXDT,DPMYDT,DPMOPT,DPMXPC,   &
     &              DPMYPC,DPMKF ,DPMC21,DPMS21,DPMPD ,DPMUDK,DPMVDK,   &
     &              DPMOCP,DPMNLD,DPMERS,XDYNPL
      COMMON/NPCOM /NPNAME,NPVAL(92),NPVAL0(92),IPVAL(92),IPVAL0(92),   &
     &              MPVAL(28),MPVAL0(28),NXNPCM
      COMMON/NPCOMX/IXARC ,IXSATP,IXDRAG,IXSLRD,IXACCL,IXGPCA,IXGPSA,   &
     &              IXAREA,IXSPRF,IXDFRF,IXEMIS,IXTMPA,IXTMPC,IXTIMD,   &
     &              IXTIMF,IXTHTX,IXTHDR,IXOFFS,IXBISA,IXFAGM,IXFAFM,   &
     &              IXATUD,IXRSEP,IXACCB,IXDXYZ,IXGPSBW,IXCAME,IXBURN,  &
     &              IXGLBL,IXGPC ,IXGPS, IXTGPC,IXTGPS,IXGPCT,IXGPST,   &
     &              IXTIDE,IXETDE,IXOTDE,IXOTPC,IXOTPS,IXLOCG,IXKF  ,   &
     &              IXGM  ,IXSMA ,IXFLTP,IXFLTE,IXPLTP,IXPLTV,IXPMGM,   &
     &              IXPMJ2,IXVLIT,IXEPHC,IXEPHT,IXH2LV,IXL2LV,IXOLOD,   &
     &              IXPOLX,IXPOLY,IXUT1 ,IXPXDT,IXPYDT,IXUTDT,IXVLBI,   &
     &              IXVLBV,IXXTRO,IXBISG,IXSSTF,IXFGGM,IXFGFM,IXLNTM,   &
     &              IXLNTA,IX2CCO,IX2SCO,IX2GM ,IX2BDA,IXRELP,IXJ2SN,   &
     &              IXGMSN,IXPLNF,IXPSRF,IXANTD,IXTARG,                 &
     &              IXSTAP,IXSSTC,IXSSTS,IXSTAV,IXSTL2,                 &
     &              IXSTH2,IXDPSI,IXEPST,IXCOFF,IXTOTL,NXNPCX
!
      DIMENSION IGTSRT(1),PARMV(1),IPTC(1),IPTS(1),CSAVE(1),SSAVE(1)
      DIMENSION CGRVTM(1),SGRVTM(1)
      DIMENSION IPTRUA(1),C(1),S(1)
!
!**********************************************************************
! START OF EXECUTABLE CODE ********************************************
!**********************************************************************
!
      IF(.NOT. LGVTM) GOTO 3000
!
! CALCULATE POINTERS FOR CDT,CPDA,CPDB,OMGPC,COSOMC,SINOMC,SDT,SPDA,
!              SPDB,OMGPS,COSOMS,SINOMS
!
      KCDT=KCGRVT
      KCPDA=KCDT+NCDT
      KCPDB=KCPDA+NCPD
      KOMGC=KCPDB+NCPD
      KCOMGC=KOMGC+NCPD
      KSOMGC=KCOMGC+NCPD
      KSDT=KSGRVT
      KSPDA=KSDT+NSDT
      KSPDB=KSPDA+NSPD
      KOMGS=KSPDB+NSPD
      KCOMGS=KOMGS+NSPD
      KSOMGS=KCOMGS+NSPD
!
! FORM IPTC AND CSAVE ARRAY; LOAD PARVM ARRAY TO CGRVTM ARRAY WITH
!     ADJUSTED PARAMETERS FOLLOWED BY ADJUSTED PARAMETERS
!
      IF(NPVAL(IXGPCT).EQ.0) GOTO 1900
!
! FOR C COEF: DOT TERM
!
      IADJ=0
      IUNADJ=IADJ+NCDTA
      IND=IPVAL(IXGPCT)-1
      ICINDX=IPVAL(IXGPC)-1
      IF(NCDT.EQ.0) GOTO 1150
      DO 1100 I=1,NCDT
         IND=IND+1
         ICS =IGTSRT(I)/100000000
         ITYPE=(IGTSRT(I)-ICS*100000000)/10000000
         IDEG =(IGTSRT(I)-ICS*100000000-ITYPE*10000000)/10000
         IORD=IGTSRT(I)-ICS*100000000-ITYPE*10000000-IDEG*10000
         IORD=IORD/10
         NM=(IDEG-1)*IDEG/2+3*(IDEG-1)+IORD+1
         IF(IPTRUA(IND).EQ.0) GOTO 1000
         IADJ=IADJ+1
         CGRVTM(IADJ)=PARMV(IND)
         IPTC(IADJ)=NM
         CSAVE(IADJ)=PARMV(ICINDX+NM)
         GOTO 1100
 1000    IUNADJ=IUNADJ+1
         CGRVTM(IUNADJ)=PARMV(IND)
         IPTC(IUNADJ)=NM
         CSAVE(IUNADJ)=PARMV(ICINDX+NM)
 1100 END DO
 1150 CONTINUE
!
! FOR C COEF: PERIODIC TERM A
!
      IADJ=NCDT
      IUNADJ=IADJ+NCPDA
      IF(NCPD.EQ.0) GOTO 1900
      DO 1300 I=NCDT+1,NCDT+NCPD
         IND=IND+1
         ICS =IGTSRT(I)/100000000
         ITYPE=(IGTSRT(I)-ICS*100000000)/10000000
         IDEG =(IGTSRT(I)-ICS*100000000-ITYPE*10000000)/10000
         IORD=IGTSRT(I)-ICS*100000000-ITYPE*10000000-IDEG*10000
         IORD=IORD/10
         NM=(IDEG-1)*IDEG/2+3*(IDEG-1)+IORD+1
         IF(IPTRUA(IND).EQ.0) GOTO 1200
         IADJ=IADJ+1
         CGRVTM(IADJ)=PARMV(IND)
         IPTC(IADJ)=NM
         CSAVE(IADJ)=PARMV(ICINDX+NM)
         GOTO 1300
 1200    IUNADJ=IUNADJ+1
         CGRVTM(IUNADJ)=PARMV(IND)
         IPTC(IUNADJ)=NM
         CSAVE(IUNADJ)=PARMV(ICINDX+NM)
 1300 END DO
!
! FOR C COEF: PERIODIC TERM B
!
      IADJ=NCDT+NCPD
      IUNADJ=IADJ+NCPDA
      DO 1500 I=NCDT+NCPD+1,NCDT+NCPD*2
         IND=IND+1
         ICS =IGTSRT(I)/100000000
         ITYPE=(IGTSRT(I)-ICS*100000000)/10000000
         IDEG =(IGTSRT(I)-ICS*100000000-ITYPE*10000000)/10000
         IORD=IGTSRT(I)-ICS*100000000-ITYPE*10000000-IDEG*10000
         IORD=IORD/10
         NM=(IDEG-1)*IDEG/2+3*(IDEG-1)+IORD+1
         IF(IPTRUA(IND).EQ.0) GOTO 1400
         IADJ=IADJ+1
         CGRVTM(IADJ)=PARMV(IND)
         GOTO 1500
 1400    IUNADJ=IUNADJ+1
         CGRVTM(IUNADJ)=PARMV(IND)
 1500 END DO
!
! FOR C COEF: PERIODIC TERM FREQ
!
      DO 1600 I=NCDT+NCPD*2+1,NCDT+NCPD*3
         ICS =IGTSRT(I)/100000000
         ITYPE=(IGTSRT(I)-ICS*100000000)/10000000
         IDEG =(IGTSRT(I)-ICS*100000000-ITYPE*10000000)/10000
         IORD=IGTSRT(I)-ICS*100000000-ITYPE*10000000-IDEG*10000
         IORD=IORD/10
!        ICS =IGTSRT(I)/10000000
!        ITYPE=(IGTSRT(I)-ICS*10000000)/1000000
!        IDEG =(IGTSRT(I)-ICS*10000000-ITYPE*1000000)/1000
!        IORD=IGTSRT(I)-ICS*10000000-ITYPE*1000000-IDEG*1000
         NM=(IDEG-1)*IDEG/2+3*(IDEG-1)+IORD+1
         IND=IND+1
         IUNADJ=IUNADJ+1
         CGRVTM(IUNADJ)=PARMV(IND)
 1600 END DO
 1900 IF(NPVAL(IXGPST).EQ.0) GOTO 3000
!
! FORM IPTS AND SSAVE ARRAY; LOAD PARVM ARRAY TO SGRVTM ARRAY WITH
!      ADJUSTED PARAMETERS FOLLOWED BY UNADJUSTED PARAMETERS
!
! FOR S COEF: DOT TERM
!
      IADJ=0
      IUNADJ=IADJ+NSDTA
      ISINDX=IPVAL(IXGPS)-1
      IF(NSDT.EQ.0) GOTO 2150
      DO 2100 I=NPVAL(IXGPCT)+1,NPVAL(IXGPCT)+NSDT
         IND=IND+1
         ICS =IGTSRT(I)/100000000
         ITYPE=(IGTSRT(I)-ICS*100000000)/10000000
         IDEG =(IGTSRT(I)-ICS*100000000-ITYPE*10000000)/10000
         IORD=IGTSRT(I)-ICS*100000000-ITYPE*10000000-IDEG*10000
         IORD=IORD/10
         NM=(IDEG-1)*IDEG/2+3*(IDEG-1)+IORD+1
         IF(IPTRUA(IND).EQ.0) GOTO 2000
         IADJ=IADJ+1
         SGRVTM(IADJ)=PARMV(IND)
         IPTS(IADJ)=NM
         SSAVE(IADJ)=PARMV(ISINDX+NM)
         GOTO 2100
 2000    IUNADJ=IUNADJ+1
         SGRVTM(IUNADJ)=PARMV(IND)
         IPTS(IUNADJ)=NM
         SSAVE(IUNADJ)=PARMV(ISINDX+NM)
 2100 END DO
 2150 CONTINUE
!
! S COEF: PERIODIC TERM A
!
      IADJ=NSDT
      IUNADJ=IADJ+NSPDA
      IBEG= NPVAL(IXGPCT)+NSDT+1
      IEND= NPVAL(IXGPCT)+NSDT+NSPD
      IF(NSPD.EQ.0) GOTO 3000
      DO 2300 I=NPVAL(IXGPCT)+NSDT+1,NPVAL(IXGPCT)+NSDT+NSPD
         IND=IND+1
         ICS =IGTSRT(I)/100000000
         ITYPE=(IGTSRT(I)-ICS*100000000)/10000000
         IDEG =(IGTSRT(I)-ICS*100000000-ITYPE*10000000)/10000
         IORD=IGTSRT(I)-ICS*100000000-ITYPE*10000000-IDEG*10000
         IORD=IORD/10
         NM=(IDEG-1)*IDEG/2+3*(IDEG-1)+IORD+1
         IF(IPTRUA(IND).EQ.0) GOTO 2200
         IADJ=IADJ+1
         SGRVTM(IADJ)=PARMV(IND)
         IPTS(IADJ)=NM
         SSAVE(IADJ)=PARMV(ISINDX+NM)
         GOTO 2300
 2200    IUNADJ=IUNADJ+1
         SGRVTM(IUNADJ)=PARMV(IND)
         IPTS(IUNADJ)=NM
         SSAVE(IUNADJ)=PARMV(ISINDX+NM)
 2300 END DO
!
! FOR S COEF: PERIODIC TERM B
!
      IADJ=NSDT+NSPD
      IUNADJ=IADJ+NSPDA
      IBEG= NPVAL(IXGPCT)+NSDT+NSPD+1
      IEND= NPVAL(IXGPCT)+NSDT+NSPD*2
      DO 2500 I=IBEG,IEND
         IND=IND+1
         ICS =IGTSRT(I)/100000000
         ITYPE=(IGTSRT(I)-ICS*100000000)/10000000
         IDEG =(IGTSRT(I)-ICS*100000000-ITYPE*10000000)/10000
         IORD=IGTSRT(I)-ICS*100000000-ITYPE*10000000-IDEG*10000
         IORD=IORD/10
         NM=(IDEG-1)*IDEG/2+3*(IDEG-1)+IORD+1
         IF(IPTRUA(IND).EQ.0) GOTO 2400
         IADJ=IADJ+1
         SGRVTM(IADJ)=PARMV(IND)
         GOTO 2500
 2400    IUNADJ=IUNADJ+1
         SGRVTM(IUNADJ)=PARMV(IND)
 2500 END DO
!
! FOR S COEF: PERIODIC TERM FREQ
!
      IBEG= NPVAL(IXGPCT)+NSDT+NSPD*2+1
      IEND= NPVAL(IXGPCT)+NSDT+NSPD*3
      DO 2600 I=IBEG,IEND
         ICS =IGTSRT(I)/100000000
         ITYPE=(IGTSRT(I)-ICS*100000000)/10000000
         IDEG =(IGTSRT(I)-ICS*100000000-ITYPE*10000000)/10000
         IORD=IGTSRT(I)-ICS*100000000-ITYPE*10000000-IDEG*10000
         IORD=IORD/10
         NM=(IDEG-1)*IDEG/2+3*(IDEG-1)+IORD+1
         IND=IND+1
         IUNADJ=IUNADJ+1
         SGRVTM(IUNADJ)=PARMV(IND)
 2600 END DO
!
 3000 CONTINUE
!
      IF(.NOT. LDPM) GO TO 4000
!
! Initialize values for dynamic polar motion
!
! Figure axis scale factor
      DPMKF=PARMV(IPVAL(IXKF))
! Save initial value of C21 at start of this global iteration
      DPMC21=PARMV(IPVAL(IXGPC)+5)
! Save initial VALUE OF S21 AT START OF THIS GLOBAL ITERATION
      DPMS21=PARMV(IPVAL(IXGPS)+5)
 4000 CONTINUE
      RETURN
      END
