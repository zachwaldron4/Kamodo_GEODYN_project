!$OBSDR2
      SUBROUTINE OBSDR2(AA,II,LL,NDIR,IDWPT,LEOF)
!********1*********2*********3*********4*********5*********6*********7**
! OBSDR2           00/00/00            0000.0    PGMR - ROWLANDS
!
! FUNCTION: LOAD ARC OBSERVATION DIRECTORY INFORMATION FROM
!           DYNAMIC MEMORY TO COMMON COBDIR
!
! I/O PARAMETERS:
!
!   NAME    I/O  A/S   DESCRIPTION OF PARAMETERS
!   ------  ---  ---   ------------------------------------------------
!   AA      I/O   A    REAL DYNAMIC ARRAY
!   II      I/O   A    INTEGER DYNAMIC ARRAY
!   LL      I/O   A    LOGICAL DYNAMIC ARRAY
!   NDIR    I     S    TOTAL # OF DIRECTORY RECORDS
!   IDWT    I     A    POINTER ARRAY TO GET THE DIRECTORY RECORDS IN TIME
!                      ORDER
!   LEOF     I    S    LOGICAL FLAG SET TRUE WHEN LAST DIRECTORY
!                      RECORD FOR AN ARC HAS BEEN EXCEEDED
!
! COMMENTS:  OBSERVATION DIRECTORY RECORDS ARE STORED IN VIRTUAL
!            MEMORY BY SUBROUTINE IFRTDD. THE FIRST DIRECTORY
!            RECORD FOR EACH ARC IS A DUMMY RECORD ADDED BY IIS
!            CONTAINING THE NUMBER OF RECORDS FOR THAT ARC.
!
!            THIS ROUTINE IS BASES ON ROUTINE OBSDIR. OBSDIR
!            ASSUMES DIRECTORY RECORDS ARE IN TIME ODER. THIS
!            ROUTINE DOES NOT.
!
!********1*********2*********3*********4*********5*********6*********7**
      IMPLICIT DOUBLE PRECISION (A-H,O-Z),LOGICAL(L)
      SAVE
!
      COMMON/CITER /NINNER,NARC,NGLOBL
      COMMON/COBDIR/DWORD(100),CDIREC,TDIREC
      COMMON/DYNPTR/KDEPHM,KDEPH2,KDAHDR(3,9),KDYNAP(3,9,2),KDNEXT(3),  &
     &NXDYNP
!
      DIMENSION AA(1),II(1),LL(1)
      DIMENSION IDWPT(NDIR)
!
      DATA ONE/1.0D0/,ZERO/0.0D0/
!
!**********************************************************************
! START OF EXECUTABLE CODE ********************************************
!**********************************************************************
!
! SET LENGTH OF DIRECTORY RECORDS FROM INFORMATION READ IN IFRTDD
      IDIRL=II(KDAHDR(1,9)+1)
! CALCULATE WHERE DIRECTORY INFORMATION IS STORED FOR THIS ARC
      IPTR=KDYNAP(1,9,1)+(NARC-1)*KDYNAP(1,9,2)
! SET TDIREC=NO. OF DIRECTORY RECORDS FOR THIS ARC
      IF(CDIREC.EQ.ZERO) TDIREC=AA(IPTR)
! TEST IF REQUESTED DIRECTORY RECORD EXCEEDS TDIREC
      CDIREC=CDIREC+ONE
!     PRINT 90100,KDAHDR(1,9),IDIRL,IPTR,TDIREC,CDIREC
!0100 FORMAT(1X,'OBSDIR-KDAHDR,IDIRL,IPTR,TDIREC,CDIREC',3I6,2F7.2)
      IF(CDIREC.GT.TDIREC) GO TO 1000
      JDIREC=CDIREC
      IDIREC=IDWPT(JDIREC)
      IPTR=IPTR+IDIRL*IDIREC-1
! LOAD DIRECTORY INFORMATION FROM DYNAMIC MEMORY TO COMMON COBDIR
      LEOF=.FALSE.
      DO 200 J=1,IDIRL
      DWORD(J)=AA(IPTR+J)
  200 END DO
!     PRINT 90120,DWORD
!0120 FORMAT(1X,'OBSDIR-DWORD'/(1X,5D22.14))
      RETURN
! RESET CURRENT DIRECTORY NUMBER TO ZERO
 1000 CONTINUE
      CDIREC=0.D0
      LEOF=.TRUE.
      RETURN
      END
