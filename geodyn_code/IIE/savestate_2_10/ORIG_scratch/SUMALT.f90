!$SUMALT
      SUBROUTINE SUMALT(AA,NM)
!********1*********2*********3*********4*********5*********6*********7**
! SUMALT           00/00/00            0000.0    PGMR - ?
!
!
! FUNCTION:
!
! I/O PARAMETERS:
!
!   NAME    I/O  A/S   DESCRIPTION OF PARAMETERS
!   ------  ---  ---   ------------------------------------------------
!   AA      I/O   A
!   NM
!
!
! COMMENTS:
!
!
!********1*********2*********3*********4*********5*********6*********7**
      IMPLICIT DOUBLE PRECISION (A-H,O-Z),LOGICAL(L)
      SAVE
      COMMON/CBLOKL/LIGHT ,LNRATE,LNREFR,LPOLAD,LTDRIV,LNANT ,LNTRAK,   &
     &       LASER ,LGPART,LGEOID,LETIDE,LOTIDE,LNTIME,LAVGRR,LRANGE,   &
     &       LSSTMD,LSSTAJ,LNTDRS,LPSBL,LACC,LAPP,LTARG,LTIEOU,LEOTRM,  &
     &       LSURFM,LGEOI2,LSSTM2,LOTID2,LOTRM2,LETID2,LNUTAD
! /COBBUF/ OBSERVATION BLOCK POINTERS
      COMMON/COBBUF/IOBSBF,IBUF1 ,IBUF2 ,IWORD1,NHEADR,NWORDM
! /COBLOC/ OBSERVATION BLOCK DYNAMIC ARRAY POINTERS
!          STATION INFORMATION POINTERS TO COORDINATE SYSTEM ARRAYS
      COMMON/COBLOC/KXMN  (3,4)  ,KENVN (3,4)  ,KSTINF(3,4)  ,          &
     &       KOBS  ,KDTIME,KSMCOR,KSMCR2,KTMCOR,KOBTIM,KOBSIG,KOBSG2,   &
     &       KIAUNO,KOBCOR(9,7)  ,KFSECS(6,8)  ,KOBSUM(8)    ,          &
     &       KEDSIG,KEDSG2
      COMMON/CPRESW/LPRE9 (24),LPRE  (24,3),LSWTCH(10,8),LOBSIN,LPREPW, &
     &              LFS   (40)
      DIMENSION AA(1)
!
!***********************************************************************
! START OF EXECUTABLE CODE *********************************************
!***********************************************************************
!
      N1=KSMCOR
      N2=N1+NM-1
      M1=KSMCR2
      M2=M1+NM-1
      DO 9000 IHEADR=2,NHEADR
!     PRINT 11111,(AA(N),N=N1,N2)
      JHEADR=IHEADR-1
! SUM COMPUTED OBSERVATION CORRECTIONS
      DO 6000 IWORD =2,8
      IF(LPRE  (IWORD ,JHEADR)) GO TO 6000
      IF(IWORD.EQ.5) GO TO 6000
      JWORD=IWORD
      IF(IWORD.EQ.4.AND.LPRE(IWORD+1,JHEADR)) JWORD=JWORD+1
      IF(.NOT.LSWTCH(JWORD ,IHEADR)) GO TO 6000
      JOBCOR=KOBCOR(JWORD ,JHEADR)
!     J2=JOBCOR+NM-1
!     PRINT 22222,IWORD,IHEADR,(AA(J),J=JOBCOR,J2)
      DO 5000 N=N1,N2
      AA(N     )   =AA(N     )   +AA(JOBCOR)
      JOBCOR=JOBCOR+1
 5000 END DO
 6000 END DO
!     PRINT 33333,(AA(M),M=M1,M2)
      KHEADR=IHEADR+2
      MHEADR=IHEADR+3
! SUM COMPUTED OCEAN PARAMETERS
      DO 8000 IWORD =10,14
      IF(JHEADR.NE.1) GO TO 6100
      IF(IWORD.EQ.11.AND.LETIDE) GO TO 6200
      IF(IWORD.EQ.12.AND.LOTIDE) GO TO 6200
      IF(IWORD.EQ.14.AND.LSSTMD) GO TO 6200
 6100 CONTINUE
      IF(LPRE  (IWORD ,JHEADR)) GO TO 8000
 6200 CONTINUE
      IF(IWORD.EQ.13) GO TO 8000
      JWORD=IWORD-9
      IF(IWORD.EQ.12.AND.LPRE(IWORD+1,JHEADR)) JWORD=JWORD+1
! ASK TVM
      IF(IWORD.EQ.11.AND.LETIDE) GO TO 6300
      IF(IWORD.EQ.12.AND.LOTIDE) GO TO 6300
      IF(IWORD.EQ.14.AND.LSSTMD) GO TO 6300
      IF(.NOT.LSWTCH(JWORD ,MHEADR)) GO TO 8000
 6300 CONTINUE
! ASK TVM
      JOBCOR=KOBCOR(JWORD ,KHEADR)
!     J2=JOBCOR+NM-1
!     PRINT 22222,IWORD,IHEADR,(AA(J),J=JOBCOR,J2)
      DO 7000 M=M1,M2
      AA(M     )   =AA(M     )   +AA(JOBCOR)
      JOBCOR=JOBCOR+1
 7000 END DO
 8000 END DO
 9000 END DO
!     PRINT 11111,(AA(N),N=N1,N2)
!     PRINT 33333,(AA(M),M=M1,M2)
      RETURN
!11111 FORMAT(' ** SUMALT **  SUMCOR ='/(1X,6D12.5))
!22222 FORMAT(' ** SUMALT **  IWORD,IHEADR =',2I12,5X,'OBSCOR(N,I,J) ='/
!    1   (1X,6D12.5))
!33333 FORMAT(' ** SUMALT **  SUMCR2 ='/(1X,6D12.5))
      END
