!$GETROT
      SUBROUTINE GETROT(INDX,ROT,ROLL,PITCH,YAW)
!*******************************************************************
!  ROUTINE NAME:   GETROT   DATE: 11/25/97      PGMR: D. Pavlis
!                                 06/22/98      PGMR: J. McCarthy
!
!   FUNCTION - TO COMPUTE ROTATION  MATRIX FOR ROLL PITCH AND YAW
!              FOLLOWING A SPECIFIC ROTATION SEQUENCE
!
!  I/O PARAMETERS:
!
!   NAME    A/S    I/O   DESCRIPTION OF I/O PARAMETERS IN ARGUMENT LIST
!   -----  ------ -----  -----------------------------------------------
!   INDX     I      S    INDEX TO THE ROTATION SEQUENCE
!   ROT      O      A    3X3 ROTATION MATRIX
!   ROLL     I      S    ANGLE IN RAD
!   PITCH    I      S    ANGLE IN RAD
!   YAW      I      S    ANGLE IN RAD
!*******************************************************************
      IMPLICIT DOUBLE PRECISION (A-H,O-Z),LOGICAL(L)
      SAVE
!
      DIMENSION ROT(3,3),JSEQ(6)
!
      DATA JSEQ/123,132,213,231,312,321/
!
!**********************************************************************
!* START OF EXECUTABLE CODE *******************************************
!**********************************************************************
!      write(6,*)' dbg ROLL PITCH YAW ',ROLL,PITCH,YAW,INDX
!      write(6,*)' dbg GET SEQUENCE ',JSEQ(INDX)
      SINROL=SIN(ROLL)
      COSROL=COS(ROLL)
      SINPIT=SIN(PITCH)
      COSPIT=COS(PITCH)
      SINYAW=SIN(YAW)
      COSYAW=COS(YAW)
      GOTO(10,20,30,40,50,60) INDX
!DEP
   10 CONTINUE
      ROT(1,1) =  COSPIT*COSYAW
      ROT(1,2) = +SINROL*SINPIT*COSYAW + COSROL*SINYAW
      ROT(1,3) = -SINPIT*COSROL*COSYAW + SINROL*SINYAW
      ROT(2,1) = -COSPIT*SINYAW
      ROT(2,2) = -SINROL*SINPIT*SINYAW + COSROL*COSYAW
      ROT(2,3) = +SINPIT*COSROL*SINYAW + COSYAW*SINROL
      ROT(3,1) =  SINPIT
      ROT(3,2) = -SINROL*COSPIT
      ROT(3,3) =  COSROL*COSPIT
!     write(6,*)ROT(1,1),ROT(2,1),ROT(3,1)
!     write(6,*)ROT(1,2),ROT(2,2),ROT(3,2)
!     write(6,*)ROT(1,3),ROT(2,3),ROT(3,3)
      RETURN
   20 CONTINUE
      ROT(1,1) =  COSYAW*COSPIT
      ROT(1,2) = +COSROL*SINYAW*COSPIT + SINROL*SINPIT
      ROT(1,3) =  SINROL*SINYAW*COSPIT - SINPIT*COSROL
      ROT(2,1) = -SINYAW
      ROT(2,2) =  COSROL*COSYAW
      ROT(2,3) = +SINROL*COSYAW
      ROT(3,1) =  COSYAW*SINPIT
      ROT(3,2) = +COSROL*SINYAW*SINPIT - COSPIT*SINROL
      ROT(3,3) =  SINROL*SINYAW*SINPIT + COSPIT*COSROL
      RETURN
   30 CONTINUE
      ROT(1,1) =  COSPIT*COSYAW + SINPIT*SINROL*SINYAW
      ROT(1,2) = +COSROL*SINYAW
      ROT(1,3) = -SINPIT*COSYAW + COSPIT*SINROL*SINYAW
      ROT(2,1) = -COSPIT*SINYAW + SINPIT*SINROL*COSYAW
      ROT(2,2) =  COSYAW*COSROL
      ROT(2,3) = +SINPIT*SINYAW + COSPIT*SINROL*COSYAW
      ROT(3,1) =  SINPIT*COSROL
      ROT(3,2) = -SINROL
      ROT(3,3) =  COSPIT*COSROL
      RETURN
   40 CONTINUE
      ROT(1,1) =  COSPIT*COSYAW
      ROT(1,2) = +SINYAW
      ROT(1,3) = -SINPIT*COSYAW
      ROT(2,1) = -COSPIT*SINYAW*COSROL + SINPIT*SINROL
      ROT(2,2) =  COSYAW*COSROL
      ROT(2,3) = +SINPIT*SINYAW*COSROL + COSPIT*SINROL
      ROT(3,1) =  COSPIT*SINYAW*SINROL + SINPIT*COSROL
      ROT(3,2) = -COSYAW*SINROL
      ROT(3,3) = -SINPIT*SINYAW*SINROL + COSPIT*COSROL
      RETURN
   50 CONTINUE
      ROT(1,1) =  COSYAW*COSPIT - SINYAW*SINROL*SINPIT
      ROT(1,2) = +SINYAW*COSPIT + COSYAW*SINROL*SINPIT
      ROT(1,3) = -COSROL*SINPIT
      ROT(2,1) = -SINYAW*COSROL
      ROT(2,2) =  COSYAW*COSROL
      ROT(2,3) = +SINROL
      ROT(3,1) =  COSYAW*SINPIT + SINYAW*SINROL*COSPIT
      ROT(3,2) = +SINYAW*SINPIT - COSYAW*SINROL*COSPIT
      ROT(3,3) =  COSROL*COSPIT
      RETURN
   60 CONTINUE
      ROT(1,1) =  COSYAW*COSPIT
      ROT(1,2) = +SINYAW*COSPIT
      ROT(1,3) = -SINPIT
      ROT(2,1) = -SINYAW*COSROL + COSYAW*SINPIT*SINROL
      ROT(2,2) =  COSYAW*COSROL + SINYAW*SINPIT*SINROL
      ROT(2,3) = +COSPIT*SINROL
      ROT(3,1) =  SINYAW*SINROL + COSYAW*SINPIT*COSROL
      ROT(3,2) = -COSYAW*SINROL + SINYAW*SINPIT*COSROL
      ROT(3,3) =  COSPIT*COSROL
      RETURN
      END
