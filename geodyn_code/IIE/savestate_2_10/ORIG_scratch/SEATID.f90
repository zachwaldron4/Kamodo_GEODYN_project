!$SEATID
      SUBROUTINE SEATID(NM,SATLAT,SATLON,COSLAT,SINLAT,COSLAM,SINLAM,   &
     &                  OTIDES,MJDSEC,FSEC,THETAG)
!********1*********2*********3*********4*********5*********6*********7**
! SEATID           00/00/00            0000.0    PGMR - ?
!
!
! FUNCTION:  GEOMETRIC OCEANTIDE MODELING ROUTINE
!
! I/O PARAMETERS:
!
!   NAME    I/O  A/S   DESCRIPTION OF PARAMETERS
!   ------  ---  ---   ------------------------------------------------
!   NM       I    S    NUMBER OF MEASUREMENTS IN THIS LOGICAL BLOCK
!   SATLAT   I    A    SATELLITE GEODETIC LATIDUDES
!   SATLON   I    A    SATELLITE GEODETIC LONGITUDES
!   COSLAT   I    A    COSINE OF GEOCENTRIC LATITUDES
!   SINLAT   I    A    SINE OF GEOCENTRIC LONGITUDES
!   COSLAM   I    A    COSINE (M*SATLON)
!   SINLAM   I    A    SINE (M*SATLON)
!   OTIDES   O    A    OCEAN TIDE HEIGHTS
!   MJDSEC   I    S    INTEGER EPHEMERIS SECONDS SINCE GEODYN REF. TIME
!   FSEC     I    A    FRACTIONAL REMAINING SECONDS
!   THETAG   I    A    GRENWICH HOUR ANGLE
!
!
! COMMENTS:
!
!
!********1*********2*********3*********4*********5*********6*********7**
      IMPLICIT DOUBLE PRECISION (A-H,O-Z),LOGICAL(L)
      SAVE
      DIMENSION SATLAT(NM),SATLON(NM),COSLAT(NM),SINLAT(NM),            &
     &          COSLAM(NM),SINLAM(NM),OTIDES(NM),FSEC(NM),THETAG(NM)
      DIMENSION PP(12),P(10,9),COSMLA(10),SINMLA(10)
      DIMENSION A(10,10),C(10,9)
      COMMON/CONSTR/PI,TWOPI,DEGRAD,SECRAD,SECDAY
      COMMON/DTMGDN/TGTYMD,TMGDN1,TMGDN2,REPDIF,XTMGN
      COMMON/TIDDEG/NMAXT
      COMMON/TIDECO/TDA0(10),TDA1(10),TDA2(10),TDA3(10),TDA4(10),       &
     &  TDA5(10),TDA6(10),TDA7(10),TDA8(10),TDA9(10),TDC0(10),TDC1(10), &
     &  TDC2(10),TDC3(10),TDC4(10),TDC5(10),TDC6(10),TDC7(10),TDC8(10), &
     &  TDC9(10),TIDDUM
      EQUIVALENCE (PP(12),P(1,1))
      EQUIVALENCE (A(1,1),TDA1(2))
      EQUIVALENCE (C(1,1),TDC1(2))
!
      DATA LNOAAS/.FALSE./
!
      DATA ZERO/0.D0/,ONE/1.D0/,TWO/2.D0/
      DATA XLON1/282.5210373D0/,XLON2/297.0057541D0/
      DATA XLAT1/ 27.5D0/,XLAT2/35.0D0/
      DATA DYS/14980.5D0/,DSECNV/.1157407407407407D-4/
!     DATA DY1/14980.5/
      DATA A0/.4719966571678319D+01/,A1/.2299715029410053D+00/,         &
     &     A2/.1483529864195180D-13/,A3/.6806784082777884D-21/
          DATA IZERO/0/,NMAXD/9/
!
!***********************************************************************
! START OF EXECUTABLE CODE *********************************************
!***********************************************************************
!
      DO 500 IIII=1,NM
      OTIDES(IIII)=ZERO
      IF(.NOT.LNOAAS) GO TO 1234
      L2LON=SATLON(IIII).GT.XLON1.AND.SATLON(IIII).LT.XLON2
      L2LAT=SATLAT(IIII).GT.XLAT1.AND.SATLAT(IIII).LT.XLAT2
      IF(L2LON.AND.L2LAT) GO TO 2222
 1234 CONTINUE
! DJUL FOR JAN 0.5 1900 IS 2415020.0
! DY1 = GEODYN REF.TIME - 2415020.0(Jan. 0.5 1900)
      DY1=TMGDN1-2415020.0D0
      DYS=DY1+DSECNV*(MJDSEC+FSEC(IIII))
      DYS2=DYS*DYS
      DYS3=DYS2*DYS
! CALCULATE MEAN LONGITUDE OF THE MOON USING FORMULA IN AENA
!     XLMOON=270.434164D0 + 13.1763965268D0*DYS - 8.5D-13*DYS2 +
!    .       3.9D-20*DYS3
      XLMOON=A0+A1*DYS-A2*DYS2+A3*DYS3
      OMEGAT=TWO*(THETAG(IIII)-XLMOON)
      DO 25 II=1,100
      PP(II)=ZERO
   25 END DO
      P(IZERO,IZERO) = ONE
      P(1,IZERO) = SINLAT(IIII)
      P(1,1) = COSLAT(IIII)
      COSOMT = COS(OMEGAT)
      SINOMT = SIN(OMEGAT)
      COSMLA(1) = COSLAM(IIII)
      SINMLA(1) = SINLAM(IIII)
      DO 10 M=2,NMAXT
      COSMLA(M) = COSLAM(IIII)*COSMLA(M-1)-SINLAM(IIII)*SINMLA(M-1)
   10 SINMLA(M) = SINLAM(IIII)*COSMLA(M-1)+COSLAM(IIII)*SINMLA(M-1)
      FN1 = ZERO
      F2N1 = ONE
      DO 30 N=2,NMAXT
      FN1 = FN1+ONE
      F2N1 = F2N1+TWO
      P(N,IZERO) = (F2N1*SINLAT(IIII)*P(N-1,IZERO)-FN1*P(N-2,IZERO))    &
     &             /DBLE(N)
      F2N1CS = F2N1*COSLAT(IIII)
      DO 30 M=1,N
   30 P(N,M) = P(N-2,M)+F2N1CS*P(N-1,M-1)
      OTIDES(IIII)=OTIDES(IIII)                                         &
     &            +(A(IZERO,IZERO)*COSOMT+C(IZERO,IZERO)*SINOMT)        &
     &            *P(IZERO,IZERO)
      N1=NMAXD-1
      DO 50 N=1,NMAXT
      OTIDES(IIII)=OTIDES(IIII)                                         &
     &            +(A(N,IZERO)*COSOMT+C(N,IZERO)*SINOMT)*P(N,IZERO)
      M1=NMAXD
      DO 40 M=1,N
      OTIDES(IIII)=OTIDES(IIII)+((A(N,M)*COSOMT+C(N,M)*SINOMT)*COSMLA(M)&
     &+(A(N1,M1)*COSOMT+C(N1,M1)*SINOMT)*SINMLA(M))*P(N,M)
   40 M1=M1-1
   50 N1=N1-1
      GO TO 500
 2222 CONTINUE
      PHI=DEGRAD*SATLAT(IIII)
      XLAM=DEGRAD*SATLON(IIII)
!     OTIDES(IIII)=CALTID(PHI,XLAM,SINLAT(IIII),MJDSEC,FSEC(IIII))
  500 END DO
      RETURN
      END
