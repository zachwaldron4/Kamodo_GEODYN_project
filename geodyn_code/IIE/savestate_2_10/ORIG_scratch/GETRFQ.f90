
      SUBROUTINE GETRFQ(MJDSBL,NM,FSEC,FREQ,MJDRMP,TRAMP,FRAMP,FDRAMP,  &
     &                  NRAMPS)
      IMPLICIT DOUBLE PRECISION (A-H,O-Z),LOGICAL(L)
      DIMENSION FSEC(NM),FREQ(NM),TRAMP(1000,2),FRAMP(NRAMPS)
      DIMENSION FDRAMP(NRAMPS)
!
      IRAMP1=1
      DO 100 I=1,NM
      TIME=DBLE(MJDSBL)+FSEC(I)
      DO 10 J=IRAMP1,NRAMPS
      TIMEX=DBLE(MJDRMP)+TRAMP(J,1)
      TIMEY=DBLE(MJDRMP)+TRAMP(J,2)
      IF(TIME.GE.TIMEX.AND.TIME.LE.TIMEY) GO TO 20
   10 END DO
      WRITE(6,6000)
      WRITE(6,6000)
      WRITE(6,6001)
      WRITE(6,6002) TIME
      WRITE(6,6003)
      DO 15 J=1,NRAMPS
      TIMEX=DBLE(MJDRMP)+TRAMP(J,1)
      TIMEY=DBLE(MJDRMP)+TRAMP(J,2)
      WRITE(6,6004) J,TIMEX,TIMEY
   15 END DO
      STOP
   20 CONTINUE
      IRAMP1=J
      DX=DBLE(MJDSBL-MJDRMP)+FSEC(I)-TRAMP(IRAMP1,1)
      FREQ(I)=FRAMP(IRAMP1)+DX*FDRAMP(IRAMP1)
  100 END DO
      RETURN
 6000 FORMAT(' ')
 6001 FORMAT(' EXECUTION TERMINATING IN SUBROUTINE GETRFQ')
 6002 FORMAT(' MEASUREMRNT TIME: ',F15.2,' CAN NOT BE MATCHED TO')
 6003 FORMAT(' A RAMP PERIOD')
 6004  FORMAT(' J,TIMEX,TIMEY ',I5,F15.3,3X,F15.3)
      END
