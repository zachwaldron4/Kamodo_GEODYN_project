!$RELFRC
      SUBROUTINE RELFRC(X,R,RSQ,DXDD,PARMV,PARMV0,PARMVC,PXDDT,NEQN,    &
     &RLAM,ILTASC,ISATID)
!********1*********2*********3*********4*********5*********6*********7**
! RELFRC           98/04/08            9604.0    PGMR - D. PAVLIS
!
! FUNCTION: (1) CALCULATE THE ACCELERATION DUE TO YUKAWA TYPE FORCE
!               AND COMPUTE PARTIAL DERIVATIVES  FOR PARAMETER ALPHA
!
!
! I/O PARAMETERS:
!
!   NAME    I/O  A/S   DESCRIPTION OF PARAMETERS
!   ------  ---  ---   ------------------------------------------------
!   X        I         STATE VECTOR OF SATELLITE
!   R        I         DISTANCE OF SATELLITE FROM CENTER OF INTEGRATION
!   RSQ      I         DISTANCE OF SATELLITE FROM CENTER OF INTEGRATION
!                      SQUARED (PROPER UNITS)
!   DXDD     O         OUTPUT ACCELERATION IN SAME COORDINATE SYSTEM
!                      AS INPUT X
!
!
! COMMENTS:
!
!   REFERENCE FOR YUKAWA-TYPE FORCE:
!   CIUFOLINI APRIL 1998
!
!
!
!********1*********2*********3*********4*********5*********6*********7**
      IMPLICIT DOUBLE PRECISION (A-H,O-Z),LOGICAL(L)
      SAVE
      COMMON/CBDSTA/BDSTAT(7,999),XBDSTA
      COMMON/CBDTRU/BDTRUE(7,999)
      COMMON/CEGREL/LGRELE,LRLCLK,LGRELR,LXPCLK,LBPCLK,NXEGRL
      COMMON/CITER /NINNER,NARC,NGLOBL
      COMMON/CITERL/LSTGLB,LSTARC,LSTINR,LNADJ ,LITER1,LSTITR,          &
     &              LOBORB,LRESID,LFREEZ,LSAVEF,LHALT,LADJPI,LADJCI
      COMMON/CNIARC/NSATA,NSATG,NSETA,NEQNG,NMORDR,NMORDV,NSORDR,       &
     &              NSORDV,NSUMX,NXDDOT,NSUMPX,NPXDDT,NXBACK,NXI,       &
     &              NXILIM,NPXPF,NINTIM,NSATOB,NXBCKP,NXTIMB,           &
     &              NOBSBK,NXTPMS,NXCNIA
      COMMON/CRM5OE/RM5OE(9)
      COMMON/PLNETI/IPLNET(999),IPLNIN(999),MPLNGD(999),MPLNGO(999),   &
     &              IPLNZ(999),NXPLNI
      COMMON/CEARTH/AEG,AEGSQ,FGINV,FG,EGSQ,EGSQP1,C1,C2,FOURC1,TWOC2,  &
     &              XH2,XL2,WREF,RMEAN,REFC20,REFC40,REFC60,BEG,CBLTC,  &
     &              WAE2,GAMMAA,FSTAR,F4
      COMMON/CGRAV/GM,AE,AESQ,FE,FFSQ32,FSQ32,XK2,XK3,XLAM,SIGXK2,      &
     &      SIGXK3,SIGLAM,RATIOM(2),AU,RPRESS
      COMMON/CLIGHT/VLIGHT,ERRLIM,XCLITE
      COMMON/IBODPT/IBDCF(999),IBDSF(999),IBDGM(999),IBDAE(999),    &
     &              IBDPF(999),                                     &
     &              ICBDCF,ICBDSF,ICBDGM,ICBDAE,ICBDPF,             &
     &              ITBDCF,ITBDSF,ITBDGM,ITBDAE,ITBDPF,NXBDPT
      COMMON/LICASE/LINT(2),LCASE(18),NXLCAS
      COMMON/NPCOM /NPNAME,NPVAL(92),NPVAL0(92),IPVAL(92),IPVAL0(92),   &
     &              MPVAL(28),MPVAL0(28),NXNPCM
      COMMON/NPCOMX/IXARC ,IXSATP,IXDRAG,IXSLRD,IXACCL,IXGPCA,IXGPSA,   &
     &              IXAREA,IXSPRF,IXDFRF,IXEMIS,IXTMPA,IXTMPC,IXTIMD,   &
     &              IXTIMF,IXTHTX,IXTHDR,IXOFFS,IXBISA,IXFAGM,IXFAFM,   &
     &              IXATUD,IXRSEP,IXACCB,IXDXYZ,IXGPSBW,IXCAME,IXBURN,  &
     &              IXGLBL,IXGPC ,IXGPS, IXTGPC,IXTGPS,IXGPCT,IXGPST,   &
     &              IXTIDE,IXETDE,IXOTDE,IXOTPC,IXOTPS,IXLOCG,IXKF  ,   &
     &              IXGM  ,IXSMA ,IXFLTP,IXFLTE,IXPLTP,IXPLTV,IXPMGM,   &
     &              IXPMJ2,IXVLIT,IXEPHC,IXEPHT,IXH2LV,IXL2LV,IXOLOD,   &
     &              IXPOLX,IXPOLY,IXUT1 ,IXPXDT,IXPYDT,IXUTDT,IXVLBI,   &
     &              IXVLBV,IXXTRO,IXBISG,IXSSTF,IXFGGM,IXFGFM,IXLNTM,   &
     &              IXLNTA,IX2CCO,IX2SCO,IX2GM ,IX2BDA,IXRELP,IXJ2SN,   &
     &              IXGMSN,IXPLNF,IXPSRF,IXANTD,IXTARG,                 &
     &              IXSTAP,IXSSTC,IXSSTS,IXSTAV,IXSTL2,                 &
     &              IXSTH2,IXDPSI,IXEPST,IXCOFF,IXTOTL,NXNPCX
      COMMON/SETAPT/                                                    &
     &       JSADRG(1),JSASRD(1),JSAGA(1),JFAADJ,JTHDRG,JACBIA,JATITD,  &
     &       JDSTAT,JDTUM ,                                             &
     &       JSACS, JSATID,JSALG,JSAGM,JSAKF,JSAXYP,JSADJ2,JSAPGM,      &
     &       JFGADJ,JLTPMU,JLTPAL,JL2CCO,JL2SCO,JL2GM,JLRELT,           &
     &       JLJ2SN,JLGMSN,JLPLFM,JL2AE,JSAXTO,JSABRN
      COMMON/VRBLOK/SINPSI,COSPSI,XLAMDA,GMR,AOR
      DIMENSION X(6),DXDD(3),VTSUN(3),OMG(3),TERM1(3),TERM2(3)
      DIMENSION PARMV(1),PARMV0(1),PARMVC(1)
      DIMENSION PXDDT(NEQN,3)
      DIMENSION RLAM(1),ILTASC(1)
!
!**********************************************************************
!* START OF EXECUTABLE CODE *******************************************
!**********************************************************************
!
!
      IF(ICBDGM.NE.3) RETURN
!
! GET THE M VALUE FOR THE CONSTATNT "ALPHA"
!
      CALL FNDNUM(ISATID,ILTASC,NSATA,IRET)
      IF(IRET.EQ.0) RETURN
!
      INDEX=IPVAL(IXLNTA)
      INDEX0=IPVAL0(IXLNTA)
      IF(NPVAL0(IXLNTA).EQ.0) THEN
      ALPHA=PARMV(INDEX)
      ELSE
      IF(NGLOBL.EQ.1) THEN
      ALPHA=PARMV0(INDEX0)
      ELSE
      ALPHA=PARMVC(INDEX0)
      ENDIF
      ENDIF
!
!   NOTE THAT SOME CONSTANTS IN CODE ARE FOR EARTH ONLY
!
!
! M = MASS OF EARTH
! G = GRAV. CONST.
! R = SATELLITE DISTANCE FROM CENTER OF THE EARTH
! OMEGA = EARTH'S ROTATIONAL FREQUENCY
! X,Y,Z = POSITION OF THE SATELLITE
! XDOT, YDOT, ZDOT = VELOCITY COMPONENTS OF THE SATELLITE
! AX,AY,AZ = ACCELERATION DUE TO LENSE-THIRRING
!
        CONST = GM/(R*R*R)
        BETA  = R/RLAM(IRET)
        PROD=CONST*(1.D0+BETA)*EXP(-BETA)
        FACTOR=ALPHA*PROD
!
! NEW FORCE MODEL
      DXDD(1)=FACTOR*X(1)
      DXDD(2)=FACTOR*X(2)
      DXDD(3)=FACTOR*X(3)
!     write(6,*)' dbg dxdd ',dxdd(1),dxdd(2),dxdd(3)
!
! FORM DIRECT PARTIALS
      IF(.NOT.LSTINR) GOTO 3000
      IF(NPVAL0(IXLNTA).GT.0) THEN
      INDX=JLTPAL
      PXDDT(INDX,1)=PROD*X(1)
      PXDDT(INDX,2)=PROD*X(2)
      PXDDT(INDX,3)=PROD*X(3)
!     write(6,*)' dbg pxddt ',pxddt(indx,1),pxddt(indx,2),pxddt(indx,3)
      ENDIF
 3000 CONTINUE
!
      RETURN
      END
