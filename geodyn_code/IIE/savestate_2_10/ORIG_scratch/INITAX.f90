!$INITAX
      SUBROUTINE INITAX(RA,DEC,W,RA_DOT,DEC_DOT,W_DOT,OMEG,XAXIS,AA)
!*******1**********2*********3*********4*********5*********6*********7**
! INITAX
!
! COMMENTS: CALLS TO PRXCSS and ROTXTR MUST HAVE BEEN MADE JUST PRIOR
!           TO THIS CALL IN ORDER TO INITIALIZE COMMON BLOCKS
!           PRXCON AND CTHDXT
!
!*******1**********2*********3*********4*********5*********6*********7**
      IMPLICIT DOUBLE PRECISION (A-H,O-Z),LOGICAL(L)
      COMMON/PRXCON/PRXCON(2,2,2)
      COMMON/CTHDXT/THDXT
      COMMON/CORA06/KPRMV ,KPNAME,KPRMV0,KPRMVC,KPRMVP,KPRMSG,KPARVR,   &
     &              KPRML0,KPDLTA,KSATCV,KSTACV,KPOLCV,KTIDCV,KSUM1 ,   &
     &              KSUM2 ,KGPNRA,KGPNRM,KPRSG0,KCONDN,KVELCV,          &
     &              KSL2CV,KSH2CV,KTIEOU,KPRMDF,NXCA06
      COMMON/NPCOM /NPNAME,NPVAL(92),NPVAL0(92),IPVAL(92),IPVAL0(92),   &
     &              MPVAL(28),MPVAL0(28),NXNPCM
      COMMON/NPCOMX/IXARC ,IXSATP,IXDRAG,IXSLRD,IXACCL,IXGPCA,IXGPSA,   &
     &              IXAREA,IXSPRF,IXDFRF,IXEMIS,IXTMPA,IXTMPC,IXTIMD,   &
     &              IXTIMF,IXTHTX,IXTHDR,IXOFFS,IXBISA,IXFAGM,IXFAFM,   &
     &              IXATUD,IXRSEP,IXACCB,IXDXYZ,IXGPSBW,IXCAME,IXBURN,  &
     &              IXGLBL,IXGPC ,IXGPS, IXTGPC,IXTGPS,IXGPCT,IXGPST,   &
     &              IXTIDE,IXETDE,IXOTDE,IXOTPC,IXOTPS,IXLOCG,IXKF  ,   &
     &              IXGM  ,IXSMA ,IXFLTP,IXFLTE,IXPLTP,IXPLTV,IXPMGM,   &
     &              IXPMJ2,IXVLIT,IXEPHC,IXEPHT,IXH2LV,IXL2LV,IXOLOD,   &
     &              IXPOLX,IXPOLY,IXUT1 ,IXPXDT,IXPYDT,IXUTDT,IXVLBI,   &
     &              IXVLBV,IXXTRO,IXBISG,IXSSTF,IXFGGM,IXFGFM,IXLNTM,   &
     &              IXLNTA,IX2CCO,IX2SCO,IX2GM ,IX2BDA,IXRELP,IXJ2SN,   &
     &              IXGMSN,IXPLNF,IXPSRF,IXANTD,IXTARG,                 &
     &              IXSTAP,IXSSTC,IXSSTS,IXSTAV,IXSTL2,                 &
     &              IXSTH2,IXDPSI,IXEPST,IXCOFF,IXTOTL,NXNPCX
      COMMON/XPCNT /NXTRAC,NXFLAG,NXALLC,NCPPER,NMINRT,NDPOR,NXXTRA
!...Begin TJS DEBUG
! Should be XMNRT, but having problems when dimensioning larger than XMNRT(1:3),
! so defining ZMNRT in a COMMON BLOCK named INERTIA as a temporary patch
      COMMON/INERTIA/WMNRT(6,2)
!...End TJS DEBUG
      DIMENSION OMEG(3),XAXIS(3,3),AA(*)
      DIMENSION RAP(1),DCP(1),FSEC(1),ROTI(9),SCRTCH(4)
!
      PHIDOT = RA_DOT
      THTDOT = -DEC_DOT
      TSIDOT = W_DOT

!!!      DO I = 1, NMINRT
!!!        ZMNRT(I) = AA(KPRMV-1 + IPVAL(IXXTRO)-1 + NXTRAC-NMINRT + I)
!!!!      END DO

      TSI=W
      PHI=RA+0.5D0*ACOS(-1.D0)
      THT=0.5D0*ACOS(-1.D0)-DEC
!
      OMEG(1)=THTDOT*COS(TSI)+PHIDOT*SIN(THT)*SIN(TSI)
      OMEG(2)=-THTDOT*SIN(TSI)+PHIDOT*SIN(THT)*COS(TSI)
      OMEG(3)=PHIDOT*COS(THT)+TSIDOT
!
      RAP(1)=RA
      DCP(1)=DEC
!
      CALL DXQN(MJDSC,FSEC,RAP,DCP,ROTI(1),ROTI(2),ROTI(3),             &
     &                ROTI(4),ROTI(5),ROTI(6),ROTI(7),ROTI(8),          &
     &                ROTI(9),SCRTCH,1)
!
! IAU X AXIS IN J2000 IS 1ST ROW OF ROTI
! IAU Z AXIS IN J2000 IS 3RD ROW OF ROTI
      SCRTCH(1)=COS(W)
      SCRTCH(2)=SIN(W)
      SCRTCH(3)=0.D0
!
      XAXIS(1,3)=ROTI(3)
      XAXIS(2,3)=ROTI(6)
      XAXIS(3,3)=ROTI(9)
      XAXIS(1,1)=ROTI(1)*SCRTCH(1)+ROTI(2)*SCRTCH(2)+ROTI(3)*SCRTCH(3)
      XAXIS(2,1)=ROTI(4)*SCRTCH(1)+ROTI(5)*SCRTCH(2)+ROTI(6)*SCRTCH(3)
      XAXIS(3,1)=ROTI(7)*SCRTCH(1)+ROTI(8)*SCRTCH(2)+ROTI(9)*SCRTCH(3)
      XAXIS(1,2)=XAXIS(2,3)*XAXIS(3,1)-XAXIS(3,3)*XAXIS(2,1)
      XAXIS(2,2)=XAXIS(3,3)*XAXIS(1,1)-XAXIS(1,3)*XAXIS(3,1)
      XAXIS(3,2)=XAXIS(1,3)*XAXIS(2,1)-XAXIS(2,3)*XAXIS(1,1)
!
      RETURN
      END
