!$NUVECT
       SUBROUTINE NUVECT(MJDSC,FSEC,DPSI,EPST,EPSM,NM,SCRTCH)
!********1*********2*********3*********4*********5*********6*********7**
! NUVECT           83/04/13            8303.0    PGMR - D. ROWLAND
!
! FUNCTION:  CALL SUBROUTINE NUINT WITH A VECTOR OF TIMES
!            FALLING COMPLETELY WITHIN AN EPHEMERIS NUTATION
!            INTERPOLATION PERIOD.
!
! I/O PARAMETERS:
!
!   NAME    I/O  A/S   DESCRIPTION OF PARAMETERS
!   ------  ---  ---   ------------------------------------------------
!   MJDSC    I    S    EPHEMERIS SECONDS SINCE GEODYN REFERENCE TIME
!   FSEC     I    A    EPHEMERIS SECONDS SINCE MJDSC
!   DPSI     O    A    NUTAION IN LONGITUDE
!   EPST     O    A    TRUE OBLIQUITY
!   EPSM     O    A    MEAN OBLIQUITY
!   NM       I    S    NUMBER OF TIMES AT WHICH NUTATIONS DESI
!   SRATCH        A    SCRTCH 5*NM IN LENGTH
!
!
! COMMENTS:
!
!
!********1*********2*********3*********4*********5*********6*********7**
      IMPLICIT DOUBLE PRECISION (A-H,O-Z),LOGICAL(L)
      SAVE
      DIMENSION FSEC(NM),DPSI(NM),EPST(NM),EPSM(NM),SCRTCH(NM,5)
      DIMENSION DPSITR(1500),EPSTTR(1500)
      COMMON/EOPRAT/ETAG,THTAG,ZTAG,EPSMG,DPSIG,EPSTG,TETAG,XPOLE,   &
     &     YPOLE,ETAR,THTAR,ZTAR,EPSMR,DPSIR,EPSTR,THETAGR,XPOLER,   &
     &     YPOLER,SP2,DSP2
      COMMON/EPHMPT/NTOT,NTOTS,NNPDPR,NUTORD,IBODDG(8),IGRPDG(4),       &
     &              NENPD,INRCD(2),KPLAN(11),NINEP,NEPHMR,NEPHEM,       &
     &              IBHINT,NINTBH,NXEPHP
      COMMON/EPHSET/EMFACT,DTENPD,DTINPD,FSC1EN,FSCENP(2),FSCINP(4),    &
     &   FSDINP(4),XEPHST
      COMMON/EPHM/FSECXY(1),XP(261),YP(261),A1UT(261),EP(261),EC(261),  &
     &            FSCFLX(1),FLUXS(36),AVGFLX(36),FLUXM(288),FSECEP(1),  &
     &            EPHP(816),EPHN(96),ELIB(120),BUFT(2700),FSECNP(4)
      DATA ONE/1.D0/,HALF/.5D0/
!
!***********************************************************************
! START OF EXECUTABLE CODE *********************************************
!***********************************************************************
!
      DEVIDE=HALF*DTENPD
      NM1=1
      NM2=NM
      IF(NENPD.EQ.1) GO TO 20
      DO 10 ISP=1,NM
      TTEST=MJDSC+FSEC(ISP)
      IF(TTEST.GT.FSCENP(2)) GO TO 15
   10 END DO
      GO TO 20
   15 NM2=ISP-1
      IF(NM2 .EQ. 0) GO TO 28
   20 CONTINUE
!   GET THE VECTOR FROM FIRST TIME PERIOD
      OFFSET=MJDSC-FSCENP(1)
      DO 25 I=1,NM2
   25 SCRTCH(I,1)=(FSEC(I)+OFFSET)/DEVIDE-ONE
      KPOINT=INRCD(1)
      CALL NUINT(EPHN(KPOINT),SCRTCH(1,1),MJDSC,FSEC,DPSI, &
     &EPST,EPSM,DPSITR,EPSTTR,SCRTCH(1,2),NM2)
      DPSIG=DPSI(1)
      EPSMG=EPSM(1)
      EPSTG=EPST(1)
      DPSIR=DPSITR(1)
      EPSTR=EPSTTR(1)
      IF(NM2 .EQ. NM) RETURN
!   GET VECTOR IN SECOND TIME PERIOD
   28 CONTINUE
      NL=NM-NM2
      OFFSET=MJDSC-FSCENP(2)
      DO 30 I=ISP,NM
   30 SCRTCH(I,1)=(FSEC(I)+OFFSET)/DEVIDE-ONE
      KPOINT=INRCD(2)
      CALL NUINT(EPHN(KPOINT),SCRTCH(ISP,1),MJDSC,FSEC(ISP), &
     &   DPSI(ISP),EPST(ISP),EPSM(ISP),DPSITR,EPSTTR,SCRTCH(1,2),NL)
      DPSIG=DPSI(ISP)
      EPSMG=EPSM(ISP)
      EPSTG=EPST(ISP)
      DPSIR=DPSITR(ISP)
      EPSTR=EPSTTR(ISP)

      RETURN
      END
