      SUBROUTINE CCOUNT(NSATA,ISATID)
      IMPLICIT REAL*8(A-H,O-Z),LOGICAL(L)
      COMMON/CBIASI/IEBIAS(4),IMBIAS(2),IBSCAL(1)  ,ITBIAS(1),          &
     &              IBTROP(3),IBIONO(3),KLKSTA(4,2),KLKSAT(4,2),        &
     &              KLKSTS(2,2),ITRPZE(2,2),ITRPGR(2,4),IBSBIA(1)
      COMMON/CBLOKI/MJDSBL,MTYPE ,NM    ,JSTATS,NPSEG ,JSATNO(3),ITSYS ,&
     &       NHEADB,NELEVS,ISTAEL(12),INDELV(3,4),JSTANO(3),ITARNO,     &
     &       KTARNO
      COMMON/ICLCKP/IUS65(50),NCLCKP(50),ICLKP(3,1000,50)
      DIMENSION ISATID(NSATA)
      DIMENSION FSEC(1),IYMD(1),IHM(1),SEC(1)
!
      IF(MTYPE.NE.65) RETURN
!
      FSEC(1)=0.D0
      CALL YMDHMS(MJDSBL,FSEC,IYMD,IHM,SEC,1)
      IYMD(1)=MOD(IYMD(1),1000000)
!
      DO 1000 JSAT=1,2
      IF(KLKSAT(1,JSAT).LE.0) GO TO 1000
      KSAT=-99
      DO I=1,NSATA
        IF(ISATID(I).EQ.JSATNO(1+JSAT)) KSAT=I
      ENDDO
      IF(KSAT.LE.0) THEN
        WRITE(6,6000)
        WRITE(6,6001)
        WRITE(6,6002) JSATNO
        WRITE(6,6003) IYMD,IHM,SEC
        WRITE(6,6004) JSATNO(1+JSAT)
        STOP
      ENDIF
!
!
      IF(KLKSAT(2,JSAT).LE.0.OR.KLKSAT(3,JSAT).LE.0) THEN
        WRITE(6,6000)
        WRITE(6,6001)
        WRITE(6,6002) JSATNO
        WRITE(6,6003) IYMD,IHM,SEC
        WRITE(6,6005) JSATNO(1+JSAT)
        WRITE(6,6006) 
        STOP
      ENDIF
!
      IUS65(KSAT)=JSATNO(1+JSAT)
!
      IF(NCLCKP(KSAT).EQ.0) THEN
        NCLCKP(KSAT)=1
        ICLKP(1,NCLCKP(KSAT),KSAT)=KLKSAT(1,JSAT)
        ICLKP(2,NCLCKP(KSAT),KSAT)=KLKSAT(2,JSAT)
        ICLKP(3,NCLCKP(KSAT),KSAT)=KLKSAT(3,JSAT)
        GO TO 1000
       ENDIF
!
      NTEST=NCLCKP(KSAT)
      DO 10 I=1,NTEST
      IF(ICLKP(1,I,KSAT).NE.KLKSAT(1,JSAT)) GO TO 10
      GO TO 1000
   10 CONTINUE 
!
      NCLCKP(KSAT)=NCLCKP(KSAT)+1
!
      IF(NCLCKP(KSAT).GT.50) THEN
        WRITE(6,6000)
        WRITE(6,6001)
        WRITE(6,6002) JSATNO
        WRITE(6,6003) IYMD,IHM,SEC
        WRITE(6,6007)
        WRITE(6,6008) JSATNO(1+JSAT)
        STOP
      ENDIF
!
      ICLKP(1,NCLCKP(KSAT),KSAT)=KLKSAT(1,JSAT)
      ICLKP(2,NCLCKP(KSAT),KSAT)=KLKSAT(2,JSAT)
      ICLKP(3,NCLCKP(KSAT),KSAT)=KLKSAT(3,JSAT)
 1000 CONTINUE
      RETURN
6000  FORMAT(' EXECUTION TERMINATING IN SUBROUTINE CCOUNT')
6001  FORMAT(' PROBLEM WITH MT 65 BLOCK')
6002  FORMAT(' SATELLITES ',3I10)
6003  FORMAT(' BLOCK START : ',I6,2X,I4,F10.1)
6004  FORMAT(' SATELLITE: ',I10,' NOT IN RUN')
6005  FORMAT(' SATELLITE: ',I10,' DOES NOT HAVE A COMPLETE')
6006  FORMAT(' QUADRATIC CLOCK POLYNOMAL ')
6007  FORMAT(' THIS BLOCK USES THE 51ST CLOCK POLYNOMIAL')
6008  FORMAT(' FOR SATELLITE ',I10,' (MAX 50)')
      END
