!$TIDCON
!cc      SUBROUTINE TIDCON(
      SUBROUTINE TIDCON(ntide1,net1,                                    &
     &                  MJDSEC,FSEC,XS,R,ISAT,AORN,THETAG,TIDES,FI,     &
     &                  GE,MM,KK,HH,JJ,SIGN1,SIGN2,ILL,QQ,P,D,          &
     &                  NEQN,GRPAR,ACCTS,COEF,XQQ,IPT,XIEXP,            &
     &                  XMM,XLL1,XSIGN1,XSN2QQ,X2M2HH,X2M2HJ,XKK,       &
     &                  ILL1,IIPPTT,IQNDEX,XSIGN2,MAINNN,               &
     &                  JJBDY,NOSIDE,ITIDE,ICENTR,SCRTCH,               &
     &                  AJ,BJ,AT,BT,AB,BA,TEMP,IDSATS,AA)
!********1*********2*********3*********4*********5*********6*********7**
! TIDCON           89/06/01            0000.0    PGMR - BEN ROSEN
!                                                PGMR - D. CHRISTODOULID
!                                                PGMR - D. ROWLANDS (GII
!                                                PGMR - D. MORSBERGER
!                                                PGMR - A. MARSHALL
!
! FUNCTION:  TIDCON IS AN EXECUTIVE ROUTINE TO COMPUTE THE FORCE DUE
!            TO THE TIDAL EXPANSION MODEL DEVELOPED BYDD
!            DEMOSTHENES CHRISTODOULIDES.
!
!
! I/O PARAMETERS:
!
!   NAME    I/O  A/S   DESCRIPTION OF PARAMETERS
!   ------  ---  ---   ------------------------------------------------
!   MJDSEC   I         INTEGER EPHEMERIS SECONDS SINCE GEODYN REF.TIME
!   FSEC     I         FRACTIONAL REMAINING SEDCONDS
!   XS       I         TRUE OF INTEGRATION STEP SATELLITE POSITION
!   R        I         RADIUS OF SATELLITE POSITION
!   ISAT     I         MULTIPLE SATELLITE POINTER
!   AORN     I         GMR*(A/R)**N
!   THETAG   I         GREENWICH HR ANGLE AT INTEGRATION STEP TIME
!   TIDES    I         ARRAY CONTAINING CURRENT VALUES OF A&B
!                      COEFFCIENTS FOR THE EXPANDED TIDAL MODEL
!   FI       I         ARRAY CONTAINING KAULA'S INCLINATION FUNCTION
!                      FOR EARTH TIDE MODEL (AT 12 HR INTERP PERIODS)
!   GE       I         ARRAY CONTAINING KAULA'S ECCENTRICITY FUNCTION
!                      FOR EARTH TIDE MODEL (AT 12 HR INTERP PERIODS)
!   MM       I         TIDAL EXPANSION ARGUMENT
!   KK       I         TIDAL EXPANSION ARGUMENT
!   HH       I         TIDAL EXPANSION ARGUMENT
!   JJ       I         TIDAL EXPANSION ARGUMENT
!   SIGN1    I         SIGN ASSOCIATED WITH EXPANSION ARGUMENTS
!   SIGN2    I         SIGN ASSOCIATED WITH Q*LAMBDA TERM (+ FOR ETIDE)
!   ILL      I         DEGREE OF TIDAL HARMONIC (2 FOR ETIDE)
!   QQ       I         ORDER OF TIDAL HARMONIC (MM TOE ETIDE)
!   P        I         LGENDER POLYNOMIALS FOR SATELLITE LATITUDE
!   D        I         NORMALIZED EQUATION FROM EGRAV
!   NEQN     I         NUMBER OF FORCE MODEL PARAMETERS
!   GRPAR    O         EXPLICIT PARTIALS OF ACCELETATION
!                      WRT TIDAL PARAMETERS (TRUE OF STEP FOR K2&K3)
!                      (TRUE OF REF FOR EXTENDED TIDES)
!   ACCTS    O         TRUE OF STEP TIDAL ACCELERATION
!   COEF     I         TIDAL COEFFICIENT. 3-MM
!                      FOR SOLID EARTH TIDES AND FROM LOADING
!                      CONSTANTS FOR OCEAN TIDES.
!   XQQ      I         DFLOAT OF ORDER OF TIDAL HARMONIC
!                      =XMM FOR SOLID EARTH TIDES
!   IPT      I         POINTER TO LGENDR POLYNOMIAL OF ILL,QQ
!   XIEXP    I         +1 IF XMM EVEN;-1 IF XMM ODD
!   XMM      I         DFLOAT OF EXPANSION ARGUMENT
!   XLL1     I         DFLOAT OF ILL+1
!   XSIGN1   I         SIGN ASSOCIATED WITH EXPANSION ARGUMENTS
!                      COLUMNS 16-17 OF THE OTIDES/ETIDES CARD
!                      MULTIPLIES -(LINEAR COMB NODE, PER, MA)
!   XSN2QQ   I         SIGN ASSOCIATED WITH HARMONIC TERM TIMES QQ
!                      + FOR SOLID EARTH TIDES
!   X2M2HH   I         2-2HH WHERE HH IS A TIDAL EXPANSION TERM
!   X2M2HJ   I         X2M2HH+JJ WHERE JJ IS AN EXPANSION ARGUMENT
!   XKK      I         DFLOAT OF EXPANSION ARGUMENT
!   ILL1     I         ILL+1
!   IIPPTT   I         POINTER FOR MULTIPLE TIDAL FREQUNCIES
!   IQNDEX   I         POINTER FOR Q*LAMBDA TERM
!   XSIGN2   I         SIGN IN ANG ARG OF TIDAL HARMONIC EXPANSION
!                      PROGRADE RETROGRADE (COLUMN 7-8 OF OTIDES)
!   MAINNN   I         DEGREE OF MAIN TIDAL LINE
!   JJBDY    I         PERTURBING BODIES
!                       1 - MOON AND SUN OR JUST MOON
!                       2 - SUN
!                      NOTE THAT IF MOON& SUN,THEN X2M2HH,X2M2HJ,XKK
!                      HAVE ALL BEEN SET TO ZERO
!   NOSIDE   I         FLAG INDICATING SIDE BAND USAGE
!   ITIDE    I         POINTER FOR SIDE BANDS
!   ICENTR   I         POINTER INDICATING MAIN TIDAL LINE
!   SCRTCH   I         SCRATCH SPACE
!   AJ                 END POINT AMPLITUDE FOR SIDE BANDS
!   BJ                 END POINT AMPLITUDE FOR SIDE BANDS
!   AT                 INTERPOLATED AMPLITUDE FOR SIDE BANDS
!   BT                 INTERPOLATED AMPLITUDE FOR SIDE BANDS
!   AB                 AMPLITUDE FOR SIDE BANDS
!   BA                 AMPLITUDE FOR SIDE BANDS
!   TEMP               SCRATCH SPACE
!   AA      I/O   A
!
! COMMENTS:
!
! REFERENCES:
!            "OBSERVED TIDAL BRAKING IN THE EARTH/MOON/SUN SYSTEM"
!             BY CHRISTODOULIDIS, ET AL., JGR, VOL 93, P. 6216-6236,
!             JUNE 10,1988.
!
!             NASA TECH MEMO 86180, "ALTIMETRY, ORBITS AND TIDES",
!             OSCAR L. COLOMBO
!
!             GEODYN DOCUMENTATION - VOLUME I
!
!********1*********2*********3*********4*********5*********6*********7**
      IMPLICIT DOUBLE PRECISION(A-H,O-Z),LOGICAL(L)
      SAVE
!
      PARAMETER( ZERO  = 0.0D0 )
      PARAMETER( ONE   = 1.0D0 )
      PARAMETER( TWO   = 2.0D0 )
      PARAMETER( HALF  = 0.5D0 )
      PARAMETER( QT    = 0.25D0 )
!
      INTEGER HH,QQ,SIGN1,SIGN2
!
      COMMON/CGRAV/GM,AE,AESQ,FE,FFSQ32,FSQ32,XK2,XK3,XLAM,SIGXK2,      &
     &      SIGXK3,SIGLAM,RATIOM(2),AU,RPRESS
      COMMON/CONSTR/PI,TWOPI,DEGRAD,SECRAD,SECDAY
      COMMON/CORA01/KFSEC0,KFSECB,KFSEC ,KFSECV,KH    ,KHV   ,KCTOL ,   &
     &              KRSQ  ,KVMATX,KCPP  ,KCPV  ,KCCP  ,KCCV  ,KCCPV ,   &
     &              KCCVV ,KXPPPP,KX    ,KPX   ,KSUMX ,KXDDOT,KSUMPX,   &
     &              KPXDDT,KAB   ,KPN   ,KAORN ,KSINLM,KCOSLM,KTANPS,   &
     &              KCRPAR,KVRARY,KXM   ,KXNP1 ,KXPRFL,KXM2  ,KXNNP1,   &
     &              KWRK  ,KFI   ,KGE   ,KB0DRG,KBDRAG,KAPGM ,KAPLM ,   &
     &              KCN   ,KSN   ,KSTID ,KTIDE ,KSTDRG,KSTSRD,KSTACC,   &
     &              KLGRAV,KGM   ,KAE   ,KFPL  ,KFEQ  ,KPLNPO,KPLNVL,   &
     &              KXEPOC,KCD   ,KCDDOT,KCR   ,KGENAC,KACN  ,KASN  ,   &
     &              KTHDRG,KCKEP ,KCKEPN,KXNRMZ,KXNRMC,KFSCEP,KFSCND,   &
     &              KAREA ,KXMASS,KRMSPO,KTCOEF,KTXQQ ,KTIEXP,KTXMM ,   &
     &              KTXLL1,KTXSN1,KTS2QQ,KT2M2H,KT2MHJ,KTXKK ,KTSCRH,   &
     &              KPXPK ,KAESHD,KCSAVE,KSSAVE,KCGRVT,KSGRVT,KXDTMC,   &
     &              KDNLT ,KTXSN2,KTNORM,KTWRK1,KTWRK2,KUNORM,KAERLG,   &
     &              KSINCO,KPARLG,KCONST,KBFNRM,KTDNRM,KCSTHT,KTPSTR,   &
     &              KTPSTP,KTPFYW,KPLMGM,KTPXAT,KEAQAT,KEAFSS,KEAINS,   &
     &              KACS  ,KECS  ,KSOLNA,KSOLNE,KSVECT,KSFLUX,KFACTX,   &
     &              KFACTY,KADIST,KGEOAN,KPALB ,KALBCO,KEMMCO,KCNAUX,   &
     &              KSNAUX,KPPER ,KACOSW,KBSINW,KACOFW,KBCOFW,KANGWT,   &
     &              KWT   ,KPLNDX,KPLANC,KTGACC,KTGDRG,KTGSLR,KWTACC,   &
     &              KWTDRG,KWTSLR,KTMACC,KTMDRG,KTMSLR,KATTUD,KDYACT,   &
     &              KACCBT,KACPER,KXDDNC,KXDDAO,KXNC  ,KXPPNC,KSMXNC,   &
     &              KXDDTH,KPDDTH,KXSSBS,KCPPNC,KEXACT,KXACIN,KXACOB,   &
     &              KPXHDT,KTPXTH,KPACCL,KTXSTA,KDELXS,KSMRNC,KPRX  ,   &
     &              KSMRNP,KDSROT,KXUGRD,KYUGRD,KZUGRD,KSUMRC,KXDDRC,   &
     &              KTMOS0,KTMOS, KTMOSP,KSMXOS,KSGTM1,KSGTM2,KSMPNS,   &
     &              KXGGRD,KYGGRD,KZGGRD,KXEGRD,KYEGRD,KZEGRD,KSSDST,   &
     &              KSDINS,KSDIND,KSSDSR,KSSDDG,KTATHM,KTAINS,KTAFSS,   &
     &              KSRAT ,KTRAT ,KHLDV ,KHLDA1,KHLDA4,KHLDA7,KQAST1,   &
     &              KQAST2,KQAST3,KQAST4,KQAST5,KQAST6,NXCA01
      COMMON/CORI01/KMJDS0,KMJDSB,KMJDSC,KMJDSV,KIBACK,KIBAKV,KIORDR,   &
     &              KIORDV,KNOSTP,KNOCOR,KNSAT ,KN3   ,KNEQN ,KNEQN3,   &
     &              KNH   ,KNHV  ,KNSTPS,KNSTPV,KICPP ,KICPV ,KICCP ,   &
     &              KICCV ,KICCPV,KICCVV,KISUMX,KIXDDT,KISMPX,KIPXDD,   &
     &              KNMAX ,KNTOLD,KNTOLO,KICNT ,KISNT ,KMM   ,KKK   ,   &
     &              KJJ   ,KHH   ,KIBDY ,KSIGN1,KSIGN2,KLL   ,KQQ   ,   &
     &              KIORFR,KIPDFR,KITACC,KJSAFR,KJSPFR,KMJDEP,KMJDND,   &
     &              KNVSTP,KNSTRN,KNDARK,KTIPPT,KTJBDY,                 &
     &              KICNTA,KISNTA,KISHDP,KIPTC ,KIPTS ,KIGTSR,KIXTMC,   &
     &              KTIPTT,KTNOSD,KTQNDX,KTLL1 ,KTJJBD,KTITDE,KTCNTR,   &
     &              KTNN  ,KITACX,KNMOVE,KPANEL,KPLPTR,KNADAR,KNADSP,   &
     &              KNADDF,KNADEM,KNADTA,KNADTC,KNADTD,KNADTF,KNADTX,   &
     &              KITPMD,KSCATT,KITPAT,KILTPX,KEASBJ,KEANMP,KEANAN,   &
     &              KEAPMP,KEAPAN,KEAMJS,KEAPPP,KEAAAA,KICNTT,KISNTT,   &
     &              KTPGRC,KTPGRS,KTPC  ,KTPS  ,KALCAP,KEMCAP,KNSEG ,   &
     &              KICNTP,KISNTP,KNRDGA,KNRDDR,KNRDSR,KIRDGA,KIRDRG,   &
     &              KIRSLR,KSTRTA,KSTRTD,KSTRTS,KDYNPE,KACCPE,KIBCKN,   &
     &              KNRAT ,KIXDDN,KISMXN,KDXDDN,KDSMXN,KICPPN,KACSID,   &
     &              KNEQNH,KHRFRC,KPTFBS,KPTFSB,KIPXDA,KIACCP,KXSTAT,   &
     &              KPXST ,KSALST,KMAPLG,KNMBUF,KSTEPS,KSGMNT,KSATIN,   &
     &              KMEMST,KNEQNI,KBUFIN,KWEMGA,KWEMDR,KTPATS,KTANMP,   &
     &              KTAPPP,KTAMJS,KTASID,KGPSID,KNSSVA,KPNALB,KBRAX1,   &
     &              KBRAX2,KBRAX3,NXCI01
      COMMON/CRMI/RMI(9)
      COMMON/CTIDES/NTIDE,NSTADJ,NET,NETADJ,NETUN,NOT,NOTADJ,           &
     &   NOTUN ,NETUNU,NETADU,NOTUNU,NOTADU,NBSTEP,KTIDA(3),            &
     &   ILLMAX,NUNPLY,NNMPLY,NDOODN,MXTMRT,NRESP ,NXCTID
      COMMON/EPHSET/EMFACT,DTENPD,DTINPD,FSC1EN,FSCENP(2),FSCINP(4),    &
     &   FSDINP(4),XEPHST
      COMMON/GEODEG/NMAX,NMAXP1,NP,NTOLD,NTOLO,NADJC,NADJS,NADJCS,      &
     &              NPMAX,NXGDEG
      COMMON/GRANGL/GHRANG(4),COSGHR(4),SINGHR(4)
      COMMON/IBODPT/IBDCF(999),IBDSF(999),IBDGM(999),IBDAE(999),    &
     &              IBDPF(999),                                     &
     &              ICBDCF,ICBDSF,ICBDGM,ICBDAE,ICBDPF,             &
     &              ITBDCF,ITBDSF,ITBDGM,ITBDAE,ITBDPF,NXBDPT
      COMMON/IEPHM2/ISUPL,ICBODY,ISEQB(2),MAXDEG,ITOTSE,IREPL(988), &
     &              NXEPH2
      COMMON/LCBODY/LEARTH,LMOON,LMARS
      COMMON/LSTRT/LSTART
      COMMON/QQTIDE/IQMAX,IQMIN,IQDIF,NUMFRQ,NBAND
      COMMON/SETADJ/LSADRG(4),LSASRD(4),LSAGA(4),LSAGP,LSATID,LSAGM,    &
     &              LSADPM,LSAKF,LSADNX,LSADJ2,LSAPGM
      COMMON/SETAPT/                                                    &
     &       JSADRG(1),JSASRD(1),JSAGA(1),JFAADJ,JTHDRG,JACBIA,JATITD,  &
     &       JDSTAT,JDTUM ,                                             &
     &       JSACS, JSATID,JSALG,JSAGM,JSAKF,JSAXYP,JSADJ2,JSAPGM,      &
     &       JFGADJ,JLTPMU,JLTPAL,JL2CCO,JL2SCO,JL2GM,JLRELT,           &
     &       JLJ2SN,JLGMSN,JLPLFM,JL2AE,JSAXTO,JSABRN
      COMMON/STARTT/ESSTRT,FSSTRT
      COMMON/VRBLOK/SINPSI,COSPSI,XLAMDA,GMR,AOR
      COMMON/TDELEM/XMEAN(2),XNODE(2),OMEGA(2),A(2),XINCL(2),E(2),      &
     &   EPSLON,RMASS,XLONG,TANPSI,THETG,RHO3,CC(3,3),B(2)
      COMMON/TIDTIM/FSCFR1,FSCFR2,FSCMS1,FSCMS2
!
      DIMENSION AA(1)
      DIMENSION ACCTS(3),ACCTR(3)
      DIMENSION GE(2,1),FI(2,1)
      DIMENSION MM(1),KK(1),HH(1),JJ(1),SIGN1(1),                       &
     &   SIGN2(1),TIDES(1),P(1),ILL(1),QQ(1),                           &
     &   GRPAR(NEQN,3),                                                 &
     &   XS(6),AORN(1)
      DIMENSION COEF(1),XQQ(1),IPT(1),XIEXP(1),XMM(1),                  &
     &          XLL1(1),XSIGN1(1),XSN2QQ(1),X2M2HH(1),X2M2HJ(1),        &
     &          XKK(1),JJBDY(1),SCRTCH(NET1,4)
      DIMENSION NOSIDE(NTIDE1),ITIDE(NTIDE1),                           &
     &          ICENTR(NTIDE1),MAINNN(NTIDE1),                          &
     &          IIPPTT(NTIDE1),IQNDEX(NTIDE1),                          &
     &            ILL1(NTIDE1),XSIGN2(NTIDE1)
      DIMENSION D(NP)
! BELOW SHOWS ACTUAL DIMENSION
      DIMENSION AJ(2*NTIDE1),BJ(2*NTIDE1),                              &
     &         AT(0:NTIDE1),BT(0:NTIDE1),                               &
     &          AB(NTIDE1),BA(NTIDE1),TEMP(NTIDE1,10)
!     DIMENSION AJ(1),BJ(1),AT(0:NTIDE1),BT(0:NTIDE1),
!
      DATA LN1ST,LETIDE /2*.FALSE./
!     DATA KENTRY/0/
!
!********1*********2*********3*********4*********5*********6*********7**
! START OF EXECUTABLE CODE
!********1*********2*********3*********4*********5*********6*********7**
!
!
!     KENTRY = KENTRY + 1
!C    WRITE(6,*) 'TIDCON: HH ', HH
!
      LUNORB=.FALSE.
!
      ACCTS(1)=ZERO
      ACCTS(2)=ZERO
      ACCTS(3)=ZERO
!
! GET ACCELERATION AND PARTIALS
! FOR K2 AND K3 ETIDES (TIME INDEPENDENT)
!
      IF(LMOON) THEN
        INDBOD=3
      ELSE
        INDBOD=4
      ENDIF
!
      CALL TIDAL(IDSATS,XS,R,NEQN,ACCTS,GRPAR,AA,INDBOD,                &
     &           MJDSEC,FSEC)
!C    IF( KENTRY .LT. 100) WRITE(6,*) 'TIDCON: ACCTS K2+K3 ACC ',
!C   1         ACCTS
!
! GET THE BASIC TIDAL MODEL
! RETURN IF NO EXPANDED MODEL INFORMATION
!
      IF(NTIDE.LE.0) RETURN
      IF(ICBDGM.NE.3) RETURN
!
! IF ON THE FIRST CALL TO TIDCON INITIALIZE
!
      IF(LN1ST) GO TO 100
! INITIALIZE
      LN1ST=.TRUE.
      LETIDE=.TRUE.
      RMASS=RATIOM(2)/RATIOM(1)
      B(1)=ONE
      AT(0)=ONE
      BT(0)=ZERO
      CALL FACBIN
  100 CONTINUE
!
      NBB=NBAND+NET
!
!
!   FOR ALL BUT FIRST SATELLITE SKIP TIME ONLY DEPENDENT
      IF(ISAT.GT.1) GO TO 1100
!
! BEGIN INTERPOLATION OF DOODSON COEFF, INCLN& ECCENT. FUNC, ETC.
      FJDSEC=DBLE(MJDSEC)+FSEC
!
! IF IN THE STARTER AND GOING BACK IN TIME, DON'T RECOMPUTE ENDPTS
! JUST EXTRAPOLATE FROM EXISTING POINTERS FOR COMPUTATIONAL EFFICIENCY
!CC  REMOVED CHECK 2/4/94 BECAUSE IT WAS NOT WORKING FOR MULTIPLE
!CC  SATELLITES
!CC      IF(FJDSEC .LT. FSCFR1 .AND. LSTART) THEN
!CC      XFRSTP=(FJDSEC-FSCFR1)/DTINPD
!CC      GOTO 1000
!CC      ENDIF
!
! COMPUTE INTERPOLATION POINT (XFRSTP) IN THE INTERPOLATION
! INTERVAL(DTINPD)
      XFRSTP=(FJDSEC-FSCINP(1))/DTINPD
      INPT=INT(XFRSTP)
      IFRSTP=INPT+1
      ISECDP=IFRSTP+1
      XFRSTP=XFRSTP+DBLE(1-IFRSTP)
!
! IF INTERP POINT IS OUTSIDE EXISTING ENDPPOINTS, COMPUTE NEW ENDPOINTS
      IF(FJDSEC.GT.FSCFR1.AND.FJDSEC.LT.FSCFR2) GOTO 1000
      FSCBG2=FSCFR1-DTINPD
      FSCED2=FSCFR2+DTINPD
!
! COMPUTE POINTERS FOR ENDPOINT INFORMATION
      IF(FJDSEC.GT.FSCFR2.AND.FJDSEC.LT.FSCED2)GOTO 200
      IF(FJDSEC.GT.FSCBG2.AND.FJDSEC.LT.FSCFR1)GOTO 300
! COMPUTE BOTH ENDPOINTS
      JT=2
! IT IS POINTER FOR THE OCEAN TIDE A'S AND B'S
      IT=NET
! NPT IS THE POINTER FOR THE EARTH TIDE DOODSON COEFS
      NPT=0
      IPD=IFRSTP
      GO TO 500
!
  200 CONTINUE
! NEED NEW RIGHT-HAND ENDPOINT
      JT=1
      IT=NBAND+NET+NET
      NPT=NBAND+NET
! IGOTN AND IGOTO ARE THE POINTERS FOR SAVING OLD INFORMATION
      IGOTN=1
      IGOTO=NBB+1
      IPD=ISECDP
      GO TO 400
!
  300 CONTINUE
! NEED NEW LEFT-HAND ENDPOINT
      JT=1
      IT=NET
      NPT=0
      IGOTN=NBB+1
      IGOTO=1
      IPD=IFRSTP
  400 CONTINUE
!
! SHIFT PRECOMPUTED ENDPOINTS FROM RIGHT TO LEFT
      DO 450 NN = 1,NBB
         AJ(IGOTN+NN-1)=AJ(IGOTO+NN-1)
         BJ(IGOTN+NN-1)=BJ(IGOTO+NN-1)
  450 END DO
  500 CONTINUE
!
! UPDATE ENDPOINT TIMES
      FSCFR1=FSCINP(1)+DBLE(INPT)*DTINPD
      FSCFR2=FSCFR1+DTINPD
!
! CALCULATE ENDPOINT VALUES
      DO 900 J=1,JT
      CALL TIDEL(IPD)
      COSEPH=COS(HALF*EPSLON)
      SINEPH=SIN(HALF*EPSLON)
      RHO3=(A(1)/A(2))**3
      B(2)=RHO3*RMASS
      THGPI2=GHRANG(IPD)+PI*HALF
!
! CALCULATE DOODSON CONSTANT(GD), INC FUNC, ECC FUNC
!
      GD=QT*GM*RATIOM(1)*AESQ/(A(1)**3)
      IF(NET.LE.0)GOTO 700
!C    WRITE(6,*) 'TIDCON: KK, HH, FI(1,1) ', KK, HH, FI(1,1)
      CALL FINCL(2,KK,HH,FI(1,1   ))
!C    WRITE(6,*) 'TIDCON: KK, HH, FI(1,1) ', KK, HH, FI(1,1)
      CALL GEXC (2,HH,JJ,GE(1,1   ))
!
! CALCULATE ALL DOODSON COEFS AND SIDE BAND INFO FOR ETIDES
!
      DO 600 I=1,NET
      IP=I
      IF(I.GT.NETADJ)IP=IP+NOTADJ
      AJ(I+NPT) = ADOOD(COSEPH,SINEPH,ILL(IP),MM(IP),KK(IP),            &
     &                  HH(IP),JJ(IP),JJBDY(IP),                        &
     &                  SIGN1(IP),FI(1,I),GE(1,I))                      &
     &            * GD
      BJ(I+NPT)=ZERO
      IF(NOSIDE(IP).EQ.0)GOTO 600
      CALL AANDBE (AJ(I+NPT),BJ(I+NPT),MAINNN(I),ICENTR(I),             &
     &       COSEPH,SINEPH,THGPI2)
  600 END DO
  700 CONTINUE
!
! CALCULATE ALL DOODSON COEFS AND SIDE BAND INFO FOR OTIDES
      DO 800 I=1,NBAND
      II=I+NET
      CALL AANDBO (AJ(IT+I),BJ(IT+I),MAINNN(II),ICENTR(II),             &
     &             COSEPH,SINEPH,THGPI2)
      AJ(IT+I)=AJ(IT+I)*GD
      BJ(IT+I)=BJ(IT+I)*GD
  800 END DO
      IT=IT+NBAND+NET
      NPT=NPT+NBAND+NET
      IPD=IPD+1
  900 END DO
!
 1000 CONTINUE
!
! BEGIN ACTUAL INTERPOLATION
! FIND ELEMENTS OF SUN AND MOON
!
      CALL TIDEL(0)
      RHO3=(A(1)/A(2))**3
      B(2)=RHO3*RMASS
      THETG=THETAG
 1100 CONTINUE
      XLONG=XLAMDA
!
! INTERPOLATE A AND B
      DO 1200 I=1,NBB
      AT(I)=(AJ(NBB+I)-AJ(I))*XFRSTP+AJ(I)
      BT(I)=(BJ(NBB+I)-BJ(I))*XFRSTP+BJ(I)
 1200 END DO
!
! PUT THE A'S AND B'S INTO THE PROPER LOCATION
      DO 1300 I=1,NTIDE
      AB(I)=AT(ITIDE(I)-1)
      BA(I)=BT(ITIDE(I)-1)
 1300 END DO
!
      JSGRP=JSATID+NSTADJ
!
! CALL TIDACC TO COMPUTE THE TIDAL ACCELERATIONS
!
      CALL TIDACC(TIDES,TIDES(NTIDE+1),R,P,COEF,ILL1,XQQ,IPT,           &
     &          XIEXP,XMM,XLL1,XSIGN1,XSN2QQ,QQ,X2M2HH,X2M2HJ,XKK,JJBDY,&
     &          TEMP,LSATID,JSGRP,NEQN,XSIGN2,AB,BA,D,IIPPTT,           &
     &          ACCTR,GRPAR,AORN,IQNDEX,AA(KUNORM))
!
! ADD THE TIDAL ACCELERATIONS TO THE TOTAL ACCELERATIONS
!
!      IF( KENTRY .LT. 100) WRITE(6,*) 'TIDCON: ACCTR TIDAL ACC ',
!     1         ACCTR
      ACCTS(1)=ACCTS(1)+RMI(1)*ACCTR(1)+RMI(4)*ACCTR(2)+RMI(7)*ACCTR(3)
      ACCTS(2)=ACCTS(2)+RMI(2)*ACCTR(1)+RMI(5)*ACCTR(2)+RMI(8)*ACCTR(3)
      ACCTS(3)=ACCTS(3)+RMI(3)*ACCTR(1)+RMI(6)*ACCTR(2)+RMI(9)*ACCTR(3)
      RETURN
      END
