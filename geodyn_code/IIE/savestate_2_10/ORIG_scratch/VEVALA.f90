      SUBROUTINE VEVALA(PXA,PXDDTA,NEQNA,LFCALC,VMAT,NEQNS,PXDDTS,      &
     &                  LNOSAT,IASTP)
      IMPLICIT DOUBLE PRECISION (A-H,O-Z),LOGICAL(L)
      DIMENSION VMAT(3,6)
      DIMENSION PXA(NEQNA,3,2),PXDDTA(NEQNA,3),PXDDTS(NEQNS,3)
      COMMON/ASTSUN/BDAST(6),GMSAT,GEOPTS(3)
      COMMON/CGRAV/GM,AE,AESQ,FE,FFSQ32,FSQ32,XK2,XK3,XLAM,SIGXK2,      &
     &      SIGXK3,SIGLAM,RATIOM(2),AU,RPRESS
      COMMON/LDUAL/LASTSN,LSTSNX,LSTSNY
      COMMON/NPCOM /NPNAME,NPVAL(92),NPVAL0(92),IPVAL(92),IPVAL0(92),   &
     &              MPVAL(28),MPVAL0(28),NXNPCM
      COMMON/NPCOMX/IXARC ,IXSATP,IXDRAG,IXSLRD,IXACCL,IXGPCA,IXGPSA,   &
     &              IXAREA,IXSPRF,IXDFRF,IXEMIS,IXTMPA,IXTMPC,IXTIMD,   &
     &              IXTIMF,IXTHTX,IXTHDR,IXOFFS,IXBISA,IXFAGM,IXFAFM,   &
     &              IXATUD,IXRSEP,IXACCB,IXDXYZ,IXGPSBW,IXCAME,IXBURN,  &
     &              IXGLBL,IXGPC ,IXGPS, IXTGPC,IXTGPS,IXGPCT,IXGPST,   &
     &              IXTIDE,IXETDE,IXOTDE,IXOTPC,IXOTPS,IXLOCG,IXKF  ,   &
     &              IXGM  ,IXSMA ,IXFLTP,IXFLTE,IXPLTP,IXPLTV,IXPMGM,   &
     &              IXPMJ2,IXVLIT,IXEPHC,IXEPHT,IXH2LV,IXL2LV,IXOLOD,   &
     &              IXPOLX,IXPOLY,IXUT1 ,IXPXDT,IXPYDT,IXUTDT,IXVLBI,   &
     &              IXVLBV,IXXTRO,IXBISG,IXSSTF,IXFGGM,IXFGFM,IXLNTM,   &
     &              IXLNTA,IX2CCO,IX2SCO,IX2GM ,IX2BDA,IXRELP,IXJ2SN,   &
     &              IXGMSN,IXPLNF,IXPSRF,IXANTD,IXTARG,                 &
     &              IXSTAP,IXSSTC,IXSSTS,IXSTAV,IXSTL2,                 &
     &              IXSTH2,IXDPSI,IXEPST,IXCOFF,IXTOTL,NXNPCX
      COMMON/SETAGP/NAJCA,NAJSA,NAJCG,NAJSG,NAJCT,NAJST
      COMMON/SETAPT/                                                    &
     &       JSADRG(1),JSASRD(1),JSAGA(1),JFAADJ,JTHDRG,JACBIA,JATITD,  &
     &       JDSTAT,JDTUM ,                                             &
     &       JSACS, JSATID,JSALG,JSAGM,JSAKF,JSAXYP,JSADJ2,JSAPGM,      &
     &       JFGADJ,JLTPMU,JLTPAL,JL2CCO,JL2SCO,JL2GM,JLRELT,           &
     &       JLJ2SN,JLGMSN,JLPLFM,JL2AE,JSAXTO,JSABRN
!
      IUP=6
      IF(IASTP.EQ.1.AND.LSTSNX) IUP=NEQNA
      IF(IASTP.EQ.2.AND.LSTSNY) IUP=NEQNA
      IF(IUP.EQ.0) GO TO 500
      DO I=1,IUP
       DO J=1,3
        PXDDTA(I,J)=0.D0
       ENDDO
      ENDDO
!
 500  CONTINUE
      IF(.NOT.LFCALC) RETURN
! CALCULATE YDD
      DO 970 J=1,3
      DO 970 I=1,NEQNA
      PXDDTA(I,J)=PXDDTA(I,J)+VMAT(J,1)*PXA(I,1,1)                      &
     &           +VMAT(J,2)*PXA(I,2,1)+VMAT(J,3)*PXA(I,3,1)
  970 CONTINUE
      DO 980 J=1,3
      DO 980 I=1,NEQNA
      PXDDTA(I,J)=PXDDTA(I,J)+VMAT(J,4)*PXA(I,1,2)                      &
     &           +VMAT(J,5)*PXA(I,2,2)+VMAT(J,6)*PXA(I,3,2)
  980 CONTINUE
      RETURN
 6000 FORMAT(' EXECUTION TERMINATING. GEOPOTENTAL COEFFCIENTS ')
 6001 FORMAT(' IN A MULTISAT EPHEMERIS CORRECT RUN ')

      END
