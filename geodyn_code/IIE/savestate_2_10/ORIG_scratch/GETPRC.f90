!$GETPRC
      SUBROUTINE GETPRC(FACT)
      IMPLICIT DOUBLE PRECISION (A-H,O-Z),LOGICAL(L)
!
      COMMON/BIAOR/NAMBB,NCYCB,NAMBBH
      COMMON/CITERL/LSTGLB,LSTARC,LSTINR,LNADJ ,LITER1,LSTITR,          &
     &              LOBORB,LRESID,LFREEZ,LSAVEF,LHALT,LADJPI,LADJCI
      COMMON/CPMPA /KTMPAR(3)    ,KMBPAR(2)    ,KRFPAR(2)    ,          &
     &              KAEPAR,KFEPAR,KFPPAR,KVLPAR,KETPAR(2,2)  ,          &
     &              KPMPAR,KUTPAR,KSTPAR(3,4)  ,NADJST       ,          &
     &              NDIM1 ,NDIM2 ,NXDIM1,NXDIM2
      COMMON/PARPRC/NPROCS,NPROCI(5,10)
      DIMENSION NT(10),NT2(10),NT3(10),NT4(10)
!
!
!
      IF(NPROCS.LE.0) NPROCS=1
      IF(NPROCS.GT.10) NPROCS=10
      IF(NPROCS.EQ.1) THEN
         WRITE(6,6000)
         WRITE(6,6000)
         WRITE(6,6000)
         WRITE(6,6010)
         WRITE(6,6011)
         WRITE(6,6000)
         WRITE(6,6000)
         RETURN
      ENDIF
      NPX=NADJST-NAMBB
      FACTX=1.D0
      DO 10 I=1,NPROCS
      FACTX=FACTX*FACT
   10 END DO
!
      IF(FACT.GT.1.D0) THEN
        SUMX=(FACTX-1.D0)/(FACT-1.D0)
      ELSE
        SUMX=DBLE(NPROCS)
      ENDIF
      NPX2=NPX*(NPX+1)/2
      XROW2=DBLE(NPX2)/SUMX
      NP1=NPROCS-1
      XROW4=XROW2
!
      SCR=1.D0+8.D0*XROW4
      XROW=(-1.D0+SQRT(SCR))/2.D0
      NROW=XROW
!
      NPROCI(5,NPROCS)=NADJST
      NPROCI(4,NPROCS)=1+NADJST-NROW
!
      IPP=NP1
      XROW4T=XROW4
      DO 12 I=1,NP1
      XROW4=XROW4*FACT
      XROW4T=XROW4T+XROW4
      SCR=1.D0+8.D0*XROW4T
      XROW=(-1.D0+SQRT(SCR))/2.D0
      NROWX=XROW
      NROW=NROWX+1-(NPROCI(5,NPROCS)-NPROCI(4,IPP+1))
      NPROCI(5,IPP)=NPROCI(4,IPP+1)-1
      NPROCI(4,IPP)=NPROCI(5,IPP)-NROW+1
      IPP=IPP-1
   12 END DO
      NPROCI(4,1)=NAMBB+1
!
      NPROCI(1,1)=NPX
      NPROCI(2,1)=NAMBB*(NADJST-NAMBB+1)
      NPROCI(3,1)=NAMBB
!
!
      DO 20 IPROC=2,NPROCS
      IL=NPROCI(1,IPROC-1)
      ISROW=NPROCI(2,IPROC-1)
      ISP=NPROCI(3,IPROC-1)
      IS=NPROCI(4,IPROC-1)
      IE=NPROCI(5,IPROC-1)
      DO 15 I=IS,IE
      ISROW=ISROW+IL
      ISP=ISP+1
      IL=IL-1
   15 END DO
!
      NPROCI(1,IPROC)=IL
      NPROCI(2,IPROC)=ISROW
      NPROCI(3,IPROC)=ISP
   20 END DO
!
      IF(.NOT.LSTINR) RETURN
      WRITE(6,6000)
      WRITE(6,6000)
      WRITE(6,6000)
      WRITE(6,6020) NPROCS
      WRITE(6,6021)
      WRITE(6,6022)
      WRITE(6,6000)
      WRITE(6,6023)
      WRITE(6,6000)
      DO 30 IPROC=1,NPROCS
      WRITE(6,6024) IPROC,NPROCI(4,IPROC),NPROCI(5,IPROC)
   30 END DO
      WRITE(6,6000)
      WRITE(6,6000)
      DO 120 I=1,NPROCS
      NT(I)=1+NPROCI(5,NPROCS)-NPROCI(4,I)
      NT2(I)=NT(I)*(NT(I)+1)/2
  120 END DO
      NX1=NPROCS-1
      DO 140 I=1,NX1
      NT3(I)=NT(I)-NT(I+1)
      NT4(I)=NT2(I)-NT2(I+1)
  140 END DO
      NT3(NPROCS)=NT(NPROCS)
      NT4(NPROCS)=NT2(NPROCS)
      DO 150 I=1,NPROCS
      WRITE(6,6025) I,NT3(I),NT4(I)
  150 END DO
      WRITE(6,6000)
      WRITE(6,6000)
      WRITE(6,6026) FACT
      WRITE(6,6027)
      WRITE(6,6000)
      WRITE(6,6000)
      RETURN
 6000 FORMAT(' ')
 6010 FORMAT(' THE NORMAL MATRIX IS NOT BEING SUBDIVIDED')
 6011 FORMAT(' NOTHING TO BE GAINED FROM MULTIPROCESSING')
 6020 FORMAT(' ',I5,' PROCESSORS HAVE BEEN REQUESTED')
 6021 FORMAT(' THEY WILL BE USED TO DIVIDE THE PORTION OF THE NORMAL')
 6022 FORMAT(' MATRIX THAT DOES NOT BELONG TO AMBIGUITY BIASES')
 6023 FORMAT(' THE MATRIX WILL BE DIVIDED AS FOLLOWS:')
 6024 FORMAT(' PROCESSOR # ',I2,' HAS ROWNO ',I6,' THRU ROWNO ',I6)
 6025 FORMAT('  PROCNO ',I4,' ROWS INSG : ',I10,' ENTRIES INSG  ',I10)
 6026 FORMAT('  TO GET THIS BALANCE OF ENTRIES A FACTOR OF ',F10.3)
 6027 FORMAT('  WAS USED ')
      END
