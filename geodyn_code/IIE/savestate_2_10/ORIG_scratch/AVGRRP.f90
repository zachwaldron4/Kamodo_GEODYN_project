!$AVGRRP
      SUBROUTINE AVGRRP(AA,PMPA,OBSC,TPARTL,DTIME,NM,NADJST)
!********1*********2*********3*********4*********5*********6*********7**
! AVGRRP           00/00/00            0000.0    PGMR - ?
!
!
! FUNCTION:
!
! I/O PARAMETERS:
!
!   NAME    I/O  A/S   DESCRIPTION OF PARAMETERS
!   ------  ---  ---   ------------------------------------------------
!   AA
!   PMPA
!   OBSC
!   TPARTL
!   DTIME
!   NM
!   NADJST
!
!
! COMMENTS:
!
!********1*********2*********3*********4*********5*********6*********7**
      IMPLICIT DOUBLE PRECISION (A-H,O-Z),LOGICAL(L)
      SAVE
! /CITERL/ SWITCHES INDICATING ITERATION AND ARC LOOP TERMINATION
      COMMON/CITERL/LSTGLB,LSTARC,LSTINR,LNADJ ,LITER1,LSTITR,          &
     &              LOBORB,LRESID,LFREEZ,LSAVEF,LHALT,LADJPI,LADJCI
! /COBBUF/ OBSERVATION BLOCK POINTERS
      COMMON/COBBUF/IOBSBF,IBUF1 ,IBUF2 ,IWORD1,NHEADR,NWORDM
! /COBLOC/ OBSERVATION BLOCK DYNAMIC ARRAY POINTERS
!          STATION INFORMATION POINTERS TO COORDINATE SYSTEM ARRAYS
      COMMON/COBLOC/KXMN  (3,4)  ,KENVN (3,4)  ,KSTINF(3,4)  ,          &
     &       KOBS  ,KDTIME,KSMCOR,KSMCR2,KTMCOR,KOBTIM,KOBSIG,KOBSG2,   &
     &       KIAUNO,KOBCOR(9,7)  ,KFSECS(6,8)  ,KOBSUM(8)    ,          &
     &       KEDSIG,KEDSG2
      COMMON/CPRESW/LPRE9 (24),LPRE  (24,3),LSWTCH(10,8),LOBSIN,LPREPW, &
     &              LFS   (40)
      DIMENSION AA(1),PMPA(NADJST,NM),OBSC(NM),TPARTL(NM),DTIME(NM)
      DATA ONE/1.0D0/
!
!***********************************************************************
! START OF EXECUTABLE CODE *********************************************
!***********************************************************************
!
! DIVIDE MEASUREMENTS AND TIME DERIVATIVES BY DOPPLER COUNTING INTERVAL
      DO 1000 M=1,NM
      OBSC(M)  =-OBSC(M)  /DTIME(M)
      TPARTL(M)=-TPARTL(M)/DTIME(M)
 1000 END DO
      IF(LNADJ) GO TO 4000
! DIVIDE PARTIALS BY DOPPLER COUNTING INTERVAL
      DO 3000 M=1,NM
      DTINV=ONE/DTIME(M)
      DO 2000 N=1,NADJST
      PMPA(N,M)=-PMPA(N,M)*DTINV
 2000 END DO
 3000 END DO
 4000 CONTINUE
      IF(.NOT.LITER1) RETURN
! DIVIDE MEASUREMENT CORRECTIONS BY DOPPLER COUNTING INTERVAL
      DO 7000 IHEADR=2,NHEADR
      JHEADR=IHEADR-1
      DO 6000 IWORD =2,8
      IF(LPRE  (IWORD ,JHEADR)) GO TO 6000
      IF(.NOT.LSWTCH(IWORD ,IHEADR)) GO TO 6000
      JOBCOR=KOBCOR(IWORD ,JHEADR)
      DO 5000 M=1,NM
      AA(JOBCOR)=-AA(JOBCOR)/DTIME(M)
      JOBCOR=JOBCOR+1
 5000 END DO
 6000 END DO
 7000 END DO
      RETURN
      END
