      SUBROUTINE  UCL_JASON_all(xbus,ybus,zbus,                       &
     &                          xpr,ypr,zpr,                          &
     &                          xpl,ypl,zpl,                          &
     &                          RPS ,acc,MJDSEC,FSEC,ratiop,GRPAR,    &
     &                          ROT,KPART,NEQN,PARMVC,SCALE )
!-----------------------------------

      IMPLICIT DOUBLE PRECISION (A-H,O-Z),LOGICAL(L)
!
      COMMON/CRMI/RMI(9)
      COMMON/NPCOM /NPNAME,NPVAL(92),NPVAL0(92),IPVAL(92),IPVAL0(92),   &
     &              MPVAL(28),MPVAL0(28),NXNPCM
      COMMON/NPCOMX/IXARC ,IXSATP,IXDRAG,IXSLRD,IXACCL,IXGPCA,IXGPSA,   &
     &              IXAREA,IXSPRF,IXDFRF,IXEMIS,IXTMPA,IXTMPC,IXTIMD,   &
     &              IXTIMF,IXTHTX,IXTHDR,IXOFFS,IXBISA,IXFAGM,IXFAFM,   &
     &              IXATUD,IXRSEP,IXACCB,IXDXYZ,IXGPSBW,IXCAME,IXBURN,  &
     &              IXGLBL,IXGPC ,IXGPS, IXTGPC,IXTGPS,IXGPCT,IXGPST,   &
     &              IXTIDE,IXETDE,IXOTDE,IXOTPC,IXOTPS,IXLOCG,IXKF  ,   &
     &              IXGM  ,IXSMA ,IXFLTP,IXFLTE,IXPLTP,IXPLTV,IXPMGM,   &
     &              IXPMJ2,IXVLIT,IXEPHC,IXEPHT,IXH2LV,IXL2LV,IXOLOD,   &
     &              IXPOLX,IXPOLY,IXUT1 ,IXPXDT,IXPYDT,IXUTDT,IXVLBI,   &
     &              IXVLBV,IXXTRO,IXBISG,IXSSTF,IXFGGM,IXFGFM,IXLNTM,   &
     &              IXLNTA,IX2CCO,IX2SCO,IX2GM ,IX2BDA,IXRELP,IXJ2SN,   &
     &              IXGMSN,IXPLNF,IXPSRF,IXANTD,IXTARG,                 &
     &              IXSTAP,IXSSTC,IXSSTS,IXSTAV,IXSTL2,                 &
     &              IXSTH2,IXDPSI,IXEPST,IXCOFF,IXTOTL,NXNPCX
      DOUBLE PRECISION mass
!     value of one Astronomical Unit in m
      PARAMETER(oneAU=149597870691.D0)
      COMMON/CONSTR/PI,TWOPI,DEGRAD,SECRAD,SECDAY
      DIMENSION acc(3),DMASS(2,288),DUMMY(288),FSECOT(288),MASST(288)
      DIMENSION GRPAR(NEQN,3),ROT(9),FACT(3)
      DIMENSION PARMVC(1)
      DATA IMASS/288/
      DATA DUMMY/288*0.D0/
      DATA DMASS/                                        &
     &     1922367983.0000,             -0.2000,         &
     &     1922865142.0000,             -0.2040,         &
     &     1923038881.0000,             -0.2170,         &
     &     1923386301.0000,             -0.8350,         &
     &     1923645769.0000,             -1.4520,         &
     &     1925390971.0000,             -1.6950,         &
     &     1936020330.0000,             -1.6970,         &
     &     1936106691.0000,             -1.7030,         &
     &     1936189013.0000,             -1.7030,         &
     &     1936270915.0000,             -1.7060,         &
     &     1936877354.0000,             -1.7040,         &
     &     1937485713.0000,             -1.7120,         &
     &     1937487803.0000,             -1.7120,         &
     &     1938095944.0000,             -1.7190,         &
     &     1938692400.0000,             -1.7220,         &
     &     1938699230.0000,             -1.7220,         &
     &     1939301473.0000,             -1.7160,         &
     &     1939902918.0000,             -1.7160,         &
     &     1940331368.0000,             -1.7120,         &
     &     1940420014.0000,             -1.7000,         &
     &     1940509130.0000,             -1.7000,         &
     &     1940510102.0000,             -1.7000,         &
     &     1941112978.0000,             -1.6970,         &
     &     1941719694.0000,             -1.7090,         &
     &     1942328661.0000,             -1.7190,         &
     &     1942929482.0000,             -1.7420,         &
     &     1943528577.0000,             -1.7390,         &
     &     1944062939.0000,             -1.7320,         &
     &     1944221872.0000,             -1.7350,         &
     &     1944741412.0000,             -1.7290,         &
     &     1945343640.0000,             -1.7190,         &
     &     1945954140.0000,             -1.7060,         &
     &     1946556476.0000,             -1.7040,         &
     &     1946899831.0000,             -1.7150,         &
     &     1946982178.0000,             -1.7190,         &
     &     1947066452.0000,             -1.7190,         &
     &     1947244324.0000,             -1.7190,         &
     &     1947768412.0000,             -1.7250,         &
     &     1948375460.0000,             -1.7390,         &
     &     1948969233.0000,             -1.7360,         &
     &     1949580390.0000,             -1.7420,         &
     &     1950183204.0000,             -1.7290,         &
     &     1950270618.0000,             -1.7250,         &
     &     1950517368.0000,             -1.7220,         &
     &     1950623468.0000,             -1.7190,         &
     &     1950690577.0000,             -1.7220,         &
     &     1950777316.0000,             -1.7220,         &
     &     1951382690.0000,             -1.7030,         &
     &     1952001244.0000,             -1.7040,         &
     &     1952592606.0000,             -1.7190,         &
     &     1953196981.0000,             -1.7250,         &
     &     1953801991.0000,             -1.7290,         &
     &     1954418379.0000,             -1.7260,         &
     &     1954491243.0000,             -1.7260,         &
     &     1954751347.0000,             -1.7290,         &
     &     1954838354.0000,             -1.7250,         &
     &     1954935622.0000,             -1.7250,         &
     &     1955011322.0000,             -1.7290,         &
     &     1955633220.0000,             -1.7120,         &
     &     1956232428.0000,             -1.7130,         &
     &     1956832434.0000,             -1.7260,         &
     &     1957438040.0000,             -1.7320,         &
     &     1957441104.0000,             -1.7320,         &
     &     1958041412.0000,             -1.7450,         &
     &     1958043796.0000,             -1.7450,         &
     &     1958653633.0000,             -1.7420,         &
     &     1959260698.0000,             -1.7420,         &
     &     1959695916.0000,             -1.7480,         &
     &     1959773841.0000,             -1.7410,         &
     &     1959861193.0000,             -1.7440,         &
     &     1959952623.0000,             -1.7350,         &
     &     1960110694.0000,             -1.7280,         &
     &     1960467918.0000,             -1.7280,         &
     &     1961074207.0000,             -1.7210,         &
     &     1961676093.0000,             -1.7090,         &
     &     1962281001.0000,             -1.7250,         &
     &     1962883288.0000,             -1.7280,         &
     &     1963479756.0000,             -1.7450,         &
     &     1964095168.0000,             -1.7450,         &
     &     1964697237.0000,             -1.7450,         &
     &     1965039891.0000,             -1.7380,         &
     &     1965124013.0000,             -1.7350,         &
     &     1965215715.0000,             -1.7350,         &
     &     1965296729.0000,             -1.7320,         &
     &     1965733561.0000,             -1.7310,         &
     &     1965819602.0000,             -1.7280,         &
     &     1965907483.0000,             -1.7280,         &
     &     1965988683.0000,             -1.7220,         &
     &     1966078942.0000,             -1.7320,         &
     &     1966426942.0000,             -1.7090,         &
     &     1966587526.0000,             -1.7120,         &
     &     1967027645.0000,             -1.7070,         &
     &     1967719863.0000,             -1.7250,         &
     &     1968325111.0000,             -1.7310,         &
     &     1968843641.0000,             -1.7370,         &
     &     1969532992.0000,             -1.7310,         &
     &     1970141053.0000,             -1.7250,         &
     &     1970745915.0000,             -1.7340,         &
     &     1971094550.0000,             -1.7150,         &
     &     1971175099.0000,             -1.7150,         &
     &     1971349622.0000,             -1.7180,         &
     &     1971957083.0000,             -1.7310,         &
     &     1972562852.0000,             -1.7350,         &
     &     1973168459.0000,             -1.7510,         &
     &     1973770246.0000,             -1.7510,         &
     &     1974377681.0000,             -1.7410,         &
     &     1974980936.0000,             -1.7510,         &
     &     1975581944.0000,             -1.7380,         &
     &     1976189056.0000,             -1.7350,         &
     &     1976797539.0000,             -1.7150,         &
     &     1977395837.0000,             -1.7380,         &
     &     1978008569.0000,             -1.7410,         &
     &     1978604796.0000,             -1.7540,         &
     &     1979213866.0000,             -1.7630,         &
     &     1979559762.0000,             -1.7570,         &
     &     1979640035.0000,             -1.7570,         &
     &     1979740988.0000,             -1.7570,         &
     &     1979821925.0000,             -1.7630,         &
     &     1980422821.0000,             -1.7440,         &
     &     1981030492.0000,             -1.7350,         &
     &     1981631395.0000,             -1.7370,         &
     &     1982238593.0000,             -1.7290,         &
     &     1982842594.0000,             -1.7440,         &
     &     1983450040.0000,             -1.7440,         &
     &     1983800990.0000,             -1.7480,         &
     &     1983957605.0000,             -1.7440,         &
     &     1984144170.0000,             -1.7440,         &
     &     1988892580.0000,             -1.7940,         &
     &     1992333797.0000,             -1.7450,         &
     &     1992422502.0000,             -1.7520,         &
     &     1992521544.0000,             -1.7580,         &
     &     1993131064.0000,             -1.7690,         &
     &     1993735962.0000,             -1.7760,         &
     &     1994077579.0000,             -1.7890,         &
     &     1994159347.0000,             -1.7890,         &
     &     1994163655.0000,             -1.7890,         &
     &     1994248870.0000,             -1.7890,         &
     &     1994333708.0000,             -1.7890,         &
     &     1994409437.0000,             -1.7890,         &
     &     1994940865.0000,             -1.7890,         &
     &     1995541459.0000,             -1.7700,         &
     &     1996144674.0000,             -1.7700,         &
     &     1996753181.0000,             -1.7510,         &
     &     1997345531.0000,             -1.7490,         &
     &     1997957902.0000,             -1.7640,         &
     &     1998562057.0000,             -1.7600,         &
     &     1999168640.0000,             -1.7690,         &
     &     1999173906.0000,             -1.7690,         &
     &     1999689350.0000,             -1.7660,         &
     &     2000381896.0000,             -1.7660,         &
     &     2000982619.0000,             -1.7670,         &
     &     2001589326.0000,             -1.7500,         &
     &     2001676499.0000,             -1.7470,         &
     &     2001932863.0000,             -1.7540,         &
     &     2002020211.0000,             -1.7480,         &
     &     2002108576.0000,             -1.7540,         &
     &     2002194898.0000,             -1.7550,         &
     &     2002800604.0000,             -1.7730,         &
     &     2002886223.0000,             -1.7730,         &
     &     2003489268.0000,             -1.7860,         &
     &     2004005855.0000,             -1.7890,         &
     &     2004611720.0000,             -1.7820,         &
     &     2004678385.0000,             -1.7820,         &
     &     2004679395.0000,             -1.7820,         &
     &     2004696878.0000,             -1.7820,         &
     &     2004937584.0000,             -1.7820,         &
     &     2004944335.0000,             -1.7820,         &
     &     2005028692.0000,             -1.7860,         &
     &     2005219672.0000,             -1.7890,         &
     &     2005821241.0000,             -1.7760,         &
     &     2005912472.0000,             -1.7760,         &
     &     2006166436.0000,             -1.7700,         &
     &     2006255220.0000,             -1.7660,         &
     &     2006343588.0000,             -1.7690,         &
     &     2006426334.0000,             -1.7630,         &
     &     2007031981.0000,             -1.7540,         &
     &     2007639156.0000,             -1.7480,         &
     &     2008240538.0000,             -1.7630,         &
     &     2008845955.0000,             -1.7730,         &
     &     2008923329.0000,             -1.7700,         &
     &     2008929713.0000,             -1.7700,         &
     &     2009448270.0000,             -1.7880,         &
     &     2010054189.0000,             -1.7920,         &
     &     2010659473.0000,             -1.7790,         &
     &     2011264075.0000,             -1.7660,         &
     &     2011870552.0000,             -1.7660,         &
     &     2012216109.0000,             -1.7500,         &
     &     2012301268.0000,             -1.7470,         &
     &     2012395074.0000,             -1.7630,         &
     &     2012475087.0000,             -1.7480,         &
     &     2013079500.0000,             -1.7660,         &
     &     2013682798.0000,             -1.7660,         &
     &     2014290876.0000,             -1.7690,         &
     &     2014811297.0000,             -1.7730,         &
     &     2015504784.0000,             -1.7660,         &
     &     2016022387.0000,             -1.7690,         &
     &     2016715473.0000,             -1.7540,         &
     &     2017315734.0000,             -1.7480,         &
     &     2017925821.0000,             -1.7660,         &
     &     2018523934.0000,             -1.7690,         &
     &     2019129736.0000,             -1.7950,         &
     &     2019736120.0000,             -1.7750,         &
     &     2020338907.0000,             -1.7880,         &
     &     2020676446.0000,             -1.7950,         &
     &     2020770894.0000,             -1.7950,         &
     &     2020847226.0000,             -1.8010,         &
     &     2020950117.0000,             -1.7820,         &
     &     2021559490.0000,             -1.7690,         &
     &     2022155511.0000,             -1.7630,         &
     &     2022758165.0000,             -1.7640,         &
     &     2023363120.0000,             -1.7690,         &
     &     2023972421.0000,             -1.7760,         &
     &     2024578522.0000,             -1.8010,         &
     &     2025182317.0000,             -1.7950,         &
     &     2025782584.0000,             -1.7720,         &
     &     2026386087.0000,             -1.7690,         &
     &     2026986244.0000,             -1.7630,         &
     &     2027595036.0000,             -1.7470,         &
     &     2028202948.0000,             -1.7730,         &
     &     2028806704.0000,             -1.7730,         &
     &     2029415637.0000,             -1.7660,         &
     &     2029927610.0000,             -1.7690,         &
     &     2030629559.0000,             -1.7590,         &
     &     2031223976.0000,             -1.7630,         &
     &     2031830564.0000,             -1.7520,         &
     &     2032435968.0000,             -1.7570,         &
     &     2033037647.0000,             -1.7660,         &
     &     2033644838.0000,             -1.7720,         &
     &     2033654227.0000,             -1.7720,         &
     &     2034251211.0000,             -1.7890,         &
     &     2034258570.0000,             -1.7890,         &
     &     2034860589.0000,             -1.7720,         &
     &     2035465212.0000,             -1.7760,         &
     &     2035978173.0000,             -1.7820,         &
     &     2036671691.0000,             -1.7650,         &
     &     2037279526.0000,             -1.7590,         &
     &     2037880015.0000,             -1.7510,         &
     &     2038481572.0000,             -1.7630,         &
     &     2039087391.0000,             -1.7660,         &
     &     2039694435.0000,             -1.7660,         &
     &     2040295239.0000,             -1.7820,         &
     &     2040902851.0000,             -1.7750,         &
     &     2041509946.0000,             -1.7620,         &
     &     2042010294.0000,             -1.7520,         &
     &     2042025111.0000,             -1.7520,         &
     &     2042032358.0000,             -1.7520,         &
     &     2042118800.0000,             -1.7520,         &
     &     2042198536.0000,             -1.7520,         &
     &     2042460245.0000,             -1.7520,         &
     &     2042716640.0000,             -1.7190,         &
     &     2043242508.0000,             -1.7170,         &
     &     2043319559.0000,             -1.7270,         &
     &     2043926602.0000,             -1.7380,         &
     &     2044531625.0000,             -1.7390,         &
     &     2045139237.0000,             -1.7520,         &
     &     2045742025.0000,             -1.7490,         &
     &     2046349290.0000,             -1.7390,         &
     &     2046956693.0000,             -1.7320,         &
     &     2046962799.0000,             -1.7320,         &
     &     2047303589.0000,             -1.7360,         &
     &     2047391810.0000,             -1.7160,         &
     &     2047464543.0000,             -1.7220,         &
     &     2047559819.0000,             -1.7200,         &
     &     2048161143.0000,             -1.7330,         &
     &     2048767307.0000,             -1.7330,         &
     &     2049368605.0000,             -1.7530,         &
     &     2049719125.0000,             -1.7490,         &
     &     2049801763.0000,             -1.7520,         &
     &     2049889786.0000,             -1.7520,         &
     &     2049976306.0000,             -1.7490,         &
     &     2050059718.0000,             -1.7490,         &
     &     2050582754.0000,             -1.7450,         &
     &     2051183428.0000,             -1.7550,         &
     &     2051791310.0000,             -1.7350,         &
     &     2052396609.0000,             -1.7290,         &
     &     2052998767.0000,             -1.7190,         &
     &     2053086311.0000,             -1.7230,         &
     &     2053349097.0000,             -1.7170,         &
     &     2053430377.0000,             -1.7170,         &
     &     2053517577.0000,             -1.7200,         &
     &     2053606346.0000,             -1.7300,         &
     &     2054211633.0000,             -1.7350,         &
     &     2054812661.0000,             -1.7450,         &
     &     2055159891.0000,             -1.7520,         &
     &     2055244099.0000,             -1.7550,         &
     &     2055416271.0000,             -1.7580,         &
     &     2056021620.0000,             -1.7520,         &
     &     2056029552.0000,             -1.7520     /

      GOTO 888
      DO J=1,IMASS
      MASST(J)=AINT(DMASS(1,J))
      ENDDO
! CONVERT UTC TIMES TO ET
      CALL UTCET(.TRUE.,288,MASST,DUMMY,FSECOT,DUMMY)

! FIND AND INTERPOLATE MASS
      TCURR=DBLE(MJDSEC)+FSEC

      DO J=1,IMASS
      DMASS(1,J)=MASST(J)+FSECOT(J)
      ENDDO

      DO 10 J=1,IMASS-1
      IF(DMASS(1,J).LT.TCURR.AND.DMASS(1,J+1).GT.TCURR) THEN
      DMASS1=DMASS(2,J)
      DMASS2=DMASS(2,J+1)
      IFOUND=J
      ENDIF
 10   CONTINUE

!     write(6,*)' dbg FOUND ', DMASS(1,IFOUND),DMASS(2,IFOUND),IFOUND
!     write(6,*)' dbg2FOUND ', DMASS(1,IFOUND+1),DMASS(2,IFOUND+1),   &
!    &                        IFOUND+1

      RATIO=(TCURR-DMASS(1,IFOUND))/(DMASS(1,IFOUND+1)-DMASS(1,IFOUND))
      FACTR=DMASS(2,IFOUND+1)-DMASS(2,IFOUND)
      MASS= 489.1D0+(RATIO*FACTR+DMASS(2,IFOUND))
!     write(6,*)' dbg orig mass, curr mass ',489.1,MASS
!     write(6,*)' dbg oneAU sat-sun dist ',oneAU,RPS
888   CONTINUE
!   NPZ
      MASS=481.1D0
!   INTERPOLATED
!     MASS=487.4049D0

      x=xbus+xpr+xpl
      y=ybus+ypr+ypl
      z=zbus+zpr+zpl

      acc(1)=ratiop*(oneAU**2.D0/RPS**2.D0)*( 489.1D0/mass ) * x
      acc(2)=ratiop*(oneAU**2.D0/RPS**2.D0)*( 489.1D0/mass ) * y
      acc(3)=ratiop*(oneAU**2.D0/RPS**2.D0)*( 489.1D0/mass ) * z
!
!     FILL UP PARTIALS
! GOTO TOD
       X1=ROT(1)*ACC(1) + ROT(4)*ACC(2) + ROT(7)*ACC(3)
       Y1=ROT(2)*ACC(1) + ROT(5)*ACC(2) + ROT(8)*ACC(3)
       Z1=ROT(3)*ACC(1) + ROT(6)*ACC(2) + ROT(9)*ACC(3)
!      write(6,*)'dbg TOTAL TOD ACCEL all ',X1,Y1,Z1

! GOTO TOR
      FACT(1)=X1*RMI(1)+Y1*RMI(2)+Z1*RMI(3)
      FACT(2)=X1*RMI(4)+Y1*RMI(5)+Z1*RMI(6)
      FACT(3)=X1*RMI(7)+Y1*RMI(8)+Z1*RMI(9)
!
      IND=IPVAL0(IXSLRD)
      SCALE=PARMVC(IND)
!     GRPAR(KPART,1)=PARMVC(IND)*FACT(1)
!     GRPAR(KPART,2)=PARMVC(IND)*FACT(2)
!     GRPAR(KPART,3)=PARMVC(IND)*FACT(3)
      GRPAR(KPART,1)=SCALE*FACT(1)
      GRPAR(KPART,2)=SCALE*FACT(2)
      GRPAR(KPART,3)=SCALE*FACT(3)
!     write(6,*)' dbg all GRPAR ',GRPAR(KPART,1),GRPAR(KPART,2),   &
!    &                              GRPAR(KPART,3),NEQN,KPART


      RETURN
      END
