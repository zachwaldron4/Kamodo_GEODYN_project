!$PDFILE
      SUBROUTINE PDFILE(IYMD,IHM,SEC,OBSTIM,OBS,TIMCOR,SUMCOR,          &
     &   OCEANP,XOVRKY,DTIME,RESID,OBSWT,FSECM,XSM,VSM,SATLAT,SATLON,   &
     &   SATH,XLAT,XLON,XHIT,XTHG,INDSAT,INDSYS,PARTL,PMPA,AA,II,LL,    &
     &   UTDT)
!********1*********2*********3*********4*********5*********6*********7**
! PDFILE           86/06/03            8606.0    PGMR - TOM MARTIN
!
! FUNCTION:  CREATE OBSERVATION PARTIAL DERIVATIVE FILE RECORDS
!            FOR ONE BLOCK OF OBSERVATIONS.
!
! I/O PARAMETERS:
!
!   NAME    I/O  A/S   DESCRIPTION OF PARAMETERS
!   ------  ---  ---   ------------------------------------------------
!   IYMD     I    A    CALENDAR DATES OF OBSERVATIONS IN BLOCK.
!   IHM      I    A    HOURS AND MINUTES OBS. UTC TIMES.
!   SEC      I    A    UTC SECONDS OF OBSERVATION TIMES.
!   OBSTIM   I    A    ELAPSED SECONDS ET FROM BLOCK START TIME
!                      FOR ALL OBSERVATIONS IN BLOCK.
!   OBS      I    A    OBSERVATION VALUES.
!   TIMCOR   I    A    SUM OF OBSERVATION TIME CORRECTIONS.
!   SUMCOR   I    A    SUM OF OBSERVATION CORRECTIONS.
!   OCEANP   I    A    SUM OF OCEAN PARAMETERS FOR ALTIMETER OBS.
!   XOVRKY   I    A    ALTIMETER CROSSOVER PAIRING KEYS.
!   DTIME    I    A    COUNTING INTERVAL FOR AVERAGE RANGE RATE.
!   RESID    I    A    OBSERVATION RESIDUALS (O-C).
!   OBSWT    I    A    OBSERVATION WEIGHTS (1/SIGMA**2).
!                      ZERO IF OBS. EDITED.
!   FSECM    I    A    ELAPSED SECONDS ET FROM BLOCK START TIME
!                      FOR S/C EPHEMERIS INFORMATION.
!   XSM      I    A    INERTIAL S/C POSITION FOR ALL OBS IN BLOCK
!   VSM      I    A    INERTIAL S/C VELOCITY FOR ALL OBS IN BLOCK
!   SATLAT   I    A    GEODETIC LATITUDE OF S/C FOR ALL OBS.
!   SATLON   I    A    EAST LONGITUDE OF S/C FOR ALL OBS.
!   SATH     I    A    ELLIPSOIDAL HEIGHT OF S/C FOR ALL OBS.
!   XLAT    I/O   A    TEMPORARY STORAGE OF S/C GEODETIC LATITUDES.
!   XLON    I/O   A    TEMPORARY STORAGE OF S/C EAST LONGITUDES.
!   XHIT    I/O   A    TEMPORARY STOR. OF S/C ELLIPSOIDAL HEIGHTS.
!   XTHG    I/O   A    TEMPORARY STOR. OF R.A. GREENWICH.
!   INDSAT   I    S    INDICES OF S/C TRACKING CONFIGURATION.
!   INDSYS   I    S    OBSERVATION TIME SYSTEM INDICATOR.
!   PARTL   I/O   A    TEMPORARY STOR. OF ONE OBS' PARTIAL DERIV.
!   PMPA     I    A    OBSERVATION PARTIAL DERIVATIVES.
!   AA      I/O   A    DYNAMIC ARRAY FOR REAL    DATA
!   II      I/O   A    DYNAMIC ARRAY FOR INTEGER DATA
!   LL      I/O   A    DYNAMIC ARRAY FOR LOGICAL DATA
!
! COMMENTS:
!   05/20/2011
!   UPDATED FOR PAIRED MEASUREMENT TYPES BY: SARA CORBITT_SANDERS
!********1*********2*********3*********4*********5*********6*********7**
      IMPLICIT DOUBLE PRECISION (A-H,O-Z),LOGICAL(L)
      SAVE
!
      COMMON/CBINRI/NSATB,NSTAB,INMSAT(3),INMSTA(3)
      COMMON/CBLOKI/MJDSBL,MTYPE ,NM    ,JSTATS,NPSEG ,JSATNO(3),ITSYS ,&
     &       NHEADB,NELEVS,ISTAEL(12),INDELV(3,4),JSTANO(3),ITARNO,     &
     &       KTARNO
      COMMON/CBLOKL/LIGHT ,LNRATE,LNREFR,LPOLAD,LTDRIV,LNANT ,LNTRAK,   &
     &       LASER ,LGPART,LGEOID,LETIDE,LOTIDE,LNTIME,LAVGRR,LRANGE,   &
     &       LSSTMD,LSSTAJ,LNTDRS,LPSBL,LACC,LAPP,LTARG,LTIEOU,LEOTRM,  &
     &       LSURFM,LGEOI2,LSSTM2,LOTID2,LOTRM2,LETID2,LNUTAD
      COMMON/CESTML/LNPNM ,NXCSTL
      COMMON/CLIGHT/VLIGHT,ERRLIM,XCLITE
      COMMON/CNIGLO/MINTIM,MSATG3,MEQNG ,MEQNG3,MSATG ,MSATOB,MSATA ,   &
     &              MSATA3,MSETA ,MINTVL,MSORDR,MSORDV,NMXORD,          &
     &       MCIPV ,MXBACK,MXI   ,MPXPF ,MAXAB ,MSETDG,MXSATD,          &
     &       MXDEGS,MXDRP ,MXDRPA,MXSRP ,MXSRPA,MXGAP ,MSATDR,          &
     &       MSATSR,MSATGA,MXDRPD,MXSRPD,MXGAPD,MXBCKP,MXTPMS,          &
     &       NSTAIN,NXCNIG
      COMMON/COBGLO/MABIAS,MCBIAS,MPVECT,MINTPL,MPARAM,MSTA,MOBBUF,     &
     &       MNPITR,MWIDTH,MSIZE ,MPART ,MBUF  ,NXCOBG
      COMMON/COBLOC/KXMN  (3,4)  ,KENVN (3,4)  ,KSTINF(3,4)  ,          &
     &       KOBS  ,KDTIME,KSMCOR,KSMCR2,KTMCOR,KOBTIM,KOBSIG,KOBSG2,   &
     &       KIAUNO,KOBCOR(9,7)  ,KFSECS(6,8)  ,KOBSUM(8)    ,          &
     &       KEDSIG,KEDSG2
      COMMON/CORA01/KFSEC0,KFSECB,KFSEC ,KFSECV,KH    ,KHV   ,KCTOL ,   &
     &              KRSQ  ,KVMATX,KCPP  ,KCPV  ,KCCP  ,KCCV  ,KCCPV ,   &
     &              KCCVV ,KXPPPP,KX    ,KPX   ,KSUMX ,KXDDOT,KSUMPX,   &
     &              KPXDDT,KAB   ,KPN   ,KAORN ,KSINLM,KCOSLM,KTANPS,   &
     &              KCRPAR,KVRARY,KXM   ,KXNP1 ,KXPRFL,KXM2  ,KXNNP1,   &
     &              KWRK  ,KFI   ,KGE   ,KB0DRG,KBDRAG,KAPGM ,KAPLM ,   &
     &              KCN   ,KSN   ,KSTID ,KTIDE ,KSTDRG,KSTSRD,KSTACC,   &
     &              KLGRAV,KGM   ,KAE   ,KFPL  ,KFEQ  ,KPLNPO,KPLNVL,   &
     &              KXEPOC,KCD   ,KCDDOT,KCR   ,KGENAC,KACN  ,KASN  ,   &
     &              KTHDRG,KCKEP ,KCKEPN,KXNRMZ,KXNRMC,KFSCEP,KFSCND,   &
     &              KAREA ,KXMASS,KRMSPO,KTCOEF,KTXQQ ,KTIEXP,KTXMM ,   &
     &              KTXLL1,KTXSN1,KTS2QQ,KT2M2H,KT2MHJ,KTXKK ,KTSCRH,   &
     &              KPXPK ,KAESHD,KCSAVE,KSSAVE,KCGRVT,KSGRVT,KXDTMC,   &
     &              KDNLT ,KTXSN2,KTNORM,KTWRK1,KTWRK2,KUNORM,KAERLG,   &
     &              KSINCO,KPARLG,KCONST,KBFNRM,KTDNRM,KCSTHT,KTPSTR,   &
     &              KTPSTP,KTPFYW,KPLMGM,KTPXAT,KEAQAT,KEAFSS,KEAINS,   &
     &              KACS  ,KECS  ,KSOLNA,KSOLNE,KSVECT,KSFLUX,KFACTX,   &
     &              KFACTY,KADIST,KGEOAN,KPALB ,KALBCO,KEMMCO,KCNAUX,   &
     &              KSNAUX,KPPER ,KACOSW,KBSINW,KACOFW,KBCOFW,KANGWT,   &
     &              KWT   ,KPLNDX,KPLANC,KTGACC,KTGDRG,KTGSLR,KWTACC,   &
     &              KWTDRG,KWTSLR,KTMACC,KTMDRG,KTMSLR,KATTUD,KDYACT,   &
     &              KACCBT,KACPER,KXDDNC,KXDDAO,KXNC  ,KXPPNC,KSMXNC,   &
     &              KXDDTH,KPDDTH,KXSSBS,KCPPNC,KEXACT,KXACIN,KXACOB,   &
     &              KPXHDT,KTPXTH,KPACCL,KTXSTA,KDELXS,KSMRNC,KPRX  ,   &
     &              KSMRNP,KDSROT,KXUGRD,KYUGRD,KZUGRD,KSUMRC,KXDDRC,   &
     &              KTMOS0,KTMOS, KTMOSP,KSMXOS,KSGTM1,KSGTM2,KSMPNS,   &
     &              KXGGRD,KYGGRD,KZGGRD,KXEGRD,KYEGRD,KZEGRD,KSSDST,   &
     &              KSDINS,KSDIND,KSSDSR,KSSDDG,KTATHM,KTAINS,KTAFSS,   &
     &              KSRAT ,KTRAT ,KHLDV ,KHLDA1,KHLDA4,KHLDA7,KQAST1,   &
     &              KQAST2,KQAST3,KQAST4,KQAST5,KQAST6,NXCA01
      COMMON/CORA02/KFSCTB,KFSCTC,KFSCTE,KDSECT,                        &
     &              KFSECT,KS    ,KCIP  ,KCIV  ,                        &
     &       KXTN  ,KXSM  ,KXTK  ,KXSJ  ,KXTI  ,KXTKP ,                 &
     &       KVTN  ,KVSM  ,KVTK  ,KVSJ  ,KVTI  ,KVTKP ,                 &
     &       KSATLT,KSATLN,KSATH ,KCOSTH,KSINTH,                        &
     &       KPXPFM,KPXPFK,KPXPFJ,KTRBF ,KFSTRC,                        &
     &       KFSTRE,KDSCTR,KFSCVS,KXSMBF,KXSKBF,KXSJBF,                 &
     &       KRSSV1,KRSSV2,KRSSV3,KTPMES,KACOEF,KACTIM,                 &
     &       KXTNPC,KXSMPC,KXTKPC,KXSJPC,KXTIPC,KXTKPP,                 &
     &       KRLRNG,KASTO,KASTP,NXCA02
      COMMON/CORA03/KRFMT ,KROTMT,KSRTCH,KCFSC ,KTHG  ,KCOSTG,KSINTG,   &
     &              KDPSI ,KEPST ,KEPSM ,KETA  ,KZTA  ,KTHTA ,KEQN  ,   &
     &              KDPSR ,KSL   ,KH2   ,KL2   ,KXPUT ,KYPUT ,KUT   ,   &
     &              KSPCRD,KSPSIG,KSTAIN,KSXYZ ,KSPWT ,KDXSDP,KDPSDP,   &
     &              KXLOCV,KSTNAM,KA1UT ,KPLTIN,KPLTVL,KPLTDV,KPUTBH,   &
     &              KABCOF,KSPEED,KANGFC,KSCROL,KSTVEL,KSTVDV,KTIMVL,   &
     &              KSTEL2,KSTEH2,KSL2DV,KSH2DV,                        &
     &              KAPRES, KASCAL, KASOFF,KXDOTP,KSAVST,               &
     &              KANGT , KSPDT , KCONAM,KGRDAN,KUANG ,KFAMP ,        &
     &              KOFACT, KOTSGN,KWRKRS,KANFSD,KSPDSD,KPRMFS,KSCRFR,  &
     &              KCOSAS,KSINAS,KDXTID,KALCOF,KSTANF,KNUTIN,KNUTMD,   &
     &              KPDPSI,KPEPST,KDXDNU,KDPSIE,KEPSTE,NXCA03
      COMMON/CORA04/KABIAS,KABSTR,KABSTP,KCBIAS,KCBSTR,KCBSTP,          &
     &       KRNM  ,KRKM  ,KRKJ  ,KRIJ  ,KRKPM ,                        &
     &       KRRNM ,KRRKM ,KRRKJ ,KRRIJ ,KRRKPM,                        &
     &       KURNM ,KURKM ,KURKJ ,KURIJ ,KURKPM,                        &
     &       KPRRNM,KPRRKM,KPRRKJ,KPRRIJ,KPRRKP,                        &
     &       KPMPXI,KPMPXE,KRA   ,KRELV ,KUHAT ,KWORK ,KTMPCR,KU    ,   &
     &       KS0   ,KS1   ,KXTP  ,KPXSXP,KPXDXP,KXUTDT,KRPOLE,KPXPOL,   &
     &       KXDPOL,KOBBUF,KOBSC ,KRESID,KSIGMA,KRATIO,KELEVS,          &
     &       KPMPA ,KPXSLV,KTPRTL,                                      &
     &       KFRQOF,KXYZOF,KFRQST,KFRQSA,KSTDLY,KSADLY,KXYZCG,KSCMRA,   &
     &       KEBVAL,KEBSIG,KEBNAM,KBTWB ,KTBTWA,KBTWD ,KPMPE ,          &
     &       KFSEB1,KFSEB2,KSTAMT,KPXSPA,KDIAGN,KOBOUT,KGRLT1,KGRLT2,   &
     &       KGRLT3,KGRLT4,KGRLT5,KPSTAT,KRSUNS,KCHEMR,KCHMOR,KEPOSR,   &
     &       KCHEMT,KCHMOT,KEPOST,KCHCBS,KCPOSS,KSCRTM,KXSTT ,KXSTR ,   &
     &       KXSS  ,KRANGT,KRANGR,KCHB1 ,KCHB2 ,KCHBV1,KCHBV2,KCHEB ,   &
     &       KSSTFQ,KSSTCC,KSSTSS,KSSTWT,KRLCOR,KWVLBI,KQUINF,KBRTS ,   &
     &       KBRTSV,KLRARC,KXEPBF,KXEPBR,KPRCBD,KPRTBD,KXPMPA,KXL,      &
     &       KXSIG ,KXEDTS,KXALO1,KXALO2,KXYOF2,KDLATF,KDLATS,KDLONF,   &
     &       KDLONS,KPF   ,KPS   ,                                      &
     &       KXOBSV,KXOBSW,KXEDSW,                                      &
     &       KXSIGW,KPSF  ,KDNUM ,KCNUM ,KFCOR ,KCOSAR,KSINAR,KSABIA,   &
     &       KSBTM1,KSBTM2,KYAWBS,KVLOUV,KACMAG,KOBSTR,                 &
     &       KPRL1 ,KPRL2, KRL1  ,KT1SE ,KTCP  ,                        &
     &       KRATDR,KFQT1S,KFQT1E,KT1STR,KFTTSE,KFRSTR,KFRRAT,KSV1  ,   &
     &       KSV2  ,KTSLOV,                                             &
     &       KGLGR1,KGLGR2,KGLFR1,KGLFR2,                               &
     &       KARGR1,KARGR2,KARFR1,KARFR2,                               &
     &       KRDS1L,KFT1AV,KDFQP ,KFREQ1,KFREQ3,KSAVD1,KSAVD2,          &
     &       KANTOU,KFM3CF,KF2CF,KTMG,KLTMG,KX2TIM,KX2OBS,KXRNDX,KX2SCR,&
     &       KALTWV,KXXBM ,KX2PAR,KATIME,KPMPAT,KPMATT,KX2PAT,          &
     &       KPXEXI,KPXEPA,KPV,KPXEP2,KX2COF,KACOF2,KACOF3,KBCOF,KBCOF2,&
     &       KDDDA ,KX2AUX,KX2VPR,KX2VPA,KEXTRA,KVARAY,KATROT,KATPER,   &
     &       KLTAR ,KXHOLD,KANTBL,KPHC  ,KOFDRV,KGNAME,KGRSIZ,KGRCNT,   &
     &       KGRDAT,KACCDT,KCTBTI,KCTBWE,KCTCTM,KANTUV,KANTOR,KW1PU ,   &
     &       KPYSQH,KSIGSP,KXYOF3,KXVTM1,KXDIST,KXDST0,KTMSE ,KDSDP ,   &
     &       KEXCST,KEXCDT,KEXCGX,KEXCGY,KEXCGZ,KIMNDX,KIMOBS,KIMTIM,   &
     &       KIMSAT,KM2VPA,KDCDD ,KDWNWT,KDPOR ,KC2PAR,KBOUNC,KBPART,   &
     &       NXCA04
      COMMON/CORI01/KMJDS0,KMJDSB,KMJDSC,KMJDSV,KIBACK,KIBAKV,KIORDR,   &
     &              KIORDV,KNOSTP,KNOCOR,KNSAT ,KN3   ,KNEQN ,KNEQN3,   &
     &              KNH   ,KNHV  ,KNSTPS,KNSTPV,KICPP ,KICPV ,KICCP ,   &
     &              KICCV ,KICCPV,KICCVV,KISUMX,KIXDDT,KISMPX,KIPXDD,   &
     &              KNMAX ,KNTOLD,KNTOLO,KICNT ,KISNT ,KMM   ,KKK   ,   &
     &              KJJ   ,KHH   ,KIBDY ,KSIGN1,KSIGN2,KLL   ,KQQ   ,   &
     &              KIORFR,KIPDFR,KITACC,KJSAFR,KJSPFR,KMJDEP,KMJDND,   &
     &              KNVSTP,KNSTRN,KNDARK,KTIPPT,KTJBDY,                 &
     &              KICNTA,KISNTA,KISHDP,KIPTC ,KIPTS ,KIGTSR,KIXTMC,   &
     &              KTIPTT,KTNOSD,KTQNDX,KTLL1 ,KTJJBD,KTITDE,KTCNTR,   &
     &              KTNN  ,KITACX,KNMOVE,KPANEL,KPLPTR,KNADAR,KNADSP,   &
     &              KNADDF,KNADEM,KNADTA,KNADTC,KNADTD,KNADTF,KNADTX,   &
     &              KITPMD,KSCATT,KITPAT,KILTPX,KEASBJ,KEANMP,KEANAN,   &
     &              KEAPMP,KEAPAN,KEAMJS,KEAPPP,KEAAAA,KICNTT,KISNTT,   &
     &              KTPGRC,KTPGRS,KTPC  ,KTPS  ,KALCAP,KEMCAP,KNSEG ,   &
     &              KICNTP,KISNTP,KNRDGA,KNRDDR,KNRDSR,KIRDGA,KIRDRG,   &
     &              KIRSLR,KSTRTA,KSTRTD,KSTRTS,KDYNPE,KACCPE,KIBCKN,   &
     &              KNRAT ,KIXDDN,KISMXN,KDXDDN,KDSMXN,KICPPN,KACSID,   &
     &              KNEQNH,KHRFRC,KPTFBS,KPTFSB,KIPXDA,KIACCP,KXSTAT,   &
     &              KPXST ,KSALST,KMAPLG,KNMBUF,KSTEPS,KSGMNT,KSATIN,   &
     &              KMEMST,KNEQNI,KBUFIN,KWEMGA,KWEMDR,KTPATS,KTANMP,   &
     &              KTAPPP,KTAMJS,KTASID,KGPSID,KNSSVA,KPNALB,KBRAX1,   &
     &              KBRAX2,KBRAX3,NXCI01
      COMMON/CORI02/KNTIME,KMJSTB,KMJSTC,KMJSTE,KISECT,                 &
     &              KINDH ,KNMH  ,KIVSAT,KIPXPF,KNTRTM,KMSTRC,          &
     &              KMSTRE,KISCTR,KISATR,KITRUN,KTRTMB,KTRTMC,          &
     &              KMJDVS,KNTMVM,NXCI02
      COMMON/CORI04/KNMP  ,KINDP ,KNDPAR,KNPVCT,KISATN,KISET ,KIANTO,   &
     &              KISATO,KIANTD,KISATD,KISTAD,KISATC,KMJDCG,KISTAT,   &
     &              KMJDEB,KMJDBN,KNDBIN,KNWTDB,KIXPAR,KNDBUF,KSSTNM,   &
     &              KSSTNA,KMBSAT,KMBSTA,KXKEY ,KXVKEY,KXFLAG,KIPNTF,   &
     &              KIPNTS,KNCON ,KKF   ,KIDATB,KNSTLV,KSLVID,KLLBIA,   &
     &              KTMRA1,KTMRA2,KIND1 ,KTARID,KATARD,KYAWID,KXOBLK,   &
     &              KDSCWV,KATRSQ,KATSAT,KKVLAS,KPARTP,KLTMSC,KLTASC,   &
     &              KCTBST,KSTBST,KANCUT,KANGPS,KANTYP,                 &
     &              KANTOF,                                             &
     &              KYSAT, KMBDEG,                                      &
     &              KMBNOD,KMBSST,KBSPLN,KSSPLN,KXIOBS,KIDLAS,KIAVP ,   &
     &              KXNAVP,KNEXCG,KIDEXC,KNREXC,KTELEO,KIKEY ,KIMKEY,   &
     &              KIMBLK,KIMPRT,KCN110,KCN111,KC110,KC111,KTDSAT,     &
     &              KTDANT,NXCI04
      COMMON/CORL01/KLORBT,KLORBV,KLNDRG,KLBAKW,KLSETS,KLAFRC,KLSTSN,   &
     &              KLSNLT,KLAJDP,KLAJSP,KLAJGP,KLTPAT,KEALQT,KLRDGA,   &
     &              KLRDDR,KLRDSR,KFHIRT,KLSURF,KHRFON,KLTPXH,KSETDN,   &
     &              KTALTA,NXCL01
      COMMON/CORL02/KLNDTT,KLWSTR,KLNDTR,KLEVMF,KLTPMS,NXCL02
      COMMON/CPARFI/IUNPF1,IUNPF2,IUNPFI,ISZPFI,NBLKPF,NWRDPF,MTCALL(4)
      COMMON/CPARFL/LPARFI,LPFEOF,LARCNU,LRORR
      COMMON/CPMPA /KTMPAR(3)    ,KMBPAR(2)    ,KRFPAR(2)    ,          &
     &              KAEPAR,KFEPAR,KFPPAR,KVLPAR,KETPAR(2,2)  ,          &
     &              KPMPAR,KUTPAR,KSTPAR(3,4)  ,NADJST       ,          &
     &              NDIM1 ,NDIM2 ,NXDIM1,NXDIM2
      COMMON/DTMGDN/TGTYMD,TMGDN1,TMGDN2,REPDIF,XTMGN
      COMMON/NEQINT/NINTOT,MEMTOT,NEQNIM,NXNEQS
      COMMON/IOS/ISTOS1,ISTOS2,ISTOS3,ISTLST,INTSUB(3),JNTSUB(3),      &
     &        ILSTSG(80),INTOSP,MAPSAT(3,4)
      COMMON/LPAIR/LSECOND
!
      DIMENSION IYMD(NM),IHM(NM),SEC(NM),OBSTIM(NM),OBS(NM),TIMCOR(NM), &
     &   SUMCOR(NM),OCEANP(NM),XOVRKY(NM),DTIME(NM),RESID(NM),OBSWT(NM),&
     &   FSECM(NM),XSM(MINTIM,3),VSM(MINTIM,3),SATLAT(NM),SATLON(NM),   &
     &   SATH(NM)
      DIMENSION XLAT(MINTIM,3),XLON(MINTIM,3),XHIT(MINTIM,3),           &
     &          XTHG(MINTIM,3),INDSAT(3,4),ISEQX(3),ITIMX(3),LSATX(3),  &
     &          JXSM(3),JVSM(3)
      DIMENSION PARTL(NADJST),PMPA(NDIM1,NDIM2),WORD50(50)
      DIMENSION AA(1),II(1),LL(1)
      DIMENSION UTDT(NM,4)
      DIMENSION DUM(3),DUM1(3,2,1)
!
      EQUIVALENCE (JXSM(1),KXSM),(JVSM(1),KVSM)
!
      DATA C1D6/1.0D6/,C1DM2/1.0D-2/
!
!**********************************************************************
!* START OF EXECUTABLE CODE *******************************************
!**********************************************************************
!
!
      CALL CLEARA(WORD50,50)
! OBSERVATION BLOCK START TIME
      WORD50(3)=DBLE(MJDSBL) + REPDIF
! OBSERVATION MEASUREMENT TYPE AND TIME SYSTEM INDICATOR
      WORD50(5)=DBLE(MTYPE)+DBLE(INDSYS)*C1DM2
! FOR PAIRED OBSERVATIONS
      IF(LSECOND) then
        WORD50(5)=DBLE(MTYPE+1)+DBLE(INDSYS)*C1DM2
      ENDIF
! SPEED OF LIGHT
      WORD50(6)=VLIGHT
! ALTIMETER FLAG
      LALTIM = MTYPE.EQ.99 .OR. MTYPE.EQ.199
! LOAD STATION AND SATELLITE ID'S
      DO 4000 I=1,NSATB
      J=I+6
      WORD50(J)=JSTANO(I)
      K=I+9
      WORD50(K)=JSATNO(I)
      IF(.NOT.LRORR) GO TO 4000
      LSATX(I)=JSATNO(I).GT.0
      IF(.NOT.LSATX(I)) GO TO 4000
! OBTAIN SPACECRAFT EPHEMERIS FOR RANGE AND RANGE RATE DATA
!
!.....SEARCH FOR EVENT TIME CORRESPONDING TO DESIRED SATELLITE
      DO 2000 K=1,4
      IF(MTCALL(K).GT.2) GO TO 2000
      DO 1000 J=1,3
      IF(INDSAT(J,K).NE.INMSAT(I)) GO TO 1000
      ISEQX(I)=K
      ITIMX(I)=J+1+(J/2)*(2-MTCALL(K))
      ISATID=II(KISATN-1+INDSAT(J,K))
      GO TO 3000
 1000 END DO
 2000 END DO
      GO TO 4000
 3000 CONTINUE

      IF(NINTOT.GT.0) THEN
      CALL FNDNUM(ISATID,II(KSATIN),NINTOT,IRET)
      IF(IRET.GT.0) THEN
      KSUMXOS=MAPSAT(INTOSP,1)
      KSUMPOS=MAPSAT(INTOSP,2)
      KXDDTOS=MAPSAT(INTOSP,3)
      KPDDTOS=MAPSAT(INTOSP,4)
      KNSTEPS=II(KSTEPS-1+IRET)
      NEQNI=II(KNEQNI-1+IRET)
      ENDIF
      ENDIF
!
!.....SET SWITCHES AND INDICATORS FOR APPROPRIATE SATELLITE
      IFSECM=KFSECS(ITIMX(I),ISEQX(I))
      CALL ORBSET(II(KNSAT),II(KIVSAT),LL(KLSETS),INMSAT(I) ,          &
     &   KNSTEPS,NEQNI,II(KSGMNT-1+IRET),                               &
     &   AA(KSGTM1-1+IRET),AA(KSGTM2-1+IRET),IRET,MJDSBL,AA(IFSECM),    &
     &   AA(IFSECM-1+NM),NM,AA,II)
!
!.....OBTAIN SATELLITE POSITION AND VELOCITY OVER ENTIRE DATA BLOCK
      IXSM=JXSM(I)
      CALL ORBIT(MJDSBL,AA(IFSECM),AA(KWORK),NM,II(KNWTDB),II(KNDBIN),  &
     &   II(KMJDSC),AA(KFSEC),II(KMJDSV),AA(KFSECV),LL(KLSETS),         &
     &   II(KIPXPF),II(KIVSAT),1,II(KNMAX),II(KNTOLD),AA(IXSM),         &
     &   AA(KPXPFM),.TRUE.,.FALSE.,II(KPLPTR),II(KPANEL),II(KNMOVE),    &
     &   AA(KTPMES+MINTIM*2*(I+1)),LL(KLTPMS+MINTIM*3*(I+1)),LL(KSETDN),&
     &   AA(KTMOS0-1+INTOSP),AA(KTMOS-1+INTOSP),AA(KTMOSP-1+INTOSP),    &
     &   AA(KSMXOS-1+KSUMXOS),AA(KSMXOS-1+KSUMPOS),AA(KSMXOS-1+KXDDTOS),&
     &   AA(KSMXOS-1+KPDDTOS),KNSTEPS,NEQNI,II(KSGMNT-1+IRET),          &
     &   AA(KSGTM1-1+IRET),AA(KSGTM2-1+IRET),AA,II,LL)

!
!.....COMPUTE RIGHT ASCENSION OF GREENWICH ACROSS ENTIRE BLOCK OF DATA
!     ....changed LEQN switch to .TRUE. in GRHRAN to compute
!     ....equation of equinoxes -- jjm 2/5/91
!
!     ....this should be modified to call ROTXTR for interplanetary
!     ....runs  -- jjm
!
!LST  CALL GRHRAN(MJDSBL,AA(IFSECM),.TRUE.,.FALSE.,AA(KEQN),AA(KSRTCH),
      CALL GRHRAN(MJDSBL,AA(IFSECM),.TRUE.,.TRUE.,AA(KEQN),AA(KSRTCH),  &
     &   XTHG(1,I),SATLAT,SATLON,NM,AA,II,UTDT(1,1),.FALSE.,DUM,DUM1)
!
!.....COMPUTE S/C HEIGHT ABOVE ELLIPSOID AND SUB-SATELLITE LAT & LON
      CALL SUBTRK(AA(IXSM),XTHG(1,I),SATLAT,SATLON,SATH,                &
     &   XLAT(1,I),XLON(1,I),XHIT(1,I),NM)
 4000 END DO
!
! OUTPUT PARTIAL DERIVATIVE RECORDS FOR EACH OBSERVATION IN BLOCK
      DO 11000 M=1,NM
      ISEC=INT(SEC(M))
!.....DATE AND TIME TO INTEGRAL SECONDS UTC
      WORD50(1)=DBLE(IYMD(M))*C1D6+DBLE(IHM(M)*100+ISEC)
!.....FRACTION OF UTC SECONDS
      WORD50(2)=SEC(M)-DBLE(ISEC)
!.....ELAPSED SECONDS ET FROM BLOCK START
      WORD50(4)=OBSTIM(M)
!.....OBSERVATION VALUE
      WORD50(13)=OBS(M)
!.....SUM OF OBSERVATION TIME CORRECTIONS
      WORD50(14)=TIMCOR(M)
!.....SUM OF OBSERVATION CORRECTIONS
      WORD50(15)=SUMCOR(M)
!.....SUM OF ALTIMETER OCEAN PARAMETERS
      IF(LALTIM) WORD50(16)=OCEANP(M)
!.....OBSERVATION RESIDUAL
      WORD50(17)=RESID(M)
!.....OBSERVATION WEIGHT (ZERO FOR EDITED OBSERVATIONS)
      WORD50(18)=OBSWT(M)
!.....CROSSOVER KEY FOR ALTIMETRY
      IF(LALTIM) WORD50(19)=XOVRKY(M)
!c      write(6,*) 'pdfile: LALTIM, m, word50(19) ',
!c     &                    LALTIM, m, word50(19)
!.....COUNTING INTERVAL FOR AVERAGE RANGE RATE
      IF(LAVGRR) WORD50(19)=DTIME (M)
!.....WORD 20 SPARE
!
      IF(LRORR) GO TO 5000
!
!.....SPACECRAFT EPHEMERIS FOR ALTIMETRY, PCE AND ANGLE DATA
      CALL PDFSAT(WORD50(21),FSECM,XSM,VSM,SATLAT,SATLON,SATH,M)
      GO TO 7000
 5000 CONTINUE
!
!.....SPACECRAFT EPHEMERIS FOR RANGE AND RANGE RATE DATA
      DO 6000 I=1,NSATB
      NDX50=(I+1)*10+1
      IFSECM=KFSECS(ITIMX(I),ISEQX(I))
      IXSM=JXSM(I)
      IVSM=JVSM(I)
!
      CALL PDFSAT(WORD50(NDX50),AA(IFSECM),AA(IXSM),AA(IVSM),           &
     &   XLAT(M,I),XLON(M,I),XHIT(M,I),M)
!
 6000 END DO
 7000 CONTINUE
!
      IF(LNPNM) GO TO 9000
!.....LOAD PARTIALS INTO TEMPORARY ARRAY IF ORDERED NM X NP
      DO 8000 N=1,NADJST
      PARTL(N)=PMPA(M,N)
 8000 END DO
!.....OUTPUT PARTIAL DERIVATIVE RECORD FOR PARTIALS ORDERED NM X NP
      CALL PDFDAT(WORD50,PARTL,NADJST)
      GO TO 10000
!
 9000 CONTINUE
!.....OUTPUT PARTIAL DERIVATIVE RECORD FOR PARTIALS ORDERED NP X NM
      CALL PDFDAT(WORD50,PMPA(1,M),NADJST)
10000 CONTINUE
11000 END DO
      RETURN
      END
