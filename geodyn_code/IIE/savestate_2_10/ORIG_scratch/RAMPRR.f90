      SUBROUTINE RAMPRR(OBSC,MJDSBL,TRINT,NDIMTR,MJDRMP,TRAMP,FRAMP,    &
     &                  FDRAMP,NRAMPS,FREQO,BIAS,VLIGHT,SF1,SF2,        &
     &                  DTIME,XINTS,XINTB,XINTS2,NM)
      IMPLICIT DOUBLE PRECISION (A-H,O-Z),LOGICAL(L)
      DIMENSION XINTB(NM),XINTS(NM),XINTS2(NM)
      DIMENSION OBSC(NM),TRINT(NDIMTR,2,2),DTIME(NM)
      DIMENSION TRAMP(1000,2),FRAMP(NRAMPS),FDRAMP(NRAMPS)
!
! LARGE CONSTANT PART OF INTEGRAL WITH PRECISE TDIF OVER ENTIRE SPAN
!
      DO 10 I=1,NM
      XINTB(I)=-(DTIME(I)+2.D0*OBSC(I)/VLIGHT)*FREQO*SF2
   10 END DO
!
! SMALLER PART OF INTEGRAL BASED ON RAMPS
!
      CALL RMPGRL(XINTS,MJDSBL,TRINT(1,1,1),TRINT(1,1,2),MJDRMP,TRAMP,  &
     &            FRAMP,FDRAMP,NRAMPS,NM)
!
      DO 20 I=1,NM
      XINTS(I)=-XINTS(I)*SF2
   20 END DO
!
      IF(ABS(SF1).LT.1.D-10) GO TO 100
!
! LARGE CONSTANT PART OF INTEGRAL WITH PRECISE TDIF OVER ENTIRE SPAN
!
      DO 30 I=1,NM
      XINTB(I)=XINTB(I)+DTIME(I)*FREQO*SF1
   30 END DO
!
! SMALLER PART OF INTEGRAL BASED ON RAMPS
!
      CALL RMPGRL(XINTS2,MJDSBL,TRINT(1,2,1),TRINT(1,2,2),MJDRMP,TRAMP, &
     &            FRAMP,FDRAMP,NRAMPS,NM)
!
      DO 40 I=1,NM
      XINTS(I)=XINTS(I)+SF1*XINTS2(I)
   40 END DO
!
!
  100 CONTINUE
!
! PUT BIAS IN COMPUTED MESAUREMENT
      DO 110 I=1,NM
      XINTB(I)=XINTB(I)-DTIME(I)*BIAS
      OBSC(I)=-XINTB(I)-XINTS(I)
  110 END DO
      RETURN
      END
