!$FILLPA
      SUBROUTINE FILLPA(COSTHG,SINTHG,NM)
!********1*********2*********3*********4*********5*********6*********7**
! FILL UP THE PARTIALS FOR PLANETARY ORIENTATION ESTIMATION / TARGET
! CONTRIBUTION
!
!********1*********2*********3*********4*********5*********6*********7**
      IMPLICIT DOUBLE PRECISION (A-H,O-Z),LOGICAL(L)
      SAVE
!
      COMMON/CRM5OE/RM5OE(9)
      COMMON/CREFMT/REFMT(9)
      COMMON/REFDRV/DREFDA(9),DREFDB(9),DR3TDW(9),RDATR(9),RDBTR(9),    &
     &              DDA(9,2,50),DDB(9,2,50),DDR(9,50)
      COMMON/STPTHG/COSSTG,SINSTG
!
      DIMENSION R3THG(9),HMAT(9),FMAT(9)
      DIMENSION COSTHG(1),SINTHG(1)
      DATA ZERO/0.0D0/,ONE/1.0D0/
!
!
!***********************************************************************
! START OF EXECUTABLE CODE *********************************************
!***********************************************************************
!
! FORM MATRIX R3(-w)
!
      DO 10 J=1,NM
      R3THG(1)=COSTHG(J)
      R3THG(2)=-SINTHG(J)
      R3THG(3)=ZERO
      R3THG(4)=SINTHG(J)
      R3THG(5)=COSTHG(J)
      R3THG(6)=ZERO
      R3THG(7)=ZERO
      R3THG(8)=ZERO
      R3THG(9)=ONE
!
      DR3TDW(1)= R3THG(2)
      DR3TDW(2)= R3THG(1)
      DR3TDW(3)= ZERO
      DR3TDW(4)=-R3THG(5)
      DR3TDW(5)=-R3THG(4)
      DR3TDW(6)= ZERO
      DR3TDW(7)= ZERO
      DR3TDW(8)= ZERO
      DR3TDW(9)= ZERO
!
! FMAT IS DRM5ODA TRANSPOSE
      FMAT(1)=-RM5OE(4)
      FMAT(2)= RM5OE(1)
      FMAT(3)= ZERO
      FMAT(4)=-RM5OE(5)
      FMAT(5)= RM5OE(2)
      FMAT(6)= ZERO
      FMAT(7)=-RM5OE(6)
      FMAT(8)= RM5OE(3)
      FMAT(9)= ZERO
!
! HMAT IS DRM5ODB TRANSPOSE
      HMAT(1)= ZERO
      HMAT(2)= ZERO
      HMAT(3)= ZERO
      HMAT(4)=-RM5OE(3)
      HMAT(5)=-RM5OE(6)
      HMAT(6)=-RM5OE(9)
      HMAT(7)= RM5OE(2)
      HMAT(8)= RM5OE(1)
      HMAT(9)= RM5OE(8)
!
      DDA(1,1,J)=DREFDA(1)*RM5OE(1)+DREFDA(2)*RM5OE(4)+                 &
     &DREFDA(3)*RM5OE(7)
      DDA(2,1,J)=DREFDA(4)*RM5OE(1)+DREFDA(5)*RM5OE(4)+                 &
     &DREFDA(6)*RM5OE(7)
      DDA(3,1,J)=DREFDA(7)*RM5OE(1)+DREFDA(8)*RM5OE(4)+                 &
     &DREFDA(9)*RM5OE(7)
      DDA(4,1,J)=DREFDA(1)*RM5OE(2)+DREFDA(2)*RM5OE(5)+                 &
     &DREFDA(3)*RM5OE(8)
      DDA(5,1,J)=DREFDA(4)*RM5OE(2)+DREFDA(5)*RM5OE(5)+                 &
     &DREFDA(6)*RM5OE(8)
      DDA(6,1,J)=DREFDA(7)*RM5OE(2)+DREFDA(8)*RM5OE(5)+                 &
     &DREFDA(9)*RM5OE(8)
      DDA(7,1,J)=DREFDA(1)*RM5OE(3)+DREFDA(2)*RM5OE(6)+                 &
     &DREFDA(3)*RM5OE(9)
      DDA(8,1,J)=DREFDA(4)*RM5OE(3)+DREFDA(5)*RM5OE(6)+                 &
     &DREFDA(6)*RM5OE(9)
      DDA(9,1,J)=DREFDA(7)*RM5OE(3)+DREFDA(8)*RM5OE(6)+                 &
     &DREFDA(9)*RM5OE(9)
!
      DDA(1,2,J)=REFMT(1)*FMAT(1)+REFMT(2)*FMAT(2)+REFMT(3)*FMAT(3)
      DDA(2,2,J)=REFMT(4)*FMAT(1)+REFMT(5)*FMAT(2)+REFMT(6)*FMAT(3)
      DDA(3,2,J)=REFMT(7)*FMAT(1)+REFMT(8)*FMAT(2)+REFMT(9)*FMAT(3)
      DDA(4,2,J)=REFMT(1)*FMAT(4)+REFMT(2)*FMAT(5)+REFMT(3)*FMAT(6)
      DDA(5,2,J)=REFMT(4)*FMAT(4)+REFMT(5)*FMAT(5)+REFMT(6)*FMAT(6)
      DDA(6,2,J)=REFMT(7)*FMAT(4)+REFMT(8)*FMAT(5)+REFMT(9)*FMAT(6)
      DDA(7,2,J)=REFMT(1)*FMAT(7)+REFMT(2)*FMAT(8)+REFMT(3)*FMAT(9)
      DDA(8,2,J)=REFMT(4)*FMAT(7)+REFMT(5)*FMAT(8)+REFMT(6)*FMAT(9)
      DDA(9,2,J)=REFMT(7)*FMAT(7)+REFMT(8)*FMAT(8)+REFMT(9)*FMAT(9)
!
      DDA1=DDA(1,1,J)*R3THG(1)+DDA(4,1,J)*R3THG(2)+DDA(7,1,J)*R3THG(3)
      DDA2=DDA(2,1,J)*R3THG(1)+DDA(5,1,J)*R3THG(2)+DDA(8,1,J)*R3THG(3)
      DDA3=DDA(3,1,J)*R3THG(1)+DDA(6,1,J)*R3THG(2)+DDA(9,1,J)*R3THG(3)
      DDA4=DDA(1,1,J)*R3THG(4)+DDA(4,1,J)*R3THG(5)+DDA(7,1,J)*R3THG(6)
      DDA5=DDA(2,1,J)*R3THG(4)+DDA(5,1,J)*R3THG(5)+DDA(8,1,J)*R3THG(6)
      DDA6=DDA(3,1,J)*R3THG(4)+DDA(6,1,J)*R3THG(5)+DDA(9,1,J)*R3THG(6)
      DDA7=DDA(1,1,J)*R3THG(7)+DDA(4,1,J)*R3THG(8)+DDA(7,1,J)*R3THG(9)
      DDA8=DDA(2,1,J)*R3THG(7)+DDA(5,1,J)*R3THG(8)+DDA(8,1,J)*R3THG(9)
      DDA9=DDA(3,1,J)*R3THG(7)+DDA(6,1,J)*R3THG(8)+DDA(9,1,J)*R3THG(9)
      DDA(2,1,J)=DDA2
      DDA(3,1,J)=DDA3
      DDA(4,1,J)=DDA4
      DDA(5,1,J)=DDA5
      DDA(6,1,J)=DDA6
      DDA(7,1,J)=DDA7
      DDA(8,1,J)=DDA8
      DDA(9,1,J)=DDA9
!
      DDA1=DDA(1,2,J)*R3THG(1)+DDA(4,2,J)*R3THG(2)+DDA(7,2,J)*R3THG(3)
      DDA2=DDA(2,2,J)*R3THG(1)+DDA(5,2,J)*R3THG(2)+DDA(8,2,J)*R3THG(3)
      DDA3=DDA(3,2,J)*R3THG(1)+DDA(6,2,J)*R3THG(2)+DDA(9,2,J)*R3THG(3)
      DDA4=DDA(1,2,J)*R3THG(4)+DDA(4,2,J)*R3THG(5)+DDA(7,2,J)*R3THG(6)
      DDA5=DDA(2,2,J)*R3THG(4)+DDA(5,2,J)*R3THG(5)+DDA(8,2,J)*R3THG(6)
      DDA6=DDA(3,2,J)*R3THG(4)+DDA(6,2,J)*R3THG(5)+DDA(9,2,J)*R3THG(6)
      DDA7=DDA(1,2,J)*R3THG(7)+DDA(4,2,J)*R3THG(8)+DDA(7,2,J)*R3THG(9)
      DDA8=DDA(2,2,J)*R3THG(7)+DDA(5,2,J)*R3THG(8)+DDA(8,2,J)*R3THG(9)
      DDA9=DDA(3,2,J)*R3THG(7)+DDA(6,2,J)*R3THG(8)+DDA(9,2,J)*R3THG(9)
!
      DDA(1,2,J)=DDA1
      DDA(2,2,J)=DDA2
      DDA(3,2,J)=DDA3
      DDA(4,2,J)=DDA4
      DDA(5,2,J)=DDA5
      DDA(6,2,J)=DDA6
      DDA(7,2,J)=DDA7
      DDA(8,2,J)=DDA8
      DDA(9,2,J)=DDA9
!
      DDB(1,1,J)=DREFDB(1)*RM5OE(1)+DREFDB(2)*RM5OE(4)+                 &
     &DREFDB(3)*RM5OE(7)
      DDB(2,1,J)=DREFDB(4)*RM5OE(1)+DREFDB(5)*RM5OE(4)+                 &
     &DREFDB(6)*RM5OE(7)
      DDB(3,1,J)=DREFDB(7)*RM5OE(1)+DREFDB(8)*RM5OE(4)+                 &
     &DREFDB(9)*RM5OE(7)
      DDB(4,1,J)=DREFDB(1)*RM5OE(2)+DREFDB(2)*RM5OE(5)+                 &
     &DREFDB(3)*RM5OE(8)
      DDB(5,1,J)=DREFDB(4)*RM5OE(2)+DREFDB(5)*RM5OE(5)+                 &
     &DREFDB(6)*RM5OE(8)
      DDB(6,1,J)=DREFDB(7)*RM5OE(2)+DREFDB(8)*RM5OE(5)+                 &
     &DREFDB(9)*RM5OE(8)
      DDB(7,1,J)=DREFDB(1)*RM5OE(3)+DREFDB(2)*RM5OE(6)+                 &
     &DREFDB(3)*RM5OE(9)
      DDB(8,1,J)=DREFDB(4)*RM5OE(3)+DREFDB(5)*RM5OE(6)+                 &
     &DREFDB(6)*RM5OE(9)
      DDB(9,1,J)=DREFDB(7)*RM5OE(3)+DREFDB(8)*RM5OE(6)+                 &
     &DREFDB(9)*RM5OE(9)
!
      DDB(1,2,J)=REFMT(1)*HMAT(1)+REFMT(2)*HMAT(2)+REFMT(3)*HMAT(3)
      DDB(2,2,J)=REFMT(4)*HMAT(1)+REFMT(5)*HMAT(2)+REFMT(6)*HMAT(3)
      DDB(3,2,J)=REFMT(7)*HMAT(1)+REFMT(8)*HMAT(2)+REFMT(9)*HMAT(3)
      DDB(4,2,J)=REFMT(1)*HMAT(4)+REFMT(2)*HMAT(5)+REFMT(3)*HMAT(6)
      DDB(5,2,J)=REFMT(4)*HMAT(4)+REFMT(5)*HMAT(5)+REFMT(6)*HMAT(6)
      DDB(6,2,J)=REFMT(7)*HMAT(4)+REFMT(8)*HMAT(5)+REFMT(9)*HMAT(6)
      DDB(7,2,J)=REFMT(1)*HMAT(7)+REFMT(2)*HMAT(8)+REFMT(3)*HMAT(9)
      DDB(8,2,J)=REFMT(4)*HMAT(7)+REFMT(5)*HMAT(8)+REFMT(6)*HMAT(9)
      DDB(9,2,J)=REFMT(7)*HMAT(7)+REFMT(8)*HMAT(8)+REFMT(9)*HMAT(9)
!
      DDB1=DDB(1,1,J)*R3THG(1)+DDB(4,1,J)*R3THG(2)+DDB(7,1,J)*R3THG(3)
      DDB2=DDB(2,1,J)*R3THG(1)+DDB(5,1,J)*R3THG(2)+DDB(8,1,J)*R3THG(3)
      DDB3=DDB(3,1,J)*R3THG(1)+DDB(6,1,J)*R3THG(2)+DDB(9,1,J)*R3THG(3)
      DDB4=DDB(1,1,J)*R3THG(4)+DDB(4,1,J)*R3THG(5)+DDB(7,1,J)*R3THG(4)
      DDB5=DDB(2,1,J)*R3THG(4)+DDB(5,1,J)*R3THG(5)+DDB(6,1,J)*R3THG(4)
      DDB6=DDB(3,1,J)*R3THG(4)+DDB(6,1,J)*R3THG(5)+DDB(9,1,J)*R3THG(4)
      DDB7=DDB(1,1,J)*R3THG(7)+DDB(4,1,J)*R3THG(8)+DDB(7,1,J)*R3THG(9)
      DDB8=DDB(2,1,J)*R3THG(7)+DDB(5,1,J)*R3THG(8)+DDB(8,1,J)*R3THG(9)
      DDB9=DDB(3,1,J)*R3THG(7)+DDB(6,1,J)*R3THG(8)+DDB(9,1,J)*R3THG(9)
!
      DDB(1,1,J)=DDB1
      DDB(2,1,J)=DDB2
      DDB(3,1,J)=DDB3
      DDB(4,1,J)=DDB4
      DDB(5,1,J)=DDB5
      DDB(6,1,J)=DDB6
      DDB(7,1,J)=DDB7
      DDB(8,1,J)=DDB8
      DDB(9,1,J)=DDB9
!
      DDB1=DDB(1,2,J)*R3THG(1)+DDB(4,2,J)*R3THG(2)+DDB(7,2,J)*R3THG(3)
      DDB2=DDB(2,2,J)*R3THG(1)+DDB(5,2,J)*R3THG(2)+DDB(8,2,J)*R3THG(3)
      DDB3=DDB(3,2,J)*R3THG(1)+DDB(6,2,J)*R3THG(2)+DDB(9,2,J)*R3THG(3)
      DDB4=DDB(1,2,J)*R3THG(4)+DDB(4,2,J)*R3THG(5)+DDB(7,2,J)*R3THG(6)
      DDB5=DDB(2,2,J)*R3THG(4)+DDB(5,2,J)*R3THG(5)+DDB(8,2,J)*R3THG(6)
      DDB6=DDB(3,2,J)*R3THG(4)+DDB(6,2,J)*R3THG(5)+DDB(9,2,J)*R3THG(6)
      DDB7=DDB(1,2,J)*R3THG(7)+DDB(4,2,J)*R3THG(8)+DDB(7,2,J)*R3THG(9)
      DDB8=DDB(2,2,J)*R3THG(7)+DDB(5,2,J)*R3THG(8)+DDB(8,2,J)*R3THG(9)
      DDB9=DDB(3,2,J)*R3THG(7)+DDB(6,2,J)*R3THG(8)+DDB(9,2,J)*R3THG(9)
!
      DDB(1,2,J)=DDB1
      DDB(2,2,J)=DDB2
      DDB(3,2,J)=DDB3
      DDB(4,2,J)=DDB4
      DDB(5,2,J)=DDB5
      DDB(6,2,J)=DDB6
      DDB(7,2,J)=DDB7
      DDB(8,2,J)=DDB8
      DDB(9,2,J)=DDB9
!
      DDR(1,J)= REFMT(1)*RM5OE(1)+REFMT(2)*RM5OE(4)+REFMT(3)*RM5OE(7)
      DDR(2,J)= REFMT(4)*RM5OE(1)+REFMT(5)*RM5OE(4)+REFMT(6)*RM5OE(7)
      DDR(3,J)= REFMT(7)*RM5OE(1)+REFMT(8)*RM5OE(4)+REFMT(9)*RM5OE(7)
      DDR(4,J)= REFMT(1)*RM5OE(2)+REFMT(2)*RM5OE(5)+REFMT(3)*RM5OE(8)
      DDR(5,J)= REFMT(4)*RM5OE(2)+REFMT(5)*RM5OE(5)+REFMT(6)*RM5OE(8)
      DDR(6,J)= REFMT(7)*RM5OE(2)+REFMT(8)*RM5OE(5)+REFMT(9)*RM5OE(8)
      DDR(7,J)= REFMT(1)*RM5OE(3)+REFMT(2)*RM5OE(6)+REFMT(3)*RM5OE(9)
      DDR(8,J)= REFMT(4)*RM5OE(3)+REFMT(5)*RM5OE(6)+REFMT(6)*RM5OE(9)
      DDR(9,J)= REFMT(7)*RM5OE(3)+REFMT(8)*RM5OE(6)+REFMT(9)*RM5OE(9)
!
      DDR1=DDR(1,J)*DR3TDW(1)+DDR(4,J)*DR3TDW(2)+DDR(7,J)*DR3TDW(3)
      DDR2=DDR(2,J)*DR3TDW(1)+DDR(5,J)*DR3TDW(2)+DDR(8,J)*DR3TDW(3)
      DDR3=DDR(3,J)*DR3TDW(1)+DDR(6,J)*DR3TDW(2)+DDR(9,J)*DR3TDW(3)
      DDR4=DDR(1,J)*DR3TDW(4)+DDR(4,J)*DR3TDW(5)+DDR(7,J)*DR3TDW(6)
      DDR5=DDR(2,J)*DR3TDW(4)+DDR(5,J)*DR3TDW(5)+DDR(8,J)*DR3TDW(6)
      DDR6=DDR(3,J)*DR3TDW(4)+DDR(6,J)*DR3TDW(5)+DDR(9,J)*DR3TDW(6)
      DDR7=DDR(1,J)*DR3TDW(7)+DDR(4,J)*DR3TDW(8)+DDR(7,J)*DR3TDW(9)
      DDR8=DDR(2,J)*DR3TDW(7)+DDR(5,J)*DR3TDW(8)+DDR(8,J)*DR3TDW(9)
      DDR9=DDR(3,J)*DR3TDW(7)+DDR(6,J)*DR3TDW(8)+DDR(9,J)*DR3TDW(9)
!
      DDR(1,J)=DDR1
      DDR(2,J)=DDR2
      DDR(3,J)=DDR3
      DDR(4,J)=DDR4
      DDR(5,J)=DDR5
      DDR(6,J)=DDR6
      DDR(7,J)=DDR7
      DDR(8,J)=DDR8
      DDR(9,J)=DDR9
!
   10 END DO
!
      RETURN
      END
