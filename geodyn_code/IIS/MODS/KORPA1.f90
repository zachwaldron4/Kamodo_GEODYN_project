!$KORPA1
      SUBROUTINE KORPA1(KORE,NCORE)
!********1*********2*********3*********4*********5*********6*********7**
! KORPA1           06/07/83            0000.0    PGMR - BILL EDDY
!
! FUNCTION:         CALCULATE POINTERS FOR FIRST DYNAMIC ALLOCATION
!                   ARRAYS. THE FOLLOWING GROUPS ARE ALLOCATED FOR:
!                       . A1TIME,POLAR MOTION AND FLUX
!                       . SELECT/DELETE ARRAYS FOR DATA HANDLING
!                       . MEASUREMENT BIASES
!                       . STATION POSITION ARRAYS
!                       . ARC FORCE MODEL PARAMETERS
!                       . POLAR MOTION
!                       . OCEAN LOADING
!                       . TIME DEPENDENT GRAVITY ARRAYS
!                       . TIME DEPENDENT SEA SURFACE TOPOGRAPHY
!
! I/O PARAMETERS:
!
!   NAME    I/O  A/S   DESCRIPTION OF PARAMETERS
!   ------  ---  ---   ------------------------------------------------
!   KORE     I         (3,NCORE) ARRAY CONTAINING REAL,INTEGER AND
!                      LOGICAL CORE REQUIREMENTS FOR EACH ALLOCATION
!                      GROUP.
!   NCORE    I         NUMBER OF ALLOCATION GROUPS
!
! COMMENTS:
!                             COMMON BLOCKS /CORA/,/CORI/,/CORL/
!                             CONTAIN THE REAL,INTEGER AND LOGICAL
!                             POINTERS CALCULATED IN THIS ROUTINE
!********************************************************************
      IMPLICIT DOUBLE PRECISION (A-H,O-Z), LOGICAL(L)
      SAVE
!
      COMMON/ARCPAR/MAXSEL,NSEL,MAXDEL,NDEL,MAXMET,NMETDT,NSATID,       &
     &              IATDEN,ISATEQ,ITRMAX,ITRMIN,ITRMX2,                 &
     &              MJDSRF,MREFSY,NTDDR,NBTOTL,IDRAGM,IMRNUT,           &
     &              NXARCP
      COMMON/ACCELR/NSATAC,NACCB,NSATDY,NDYNAC,NXACC,                   &
     &       MXACC,NXACCX,MXACCX,NXISSM,MXISSM,NXS1,MXS1,NXS2,MXS2,     &
     &       NXPPN,MXPPN,NXSBS,MXSBS,NSATHR,NFACCB(2,200),NFATIT(2,200),&
     &       MRAT,NBAPPD(200),NDYNPD(200),IACSAT(200),NACB(200),        &
     &       IDNSAT(200),NDYN(200)
      COMMON/BIASNX/IEBIAS(4  ),IMBIAS(2)  ,IBSCAL(1),ITBIAS(1),        &
     &              IBREFR(3,2),KLKSTA(4,2),KLKSAT(4,2),KLKSTS(2,2),    &
     &              ITRPZE(2,2),ITRPGR(2,4),IBBIAS(1),NBKBIA,NDXBS1,  &
     &              NXBIAS
      COMMON/BINBUF/NBUFIN,NLENI ,MAXBUF,MAXOBS,NBUFOT,NLENO ,NMAXOT,   &
     &              KBUFOT,MXBLEN,MAXTDD,NLENDR,MOBSBK,MXTIMB,          &
     &              MXOBSB,IIOBDR,IPSMAX,ILIMBK,NPASS ,MVERSN,NXBINB
      COMMON/BWINTG/NMSLAB,NAREPT,NSPRPT,NDFRPT,NEMIPT,NTMAPT,NTMCPT,   &
     &      NTMDPT,NTMFPT,NTHXPT,MXSLAB,MXARPT,MXSRPT,MXDFPT,MXEMPT,    &
     &      MXTAPT,MXTCPT,MXTDPT,MXTFPT,MXTXPT,NXBWIN
      COMMON/CGVTMI/NCDT,NSDT,NCPD,NSPD,NCDTA,NSDTA,NCPDA,NSPDA,NGRVTM, &
     &       KCDT,KCPDA,KCPDB,KSDT,KSPDA,KSPDB,KOMGC,KOMGS,KCOMGC,      &
     &       KSOMGC,KCOMGS,KSOMGS,NXGVTI
      COMMON/CTIDES/NTIDE ,NSTADJ,NET   ,NETADJ,NETUN ,NOT   ,NOTADJ,   &
     &              NOTUN ,NETUNU,NETADU,NOTUNU,NOTADU,NBSTEP,KTIDA(3), &
     &              ILLMAX,NUNPLY,NNMPLY,NDOODN,MXTMRT,NRESP ,NXCTID
      COMMON/CORA  /KA1UTC,KA1UT1,KXP   ,KYP   ,KEOPDP,KEOPDS,KFLXS ,   &
     &              KFLXM ,KFLXAV,KBIN  ,KBOUT ,KOBDR ,KDAT1 ,KDAT2 ,   &
     &              KDAT3 ,KSCOB ,KB1   ,KB2   ,KB3   ,KBSIGM,KBBIAS,   &
     &              JDSCRP,JDPSR ,JPOLIN,JPUTBH,JXNMOL,JEAQFB,JEAQFE,   &
     &              JEAEFB,JEAEFE,JEAINT,JEASTP,JEAVER,JATPER,JTACCL,   &
     &              JTIMES,JTDYNS,JTIMED,JEXACT,JXACIN,JCTBTI,JCTBWE,   &
     &              JCTCTM,JRTMTB,JVLOPT,JSIGSP,JSSDST,JSSDSR,JSSDDG,   &
     &              JXCGST,JXCGDT,JTACFB,JTACFE,JTAVER,JTAEFB,JTAEFE,   &
     &              JTAINT,JTASTP,JNUTIN,JNUTMD,JDWNWT,NXCORA
      COMMON/CORI  /KNAME ,KSTA  ,KCONFG,KTYPE ,KSATCD,KMOD  ,KDAY1 ,   &
     &              KTIM1 ,KDAY2 ,KTIM2 ,KVBAS ,KVSTA ,KSATID,KISETN,   &
     &              KVBSTA,KVBVEL,KQUAID,KBNQUA,KBSTA1,KBSAT1,KBTYPE,   &
     &              KBTIM1,KBTIM2,KBIDX, KKPTR ,KSATEQ,JIORFR,JIPDFR,   &
     &              JINDPI,KPSSTA,KPSSAT,KPSTYP,KPSBIA,KPSBLK,KPSTIM,   &
     &              KPSPTR,JEBSTA,JEBSAT,JEBTYP,JEBBEG,JEBEND,JBKBIA,   &
     &              JIPOLC,JIBASP,JIPDAD,JIPDRD,JISTOL,JGTSRT,JGTSRA,   &
     &              JSSTPT,JSSTPA,JSSTFQ,JNPANE,JIFACE,JIPARE,JIPSPR,   &
     &              JIPDIF,JIPEMI,JIPTPA,JIPTPC,JIPTMD,JIPTMF,JIPTHX,   &
     &              JNADAR,JNADSP,JNADDF,JNADEM,JNADTA,JNADTC,JNADTD,   &
     &              JNADTF,JNADTX,JNMOVE,JEASID,JEAQSB,JEAQSE,JEANPA,   &
     &              JEAESB,JEAESE,JEAPNT,JEANMQ,KVBSL2,KVBSH2,KBATYP,   &
     &              JNRDGA,JNRDDR,JNRDSR,JCSETA,JCSETD,JCSETS,JVSETA,   &
     &              JVSETD,JVSETC,JSTRTA,JSTRTD,JSTRTS,JNSTLV,JSLVID,   &
     &              JATSAT,JKVLAS,JYWSID,JLOV  ,JCBID ,JCBDEG,JSATAC,   &
     &              JSATDY,JSATHR,JACSID,JCTBST,JSRTTB,JTMPTB,JSTBST,   &
     &              JDN   ,JDN2  ,JDN3  ,JALSIT,JAPLST,KBDEGR,KBNODE,   &
     &              KBNPRM,KBSSTA,JBSPLN,JSSPLN,JNEXCG,JIDEXC,JNREXC,   &
     &              JWEMGA,JWEMDR,JTPATS,KSIGOV,JTACSB,JTACSE,JTASID,   &
     &              JTAESB,JTAESE,JTANMC,JTAPNT,JTANPA,JGPSID,JGPSBL,   &
     &              JGPSND,JPNALB,JTDSAT,JTDANT,NXCORI
      COMMON/CORL  /KLKEEP,JLAFRC,KPSOUT,KPSOPN,KNBCDT,KQUADJ,JLEBIS,   &
     &              JLAJOL,JEAFIL,JLRDGA,JLRDDR,JLRDSR,JACFIL,KQVADJ,   &
     &              JTAFIL,NXCORL
      COMMON/COREQ /NCHRLY,MAXUTC,MAXUT1,MAXFLX,MAXDSC,KORSUM(3),       &
     &              KORSM2(3),NXCORQ
      COMMON/CORBNF/MAXINF,NORBNF,INFSTA(15),INFNDX(15),INFSTR,INFSTP,  &
     &              INFRT ,NXCORB
      COMMON/DELAY /NTDL
      COMMON/DWNWGT/LDWNWT,LDNWMT(999),NXDWNW
      COMMON/EXTAGI/MTASAT,MTAFIL,MTAMEM,MTAPLA,NXTAGI
      COMMON/EXTAGL/LEXTHC,NXTAGL
      COMMON/EXACGI/MACSAT,MACFIL,NXACGI
      COMMON/EXATGI/MEASAT,MEAFIL,MEAMEM,MEAPLA,MEAANT,NXEAGI
      COMMON/GLBPAR/NARCS,NDPOLE,NDCSA,MXDEGG,MXORDG,NSRA,              &
     &              NDUMMY,MAXPAS,NXGLBP
      COMMON/GPSINT/IGPSBW,NGPSBW
      COMMON/IEPHM2/ISUPL,ICBODY,ISEQB(2),MAXDEG,ITOTSE,IREPL(988),  &
     &              NXEPH2
      COMMON/KNTSTS/KNTACC(9,40),MKNTAC,KNTDRG,KNTSLR,MAXNGA,MAXNDR,    &
     &              MAXNSR,NXKNTS
      COMMON/NALOAD/NSITES,NALFIL,NALSIT,MAXSIT,ITOTAL,MAXAPL,ITAPLB,   &
     &              ITAPLE,IAPLDT,NXLOAD
      COMMON/MBIAS /NBIASK,NBIASA,NBIASG,NBCDP,NBCDT,                   &
     &              NUMPAS,NPSFIL,NARCBS,NEBKNT,NXMBIA
      COMMON/MBIAST/MBTRAD,MBTRUN,ICONBIA,IPRCTP,IPREND,NXMBST
      COMMON/MBSGLB/MBIASK,MBIASA,MBIASG,MBCDP,MBCDT,MARCBS,            &
     &              NBIST2,MEBKNT,NBIAST,NXMBGB
      COMMON/NUTINF/NNUT,NNUTAA,NXNUTA
      COMMON/OLDMOD/NTOLFR,NTOLF2,NTOLMD,NSTAOL,NSITOL,NTOLAJ,MXOLSA,   &
     &              NPOLSH,                                             &
     &              NXOLMD
      COMMON/POLINF/NPOLE,NPOLEA,NUTA,MXUTC,NMODEL,NXPOLI
      COMMON/SPBIAS/NCTSTA,NXSPB
      COMMON/SSLIST/MXBAS,MXSTA,MXSAT,MXBSTA,MXSTV,MXQUA,NXSSLI
      COMMON/SSTCOM/NCBAR, NSBAR ,NCDOT ,NSDOT ,NCAPRD,NCBPRD,NSAPRD,   &
     &              NSBPRD,NCBARA,NSBARA,NCDOTA,NSDOTA,NCAPDA,NCBPDA,   &
     &              NSAPDA,NSBPDA,ISSTEP,NXSST
      COMMON/TOPOVR/NMTPAT,MXTPAT,NOVRID,NGCATT,NTPBIA,NSTLVS,          &
     &              NISLV, NYWBIA,MSATYW,MAXYWB,NSATTP,NXTOPO
      COMMON/UNITS /IUNT01,IUNT02,IUNT03,IUNT05,IUNT06,IUNT07,IUNT11,   &
     &              IUNT12,IUNT15,IUNT16,                               &
     &              IUNT30,IUNT31,IUNT39,IUNT40,IUNT41,IUNT42,IUNT43,   &
     &              IUNT50,IUNT52,IUNT53,IUNT60,IUNT90,IUNT91,IUNT99,   &
     &              ILINE(2),IPAGE(2),MLINEP(2),MAXCOL(2),IUNT17,       &
     &              IUNT70,IUNT71,                                      &
     &              IUNT88,NXUNIT
      COMMON/VLBI/NQUA,NADJQ,NADJQV,NQUAB,IYMDV,NVOPT,NXVLBI
      COMMON/LSFSHD/LSLFSH, NXSLFS
      COMMON/SLFSHD/NSHSAT,IDSASH(200),NSPANL(200),IFLGSH(200),        &
     &              IATYSH(200),NSHRCD(200),MNSHPL,NXSFSD
      COMMON/EXCGCR/NEXCG,IDEXCG(200),IFTPCG(200),NRCDCG(200),NXEXCG
!
      DIMENSION KORE(3,NCORE)
!**********************************************************************
! START OF EXECUTABLE CODE ********************************************
!**********************************************************************
!
      MAXCDS=MAXSEL+MAXDEL+MAXMET
!
! INITIALIZE POINTER INDICES
!
      KOREAA=1
      KOREII=1
      KORELL=1
!
! CALCULATE GROUP1 POINTERS: A1TIME,POLAR MOTION,FLUX ARRAYS
!
!     SET GROUP NUMBER
      IGROUP=1
!     SET TYPE INDICATOR: 1=FLOATING POINT,2=INTEGER,3=LOGICAL
      IT=1
! FLOATING POINT ARRAYS:
!  (A1UTC(3,MAXUTC)+1),(A1UT1,XP,YP;MAXUT1),(FLUXS,FLUXM,FLXAV;MAXFLX)
      IDYFLX=1
      IATDN=IATDEN/10
      IF((IATDN.EQ.4).OR.(IATDN.EQ.5).OR.(IATDN.EQ.6)) IDYFLX=8
!
      KA1UTC=KOREAA
      KA1UT1=KA1UTC+3*MAXUTC+1
      KXP   =KA1UT1+MAXUT1
      KYP   =KXP+MAXUT1
      KEOPDP=KYP+MAXUT1
      KEOPDS=KEOPDP+MAXUT1
      KFLXS =KEOPDS+MAXUT1
      KFLXM =KFLXS+MAXFLX
      KFLXAV=KFLXM+MAXFLX*IDYFLX
      KOREAA=KFLXAV+MAXFLX
      IF(KOREAA-KA1UTC .NE. KORE(IT,IGROUP)) GO TO 5000
! INTEGER ARRAYS:
      IT=2
      JLOV=KOREII
      KOREII=JLOV+ICBODY
      JCBID=KOREII
      KOREII=JCBID+ICBODY
      JCBDEG=KOREII
      KOREII=JCBDEG+ICBODY
      IF(KOREII-JLOV .NE. KORE(IT,IGROUP)) GO TO 5000
! LOGICAL ARRAYS:
      IT=3
      JLEBIS=KORELL
      KORELL=JLEBIS+MAXDSC
      IF(KORELL-JLEBIS .NE. KORE(IT,IGROUP)) GOTO 5000
!
! CALCULATE GROUP2 POINTERS:
!     SELECT/DELETE ARRAYS FOR DATA HANDLING
!     SET GROUP NUMBER
!     PASS DIRECTORY FOR USE BY SUBROUTINE BINARY
      IGROUP=2
!     SET TYPE INDICATOR: 1=FLOATING POINT,2=INTEGER,3=LOGICAL
      IT=1
!  FLOATING POINT ARRAYS:
      KBIN  =KOREAA
      KBOUT =KBIN+MAXBUF*10*NLENI
      KOBDR =KBOUT+NLENO*NMAXOT
      KDAT1 =KOBDR+NLENDR
      KDAT2 =KDAT1+MAXCDS
      KDAT3 =KDAT2+MAXCDS
      KSCOB =KDAT3+MAXCDS
      KB1   =KSCOB+3*MAXOBS
!     KB2   =KB1+MAXOBS
!     KB3   =KB2+MAXOBS
      KB2   =KB1+3000
      KB3   =KB2+3000
!     JDSCRP=KB3+MAXOBS
      JDSCRP=KB3+3000
      JTACCL=JDSCRP+7*MAXDSC
      JTIMES=JTACCL+3*NACCB
      JTDYNS=JTIMES+2*NACCB*NSATAC
      JTIMED=JTDYNS+3*NDYNAC
      JEXACT=JTIMED+2*NDYNAC*NSATDY
      JXACIN=JEXACT+MXSAT*2
      KOREAA=JXACIN+MXSAT
      IF(KOREAA-KBIN   .NE. KORE(IT,IGROUP)) GO TO 5000
! INTEGER ARRAYS:
      IT=2
      KNAME =KOREII
      KSTA  =KNAME+MAXCDS
      KCONFG=KSTA+MAXCDS
      KTYPE =KCONFG+MAXCDS
      KSATCD=KTYPE+MAXCDS
      KMOD  =KSATCD+MAXCDS
      KDAY1 =KMOD+MAXCDS
      KTIM1 =KDAY1+MAXCDS
      KDAY2 =KTIM1+MAXCDS
      KTIM2 =KDAY2+MAXCDS
      KKPTR =KTIM2+MAXCDS
      KPSSTA=KKPTR+MAXOBS
      KPSSAT=KPSSTA+IPSMAX*3
      KPSTYP=KPSSAT+IPSMAX*3
      KPSBIA=KPSTYP+IPSMAX
!      KPSBLK=KPSBIA+IPSMAX*30
      KPSBLK=KPSBIA+IPSMAX*NBKBIA
      KPSTIM=KPSBLK+ILIMBK*IPSMAX
      KPSPTR=KPSTIM+IPSMAX*2
      JSATAC=KPSPTR+IPSMAX
      JSATDY=JSATAC+NSATAC
      JSATHR=JSATDY+NSATDY
      JDN   =JSATHR+NSATHR
      JDN2  =JDN   + NTIDE
      JDN3  =JDN2  + NTIDE+NTOLMD
      KOREII=JDN3  + NTIDE+10
      KSIGOV=KOREII
      KOREII=KSIGOV+MAXCDS
      IF(KOREII-KNAME  .NE. KORE(IT,IGROUP)) GO TO 5000
!  LOGICAL ARRAYS:
      IT=3
      KLKEEP=KORELL
      KPSOUT=KLKEEP+MXOBSB
      KPSOPN=KPSOUT+IPSMAX
      KORELL=KPSOPN+IPSMAX
      IF(KORELL-KLKEEP .NE. KORE(IT,IGROUP)) GO TO 5000
!
! CALCULATE GROUP3 POINTERS:
!     MEASUREMENT BIASES
!     SET GROUP NUMBER
      IGROUP=3
!     SET TYPE INDICATOR: 1=FLOATING POINT,2=INTEGER,3=LOGICAL
      IT=1
!  FLOATING POINT ARRAYS:
      KBSIGM=KOREAA
      KBBIAS=KBSIGM+NBIAST
      JCTBTI=KBBIAS+NBIAST
      JCTBWE=JCTBTI+ICONBIA*2
      JCTCTM=JCTBWE+ICONBIA
      JRTMTB=JCTCTM+ICONBIA
      JVLOPT=JRTMTB+ICONBIA
      JSIGSP=JVLOPT+NVOPT*64
      KOREAA= JSIGSP+ 6*NCTSTA
! EXTERNAL CGMASS COORDINATES
      JXCGST=KOREAA
      JXCGDT=KOREAA+NEXCG
      KOREAA=JXCGDT+NEXCG
! ELEVATION DEPENDENT DOWNWEIGHTING
      JDWNWT=KOREAA
      IF (LDWNWT) KOREAA=JDWNWT+90*111

      IF(KOREAA-KBSIGM .NE. KORE(IT,IGROUP)) GOTO 5000
!  INTEGER ARRAYS:
      IT=2
      KBSTA1=KOREII
      KBSAT1=KBSTA1+NBIAST*3
      KBTYPE=KBSAT1+NBIAST*3
      KBTIM1=KBTYPE+NBIAST
      KBTIM2=KBTIM1+NBIAST
      KBIDX =KBTIM2+NBIAST
      JEBTYP=KBIDX+NBIAST
      JEBBEG=JEBTYP+MEBKNT
      JEBEND=JEBBEG+MEBKNT
      JEBSTA=JEBEND+MEBKNT
      JEBSAT=JEBSTA+3*MEBKNT
      JBKBIA=JEBSAT+3*MEBKNT
      KBATYP=JBKBIA+NBKBIA
      JCTBST=KBATYP+NBIAST
      JSRTTB=JCTBST+ICONBIA
      JTMPTB=JSRTTB+ICONBIA
      JSTBST=JTMPTB+ICONBIA
      JALSIT=JSTBST+MBTRAD
      JAPLST=JALSIT+MAXSIT
      KBDEGR=JAPLST+MAXSIT
      KBNODE=KBDEGR+NBIAST*3
      KBNPRM=KBNODE+NBIAST*3
      KBSSTA=KBNPRM+NBIAST*3
      JBSPLN=KBSSTA+NBIAST*2
      JSSPLN=JBSPLN+NCTSTA*5
      KOREII=JSSPLN+NCTSTA*2
! EXTERNAL CGMASS COORDINATES
      JNEXCG=KOREII
      JIDEXC=JNEXCG+1
      JNREXC=JIDEXC+NEXCG
      KOREII=JNREXC+NEXCG
!
      IF(KOREII-KBSTA1 .NE. KORE(IT,IGROUP)) GOTO 5000
      IT=3
      KNBCDT=KORELL
      KORELL=KNBCDT+NBIAST
      IF(KORELL-KNBCDT .NE. KORE(IT,IGROUP)) GOTO 5000
!
! CALCULATE GROUP4 POINTERS:
!     STATION POSITION ARRAYS
!     SET GROUP NUMBER
      IGROUP=4
!     SET TYPE INDICATOR: 1=FLOATING POINT,2=INTEGER,3=LOGICAL
      IT=1
!  FLOATING POINT ARRAYS:
      IF(KOREAA-KOREAA .NE. KORE(IT,IGROUP)) GOTO 5000
!  INTEGER ARRAYS:
      IT=2
      KVBAS =KOREII
      KVSTA =KVBAS +MXBAS
      KSATID=KVSTA +MXSTA
      KISETN=KSATID+MXSAT
      KVBSTA=KISETN+MXSAT
      KVBVEL=KVBSTA+MXBSTA+NORBNF
      KQUAID=KVBVEL+MXBSTA
      KBNQUA=KQUAID+MXQUA
      KVBSL2=KBNQUA+MXQUA
      KVBSH2=KVBSL2+MXBSTA
      KOREII=KVBSH2+MXBSTA
      IF(KOREII-KVBAS  .NE. KORE(IT,IGROUP)) GOTO 5000
! LOGICAL ARRAYS:
      IT=3
      KQUADJ=KORELL
      KQVADJ=KQUADJ+MXQUA
      KORELL=KQVADJ+MXQUA
      IF(KORELL-KQUADJ .NE. KORE(IT,IGROUP)) GOTO 5000
!
! CALCULATE GROUP5 POINTERS:
!     ARC FORCE MODEL PARAMETER COUNT
!     SET GROUP NUMBER
      IGROUP=5
!     SET TYPE INDICATOR: 1=FLOATING POINT,2=INTEGER,3=LOGICAL
      IT=1
!  FLOATING POINT ARRAYS:
      JEAQFB=KOREAA
      JEAQFE=JEAQFB+MEASAT
      JEAEFB=JEAQFE+MEASAT
      JEAEFE=JEAEFB+MEASAT
      JEAINT=JEAEFE+MEASAT
      JEASTP=JEAINT+MEASAT
      JEAVER=JEASTP+MEASAT
      JATPER=JEAVER+NARCS
      KOREAA=JATPER+MXSAT
      IEXTA=0
      if(LEXTHC) IEXTA=1
      JTACFB=KOREAA
      JTACFE=JTACFB+MTASAT*IEXTA
      JTAEFB=JTACFE+MTASAT*IEXTA
      JTAEFE=JTAEFB+MTASAT*IEXTA
      JTAINT=JTAEFE+MTASAT*IEXTA
      JTASTP=JTAINT+MTASAT*IEXTA
      JTAVER=JTASTP+MTASAT*IEXTA
      KOREAA=JTAVER+MTAFIL*IEXTA

! SELF SHADOWING
      JSSDST=KOREAA
      IF(LSLFSH) THEN
        JSSDSR=JSSDST+3*NSHSAT+2*MNSHPL
        JSSDDG=JSSDSR
        DO ISAT=1,NSHSAT
          IF(IFLGSH(ISAT).EQ.10.OR.IFLGSH(ISAT).EQ.11) THEN
            JSSDDG=JSSDDG+NSPANL(ISAT)*NSHRCD(ISAT)
          ENDIF
        ENDDO
        KOREAA=JSSDDG
        DO ISAT=1,NSHSAT
          IF(IFLGSH(ISAT).EQ.1 .OR.IFLGSH(ISAT).EQ.11) THEN
            KOREAA=KOREAA+NSPANL(ISAT)*NSHRCD(ISAT)
          ENDIF
        ENDDO
      ELSE
        JSSDSR=JSSDST
        JSSDDG=JSSDSR
        KOREAA=JSSDDG
      ENDIF
!
      IF(KOREAA-JEAQFB .NE. KORE(IT,IGROUP)) GOTO 5000
!  INTEGER ARRAYS: NSATEQ(2,ISATEQ,MXSAT)
      IT=2
      KSATEQ=KOREII
      JIORFR=KSATEQ+2*ISATEQ*MXSAT
      JIPDFR=JIORFR+3*MXSAT
      JIBASP=JIPDFR+3*MXSAT
      JIPDAD=JIBASP+3*MXSAT
      JIPDRD=JIPDAD+3*MXSAT
      JNPANE=JIPDRD+6*MXSAT
      JNADAR=JNPANE+MXSAT
      JNADSP=JNADAR+MXSAT
      JNADDF=JNADSP+MXSAT
      JNADEM=JNADDF+MXSAT
      JNADTA=JNADEM+MXSAT
      JNADTC=JNADTA+MXSAT
      JNADTD=JNADTC+MXSAT
      JNADTF=JNADTD+MXSAT
      JNADTX=JNADTF+MXSAT
      JNMOVE=JNADTX+MXSAT
      JIFACE=JNMOVE+MXSAT
      JIPARE=JIFACE+MXSLAB
      JIPSPR=JIPARE+MXARPT
      JIPDIF=JIPSPR+MXSRPT
      JIPEMI=JIPDIF+MXDFPT
      JIPTPA=JIPEMI+MXEMPT
      JIPTPC=JIPTPA+MXTAPT
      JIPTMD=JIPTPC+MXTCPT
      JIPTMF=JIPTMD+MXTDPT
      JIPTHX=JIPTMF+MXTFPT
      JEASID=JIPTHX+MXTXPT
      JEAQSB=JEASID+MEASAT
      JEAQSE=JEAQSB+MEASAT
      JEANPA=JEAQSE+MEASAT
      JEAESB=JEANPA+MEASAT
      JEAESE=JEAESB+MEASAT
      JEAPNT=JEAESE+MEASAT
      JEANMQ=JEAPNT+MEASAT
      JNRDGA=JEANMQ+MEASAT
      JNRDDR=JNRDGA+9*MXSAT*MKNTAC
      JNRDSR=JNRDDR+MXSAT*KNTDRG
      JCSETA=JNRDSR+MXSAT*KNTSLR
      JCSETD=JCSETA+9*MXSAT
      JCSETS=JCSETD+MXSAT
      JVSETA=JCSETS+MXSAT
      JVSETD=JVSETA+9*MXSAT
      JVSETC=JVSETD+MXSAT
      JSTRTA=JVSETC+MXSAT
      JSTRTD=JSTRTA+9*MXSAT*MKNTAC
      JSTRTS=JSTRTD+MXSAT*KNTDRG
      JNSTLV=JSTRTS+MXSAT*KNTSLR
      JSLVID=JNSTLV+NSTLVS
      JATSAT=JSLVID+NSTLVS
      JKVLAS=JATSAT+MXSAT
      JYWSID=JKVLAS+MXSAT*10
      JACSID=JYWSID+NYWBIA
      KOREII=JACSID+MACSAT
      JWEMGA=KOREII
      JWEMDR=JWEMGA+9*MXSAT*MKNTAC
      KOREII=JWEMDR+MXSAT*KNTDRG
      JTPATS=KOREII
      KOREII=JTPATS+NSATTP
      JTASID=KOREII
      JTACSB=JTASID+MTASAT
      JTACSE=JTACSB+MTASAT
      JTANPA=JTACSE+MTASAT
      JTAESB=JTANPA+MTASAT
      JTAESE=JTAESB+MTASAT
      JTANMC=JTAESE+MTASAT
      JTAPNT=JTANMC+MTASAT
      KOREII=JTAPNT+MTASAT
      JGPSID=KOREII
      KOREII=JGPSID+IGPSBW
      JGPSBL=KOREII
      KOREII=JGPSBL+IGPSBW
      JGPSND=KOREII
      KOREII=JGPSND+IGPSBW*9
      JPNALB=KOREII
      KOREII=JPNALB+MXSLAB
!  ANTENA TRANSPONDER DELAY
      JTDSAT=KOREII
      KOREII= JTDSAT+NTDL
      JTDANT=KOREII
      KOREII= JTDANT+NTDL
      IF(KOREII-KSATEQ .NE. KORE(IT,IGROUP)) GOTO 5000
! LOGICAL ARRAYS:
      IT=3
      JLAFRC=KORELL
      JEAFIL=JLAFRC+4*3*MXSAT
      JLRDGA=JEAFIL+MEASAT
      JLRDDR=JLRDGA+9*MXSAT
      JLRDSR=JLRDDR+MXSAT
      JACFIL=JLRDSR+MXSAT
      JTAFIL=JACFIL+MACSAT
      KORELL=JTAFIL+MTASAT
      IF(KORELL-JLAFRC .NE. KORE(IT,IGROUP)) GOTO 5000
!**********************************************************************
!  CALCULATE GROUP 6 POINTERS: POLAR MOTION
!*********************************************************************
!  SET GROUP POINTER
      IGROUP=6
!  SET TYPE POINTER
      IT=1
!*************************
! FLOATING POINT ARRAYS **
!*************************
! DPSR   - POLE TIMES(INITIALLY MID POINT TIMES THEN CHANGED TO START
!                    TIMES IN POLEUT) - ALLOCATED LARGE ENOUGH FOR
!                    GENERATION OF POLE INTERVALS IF TIME GAPS EXIST
! POLINT - POLE INTERVAL
! PUTBIH - BIH VALUES FOR POLE &UT DATA
! KNUTMD(NNUT) - NUTATION TIMES (MIDPOINT OF INTERVALS)
! KNUTIN(NNUT) - NUTATION INTERVAL LENGTH
      JDPSR =KOREAA
      JPOLIN=JDPSR +NPOLE*2+1
      JPUTBH=JPOLIN+NPOLE*2+1
      KOREAA=JPUTBH+3*(NPOLE*2+1)
      JNUTIN=KOREAA
      JNUTMD=JNUTIN + NNUT
      KOREAA=JNUTMD + NNUT
!
! TEST FOR POINTER AND CORE ALLOCATION AGREEMENT
!
      IF(KOREAA-JDPSR .NE.KORE(IT,IGROUP)) GO TO 5000
!******************
! INTEGER ARRAYS **
!******************
      IT=2
!
      JINDPI=KOREII
      JIPOLC=JINDPI+(NPOLE*2+1)
      KOREII=JIPOLC+(NPOLE*2+1)
!
! TEST FOR POINTER AND CORE ALLOCATION AGREEMENT
!
      IF(KOREII-JINDPI.NE.KORE(IT,IGROUP)) GO TO 5000
!******************
! LOGICAL ARRAYS **
!******************
      IT=3
!
! TEST FOR POINTER AND CORE ALLOCATION AGREEMENT
!
      IF(KORELL-KORELL.NE.KORE(IT,IGROUP)) GO TO 5000
!
! CALCULATE GROUP7 POINTERS: OCEAN LOADING
!
!     SET GROUP NUMBER
      IGROUP=7
!     SET TYPE INDICATOR: 1=FLOATING POINT,2=INTEGER,3=LOGICAL
      IT=1
! FLOATING POINT ARRAYS:
!  (XNUMOL(NTOLMD))
      JXNMOL=KOREAA
      KOREAA=JXNMOL+NTOLMD
      IF(KOREAA-JXNMOL .NE. KORE(IT,IGROUP)) GO TO 5000
! INTEGER ARRAYS:
!  (ISITOL(NTOLMD))
      IT=2
      JISTOL=KOREII
      KOREII=JISTOL+NTOLMD
      IF(KOREII-JISTOL .NE. KORE(IT,IGROUP)) GO TO 5000
! LOGICAL ARRAYS:
!  (LAJOL(NTOLMD))
      IT=3
      JLAJOL=KORELL
      KORELL=JLAJOL+NTOLMD
      IF(KORELL-JLAJOL .NE. KORE(IT,IGROUP)) GOTO 5000
!
!**********************************************************************
!  CALCULATE GROUP 8 POINTERS: TIME DEPENDENT GRAVITY ARRAYS
!*********************************************************************
!  SET GROUP POINTER
      IGROUP=8
!  SET TYPE POINTER (1:FLOATING POINT,2:INTEGER,3:LOGICAL)
!*************************
! FLOATING POINT ARRAYS **
!*************************
! NONE
      IT=1
!******************
! INTEGER ARRAYS **
!******************
      IT=2
!
      JGTSRT=KOREII
      JGTSRA=JGTSRT+NCDT+NSDT+3*(NCPD+NSPD)
      KOREII=JGTSRA+NCDTA+NSDTA+2*(NCPDA+NSPDA)
!
! TEST FOR POINTER AND CORE ALLOCATION AGREEMENT
!
      IF(KOREII-JGTSRT.NE.KORE(IT,IGROUP)) GO TO 5000
!******************
! LOGICAL ARRAYS **
!******************
! NONE
      IT=3
!
! TEST FOR POINTER AND CORE ALLOCATION AGREEMENT
!
      IF(KORELL-KORELL.NE.KORE(IT,IGROUP)) GO TO 5000
!
!**********************************************************************
!  CALCULATE GROUP 9 POINTERS: SEA SURFACE TOPOGRAPHY ARRAYS
!*********************************************************************
!  SET GROUP POINTER
      IGROUP=9
!  SET TYPE POINTER (1:FLOATING POINT,2:INTEGER,3:LOGICAL)
!*************************
! FLOATING POINT ARRAYS **
!*************************
! SSTFRQ
      IT=1
!
      JSSTFQ=KOREAA
      KOREAA=JSSTFQ+NCBAR+NSBAR+NCDOT+NSDOT+NCAPRD+NCBPRD+NSAPRD+NSBPRD
! TEST FOR POINTER AND CORE ALLOCATION AGREEMENT
!
      IF(KOREAA-JSSTFQ.NE.KORE(IT,IGROUP)) GO TO 5000
!******************
! INTEGER ARRAYS **
!******************
! ISSTPT,ISSTPA
      IT=2
!
      JSSTPT=KOREII
      JSSTPA=JSSTPT+NCBAR+NSBAR+NCDOT+NSDOT+NCAPRD+NCBPRD+NSAPRD+NSBPRD
      KOREII=JSSTPA+NCBARA+NSBARA+NCDOTA+NSDOTA+NCAPDA+NCBPDA+          &
     &              NSAPDA+NSBPDA
!
! TEST FOR POINTER AND CORE ALLOCATION AGREEMENT
!
      IF(KOREII-JSSTPT.NE.KORE(IT,IGROUP)) GO TO 5000
!******************
! LOGICAL ARRAYS **
!******************
! NONE
      IT=3
!
! TEST FOR POINTER AND CORE ALLOCATION AGREEMENT
!
      IF(KORELL-KORELL.NE.KORE(IT,IGROUP)) GO TO 5000
!
      RETURN
! ERROR MESSAGES
 5000 WRITE(IUNT06,80000) KOREAA,KOREII,KORELL,IT,IGROUP,               &
     & KORE(IT,IGROUP)
      STOP 16
80000 FORMAT(10X,'EXECUTION TERMINATING IN KORPA1. CORE ALLOCATION AND',&
     &    'CORE POINTERS DO NOT LINE UP.'/10X,'KOREAA,KOREII,KORELL,IT',&
     &    'IGROUP,KORE(IT,IGROUP) ',6I12)
      END
