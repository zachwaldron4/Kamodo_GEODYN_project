!$RD50A2
      SUBROUTINE RD50A2(AA1   ,II1   ,LL1   ,IARC  ,NAMCRD,ISTA  ,      &
     &    ICONFG,ITYPE ,ISATCD,IMODLO,MJDS1 ,IPSW1 ,MJDS2 ,IPSW2 ,      &
     &    F1    ,F2    ,F3    ,ISTARD,ISATID,ISETN ,NBISTA,NBISAT,      &
     &    NBITYP,NBTIM1,NBTIM2,BISIGM,BIBIAS,IORFRC,IPDFRC,LAFRC ,      &
     &    POLINT,DPSR  ,INDPI ,IVLBAS,IBNSTA,IEBEGN,IEBEND,IEBTYP,      &
     &    IEBSTA,IEBSAT,IBASPD,IPDADJ,XNUMOL,LAJOL,IGTSRT,IGTSRA,       &
     &    ISSTPT,ISSTPA,IQUAID,IBNQUA,LQUADJ,NPANEL,NMOVE,IFACE,        &
     &    IPAREA,IPSPRF,IPDFRF,IPEMIS,IPTMPA,IPTMPC,IPTIMD,             &
     &    IPTIMF,IPTHTX,NARADJ,NSPADJ,NDFADJ,NEMADJ,NTAADJ,NTCADJ,      &
     &    NTDADJ,NTFADJ,NTXADJ,LATGRV,NBATYP,LREDGA,LREDDR,LREDSL,      &
     &    NSETAC,NSETDR,NSETSL,A1UTC,NSTLOV,ISLVID,IATSAT,              &
     &    KVLAS ,ATPER ,IYWSID,TACCLR,TDYNSL,ISATHR,ISTACT,TIMECT,      &
     &    WEIGCT,CRLTCT,IDN   ,LQVADJ,NBIDEG,NBINOD,ISTBSL,VLB_STR,     &
     &    SIGSP,NBSPLN,NSSPLN,NBNPRM,ITPATS,ISIGOV,DNUTIN,DNUTMD,       &
     &    IGPSID,IGPSBL,IGPSIND,IPNALB,ITDSAT,ITDANT)
!********1*********2*********3*********4*********5*********6*********7**
! RD50A2           06/03/83            VVVV.V    PGMR - BILL EDDY
!                                                PGMR - DIANE SEVITSKI
!
! FUNCTION         READ UNIT 50 AND LOAD ALLOCATION #1 ARRAYS FOR:
!                       . BIASES (GLOBAL AND ARC)
!                       . SELECT/DELETE CARDS
!                       . STATION POSITION CARDS
!                  DETERMINE ALLOCATION #2 REQUIREMENTS.
!                       . TIDES
!
! I/O PARAMETERS:
!
!   NAME    I/O  A/S   DESCRIPTION OF PARAMETERS
!   ------  ---  ---   ------------------------------------------------
!   AA1                DYNAMIC ARRAY FOR REAL VARIABLES ALLOCATION # 1
!   II1                DYNAMIC ARRAY FOR INTEGER VARIABLES ALLOCATION #1
!   LL1                DYNAMIC ARRAY FOR LOGICAL VARIABLES ALLOCATION #1
!   IARC               CURRENT ARC NUMBER(IARC=0 FOR GLOBAL SET)
!   NAMCRD             1=SELECT, 2=DELETE, 3=PREPRO, 4=SIGMA,
!                      5=OBSCOR, 6=METDAT
!   ISTA               COL'S 7-14
!   ICONFG             COLUMN 15
!   ITYPE              COL'S 16-17
!   ISATCD             COL'S 18-24
!   IMODLO
!   MJDS1              COL'S 41-46
!   IPSW1
!   MJDS2              COL'S 61-66
!   IPSW2
!   F1
!   F2                 COL'S 51-60
!   F3                 COL'S 71-80
!   ISTARD
!   ISATID             ARRAY OF SATELLITE ID'S FOR THIS ARC
!   ISETN              ARRAY CONTAINING THE SET NUMBER THAT
!                      EACH SATELLITE IN THIS ARC BELONGS TO
!   NBISTA
!   NBISAT
!   NBITYP
!   NBTIM1
!   NBTIM2
!   BISIGM
!   BIBIAS
!   IORFRC             ARRAY CONTAINING HIGHEST ORDER COEFFICIENT
!                      FOR DRAG,SOLAR RADIATION AND GEN. ACCEL.
!   IPDFRC             ARRAY CONTAINING THE NUMBER OF TIME PERIODS
!                      FOR DRAG,SOLAR RADIATION AND GEN. ACCEL.
!   LAFRC              LOGICAL ARRAY USED TO INDICATE WHETHER
!                      PARTICULAR ORDERS(LAFRC(1-3,I,J)) OR
!                      TIME PERIOD (LAFRC(4,I,J) ARE TO BE ADJUSTED
!                      FOR DRAG,SOLAR RADIATION AND GEN. ACCEL. FOR
!                      A GIVEN SATELLITE
!   POLINT             POLAR MOTION INTERVAL IN SECONDS
!   DPSR     O    A    MID-POINT TIME FOR POLAR MOTION INTERVALS
!   INDPI              INDICATOR FOR ADJ. POLAR MOTION INTERVALS
!   IVLBAS
!   IBNSTA
!   IEBEGN
!   IEBEND
!   IEBTYP
!   IEBSTA
!   IEBSAT
!   IBASPD
!   IPDADJ             ARRAY CONTAINING THE NUMBER OF ADJUSTED TIME
!                      PERIODS FOR DRAG,SOLAR RADIATION AND GEN.
!                      ACCELERATION FOR EACH SATELLITE IN THE ARC.
!   XNUMOL
!   LAJOL
!   IGTSRT
!   IGTSRA
!   ISSTPT             POINTER ARRAY FOR SST PARAMETERS (TO BE PUT
!                      IN EMAT ORDER)
!   ISSTPA             POINTER ARRAY FOR ADJUSTED SST PARAMETERS
!                      (TO BE PUT IN EMAT ORDER)
!   IBNQUA
!   LQUADJ - LOGICAL TO ADJUSTED QUASAR COORDINATES
!   NPANEL - ARRAY CONTAINING NO OF PANELS
!   NARADJ - ARRAY CONTAINING NO OF ADJ AREAS
!   NSPADJ - ARRAY CONTAINING NO OF ADJ SPEC RF
!   NDFADJ - ARRAY CONTAINING NO OF ADJ DIFF RF
!   NEMADJ - ARRAY CONTAINING NO OF ADJ EMIS
!   NTAADJ - ARRAY CONTAINING NO OF ADJ TEMP A
!   NTCADJ - ARRAY CONTAINING NO OF ADJ TEMP C
!   NTDADJ - ARRAY CONTAINING NO OF ADJ TEMP D
!   NTFADJ - ARRAY CONTAINING NO OF ADJ TEMP F
!   NTXADJ - ARRAY CONTAINING NO OF ADJ TEMP X
!   NMOVE  - NUMBER OF MOVEABLE PLATES
!   IFACE  - ARRAY CONTAINING THE INDICES FOR SORTING
!   IPAREA - ARRAY FOR AREAS
!   IPSPRF -   "       SPECULAR REFLECTIVITY
!   IPDFRF -   "       DIFFUSE REFLECTIVITY
!   IPEMIS -   "       EMISSIVITY
!   IPTMPA -   "       TEMP A
!   IPTMPC -   "       TEMP C
!   IPTIMD -   "       TEMP TIME D
!   IPTIMF -   "       TEMP TIME F
!   IPTHTX -   "       THETA X
!   LATGRV - LOGICAL SWITCH FOR APPLICATION OF ATMOSPHERIC EFFECT
!            ON GRAVITY COEFFICIENTS
!   LREDGA   O    A    ARRAY OF LOGICAL FLAGS FOR GENERAL ACCELERATION
!                      CONSTRAINTS
!   LREDDR   O    A    ARRAY OF LOGICAL FLAGS FOR DRAG CONSTRAINTS
!   LREDSL   O    A    ARRAY OF LOGICAL FLAGS FOR SOLAR RADIATION CONSTR
!   NSETAC   O    A    ARRAY INDICATING THE NUMBER OF CONTINUOUS PERIODS
!                      GENERAL ACCELERATION CONSTRAINTS AND SPACECRAFT
!   NSETDR   O    A    ARRAY INDICATING THE NUMBER OF CONTINUOUS PERIODS
!                      DRAG CONSTR. AND A SPECIFIC SPACECRAFT
!   NSETSL   O    A    ARRAY INDICATING THE NUMBER OF CONTINUOUS PERIODS
!                      SOLAR RADUATION  CONSTR. AND A SPECIFIC SPACECRAF
!   A1UTC    I    A    A1-UTC TIME DIFFERENCES
!   IATSAT   O    A    ARRAY WITH SATELLITES FOR WHICH ATTITUDE MODELS A
!   ISATHR   I    A    ARRAY WITH HIGH RATE INTEGRATION SATELLITES
!   LQVADJ - LOGICAL TO ADJUSTED QUASAR  PROPER MOTION
!   ITPATS - I/O  A    ARRAY USED TO STORE UNIQUE SAT IDS FROM TOPATT
!                      EQUAL TO II1(JTPATS)         i
!   DNUTIN   O    A    ARRAY CONTIANING NUTATION INTERVALS (DAYS OR HOURS)
!   DNUTMD   O    A    ARRAY CONTAINING MID POINT OF NUTATION INTERVAL (MJD)
!
! COMMENTS
!
!********1*********2*********3*********4*********5*********6*********7**
      IMPLICIT DOUBLE PRECISION (A-H,O-Z), LOGICAL(L)
      SAVE
!
      PARAMETER ( NOPTS = 145)
      CHARACTER*8 OPTNAM
      CHARACTER*80 CARDH
      CHARACTER*6 FILNAM
!
      CHARACTER(8)              :: CARDID
      CHARACTER(8)              :: GLBOPT
      CHARACTER*64 VSTRING
      CHARACTER*64 VLB_STR

!
      COMMON/ACCEL9/MXACC9,ITOTGA,NUMGA,ITYPGA,MACC,NXACC9
      COMMON/ACCELR/NSATAC,NACCB,NSATDY,NDYNAC,NXACC,                   &
     &       MXACC,NXACCX,MXACCX,NXISSM,MXISSM,NXS1,MXS1,NXS2,MXS2,     &
     &       NXPPN,MXPPN,NXSBS,MXSBS,NSATHR,NFACCB(2,200),NFATIT(2,200),&
     &       MRAT,NBAPPD(200),NDYNPD(200),IACSAT(200),NACB(200),        &
     &       IDNSAT(200),NDYN(200)
      COMMON/ACCINF/DATOL
      COMMON/AGRAV /NACSET,NADEG,NAORD,IAGCB,IAGCE,IDATB,IDATE,INTAG,   &
     &KCOUNT,KSKIP,INTC21,NXAGRA
      COMMON/ALBINT/IRINGS,ISPOTS,IMAXA,IMAXE,MMAXA,MMAXE,KMAXA,KMAXE,  &
     &              KALB,KEMM,KLMOD,IMODEL,NPNALB,NXALBI
      COMMON/ALBMAX/MRINGS,MSPOTS,MIMAXA,MIMAXE,MMMAXA,MMMAXE,          &
     &              MKMAXA,MKMAXE,                                      &
     &              MIMA1A, MIMA1E,MMMA1A,MMMA1E,                       &
     &              MKMA1A,MKMA1E,                                      &
     &              NXALMX
      COMMON/ALBMIS/ALBON,ALBCON,EMSCON,ALBTUM,XALBMI
      COMMON/ALTCB /NALTW,MAXIT,NPERT,NXALT
      COMMON/ATTCB /KPAT,MAXAT,MAXLAS,IBLAS,                            &
     &              NASAT,IATCNT,NXATT
      COMMON/ARCPAR/MAXSEL,NSEL,MAXDEL,NDEL,MAXMET,NMETDT,NSATID,       &
     &              IATDEN,ISATEQ,ITRMAX,ITRMIN,ITRMX2,                 &
     &              MJDSRF,MREFSY,NTDDR,NBTOTL,IDRAGM,IMRNUT,           &
     &              NXARCP
      COMMON/BINBUF/NBUFIN,NLENI ,MAXBUF,MAXOBS,NBUFOT,NLENO ,NMAXOT,   &
     &              KBUFOT,MXBLEN,MAXTDD,NLENDR,MOBSBK,MXTIMB,          &
     &              MXOBSB,IIOBDR,IPSMAX,ILIMBK,NPASS ,MVERSN,NXBINB
      COMMON/BIHTBL/IA1UTC,JA1UTC,IPOLA1,JPOLA1,IFLUXS,JFLUXS,IFLXAP,   &
     &              JFLXAP,IFLXKP,JFLXKP,IIONO,JIONO,                   &
     &              NVR(6),NUTC  ,IBIH  ,JBIH  ,                        &
     &              IFLUX ,JFLUX ,IBHSYS,IBHDAT,IBHTIM,IFLXSF,          &
     &              IBIHTL(2),IBIHHR,JBIHHR,NXBIHT
      COMMON/BURN  /NBGRP,NBMODE,NBURN
      COMMON/BWINTG/NMSLAB,NAREPT,NSPRPT,NDFRPT,NEMIPT,NTMAPT,NTMCPT,   &
     &      NTMDPT,NTMFPT,NTHXPT,MXSLAB,MXARPT,MXSRPT,MXDFPT,MXEMPT,    &
     &      MXTAPT,MXTCPT,MXTDPT,MXTFPT,MXTXPT,NXBWIN
      COMMON/C12PRM/IDSATS(10,2),IP1,IP2,NXC12P
      COMMON/CASPER/NFGGLB,NFFGLB,NFGARC,NFFARC,NGGA,NGFA,NAGA,NAFA,    &
     &              NFANEP,NFDIR(4),NSATFA(2,200),NFANTM,NXCASP
      COMMON/CA1UTC/RID1,RID2,YMD1,YMD2,HMS1,HMS2,DAYS1,DAYS2,          &
     &              EPAUT1(6),EPAUT2(6)
      COMMON/CALTOP/LADYNO,LAGEOO,LRGEOT,LRETDT,LROTDT,LRSSTT,LCOTRM,   &
     &              LFILOT,LATCOR,LFIRIT,LX1ALT,LX2ALT,LMSSWG,LATMOD,   &
     &              LG1BOT,LG1B,LONEG1,LXATTD,LXBEAM,NXALTO
      COMMON/CAMSAT/NCAM,NSCID(30),NXSCID
      COMMON/CANTEN/NCUT,NXANTE
      COMMON/CIFF  /IFHEAD,IFLNTH,IFBUFL,IFBUFR,KDYNHD,KDYNLN,          &
     &              KDYNIF,KDYNFF,NXCIFF
      COMMON/CIMDST/IDRLTM(200),ITRLTM(200),IRELON,IRLONA,NRLTMC,       &
     & IDRCK4(200),IRKONA,NROCK4,IRKRAD,NXIRTM
      COMMON/CEBGLB/MEPARM,MEDIM,MEBIAS,MBIASE,NEBGRP,IEBGRP(4),NXCEBG
      COMMON/CEDIT /EDITX ,EDTRMS,EDLEVL,CONVRG,GLBCNV,EBLEVL,EDITSW,   &
     &              ENPX  ,ENPRMS,ENPCNV,EDBOUN,FREEZI,FREEZG,FREEZA,   &
     &              XCEDIT
      COMMON/CESTML/LNPNM ,NXCSTL
      COMMON/CGVTMI/NCDT,NSDT,NCPD,NSPD,NCDTA,NSDTA,NCPDA,NSPDA,NGRVTM, &
     &       KCDT,KCPDA,KCPDB,KSDT,KSPDA,KSPDB,KOMGC,KOMGS,KCOMGC,      &
     &       KSOMGC,KCOMGS,KSOMGS,NXGVTI
      COMMON/CGVTMR/EPGVTM,ELAPGT,XCGVTR
      COMMON/CIOCON/NUMCON(15),NESCON(15),NUMIND,NXCON
      COMMON/CIOTMD/NOTPT,NOTPRF,NODEG,NXCIOT
      COMMON/CISSTM/NSSTPT,NSSTF,NSDEG,NXCISS
      COMMON/CLIGHT/VLIGHT,ERRLIM,XCLITE
      COMMON/CLSSOT/LSSTMO,LOTMOD,LPRDES,NXLSST
      COMMON/CLSSTC/LSTOPO,LSTPRD,LSSCOF,LSTTIM
      COMMON/CLTMX/LACTMX,LDRTMX,LSRTMX,LGATMX,NXTMX
      COMMON/CLVIEW/LNPRNT(18),NXCLVI
      COMMON/CNIARC/NSATA ,NSATG ,NSETA ,NEQNG ,NMORDR,NMORDV,NSORDR,   &
     &              NSORDV,NSUMX ,NXDDOT,NSUMPX,NPXDDT,NXBACK,NXI   ,   &
     &              NXILIM,NPXPF ,NINTIM,NSATOB,NXBCKP,NXTIMB,NOBSBK,   &
     &              NXTPMS,NXCNIA
      COMMON/COBGLO/MABIAS,MCBIAS,MPVECT,MINTPL,MPARAM,MSTA,MOBBUF,     &
     &              MNPITR,MWIDTH,MSIZE ,MPART ,MBUF  ,NXCOBG
      COMMON/CONTRL/LSIMDT,LOBS  ,LORB  ,LNOADJ,LNADJL,LORFST,LORLST,   &
     &              LORALL,LORBOB,LOBFST,LOBLST,LOBALL,LPREPO,LORBVX,   &
     &              LORBVK,LACC3D,LSDATA,LCUTOT,LACCEL,LDYNAC,LFRCAT,   &
     &              LNIAU ,NXCONT
      COMMON/COPNAM/GLBOPT(134),STAGEO(15),ARCMAN(6),ARCOPT(88),        &
     &              SELDEL(14)
      COMMON/COPNUM/NGLTTL,NGLBOP,NSTAGO,NARTTL,NARCMN,NARCOP,NSELDL,   &
     &              NDXSTA,NDXNDG,NDXNDS,NDXDAT,NDXNDA,NDXEND,NDXALL,   &
     &              NDXCYB,NDXIBM,NDXPUT,NDXPVU,NDXTVU,NDXQUA,NDXLGR,   &
     &              NDXANO,NDXSDN,NDXGHT,NDXGRD,NDXGRE,NDXBRN,NDXFLO,   &
     &              NDXACC
      COMMON/CORA  /KA1UTC,KA1UT1,KXP   ,KYP   ,KEOPDP,KEOPDS,KFLXS ,   &
     &              KFLXM ,KFLXAV,KBIN  ,KBOUT ,KOBDR ,KDAT1 ,KDAT2 ,   &
     &              KDAT3 ,KSCOB ,KB1   ,KB2   ,KB3   ,KBSIGM,KBBIAS,   &
     &              JDSCRP,JDPSR ,JPOLIN,JPUTBH,JXNMOL,JEAQFB,JEAQFE,   &
     &              JEAEFB,JEAEFE,JEAINT,JEASTP,JEAVER,JATPER,JTACCL,   &
     &              JTIMES,JTDYNS,JTIMED,JEXACT,JXACIN,JCTBTI,JCTBWE,   &
     &              JCTCTM,JRTMTB,JVLOPT,JSIGSP,JSSDST,JSSDSR,JSSDDG,   &
     &              JXCGST,JXCGDT,JTACFB,JTACFE,JTAVER,JTAEFB,JTAEFE,   &
     &              JTAINT,JTASTP,JNUTIN,JNUTMD,JDWNWT,NXCORA
      COMMON/CORA05/KOBTYP,KDSCRP,KGMEAN,KGLRMS,KWGMEA,KWGRMS,KTYMEA,   &
     &       KTYRMS,KWTMTY,KWTYRM,KTMEAN,KTRMS ,KWMEAN,KWTRMS,KWTRND,   &
     &       KPRVRT,KEBSTT,KVLOPT,NXCA05
      COMMON/CORBNF/MAXINF,NORBNF,INFSTA(15),INFNDX(15),INFSTR,INFSTP,  &
     &              INFRT ,NXCORB
      COMMON/COREPH/EMJDS0(2),EFSEC0(2),EMODE(2),ECORR(2),              &
     &              PSTAE0(12),DEBC(12),SGMEBC(12),BODYID(2),XCOEPH
      COMMON/COREQ /NCHRLY,MAXUTC,MAXUT1,MAXFLX,MAXDSC,KORSUM(3),       &
     &              KORSM2(3),NXCORQ
      COMMON/CORI  /KNAME ,KSTA  ,KCONFG,KTYPE ,KSATCD,KMOD  ,KDAY1 ,   &
     &              KTIM1 ,KDAY2 ,KTIM2 ,KVBAS ,KVSTA ,KSATID,KISETN,   &
     &              KVBSTA,KVBVEL,KQUAID,KBNQUA,KBSTA1,KBSAT1,KBTYPE,   &
     &              KBTIM1,KBTIM2,KBIDX, KKPTR ,KSATEQ,JIORFR,JIPDFR,   &
     &              JINDPI,KPSSTA,KPSSAT,KPSTYP,KPSBIA,KPSBLK,KPSTIM,   &
     &              KPSPTR,JEBSTA,JEBSAT,JEBTYP,JEBBEG,JEBEND,JBKBIA,   &
     &              JIPOLC,JIBASP,JIPDAD,JIPDRD,JISTOL,JGTSRT,JGTSRA,   &
     &              JSSTPT,JSSTPA,JSSTFQ,JNPANE,JIFACE,JIPARE,JIPSPR,   &
     &              JIPDIF,JIPEMI,JIPTPA,JIPTPC,JIPTMD,JIPTMF,JIPTHX,   &
     &              JNADAR,JNADSP,JNADDF,JNADEM,JNADTA,JNADTC,JNADTD,   &
     &              JNADTF,JNADTX,JNMOVE,JEASID,JEAQSB,JEAQSE,JEANPA,   &
     &              JEAESB,JEAESE,JEAPNT,JEANMQ,KVBSL2,KVBSH2,KBATYP,   &
     &              JNRDGA,JNRDDR,JNRDSR,JCSETA,JCSETD,JCSETS,JVSETA,   &
     &              JVSETD,JVSETC,JSTRTA,JSTRTD,JSTRTS,JNSTLV,JSLVID,   &
     &              JATSAT,JKVLAS,JYWSID,JLOV  ,JCBID ,JCBDEG,JSATAC,   &
     &              JSATDY,JSATHR,JACSID,JCTBST,JSRTTB,JTMPTB,JSTBST,   &
     &              JDN   ,JDN2  ,JDN3  ,JALSIT,JAPLST,KBDEGR,KBNODE,   &
     &              KBNPRM,KBSSTA,JBSPLN,JSSPLN,JNEXCG,JIDEXC,JNREXC,   &
     &              JWEMGA,JWEMDR,JTPATS,KSIGOV,JTACSB,JTACSE,JTASID,   &
     &              JTAESB,JTAESE,JTANMC,JTAPNT,JTANPA,JGPSID,JGPSBL,   &
     &              JGPSND,JPNALB,JTDSAT,JTDANT,NXCORI
      COMMON/CORL  /KLKEEP,JLAFRC,KPSOUT,KPSOPN,KNBCDT,KQUADJ,JLEBIS,   &
     &              JLAJOL,JEAFIL,JLRDGA,JLRDDR,JLRDSR,JACFIL,KQVADJ,   &
     &              JTAFIL,NXCORL
      COMMON/CPARTI/MAXLP ,KORSIZ,MAXWRK,                               &
     &              IUNTP1,IUNTP2,IUNTPF,ISIZPF,IRECPF,NRECPF,          &
     &              NPDONE,NP1   ,NP2   ,NPAR1 ,NPARTL,NXPARI
      COMMON/CPARTL/LPART ,LPARTI,NXPARL
      COMMON/CTIDES/NTIDE ,NSTADJ,NET   ,NETADJ,NETUN ,NOT   ,NOTADJ,   &
     &              NOTUN ,NETUNU,NETADU,NOTUNU,NOTADU,NBSTEP,KTIDA(3), &
     &              ILLMAX,NUNPLY,NNMPLY,NDOODN,MXTMRT,NRESP ,NXCTID
      COMMON/DELAY /NTDL
      COMMON/DELOFF/NOFFST,NSATDL,NSTADL,NCGMAS,NXDELO
      COMMON/DSTAT /NSATDS,NFDSTA(200),NXDELT(2,200)
      COMMON/DTMGDN/TGTYMD,TMGDN1,TMGDN2,REPDIF,XTMGN
      COMMON/DTMTIM/ISTDRG,IENDRG
      COMMON/DWNWGT/LDWNWT,LDNWMT(999),NXDWNW
      COMMON/DYNPOL/DPMEP ,DPMXP ,DPMYP ,DPMXDT,DPMYDT,DPMOPT,DPMXPC,   &
     &              DPMYPC,DPMKF ,DPMC21,DPMS21,DPMPD ,DPMUDK,DPMVDK,   &
     &              DPMOCP,DPMNLD,DPMERS,XDYNPL
      COMMON/DYNX  /XZEROP
      COMMON/EPHMPT/NTOT,NTOTS,NNPDPR,NUTORD,IBODDG(8),IGRPDG(4),       &
     &              NENPD,INRCD(2),KPLAN(11),NINEP,NEPHMR,NEPHEM,       &
     &              IBHINT,NINTBH,NXEPHP
      COMMON/EPOCTM/IEPSTP,NXEPOC
      COMMON/EXTAGL/LEXTHC,NXTAGL
      COMMON/EXTAAI/NTASAT,NXTAAI
      COMMON/EXATGL/LEXATT,NXEAGL
      COMMON/EXATAI/NEASAT,NXEAAI
      COMMON/EXATAL/LEXATA,LEXATM,NXEAAL
      COMMON/FANTOM/LFGLB,LFARC,LFTARC,LFTGLB,LENDGL,LPHNTM(4),LPHTIM(4)&
     &             ,LXTRAF,LSATFA(4,3),NXFANT
      COMMON/FLUXAU/FLX1AU,XFLUXA
      COMMON/G2SINF/G2SVER,G2SDAT,G2SRTM,G2SCOM,TDFVER,TDFRTM,SETCDS,   &
     &              GPCKSM,GPDEG ,GPORD ,XG2SIN
      COMMON/GEODEG/NMAX,NMAXP1,NP,NTOLD,NTOLO,NADJC,NADJS,NADJCS,      &
     &              NPMAX,NXGDEG
      COMMON/GEOMCS/MDEGEO,MORGEO,NPGEOM,NXGEOM
      COMMON/GPSINT/IGPSBW,NGPSBW
      COMMON/GLBPAR/NARCS,NDPOLE,NDCSA,MXDEGG,MXORDG,NSRA,              &
     &              NDUMMY,MAXPAS,NXGLBP
      COMMON/IBODPT/IBDCF(999),IBDSF(999),IBDGM(999),IBDAE(999)      ,  &
     &              IBDPF(999),ICBDCF,ICBDSF,ICBDGM,ICBDAE,ICBDPF,      &
     &              ITBDCF,ITBDSF,ITBDGM,ITBDAE,ITBDPF,NXBDPT
      COMMON/IDELTX/MXSTAT,NEVENTS,NDSTAT,IDSYST,NDELTX
      COMMON/IEPHM2/ISUPL,ICBODY,ISEQB(2),MAXDEG,ITOTSE,IREPL(988),  &
     &              NXEPH2
      COMMON/INTFLD/IFIELD(18),IC78,IC910,IC1112,IC1314,IC2122,IC2324,  &
     &              IC1517,IC1820,IC710,IC1114,IC2124,IC1824,IC714,     &
     &              NXINTF
      COMMON/ION2EL/LIONC,LFRQOP,lFRQOF,NXIONL
      COMMON/IONO2E/IONNDX(12),IONRZ(12),IONOYM(12),IONYMS,IONYME,IURSI,&
     &              INTERP,NXIONO
      COMMON/IONO2S/NFM3CF,NF2CF,NMDATA,NXIO2S
      COMMON/IPLMOD/NFMOD,NSMOD,NFTOT,NSTOT,IDFMOD(1000),IDSMOD(1000), &
     &             NFPARAM(1000),&
     &             NPMIND(1000),NSPARAM(1000),NPSIND(1000),NXPLMD
      COMMON/ISATPV/IPIDSR,IPIDDG,IPIDAC
      COMMON/KNTSTS/KNTACC(9,40),MKNTAC,KNTDRG,KNTSLR,MAXNGA,MAXNDR,    &
     &              MAXNSR,NXKNTS
      COMMON/NETCON/TRANET(3,2),ROTNET(3,2),ROTQUA(3,2),XNETC
      COMMON/NGRIDS/NCTGRD,NREFER(6),NCENTR(6),NXGRID
      COMMON/LAPLOD/LAPL,NXLAPL
      COMMON/LBDTIM/LBDTM
      COMMON/LASTER/LASTR(2),LBINAST,NXASTR
      COMMON/LDUAL/LASTSN
      COMMON/LGPSBX/LGPBOXW(100)
      COMMON/LICASE/LINT(2),LCASE(18),NXLCAS
      COMMON/LNUTAT/LSPNUT,NXLNUT
      COMMON/LSWTCH/LFLXPR,LMALL,LPGRAV,LST50,LST50I,LTERMV,LST17,      &
     &              NXLSWT
      COMMON/MBIAS /NBIASK,NBIASA,NBIASG,NBCDP,NBCDT,                   &
     &              NUMPAS,NPSFIL,NARCBS,NEBKNT,NXMBIA
      COMMON/MBIAST/MBTRAD,MBTRUN,ICONBIA,IPRCTP,IPREND,NXMBST
      COMMON/MBSGLB/MBIASK,MBIASA,MBIASG,MBCDP,MBCDT,MARCBS,            &
     &              NBIST2,MEBKNT,NBIAST,NXMBGB
      COMMON/MLTARC/LAUNIT,LREWND
      COMMON/MODEL /NPRM(10,2,5),ICROSS,MJD01,ISSTMD,NXMODL
      COMMON/MULTDM/MLTDEM,MEMDEM,NXMDEM
      COMMON/NALOAD/NSITES,NALFIL,NALSIT,MAXSIT,ITOTAL,MAXAPL,ITAPLB,   &
     &              ITAPLE,IAPLDT,NXLOAD
      COMMON/NBDTIM/NBDTM
      COMMON/NEQINT/NINTOT,MEMTOT,NEQNIM,NXNEQS
      COMMON/NHINPT/NH1VOC,NXNHIN
      COMMON/NLOCGR/INTEGG,IOPTLG,ICUTLG,MAXDO,NLOCAL,NLATLG,NLONLG,    &
     &              NLOCGU, NLOCGA, NXLOCG
      COMMON/NLRA/NLRARC,NLRAIN,NLRAD1,NLRAD2,NLRAPT,NLRAST,NSARAL, &
     &            NXNLRA
      COMMON/NPCOM /NPNAME,NPVAL(92),NPVAL0(92),IPVAL(92),IPVAL0(92),   &
     &              MPVAL(28),MPVAL0(28),NXNPCM
      COMMON/NPCOMX/IXARC ,IXSATP,IXDRAG,IXSLRD,IXACCL,IXGPCA,IXGPSA,   &
     &              IXAREA,IXSPRF,IXDFRF,IXEMIS,IXTMPA,IXTMPC,IXTIMD,   &
     &              IXTIMF,IXTHTX,IXTHDR,IXOFFS,IXBISA,IXFAGM,IXFAFM,   &
     &              IXATUD,IXRSEP,IXACCB,IXDXYZ,IXGPSBW,IXCAME,IXBURN,  &
     &              IXGLBL,IXGPC ,IXGPS, IXTGPC,IXTGPS,IXGPCT,IXGPST,   &
     &              IXTIDE,IXETDE,IXOTDE,IXOTPC,IXOTPS,IXLOCG,IXKF  ,   &
     &              IXGM  ,IXSMA ,IXFLTP,IXFLTE,IXPLTP,IXPLTV,IXPMGM,   &
     &              IXPMJ2,IXVLIT,IXEPHC,IXEPHT,IXH2LV,IXL2LV,IXOLOD,   &
     &              IXPOLX,IXPOLY,IXUT1 ,IXPXDT,IXPYDT,IXUTDT,IXVLBI,   &
     &              IXVLBV,IXXTRO,IXBISG,IXSSTF,IXFGGM,IXFGFM,IXLNTM,   &
     &              IXLNTA,IX2CCO,IX2SCO,IX2GM ,IX2BDA,IXRELP,IXJ2SN,   &
     &              IXGMSN,IXPLNF,IXPSRF,IXANTD,IXTARG,                 &
     &              IXSTAP,IXSSTC,IXSSTS,IXSTAV,IXSTL2,                 &
     &              IXSTH2,IXDPSI,IXEPST,IXCOFF,IXTOTL,NXNPCX
      COMMON/NUTINF/NNUT,NNUTAA,NXNUTA
      COMMON/OLDMOD/NTOLFR,NTOLF2,NTOLMD,NSTAOL,NSITOL,NTOLAJ,MXOLSA,   &
     &              NPOLSH,                                             &
     &              NXOLMD
      COMMON/PLATE /NPLATE,MJDPLR,NPLTMS,NXPLAT
      COMMON/PLMONI/IMNNUM(5,2),NXPLMI
      COMMON/PLNETI/IPLNET(999),IPLNIN(999),MPLNGD(999),MPLNGO(999),  &
     &              IPLNZ(999),NXPLNI
      COMMON/PLNRAJ/LPLNRA
      COMMON/PLTCOM/PLTLAT(36),PLTLON(36),PLTAVL(36),NUMPLT,NDEFOP,     &
     &              NUVPLT
      COMMON/PLTOPO/IBDTOP,NXPLTP
      COMMON/POLINF/NPOLE,NPOLEA,NUTA,MXUTC,NMODEL,NXPOLI
      COMMON/ION2ER/STEPSZ,XIONR
      COMMON/SETDI /NSETDP,NFRSED,NFRSDI,NFRSLN,NXSETI
      COMMON/SATPIN/MAXDS,NGSAT1,NXSATP
      COMMON/SIMLM/OBSINT,VINT,ELCUTO,XSMLM
      COMMON/SPBIAS/NCTSTA,NXSPB
      COMMON/SSTCOM/NCBAR, NSBAR ,NCDOT ,NSDOT ,NCAPRD,NCBPRD,NSAPRD,   &
     &              NSBPRD,NCBARA,NSBARA,NCDOTA,NSDOTA,NCAPDA,NCBPDA,   &
     &              NSAPDA,NSBPDA,ISSTEP,NXSST
      COMMON/SSLIST/MXBAS,MXSTA,MXSAT,MXBSTA,MXSTV,MXQUA,NXSSLI
      COMMON/STATN /NSTA,NSTAE,NMSTA,NCSTA,NSTAV,NSTLV,NSTEL2,          &
     &              NSTEH2,                                             &
     &              NPH2L2,                                             &
     &              NSTNUM, NSTIME, NALLST,KCONAD, NXSTAT
      COMMON/TARGET/NLXYZ(200000),NPLTAR,NTARG,NATARG,NXTARG
      COMMON/TELEN/NTELEM,NXTELEN
      COMMON/TETHER/LTETHR,NXTETH
      COMMON/TETHIN/NAFMPT,IT1CMT,ISTPCM
      COMMON/TIDALC/LRAY,LOLDST,NXTIDL
      COMMON/TIMDAT/KYMD,KHMS,ICPU,IO,IRUNB,IRUNE,ITBLB,ITBLE,IARCT1,   &
     &              IARCT2,IDATAB,IDATAE,NXTIME
      COMMON/TOPOVR/NMTPAT,MXTPAT,NOVRID,NGCATT,NTPBIA,NSTLVS,          &
     &              NISLV, NYWBIA,MSATYW,MAXYWB,NSATTP,NXTOPO
      COMMON/TPGRAV/NTPGCU,NTPGCA,NTPGSU,NTPGSA,ITPGRV,NTIMEC,NTIMES,   &
     &              NXTPGR
      COMMON/TRAJI /MJDSTR,NTRAJC,MTRAJC,NXTRAJ
      COMMON/UCLJAL/LJBUS(50),LJPAN(50),LJTRR(50),LUGFO,LENVI,NUCLJA
      COMMON/UCLJAI/IUCLSAT(50),NUCLJAI
      COMMON/UNITS /IUNT01,IUNT02,IUNT03,IUNT05,IUNT06,IUNT07,IUNT11,   &
     &              IUNT12,IUNT15,IUNT16,                               &
     &              IUNT30,IUNT31,IUNT39,IUNT40,IUNT41,IUNT42,IUNT43,   &
     &              IUNT50,IUNT52,IUNT53,IUNT60,IUNT90,IUNT91,IUNT99,   &
     &              ILINE(2),IPAGE(2),MLINEP(2),MAXCOL(2),IUNT17,       &
     &              IUNT70,IUNT71,                                      &
     &              IUNT88,NXUNIT
      COMMON/VLBI/NQUA,NADJQ,NADJQV,NQUAB,IYMDV,NVOPT,NXVLBI
      COMMON/VOPTCP/LVOPTC
      COMMON/XPCNT /NXTRAC,NXFLAG,NXALLC,NCPPER,NMINRT,NDPOR,NXXTRA
      COMMON/XPCNT2/NXTRAC2,NXFLAG2,NXALLC2,NCPPER2,NMINRT2,NDPOR2,    &
     & NXXTR2
      COMMON/XTRAOR/T0XTRO,T0XTRO2,CVENUS,CLIBMN,CMARS,CMERC,XXTRAO
      COMMON/YARINT/NYACRD,NXYARK
      COMMON/YARSCH/YARTYP,YARMOD,AYAR,TAU,RISYEN,FSEYEN,RISYEX,FSEYEX, &
     &              SMEANM,XYARMD
      COMMON/SLFSHD/NSHSAT,IDSASH(200),NSPANL(200),IFLGSH(200),        &
     &              IATYSH(200),NSHRCD(200),MNSHPL,NXSFSD
      COMMON/EXCGCR/NEXCG,IDEXCG(200),IFTPCG(200),NRCDCG(200),NXEXCG
!
      DIMENSION AA1(*)
      DIMENSION BIAS(2),BIBIAS(*),BISIGM(*)
      DIMENSION DPSR(*)
      DIMENSION EBIS(2)
      DIMENSION F1(*),F2(*),F3(*),FIELD(4),FA3(3)
      DIMENSION II1(*),IPSW1(*),IPSW2(*),ISETN(*)
      DIMENSION IBNSTA(*),IGTSRT(*),IGTSRA(*)
      DIMENSION INDPI(*),IORFRC(3,*),IPDFRC(3,*)
      DIMENSION ISTA(*),ICONFG(*),ITYPE(*),ISATCD(*),IMODLO(*)
      DIMENSION ISIGOV(*)
      DIMENSION ISTARD(*),ISATID(*),IVLBAS(*)
      DIMENSION LAFRC(4,3,*)
      DIMENSION LL1(*)
      DIMENSION MJDS1(*),MJDS2(*)
      DIMENSION NAMCRD(*)
      DIMENSION NBISTA(3,*),NBISAT(3,*),NBITYP(*),NBTIM1(*),NBTIM2(*)
      DIMENSION NBINOD(3,*),NBIDEG(3,*),NBNPRM(3,1),ISTBSL(2,*)
      DIMENSION PBIAS(2),POLINT(*)
      DIMENSION SELCDS(6),STACDS(14)
      DIMENSION IEBEGN(*),IEBEND(*),IEBTYP(*),IEBSAT(3,*),IEBSTA(3,*)
      DIMENSION IBASPD(3,*),IPDADJ(3,*)
      DIMENSION XNUMOL(*),LAJOL(*)
      DIMENSION ISSTPT(*),ISSTPA(*)
      DIMENSION IQUAID(*),IBNQUA(*),LQUADJ(*),LQVADJ(*)
      DIMENSION NPANEL(*),NMOVE(*),IFACE(*),IPNALB(*)
      DIMENSION IPAREA(*),IPSPRF(*),IPDFRF(*),IPEMIS(*),IPTMPA(*)
      DIMENSION IPTMPC(*),IPTIMD(*),IPTIMF(*),IPTHTX(*)
      DIMENSION NARADJ(*),NSPADJ(*),NDFADJ(*),NEMADJ(*),NTAADJ(*)
      DIMENSION NTCADJ(*),NTDADJ(*),NTFADJ(*),NTXADJ(*)
      DIMENSION NBATYP(*)
      DIMENSION OPTION(NOPTS)
      DIMENSION INDC(15),IND1(10),IND2(10)
      DIMENSION ISLVID(1),NSTLOV(1)
      DIMENSION LREDGA(3,3,1),LREDDR(1),LREDSL(1)
      DIMENSION NSETAC(3,3,1),NSETDR(1),NSETSL(1)
      DIMENSION A1UTC(1)
      DIMENSION IATSAT(1)
      DIMENSION KVLAS(10,MXSAT)
      DIMENSION ATPER(1)
      DIMENSION IYWSID(NYWBIA)
      DIMENSION TACCLR(NACCB,3)
      DIMENSION TDYNSL(NDYNAC,3)
      DIMENSION ISATHR(NSATHR)
      DIMENSION ISTACT(1),TIMECT(ICONBIA,2),WEIGCT(1),CRLTCT(1)
      DIMENSION IDN(1)
      DIMENSION VLB_STR(1)
      DIMENSION SIGSP(6,NCTSTA),NBSPLN(5,NCTSTA),NSSPLN(2,NCTSTA)
      DIMENSION ITPATS(NSATTP)
      DIMENSION DNUTMD(NNUT), DNUTIN(NNUT)
      DIMENSION IGPSID(*),IGPSBL(*),IGPSIND(*)
      DIMENSION ITDSAT(1),ITDANT(1)
!**********************************************************************
      DATA IND1/1,3,5,7,9,11,13,15,17,19/
      DATA IND2/2,4,6,8,10,12,14,16,18,20/
      DATA INDC/0,1,2,3,4,5,6,7,8,9,10,11,12,13,14/
      DATA NAC/0/,NDY/0/,ISHR/0/
      DATA IGPS1/0/
      CHARACTER(8)      :: CDNAME
      CHARACTER(8)      :: CRD2
      CHARACTER(8)      :: OPTION
      DATA OPTION/'ATMDEN','DATA  ','DRGTAB','ENDARC','ENDGLB',         &
     &            'EBIAS ','EBIAS1','EBIAS2','EBIAS3','MBIAS ',         &
     &            'MBIAS1','MBIAS2','MBIAS3','PBIAS ','PBIAS1',         &
     &            'PBIAS2','PBIAS3','REFSYS','SATPAR','SOLTAB',         &
     &            'STAPOS','DPOLE ','EARTH ','TIDES ','ETIDES',         &
     &            'OTIDES','GCOEF ','GCOEFC','GCOEFS','H2LOVE',         &
     &            'L2LOVE','POLEUT','ACCEL ','DRAG  ','OFFSET',         &
     &            'SOLRAD','POLE  ','FLUX  ','PLANET','LOCALG',         &
     &            'ATITUD','STEP  ','VLIGHT','GXPAND','ORBFIL',         &
     &            'DELAY ','CGMASS','PLATE ','PLATIM','VECOPT',         &
     &            'EMATRX','OLOAD ','SSCOEF','SSTOPO','NORMPT',         &
     &            'SIMDAT','GRVTIM','POLKF ','ACCELT','ETIDEN',         &
     &            'OTIDEN','SSTPRD','SSTTIM','INTCOM','MLTARC',         &
     &            'QUAPOS','ACCEL9','PLNEPH','ANOMLY','SURDEN',         &
     &            'GRIDS ','PANEL ','TOPATT','PLMOON','LRARC ',         &
     &            'THRDRG','EBIASM','MBIASM','PBIASM','PLANOR',         &
     &            'ALBEDO','ALTIME','ACOEF ','GCOFCT','GCOFST',         &
     &            'ATGRAV','GTPEND','SSTMOD','OTMOD ',                  &
     &            'OTCOEF','NUTATE','TOPBIA','TATBIA','TSTLOV',         &
     &            'TOPLOV','FANTOM','FANTIM','IONCOR','TARGET',         &
     &            'TARSIG','CON9PA','CONDRG','CONSOL','ALTWVL',         &
     &            'LNSTHR','YAWPOL','ALTIM ','YAWBIA','FREEZE',         &
     &            'SCBODY','LINK  ','ACCLRM','ACCBIA','DYNSEL',         &
     &            'ENDACC','HRATEF','CONBIA','DSTATE','ANTCUT',         &
     &            'ROCK4 ','RAYTID','APLOAD','IAU200','YARKOV',         &
     &            'OPVLBI','VLBSTR','ENDOPV','CONSPL','NETCON',         &
     &            'GPSBXW','CAMERA','ELEVWT','TELEM ','COMCOF',         &
     &            'BINAST','G2COFC','G2COFS',                           &
     &            'RELPPN','J2SUN ','GMSUN ','PLNGLF','PLNSRF',         &
     &            'ADELAY','FNBURN','ENDBRN'/
!**********************************************************************
      CHARACTER(8)      :: ACCELT
      DATA ACCELT/'ACCELT'/
      CHARACTER(8)      :: BLNK
      CHARACTER(8)      :: SLAVE
      DATA BLNK/'      '/,SLAVE/'SLAVE '/
! SUBGROUP "SELECT/DELETE" CARDS
      CHARACTER(8)      ::  XMETDT,DELETE,ENDARC
      DATA XMETDT,DELETE,ENDARC/'METDAT','DELETE','ENDARC'/
      CHARACTER(8)      :: SELCDS
      DATA SELCDS/'SELECT','DELETE','PREPRO','SIGMA ','OBSCOR','METDAT'/
      DATA LSLFLG/.TRUE./
! BIAS CARDS
      CHARACTER(8)      :: BIAS
      CHARACTER(8)      :: EBIS
      CHARACTER(8)      :: PBIAS
      DATA BIAS /'MBIAS2','MBIAS3'/
      DATA EBIS /'EBIAS2','EBIAS3'/
      DATA PBIAS/'PBIAS2','PBIAS3'/
! INITIALIZE THE COUNTERS FOR SORT INDICE AND ADJUSTED SORT INDICE
      DATA IGRV/0/,IGRVA/0/
! INITIALIZE COUNTER FOR NUMBER OF SATELLITES USING UCL MODEL
      DATA NUCL/0/
! SUBGROUP "DRGTAB" AND "SOLTAB" CARDS
      CHARACTER(8)      :: FIN
      DATA FIN/'FIN   '/
! REFSYS CARDS
      CHARACTER(8)      :: REFSYS,SATPAR,EPOCH,ELEMS1,ELEMS2
      DATA REFSYS,SATPAR,EPOCH,ELEMS1,ELEMS2/'REFSYS','SATPAR',         &
     &     'EPOCH ','ELEMS1','ELEMS2'/
! END GLOBAL CARD
      CHARACTER(8)      :: ENDGLB
!      DATA ENDGLB/'ENDGLB'/
! SUBGROUP "STAPOS" CARDS
      DATA NSTACD/14/
      CHARACTER(8)      :: ENDSTA
      DATA ENDSTA/'ENDSTA'/
      CHARACTER(8)      :: QUAVEL
      DATA QUAVEL/'QUAVEL  '/
      CHARACTER(8)      :: ENDQUA
      DATA ENDQUA/'ENDQUA  '/
      CHARACTER(8)      :: STACDS
      DATA STACDS/'ADJUSTED','CORREL  ','CONSTADJ','CONSTEND',          &
     &            'FIXED   ','GEODETIC','EXTRAGEO','ELCUTOFF',          &
     &            'INSTRMNT','STAVEL  ','TIMVEL  ','SIGVEL  ',          &
     &            'STATL2  ','STATH2  '/
! METDAT BIT OFFSETS
      DATA CPRESS/.16384D+05/,CTEMP/.4294967296D+10/
! SPEED OF LIGHT TOLERANCE
! CONSTANTS
      DATA C100D0/100.0D0/,C0P5/0.5D0/,C10D0/10.0D0/,C0/0.0D0/
      DATA ONE/1.0D0/
      DATA C1D6/1.0D6/,C1D11/1.D11/,C24D0/24.D0/,C60D0/60.D0/
      DATA SECDAY/8.64D4/,SECHR/3600.0D0/
      DATA C1DM4/1.0D-4/,C1D7/1.0D7/
      DATA ETA1/32.1496183D0/
      DATA LNPT17/.FALSE./
      DATA ZERO/0.0D0/
      DATA NCRDUM/0/
!
!**********************************************************************
! START OF EXECUTABLE CODE
!**********************************************************************
!
! INITIALIZE GLOBAL VARIABLES
      IND_CNS=0
      LALLST=.FALSE.
!     write(6,*) 'enter rd50a2'
      IYAWBS=0
      LGLOBL=IARC.EQ.0
      IF(.NOT.LGLOBL) GO TO  200
      NSTARD=0
      NBIASG=0
      NDPOLE=0
      NDCSA=0
      IPOLE=1
      IFLXF1=0
      MTRAJC=0
      NOFFST=0
      NSATDL=0
      NSTADL=0
      NCGMAS=0
      NTOLMD=0
      LNPN17=.FALSE.
      CALL ZEROI(INDPI,NPOLE)
  200 CONTINUE
      IF(LGLOBL) GOTO 210
!
! INITIALIZE ARC VARIABLES

      MAXCDS = MAXSEL+MAXDEL+MAXMET

      ICONBIA=0
      NISLV=0
      DO 201 I=1,NSTLVS
      NSTLOV(I)=0
  201 END DO
      IATIM=0
      IDTIM=0
      ISTIM=0
      NXTIMB=999999999
      MXDEGA=MXDEGG
      MXORDA=MXORDG
      NBCDT=0
      NBCDP=0
      NBIASA=0
      NBIASK=0
      NEBKNT=0
      NTRAJC=0
      NGPSID=0
      MINSH=60
      MAXSOR=11
  210 CONTINUE
! INITIALIZE CONSTRAINT ARRAYS
      DO 350 K=1,MXSAT
      DO 349 J=1,3
      DO 348 I=1,3
      NSETAC(I,J,K)=0
      LREDGA(I,J,K)=.FALSE.
  348 END DO
  349 END DO
      LREDDR(K)=.FALSE.
      NSETDR(K)=0
      LREDSL(K)=.FALSE.
      NSETSL(K)=0
  350 END DO
  400 CONTINUE
      IF(LGLOBL) GO TO 500
!
! READ TITLE CARDS
!
      DO 410 I=1,NARTTL
      READ(IUNT50,71100,END=420) CX
  410 END DO
! ARC SET TITLE CARDS MUST BE FOLLOWED BY REFSYS CARD
      GO TO 9000
! END OF FILE; IF GLOBAL SET-ERROR; IF ARC SET- NORMAL END OF JOB
  420 IF(LGLOBL) GO TO 60100
      GO TO 60000
!
! READ TITLE CARDS
!
  500 CONTINUE
      DO 550 I=1,3
      READ(IUNT50,71100,END=420) CX
  550 END DO
!
! READ OPTION CARDS
!
  600 CONTINUE
      READ(IUNT50,71000,END=60000) CDNAME,IC78,IC910,IC1112,IC1314,     &
     &   IC1517,FA3,IC2122,IC2324,FIELD
      IF(CDNAME.EQ.OPTION(127)) GOTO 600
      IF(CDNAME.EQ.OPTION(125)) GOTO 601
      CALL A3TOI6(FA3,I6,IC1820)
      IF(CDNAME.EQ.OPTION(35)) THEN
         BACKSPACE IUNT50
         READ(IUNT50,71001) CARDH
      ENDIF
! SET INTEGER FIELD COLUMNS
      CALL MAKFLD
601   CONTINUE
!
! TEST FOR OPTION CARDS
!
      DO 700 I=1,NOPTS
      ICARD=I
      IF(CDNAME.EQ.OPTION(I)) GO TO                                    &
     &   ( 1500,10500, 3000, 4000, 5000, 3700, 3700, 3700, 3700, 7000,  &
     &     7000, 7000, 7000, 8000, 8000, 8000, 8000, 9000, 9500,11000,  &
     &    12000, 1500, 3500,13000, 5100, 7300, 5500, 5700, 5800, 6600,  &
     &     6800, 7700, 1300, 2000, 7250,10700, 7600, 5300, 8500, 6900,  &
     &     1400,12500,14000, 6100, 7100, 1450, 1425, 7500, 7550,15000,  &
     &     3800, 7070,11250,11750, 7060,10650, 5900, 6000, 1300, 5100,  &
     &     7300,11800,11900, 5980, 7055, 8800, 1299, 8755, 1366,12600,  &
     &     5890,7450, 13100, 8751, 6950,12700, 3750, 7052, 8070,16000,  &
     &     1355,1358,  1351, 5760, 5855, 1375, 5960,11300, 7400,        &
     &     7350, 7065,13200,13200,13300,13300, 5200, 5120, 6700,12610,  &
     &     12650,1600,1620 ,1640 ,1365,  6850,17000, 1357,18000, 5415,  &
     &     10025,6810,13500,13600,13700,13800, 5970, 1475, 3020,13650,  &
     &     10021,8900,1367, 5975, 15500, 7071, 7071, 7071, 1650, 5990,  &
     &     5865,1410, 1415,12680,  1800, 1405, 5420,5430,               &
     &     8910,12550,5860,7570,7580,13620,5417,5418),I
  700 END DO
! READ NEXT CARD
      GO TO 600
!*********************************************************************
! ** ACCEL,ACCELT,ACCEL9                                   * ACCEL  **
!*********************************************************************
 1299 CONTINUE
! SET FLAG FOR ACCEL9 OPTION
      IFIELD(1)=9
 1300 CONTINUE
! Set flag indicating whether or not 3 dimensional accel. option is used
      LACC3D=CDNAME.EQ.ACCELT
!     FIND CURRENT SATELLITE IN SATELLITE ID ARRAY
      CALL FNDNUM(IC1824,ISATID,NSATID,ISAT)
      IF(ISAT.EQ.0) GO TO 60650
! TEST SIGMA
      IBEG=IARCT1
      IEND=IARCT2
      IF(FIELD(3).EQ.C0) GOTO 1320
         IBEG=IDATAB
         IEND=IDATAE
 1320 CONTINUE
! THE FOLLOWING CODE IS FOR THE 9 PARAMETER GENERAL ACC OPTION
      IF(IFIELD(1).EQ.9) THEN
           ITOTGA=ITOTGA+1
!       FORCE THE INPUT TIME FIELD TO BE GREATER THAN ZERO
           FIELD(2)=ONE
!       SET THE TIME IN MJDS EQUAL TO THE END OF THE RUN
           IISEC=IEND
           GO TO 1330
      ENDIF
! END OF CODE FOR 9 PARAMETER GENERAL ACC OPTION
      IF(FIELD(2).LE.C0) GOTO 1330
!
!     ....check validity of end time for ACCEL, ACCELT
!
      if( lacc3d ) then
         optnam = 'ACCELT  '
      else if(ifield(1).eq.9) then
         optnam = 'ACCEL9  '
      else
         optnam = 'ACCEL   '
      endif
      CALL CHKTM1( FIELD(2), optnam )
! ** BREAK UP FIELD 2 **
      CALL RIYMDH(FIELD(2),I1YMD,I1HMS)
      CALL YMDTIS(I1YMD,I1HMS,I1SEC)
! eliminate cards with times prior to the start time of the run
      IF(I1SEC.LT.IBEG) GOTO 600
! if previous satellite id is not equal to current sat id reset lgatmx
! to false so that first time that exceeds the end time will
! be accepted for the current satellite.
      IF(IPIDAC.NE.IC1824)LACTMX=.FALSE.
! accept the first time that exceeds the end time (LACTMX=.FALSE.)
! reject all other times that exceed the end time (LACTMX=.TRUE.)
      IF(LACTMX.AND.(I1SEC.GT.IEND)) GOTO 600
! set flag to tell that the first time beyond the end time was found
      IF(I1SEC.GT.IEND) LACTMX=.TRUE.
! save value of satellite id
      IPIDAC=IC1824
 1330 CONTINUE
      NIC8=IFIELD(2)+1
      NIC8= MIN(3,NIC8)
      IORFRC(3,ISAT)= MAX(IORFRC(3,ISAT),NIC8)
      IF(FIELD(2).GT.C0) GOTO 1350
! ACCEL CARD IS NOT TIME DEPENDENT
      IBASPD(3,ISAT)=IORFRC(3,ISAT)
      IF(FIELD(3).NE.C0) LAFRC(NIC8,3,ISAT)=.TRUE.
      GOTO 600
!     ** TIME DEPENDENT **
 1350 CONTINUE
!
      IF(IFIELD(1).EQ.9)  THEN
         IF(IC1112.EQ.99)  THEN
           IPDFRC(3,ISAT)=IPDFRC(3,ISAT)+9
           MXACC9=MXACC9+9
         ENDIF
      ELSE
         IPDFRC(3,ISAT)=IPDFRC(3,ISAT)+1
      ENDIF
!
      IF(FIELD(3).NE.C0) LAFRC(4,3,ISAT)=.TRUE.
      IF(FIELD(3).NE.C0) IPDADJ(3,ISAT)=IPDADJ(3,ISAT)+1
      GOTO 600
!*********************************************************************
! ** ACCLRM                                               * ACCLRM  **
!*********************************************************************
13500 CONTINUE
      LACCEL=.TRUE.
      DATOL=FIELD(1)
      GOTO 600
!*********************************************************************
! ** ACCBIA                                               * ACCBIA  **
!*********************************************************************
13600 CONTINUE
      NAC=NAC+1
      IACTYP=IC78/10
      IACORD=IC78-IACTYP*10
      IACCMP=IC910/10
      TACCLR(NAC,1)=FIELD(1)
      TACCLR(NAC,2)=FIELD(2)
      TACCLR(NAC,3)=DBLE(IC1824)
!     write(6,*)' dbg  RD50A2 ',NACCB,ACTYP,IACORD,IACCMP,IC1824
      READ(IUNT50,71000,END=60000) CDNAME,IC78,IC910,IC1112,IC1314,     &
     &   IC1517,FA3,IC2122,IC2324,FIELD
      IF(CDNAME.NE.'ACCBI2') GOTO 61020
      GOTO 600
!*********************************************************************
! ** ADELAY                                               * ADELAY  **
!*********************************************************************
13620 CONTINUE
      NTD=NTD+1
      ITDSAT(NTD)=IC1824
      ITDANT(NTD)=IC1517
      NPVAL(IXANTD)=NTDL
      NPVAL0(IXANTD)=NTDL
      GOTO 600
!*********************************************************************
! ** ANTCUT                                               * ANTCUT  **
!*********************************************************************
13650 CONTINUE
      NCUT=NCUT+1
      GOTO 600
!*********************************************************************
! ** DYNSEL                                               * DYNSEL  **
!*********************************************************************
13700 CONTINUE
      NDY=NDY+1
      TDYNSL(NDY,1)=FIELD(1)
      TDYNSL(NDY,2)=FIELD(2)
      TDYNSL(NDY,3)=DBLE(IC1824)
      GOTO 600
!*********************************************************************
! ** ACCEND                                               * ACCEND  **
!*********************************************************************
13800 CONTINUE
      GOTO 600
!*********************************************************************
! ** ACOEF                                                * ACOEF   **
!*********************************************************************
 1351 CONTINUE
      GOTO 600
!*********************************************************************
! ** ALBEDO                                                * ALBEDO **
!*********************************************************************
 1355 CONTINUE
      IF(IC910.EQ.1)IMODEL=1
!     ALGORITHM FOR DETERMINING THE NUMBER OF SPOTS FROM THE NUMBER
!     OF INPUT RINGS.

      ALBTUM=DBLE(IC1112)

      IF(IC78.NE.0) THEN
      IRINGS=IC78
      ELSE
      IRINGS=2
      ISPOTS=19
      ENDIF
      ISUM=1
      IN=IRINGS-1
      DO 1356 J=1,IN
      ISUM=ISUM+2**J
 1356 END DO
!     ISPOTS WILL BE USED FOR ALLOCATIONS
      ISPOTS=1+6*ISUM
      MSPOTS=MAX(MSPOTS,ISPOTS)
      MRINGS=MAX(MRINGS,IRINGS)
      GOTO 600
!*********************************************************************
! ** ALTIM                                                 * ALTIM  **
!*********************************************************************
 1357 CONTINUE
      IF(IFIELD(7).EQ.2) LXATTD=.TRUE.
      IF(IFIELD(7).GE.1) LATMOD=.TRUE.
      IF(FIELD(1).GT.0.D0) XZEROP=FIELD(1)
      GOTO 600
!*********************************************************************
! ** ALTIME                                                * ALTIME **
!*********************************************************************
 1358 CONTINUE
      IF(IMODEL.EQ.0)THEN
       WRITE(IUNT06,83715)
       STOP
      ENDIF
      IF(IC78.EQ.0) GOTO 1360
      IF(IC78.NE.1) GOTO 1370
!     ALBEDO = 1
      KMAXA=KMAXA+1
      ITMPA=IC1112
      MTMPA=IC1314
      IMAXA=MAX(IMAXA,ITMPA)
      MMAXA=MAX(MMAXA,MTMPA)
!  Compute max over all arcs
      MIMAXA=MAX(IMAXA,MIMAXA)
      MMMAXA=MAX(MMAXA,MMMAXA)
      MKMAXA=MAX(KMAXA,MKMAXA)
!
      MIMA1A=MAX( 1, MIMAXA)
      MMMA1A=MAX( 1, MMMAXA)
      MKMA1A=MAX( 1, MKMAXA)
      GOTO 600
!
!     EMISSIVITY = 0
 1360 CONTINUE
      KMAXE=KMAXE+1
      ITMPE=IC1112
      MTMPE=IC1314
      IMAXE=MAX(IMAXE,ITMPE)
      MMAXE=MAX(MMAXE,MTMPE)
!  Compute max over all arcs
      MIMAXE=MAX(IMAXE,MIMAXE)
      MMMAXE=MAX(MMAXE,MMMAXE)
      MKMAXE=MAX(KMAXE,MKMAXE)
      GOTO 600
 1370 CONTINUE
! ERROR EXIT
      WRITE(6,13750)IC78
      STOP
13750 FORMAT(1X,'ALBEDO/EMISSIVITY MODEL INDICATOR ',I2,' IS NOT VALID',&
     & 'USE 1 FOR ALBEDO AND 0 FOR EMISSIVITY')
!*********************************************************************
! ** ALTWVL **                                             * ALTWVL **
!*********************************************************************
 1365 CONTINUE
      NALTW=NALTW+1
      GOTO 600
!*********************************************************************
! ** ANOMLY **                                             * ANOMLY **
!*********************************************************************
 1366 CONTINUE
      GOTO 600
!*********************************************************************
! ** APLOAD **                                             * APLOAD **
!*********************************************************************
 1367 CONTINUE
      LAPL=.TRUE.
      GOTO 600
!*********************************************************************
! ** ATGRAV **                                             * ATGRAV **
!*********************************************************************
 1375 CONTINUE
      LATGRV=.TRUE.
      IF(IC78.GT.0)  NADEG=IC78
      IF(IC910.GT.0) NAORD=IC910
      INTC21=IFIELD(7)
      NAORD=NADEG
      IF(IC1112.EQ.1)INTAG=1
      IDATB=IARCT1
      IDATE=IARCT2
      IF(FIELD(1).LE.C0) GOTO 1376
!
!     ....check validity of time
!
      CALL CHKTM1( FIELD(1), 'ATGRAV    ' )
!
! ** BREAK UP FIELD 1 **
      X1=1.D+6
      X1YMD=FIELD(1)/X1
      X1HMS=MOD(FIELD(1),X1)
      I1YMD=INT(X1YMD)
      I1HMS=INT(X1HMS)
      CALL YMDTIS(I1YMD,I1HMS,I1SEC)
! if times on the card are different from epoch start
! times reset times.
      IDATB=MAX(IDATB,I1SEC) + INT(REPDIF)
 1376 CONTINUE
      IF(FIELD(2).LE.C0) GOTO 1377
!
!     ....check validity of time
!
      CALL CHKTM1( FIELD(2), 'ATGRAV    ' )
!
! ** BREAK UP FIELD 2 **
      X1=1.D+6
      X1YMD=FIELD(2)/X1
      X1HMS=MOD(FIELD(2),X1)
      I1YMD=INT(X1YMD)
      I1HMS=INT(X1HMS)
      CALL YMDTIS(I1YMD,I1HMS,I1SEC)
! if times on the card are different from epoch stop
! times reset times.
      IDATE=MAX(IDATE,I1SEC)+ INT(REPDIF)
 1377 CONTINUE
      GOTO 600
!*********************************************************************
! ** ATITUD **                                             * ATITUD **
!*********************************************************************
 1400 CONTINUE
! COUNT ROLL PITCH YAW ANGLES
        IF(IFIELD(1) .EQ.0) THEN
! CHECK IF COLS 10 - 11 ARE 99  IF NOT TERMINATE THE RUN
      IV=IFIELD(4)*10+IFIELD(5)
           IF(IV.NE.99.OR.FIELD(2).EQ.0.D0) THEN
      WRITE(6,*)' THE HEADER ATITUD CARD IS INCORRECT: EITHER NO 99 ',&
     & 'WAS FOUND ON COLUMNS 10-11 OR  END TIME WAS NOT PROVIDED '
      STOP 16
           ELSE
! CHECK VALIDITY OF SATELLITE
      CALL FNDNUM(IC1824,ISATID,NSATID,ISAT)
      IRETAL=ISAT
!
      IF(ISAT.EQ.0) THEN
      WRITE(6,*)' SATELLITE ID',IC1824,' ON ATITUD CARD IS NOT FOUND &
     &            IN SATELLITE LIST '
      WRITE(6,*)' EXECUTION TERMINATED IN  RD50A2 '
      STOP
      ENDIF
!
          ENDIF

          IROTSC=IFIELD(6)*100+IFIELD(7)*10+IFIELD(8)

! LOAD SATELLITE IN SAT ATT ARRAY
      IF (MAXAT.EQ.0) THEN
      NASAT=NASAT+1
      IATSAT(NASAT)=IC1824
      IF(FIELD(3).EQ.0.D0) THEN
      WRITE(6,*)' EXECUTION TERMINATED IN RD50A2 -- PERIOD MISSING ON ',&
     &' THE ATITUD  99 CARD '
      ENDIF
      ATPER(NASAT)=FIELD(3)
      ELSE
      CALL FNDNUM(IC1824,IATSAT,MXSAT,IRET)
      IF (IRET.EQ.0) THEN
      NASAT=NASAT+1
      KPAT=0
      ENDIF
      IATSAT(NASAT)=IC1824
      IF(FIELD(3).EQ.0.D0) THEN
      WRITE(6,*)' EXECUTION TERMINATED IN RD50A2 -- PERIOD MISSING ON ',&
     &' THE ATITUD  99 CARD '
      ENDIF
      ATPER(NASAT)=FIELD(3)
! START RE-COUNTING THE PERIODS FOR A NEW S/C
! EVENTUALLY MAXAT IS THE MAXIMUM NUMBER OF PERIODS FOR ANY S/C
      IBLAS=0
      ENDIF
! COUNT THE TIME PERIODS
      KPAT=KPAT+1
      MAXAT=MAX(MAXAT,KPAT)
        ELSE
! THIS IS A PARAMETER CARD NOT A 99 CARD
! IDENTIFY THE BODY (S/C OR LASER)
      IB=IFIELD(6)*100+IFIELD(7)*10+IFIELD(8)
      IF(IB.GT.0) THEN
      CALL FNDNUM(IB,KVLAS(1,NASAT),10,IRET1)
      IF(IRET1.EQ.0) THEN
      IBLAS=IBLAS+1
      KVLAS(IBLAS,NASAT)=IB
      MAXLAS=MAX(MAXLAS,IBLAS)
      ENDIF
      ENDIF
       ENDIF
      NFATIT(1,IRETAL)=MAXAT*(15*(MAXLAS+1))
      NFATIT(2,IRETAL)=MAXAT*(15*(MAXLAS+1))
      GOTO 600
!*********************************************************************
! ** BINAST **                                             * BINAST **
!*********************************************************************
 1405 CONTINUE
      IF(LBINAST.AND..NOT.LASTSN) THEN
      WRITE(6,*)' EXECUTION TERMINATED IN RD50A2 '
      WRITE(6,*)' THE BINAST OPTION REQUIRES THE PRESENCE OF INTGCB'
      STOP
      ENDIF
      NPVAL(IX2GM)=1
      NPVAL0(IX2GM)=1
      NPVAL(IX2BDA)=1
      NPVAL0(IX2BDA)=1
      GOTO 600
!*********************************************************************
! ** CAMERA **                                             * CAMERA **
!*********************************************************************
 1410 CONTINUE
      NPVAL(IXCAME)=5*NCAM
      NPVAL0(IXCAME)=5*NCAM
      GOTO 600
!*********************************************************************
! ** CGMASS **                                             * CGMASS **
!*********************************************************************
 1425 CONTINUE
      NCGMAS=NCGMAS+1
      GOTO 600
!*********************************************************************
! ** CONBIA **                                             * CONBIA **
!*********************************************************************
 1475 CONTINUE
      ICONBIA=ICONBIA+1
      ISTACT(ICONBIA)=IC714
!     IT1=INT(FIELD(1))
!     IT2=INT(FIELD(2))
!     FSEC1=FIELD(1)-DFLOAT(IT1)
!     FSEC2=FIELD(2)-DFLOAT(IT2)
      CALL RIYMDH(FIELD(1),I1YMD,I1HMS)
      CALL YMDTIS(I1YMD,I1HMS,I1SEC)
      T1=DBLE(I1SEC)
      CALL RIYMDH(FIELD(2),I1YMD,I1HMS)
      CALL YMDTIS(I1YMD,I1HMS,I2SEC)
      T2=DBLE(I2SEC)
      TIMECT(ICONBIA,1)=T1
      TIMECT(ICONBIA,2)=T2
      WEIGCT(ICONBIA)=FIELD(3)
      CRLTCT(ICONBIA)=FIELD(4)
      GOTO 600
!*********************************************************************
! ** CON9PA **                                             * CON9PA **
!*********************************************************************
 1600 CONTINUE
      IDIR=IC78/10
      ICON=IC78-IDIR*10
      CALL FNDNUM(IC1824,ISATID,NSATID,ISAT)
      IF(ISAT.EQ.0) GO TO 60650
      LREDGA(IDIR,ICON,ISAT)=.TRUE.
      NSETAC(IDIR,ICON,ISAT)=NSETAC(IDIR,ICON,ISAT)+1
      GO TO 600
!*********************************************************************
! ** CONDRG **                                             * CONDRG **
!*********************************************************************
 1620 CONTINUE
      CALL FNDNUM(IC1824,ISATID,NSATID,ISAT)
      IF(ISAT.EQ.0) GO TO 60650
      LREDDR(ISAT)=.TRUE.
      NSETDR(ISAT)=NSETDR(ISAT)+1
      GO TO 600
!*********************************************************************
! ** CONSOL **                                             * CONSOL **
!*********************************************************************
 1640 CONTINUE
      CALL FNDNUM(IC1824,ISATID,NSATID,ISAT)
      IF(ISAT.EQ.0) GO TO 60650
      LREDSL(ISAT)=.TRUE.
      NSETSL(ISAT)=NSETSL(ISAT)+1
      GO TO 600
!*********************************************************************
! ** CONSPL **                                             * CONSPL **
!*********************************************************************
 1650 CONTINUE
      IND_CNS=IND_CNS+1
      NBSPLN(1,IND_CNS)=IC1517
      NBSPLN(2,IND_CNS)=0
      NBSPLN(3,IND_CNS)=0
      NBSPLN(4,IND_CNS)=0
      NBSPLN(5,IND_CNS)=0
      NSSPLN(1,IND_CNS)=IC714
      NSSPLN(2,IND_CNS)=0.D0
      SIGSP(1,IND_CNS)=FIELD(1)
      SIGSP(2,IND_CNS)=FIELD(2)
      SIGSP(3,IND_CNS)=FIELD(3)
      SIGSP(4,IND_CNS)=FIELD(4)
      SIGSP(5,IND_CNS)=0.D0
      SIGSP(6,IND_CNS)=0.D0
      GO TO 600
!*********************************************************************
! ** COMCOF **                                             * COMCOF **
!*********************************************************************
1800  CONTINUE
      NPVAL(IXCOFF)=3
      IF(FIELD(4).NE.0.0D0) NPVAL0(IXCOFF)=3
      GO TO 600
!*********************************************************************
! ** DATA   **  SEE SELECT/DELETE OPTION CARDS             * DATA   **
!*********************************************************************
!*********************************************************************
! ** DELAY  **                                             * DELAY  **
!*********************************************************************
 1450 CONTINUE
      IF(IC1824.GT.0) GOTO 1455
! STATION DELAY
      IF(IC714.EQ.0) WRITE(IUNT06,80725) IC714,IC1517,IC1824,FIELD(1),  &
     &     FIELD(2),FIELD(3),FIELD(4)
      IF(IC714.NE.0) NSTADL=NSTADL+1
      GOTO 600
! SATELLITE DELAY
 1455 CONTINUE
      NSATDL=NSATDL+1
      GOTO 600
!*********************************************************************
! ** DRAG   **                                             * DRAG   **
!*********************************************************************
 2000 CONTINUE
! FIND LOCATION IN SATELLITE ARRAY OF THIS SATELLITE
      CALL FNDNUM(IC1824,ISATID,NSATID,ISAT)
      IF(ISAT.EQ.0) GO TO 60650
!
! TEST SIGMA
      IBEG=IARCT1
      IEND=IARCT2
      IF(FIELD(3).EQ.C0) GOTO 2020
         IBEG=IDATAB
         IEND=IDATAE
 2020 CONTINUE
      IF(FIELD(2).LE.C0) GOTO 2030
!
!     ....check validity of end time
!
      CALL CHKTM1( FIELD(2), 'DRAG    ' )
!
! ** BREAK UP FIELD 2 **
      CALL RIYMDH(FIELD(2),I1YMD,I1HMS)
      CALL YMDTIS(I1YMD,I1HMS,I1SEC)
! eliminate cards with times prior to the start time of the run
!     IF(I1SEC.LT.IBEG) GOTO 600
! if previous satellite id is not equal to current sat id reset ldrtmx
! to false so that first time that exceeds the end time will
! be accepted for the current satellite.
      IF(IPIDDG.NE.IC1824)LDRTMX=.FALSE.
! accept the first time that exceeds the end time (LDRTMX=.FALSE.)
! reject all other times that exceed the end time (LDRTMX=.TRUE.)
      IF(LDRTMX.AND.(I1SEC.GT.IEND)) GOTO 600
! set flag to tell that the first time beyond the end time was found
      IF(I1SEC.GT.IEND) LDRTMX=.TRUE.
! save value of satellite id
      IPIDDG=IC1824
 2030 CONTINUE
      NIC8=IFIELD(2)+1
      NIC8= MIN(3,NIC8)
      IORFRC(1,ISAT)= MAX(IORFRC(1,ISAT),NIC8)
      IF(FIELD(2).GT.C0) GOTO 2050
! DRAG CARD IS NOT TIME DEPENDENT
      IBASPD(1,ISAT)=IORFRC(1,ISAT)
      IF(FIELD(3).NE.C0) LAFRC(NIC8,1,ISAT)=.TRUE.
      GOTO 600
!     ** TIME DEPENDENT **
 2050 CONTINUE
      IPDFRC(1,ISAT)=IPDFRC(1,ISAT)+1
      IF(FIELD(3).NE.C0) LAFRC(4,1,ISAT)=.TRUE.
      IF(FIELD(3).NE.C0) IPDADJ(1,ISAT)=IPDADJ(1,ISAT)+1
      GOTO 600
!*********************************************************************
! ** DPOLE  **                                             * DPOLE  **
!*********************************************************************
 1500 CONTINUE
      NDPOLE=NDPOLE+1
      GO TO 600
!*********************************************************************
! ** DRGTAB **                                             * DRGTAB **
!*********************************************************************
 3000 NDCSA=IC710+IC1114+IC1517
 3010 READ(IUNT50,71100,END=60100) CDNAME
      IF(CDNAME.NE.FIN) GO TO 3000
      GOTO 600
!*********************************************************************
! ** DSTATE  **                                           * DSTATE  **
!*********************************************************************
 3020 CONTINUE
      NFQ=2*NSATDS
      CALL FNDNUM(IC1824,NXDELT(1,1),NFQ,IDSAT)
      IDSAT=1+(IDSAT/2)
      CALL FNDNUM(IC1824,ISATID,NSATID,ISAT)
      IRETAL=ISAT
      NFDSTA(IRETAL)=NXDELT(2,IDSAT)*6
!     NPVAL(IXDXYZ)=NEVENTS*6
!     NPVAL0(IXDXYZ)=NEVENTS*6
      GOTO 600
!*********************************************************************
! ** EARTH  **                                             * EARTH  **
!*********************************************************************
 3500 CONTINUE
      IF(.NOT.LGLOBL) GOTO 3550
! ** GLOBAL **
      IF(IFIELD(1).GT.0) IPLNZ(3)=IFIELD(1)
      IF(IFIELD(3).GT.0) GO TO 3525
      IF(ICBDCF.NE.3) GO TO 600
 3510 CONTINUE
      MXDEGG= MAX(IC1517,3)
      MXORDG= MAX(IC1820,2)
! IF ZERO IS ON SATPAR FOR GEOPOTENTIAL USE FULL GEOPOTENTIAL
! SET MAXIMUM DEGREE AND ORDER
      IF(MAXDS.EQ.99999)MAXDS=MXDEGG
      MXDEGG=MIN(MXDEGG,MAXDS)
      MXORDG=MIN(MXORDG,MAXDS)
      GPDEG =MXDEGG
      GPORD =MXORDG
      NMAX=MXDEGG
      NPVAL(IXGPC)=(MXDEGG*(MXDEGG+1))/2+3*MXDEGG
      NPVAL(IXGPS)=NPVAL(IXGPC)
      GOTO 600
 3525 IF(FIELD(1).GT.C0)  NPVAL0(IXGM  )=NPVAL0(IXGM  )+1
      IF(FIELD(2).GT.C0)  NPVAL0(IXSMA )=NPVAL0(IXSMA )+1
      IF(FIELD(3).GT.C0)  NPVAL0(IXFLTP)=NPVAL0(IXFLTP)+1
      IF(FIELD(4).GT.C0)  NPVAL0(IXFLTE)=NPVAL0(IXFLTE)+1
      GO TO 600
! ** ARC **
 3550 CONTINUE
      IF(ICBDCF.NE.3) GO TO 600
 3555 CONTINUE
      MXDEGA= MAX(IC1517,3)
      MXORDA= MAX(IC1820,2)
      NPVAL(IXGPCA)=(MXDEGA*(MXDEGA+1))/2+3*MXDEGA
      NPVAL(IXGPSA)=NPVAL(IXGPCA)
      GO TO 600
!*********************************************************************
! ** EBIAS  **                                             * EBIAS  **
!*********************************************************************
 3700 CONTINUE
      JX=1
      DO 3705 I=1,2
      IF(CDNAME.EQ.EBIS(I)) JX=JX+I
 3705 END DO
      IF(JX.EQ.1) NEBKNT=NEBKNT+1
!
!     ....check validity of start and stop times
!
      IF( FIELD(2) .GT. C0 ) CALL CHKTM1( FIELD(2), 'EBIAS   ' )
      IF( FIELD(3) .GT. C0 ) CALL CHKTM1( FIELD(3), 'EBIAS   ' )
!
      IEBSTA(JX,NEBKNT)=IC714
      IEBSAT(JX,NEBKNT)=IC1824
      IF(JX.NE.1) GOTO 600
      IEBTYP(NEBKNT)=IC1517
!  IF IC1517 IS EQUAL TO ZERO CHECK IF THERE IS AN EBIASM CARD
!  NEXT TO SPECIFY THE MEASUREMENT TYPE
      IF(IC1517.EQ.0) THEN
       READ(IUNT50,71150,END=60000) CDNAME,IC710
       IF(CDNAME.NE.OPTION(77)) THEN
       GO TO 60987
       ELSE
       IEBTYP(NEBKNT)=IC710
       IGRP=IEBTYP(NEBKNT)/1000
       ENDIF
      GO TO 7306
      ENDIF
!  DETERMINE IF THIS IS A VALID EBIAS GROUP
      IGRP=IEBTYP(NEBKNT)/100
 7306 CONTINUE
      IF(NEBGRP.LE.0) THEN
        NEBGRP=1
        IEBGRP(1)=IGRP
      ELSE
        DO 3715 J=1,NEBGRP
        IF (IGRP.EQ.IEBGRP(J)) GO TO 3718
 3715   CONTINUE
        NEBGRP=NEBGRP+1
        IF(NEBGRP.GT.MEPARM) THEN
!          TERMINATE RUN - TOO MANY GROUPS ARE USED
           WRITE(IUNT06,80940) MEPARM,IEBGRP,NEBKNT,IEBTYP(NEBKNT)
           WRITE(IUNT06,89000)
           STOP
        ELSE
!          ADD NEW EBIAS GROUP NUMBER
           IEBGRP(NEBGRP)=IGRP
        ENDIF
 3718 CONTINUE
      ENDIF
 3719 CONTINUE
! START TIME
      MJDSEC=0
      IF(FIELD(2).EQ.C0) GOTO 3720
      CALL RIYMDH(FIELD(2),IJXYMD,IJXHMS)
      CALL YMDTIS(IJXYMD,IJXHMS,MJDSEC)
 3720 IEBEGN(NEBKNT)=MJDSEC
! STOP TIME
! STOP TIME
! ..The following has been modified for y2000
!  if FIELD(3)=0.D0 ,IEBEND = IARCT2
!
!     IJXYMD=991231
!     IJXHMS=235900
!     IF(FIELD(3).EQ.C0) GOTO 3740
!3740  CALL RIYMDH(FIELD(3),IJXYMD,IJXHMS)
      IF(FIELD(3).EQ.C0)THEN
      IEBEND(NEBKNT)=IARCT2
      GOTO 3740
      ENDIF
      CALL RIYMDH(FIELD(3),IJXYMD,IJXHMS)
      CALL YMDTIS(IJXYMD,IJXHMS,MJDSEC)
      IEBEND(NEBKNT)=MJDSEC
 3740 GOTO 600
!*********************************************************************
! ** EBIASM  **                                           * EBIASM  **
!*********************************************************************
 3750 CONTINUE
      IEBTYP(NEBKNT)=IC78*100+IC910
!  IF IC1517 IS EQUAL TO ZERO CHECK IF THERE IS AN EBIASM CARD
!  NEXT TO SPECIFY THE MEASUREMENT TYPE
!  DETERMINE IF THIS IS A VALID EBIAS GROUP
      IGRP=IEBTYP(NEBKNT)/1000
      IF(NEBGRP.LE.0) THEN
        NEBGRP=1
        IEBGRP(1)=IGRP
      ELSE
        DO 3751 J=1,NEBGRP
        IF (IGRP.EQ.IEBGRP(J)) GO TO 3752
 3751   CONTINUE
        NEBGRP=NEBGRP+1
        IF(NEBGRP.GT.MEPARM) THEN
!          TERMINATE RUN - TOO MANY GROUPS ARE USED
           WRITE(IUNT06,80940) MEPARM,IEBGRP,NEBKNT,IEBTYP(NEBKNT)
           WRITE(IUNT06,89000)
           STOP
        ELSE
!          ADD NEW EBIAS GROUP NUMBER
           IEBGRP(NEBGRP)=IGRP
        ENDIF
 3752 CONTINUE
      ENDIF
 3753 CONTINUE
      GO TO 600
!*********************************************************************
! ** ELEVWT **                                             * ELEVWT **
!*********************************************************************
 1415 CONTINUE
!!      write(6,*)'jtwRD50A2: ELEVWT,IC1112',IC1112

      IF (IC1112.LT.99) THEN

!!       write(6,*)'jtwIC1517,FIELD(1)',IC1517,FIELD(1)
!!!       AA1(JDWNWT+((IC1517-1)*90)+(90-IC1112))=FIELD(1)
!!move elevation angle from 1112 to 1314

!!       IIDUM=((IC1517-1)*90)+(90-IC1112)
       IIDUM=((IC1517-1)*90)+(90-IC1314)
       AA1(JDWNWT+IIDUM) = FIELD(1)
       IF (AA1(JDWNWT+IIDUM-1).EQ.0) THEN
        IDUM1=JDWNWT+((IC1517-1)*90)
!!        IDUM2=JDWNWT+((IC1517-1)*90)+(90-IC1112)-1
        IDUM2=JDWNWT+((IC1517-1)*90)+(90-IC1314)-1
        DO JJ=IDUM1,IDUM2
           AA1(JJ)=1.0D0
        END DO
       ENDIF
      ENDIF
      GOTO 600
!*********************************************************************
! ** EMATRX **                                             * EMATRX **
!*********************************************************************
 3800 CONTINUE
!  MAKE SURE THAT THE GEOPOTENTIAL TOLS FOR EACH SET WILL BE MAX
      NTOLD=999999999
      GOTO 600
!*********************************************************************
! ** ENDARC **                                             * ENDARC **
!*********************************************************************
 4000 CONTINUE
!     ....if LSLFLG is .FALSE., you had a DATA card and no SELECT card
      IF(.NOT.LSLFLG) GO TO 60995
      MTRAJC= MAX(MTRAJC,NTRAJC)
! DETERMINE MAXIMUM NUMBER FOR BIAS ARC OPTIONS
      MBIASA= MAX(MBIASA,NBIASA)
      MBIASK= MAX(MBIASK,NBIASK)
      MBCDT = MAX(MBCDT,NBCDT)
      MBCDP = MAX(MBCDP,NBCDP)
      MEBKNT= MAX(MEBKNT,NEBKNT)
! determine maximums over an arc for box-wing arrays
      MXSLAB= MAX(MXSLAB,NMSLAB)
      NPNALB=MXSLAB
      MXTPAT= MAX(MXTPAT,NMTPAT)
! CALCULATE NXTIMB IF NECESSARY
      IF(NXTIMB.LT.999999999) GO TO 4010
      NSTEPS=(MAXSOR-1)*2
      NH1=NSTEPS-(MAXSOR-1)
      IF(NH1VOC.GT.NH1) NH1=NH1VOC
      NXTIMB=MINSH*NH1
 4010 CONTINUE
      IF(LSDATA) THEN
      NPTS=NXTIMB/VINT
      IESTIM=40*(NPTS+1)
      MXBLEN=(IESTIM/NLENO)+1
      MOBBUF=MAX(MOBBUF,MXBLEN*NLENO)
      ENDIF
!
! CHECK IF WHEN USING THE NEW ALBEDO EARTH MODEL THAT ALTIME CARDS
! ARE PROVIDED ON UNIT 5
!
      IF(KMAXA.EQ.0.AND.KMAXE.EQ.0) THEN
      IF(IMODEL.EQ.1)THEN
       WRITE(IUNT06,83720)
       STOP
      ENDIF
      ENDIF
! EVALUATE NUMBER OF INDIVIDUAL TIDAL CONSTITUENTS FOR THE NEW TIDAL
! MODEL
      IF(LOTMOD) THEN
      DO 60050 I=1,15
      IF(NUMCON(I).GT.0) THEN
      NUMIND=NUMIND+1
      ENDIF
60050 END DO
      ENDIF
      RETURN
!*********************************************************************
!** ENDGLB **                                              * ENDGLB **
!*********************************************************************
 5000 LGLOBL=.FALSE.
      LENDGL=.TRUE.
      RETURN
!*********************************************************************
! ** ETIDES ** ETIDEN                              ETIDEN ** ETIDES **
!*********************************************************************
 5100 CONTINUE
      NTIDE=NTIDE+1
      NET=NET+1
      NPVAL(IXETDE)=NPVAL(IXETDE)+2
      IDN(NTIDE)=IC1824
      IF(FIELD(3).NE.C0.OR.FIELD(4).NE.C0) GO TO 5110
      NETUN=NETUN+1
      GO TO 600
 5110 CONTINUE
      NPVAL0(IXETDE)=NPVAL0(IXETDE)+2
      NETADJ=NETADJ+1
      GOTO 600
!*********************************************************************
! ** FANTIM **                                             * FANTIM **
!*********************************************************************
 5120 CONTINUE
      IC7=(IC78/10)+0.9D0
      !write(6,'(A,1x,I6)') 'rd50a2: fantim  ic7 ', ic7
!
      IF(LENDGL) GOTO 5115
      IF(LFTGLB) THEN
!
          !  GLOBAL
!
          IF(IC7.EQ.1) THEN
              IF(FIELD(1).GT.ZERO) NFANEP=NFANEP+1
              IF(FIELD(2).GT.ZERO) NFANTM=NFANTM+1
!
              !write(6,*)'rd50a2: fantim global geometric '
              !write(6,*)'rd50a2: field(1), field(2), nfanep, nfantm ', &
              !                   field(1), field(2), nfanep, nfantm
          ENDIF
!
          IF(IC7.EQ.2) THEN
              IF(FIELD(1).GT.ZERO) NFANEP=NFANEP+1
              IF(FIELD(2).GT.ZERO) NFANTM=NFANTM+1
!
              !write(6,*)'rd50a2: fantim global force     '
              !write(6,*)'rd50a2: field(1), field(2), nfanep, nfantm ', &
              !                   field(1), field(2), nfanep, nfantm
          ENDIF
!
      ENDIF ! LFTGLB
!
      GOTO 600
!
 5115 CONTINUE
!
      IF(.NOT.LFTARC)GOTO 600
      !  ARC
      IF(IC7.EQ.1) THEN
          IF(FIELD(1).GT.ZERO) NFANEP=NFANEP+1
          IF(FIELD(2).GT.ZERO) NFANTM=NFANTM+1
!
          !write(6,*)'rd50a2: fantim ARC    geometric '
          !write(6,*)'rd50a2: field(1), field(2), nfanep, nfantm ', &
          !                   field(1), field(2), nfanep, nfantm
      ENDIF
      IF(IC7.EQ.2) THEN
          IF(FIELD(1).GT.ZERO) NFANEP=NFANEP+1
          IF(FIELD(2).GT.ZERO) NFANTM=NFANTM+1
!
          !write(6,*)'rd50a2: fantim ARC    force     '
          !write(6,*)'rd50a2: field(1), field(2), nfanep, nfantm ', &
          !                   field(1), field(2), nfanep, nfantm
      ENDIF
!
      GO TO 600
!*********************************************************************
! ** FANTOM  **                                        * FANTOM     **
!*********************************************************************
 5200 CONTINUE
!
      IC7=(IC78/10)+0.9D0
      IC8=IC78-IC7*10
      IC9=(IC910/10)+0.9D0
      IC10=IC910-IC9
!
      !write(6,*)'rd50a2: fantom  IC7, IC8, IC9, IC10 ',  &
      !                           IC7, IC8, IC9, IC10
!
      IF(IC9.GT.0)LXTRAF=.TRUE.
!
      !write(6,*)'rd50a2: fantom  LXTRAF ', LXTRAF
      !write(6,*)'rd50a2: fantom  LENDGL ', LENDGL
!
      IF(LENDGL)GO TO 5210
!
      ! GLOBAL
!
      IF(LFGLB) THEN
          IF(IC7.EQ.1) THEN
              NPVAL(IXFGGM)=NPVAL(IXFGGM)+1
              IF(FIELD(2).GT.ZERO) NPVAL0(IXFGGM)=NPVAL0(IXFGGM)+1
          ENDIF
          IF(IC7.EQ.2) THEN
              NPVAL(IXFGFM)=NPVAL(IXFGFM)+1
              IF(FIELD(2).GT.ZERO) NPVAL0(IXFGFM)=NPVAL0(IXFGFM)+1
          ENDIF
      ENDIF ! LFGLB
!
      GOTO 600
 5210 CONTINUE
!
      IF(.NOT.LFARC) GOTO 600
!
      ! ARC
!
      IF( IC7.EQ.1 ) THEN
          NPVAL(IXFAGM)=NPVAL(IXFAGM)+1                         ! geometr
          IF(FIELD(2).GT.ZERO) NPVAL0(IXFAGM)=NPVAL0(IXFAGM)+1  ! geometr
      ENDIF
!
      IF(IC7.EQ.2) THEN
      CALL FNDNUM(IC1824,ISATID,NSATID,ISAT)
!     NPVAL(IXFAFM)=NPVAL(IXFAFM)+1        ! force
      NSATFA(1,ISAT)=NSATFA(1,ISAT)+1      ! number unadjusted
!     IF(FIELD(2).GT.ZERO) NPVAL0(IXFAFM)=NPVAL0(IXFAFM)+1
      IF(FIELD(2).GT.ZERO) NSATFA(2,ISAT)=NSATFA(2,ISAT)+1  ! number adj
      IF(FIELD(2).GT.ZERO) LSATFA(1,ISAT)=.TRUE.
        ! write(6,*)'rd50a2: fantom isat ', isat                      ! j
        ! write(6,*)'rd50a2: fantom nsatfa(1,isat),nsatfa(2,isat) ',& ! j
        !                           nsatfa(1,isat),nsatfa(2,isat)     ! j
        ! write(6,*)'rd50a2: fantom lsatfa(1:2,isat) ', &             ! j
        !                           lsatfa(1:2,isat)                  ! j
!
      ENDIF !  jjm 3/98
!
      GOTO 600
!
!*********************************************************************
! ** FLUX   **                                             * FLUX   **
!*********************************************************************
 5300 CONTINUE
!****PLEASE NOTE THIS FIRST CHECK DETERMINES WHICH FLUX CARD IS READ
!****THEREFORE, IT MUST ALWAYS PRECEED OTHER CODE ON CARD.  IF COL 9
!****IS SET TO 1, THEN FIELD(1) CONTAINS SOLAR FLUX AT 1 AU.  oTHERWISE,
!****CARD MODIFIES FLUX VALUES IN BUILT IN TABLES
!
      IF(IFIELD(3).EQ.1) THEN
         IF(FIELD(1).NE.C0) FLX1AU=FIELD(1)
         GOTO 600
      ENDIF
!
      IF(IFIELD(1).GT.0) LFLXPR=.TRUE.
      IYMD=FIELD(1)
      IF(IYMD.GE.000101.AND.IYMD.LE.991231) GOTO 5305
      IF(IYMD.NE.0) GOTO 60800
      GOTO 600
!
 5305 CONTINUE
      IF(IYMD.LE.491231)IYMD=IYMD+1000000
      IF(IYMD.GE.IFLUX.AND.IYMD.LE.JFLUX) GOTO 5310
      GOTO 600
 5310 CALL DIFF(IFLUX,0,IYMD,0,NDAYS,NSEC)
! SOLAR FLUX
      IF(FIELD(2) .LT.C0) AA1(KFLXS +NDAYS)=C0
      IF(FIELD(2) .GT.C0) AA1(KFLXS +NDAYS)=FIELD(2)*C10D0
      IF(IATDEN.EQ.10) GOTO 60950
! KP CALCULATED FROM AP
      IF(IFIELD(2).GT.0) CALL FLUXKP(FIELD(4))
! KP -- JACCHIA MODEL 71 AND JACCHIA MODEL 77
      IF(FIELD(4).GT.C0) THEN
       IATDN=IATDEN/10
       IF((IATDN.EQ.4).OR.(IATDN.EQ.5).OR.(IATDN.EQ.6)) THEN
        WRITE(6,*) 'CHECK RD50A2: non jaachia selection'
        DO 5311 J1=1,8
        AA1(KFLXM+NDAYS*8+(J1-1))=FIELD(4)*C100D0
!       IF(IATDN.EQ.6) THEN
!        DO 5311 J1=1,8
!        AA1(KFLXM+NDAYS*8+(J1-1))=FIELD(4)*C100D0
 5311   CONTINUE
       ELSE
        AA1(KFLXM+NDAYS)=FIELD(4)*C100D0
       ENDIF
      ENDIF
! FOR USER SPECIFIED AVERAGE FLUX VALUE
      IF(FIELD(3).LT.C0) AA1(KFLXAV +NDAYS)=C0
      IF(FIELD(3).GT.C0) THEN
      IF(IFLXF1.GT.0) GOTO 5412
      DO 5411 J=KFLXAV,KFLXAV+MAXFLX-1
      AA1(J)=FIELD(3)*C10D0
 5411 END DO
      GOTO 5414
 5412 AA1(KFLXAV+NDAYS)=FIELD(3)*C10D0
 5414 IFLXF1=1
      ENDIF
      GO TO 600
!*********************************************************************
! ** FREEZE **                                             * FREEZE **
!*********************************************************************
 5415 CONTINUE
      IF(IC78.LE.0) GOTO 5416
      FREEZI=DBLE(IC78)
      IF(IC910.GT.0) THEN
      FREEZG=DBLE(IC910)
      ENDIF
 5416 CONTINUE
      IF(IC1112.GT.0) FREEZA=DBLE(IC1112)
      GO TO 600
!*********************************************************************
! ** FNBURN **                                             * FNBURN **
!*********************************************************************
 5417 CONTINUE
      NPVAL(IXBURN)=NBGRP*25
      NPVAL0(IXBURN)=NBGRP*25
      GO TO 600
! ENDBRN
 5418 CONTINUE
      INDXB=IC78/10
      IF(INDXB.GT.0) NBMODE=INDXB
      GO TO 600
!*********************************************************************
! ** G2COFC  **                                           * G2COFC  **
!*********************************************************************
 5420 CONTINUE
      NPVAL(IX2CCO)=39
!     NPVAL(IX2CCO)=NPVAL(IX2CCO)+1
      IF(FIELD(3).GT.C0) NPVAL0(IX2CCO)=NPVAL0(IX2CCO)+1
      GO TO 600
!*********************************************************************
! ** G2COFS  **                                           * G2COFS  **
!*********************************************************************
 5430 CONTINUE
      NPVAL(IX2SCO)=39
!     NPVAL(IX2SCO)=NPVAL(IX2SCO)+1
      IF(FIELD(3).GT.C0) NPVAL0(IX2SCO)=NPVAL0(IX2SCO)+1
      GO TO 600
!*********************************************************************
! ** GCOEF  **                                             * GCOEF  **
!*********************************************************************
 5500 CONTINUE
      IF(.NOT.LGLOBL) GO TO 5600
      IF(IC1517.LT.1.OR.IC1517.GT.MXDEGG) GOTO 600
      IF(IC1820.GT.IC1517 .OR. IC1820.GT.MXORDG) GOTO 600
      IF(FIELD(3).GT.C0) NPVAL0(IXGPC)=NPVAL0(IXGPC)+1
      IF(FIELD(4).GT.C0.AND.IC1820.GT.0)                                &
     &     NPVAL0(IXGPS)=NPVAL0(IXGPS)+1
      GO TO 600
 5600 CONTINUE
! ARC COEFFICIENTS
      IF(IC1517.LT.1.OR.IC1517.GT.MXDEGA) GOTO 600
      IF(IC1820.GT.IC1517 .OR. IC1820.GT.MXORDA) GOTO 600
      IF(FIELD(3).GT.C0) NPVAL(IXGPCA)=NPVAL(IXGPCA)+1
      IF(FIELD(3).GT.C0) NPVAL0(IXGPCA)=NPVAL0(IXGPCA)+1
      IF(IC1820.EQ.0) GOTO 600
      IF(FIELD(4).GT.C0) NPVAL(IXGPSA)=NPVAL(IXGPSA)+1
      IF(FIELD(4).GT.C0) NPVAL0(IXGPSA)=NPVAL0(IXGPSA)+1
      GOTO 600
!*********************************************************************
! ** GCOEFC **                                             * GCOEFC **
!*********************************************************************
 5700 CONTINUE
      IF(.NOT.LGLOBL) GO TO 5750
      IF(ITPGRV.EQ.1) GO TO 5710
      IF(IC1517.LT.1.OR.IC1517.GT.MXDEGG) GOTO 600
      IF(IC1820.GT.IC1517 .OR. IC1820.GT.MXORDG) GOTO 600
      IF(FIELD(3).GT.C0) NPVAL0(IXGPC)=NPVAL0(IXGPC)+1
      GO TO 600
 5710 CONTINUE
      IF(IC1517.LT.1.OR.IC1517.GT.MXDEGG) GOTO 600
      IF(IC1820.GT.IC1517 .OR. IC1820.GT.MXORDG) GOTO 600
       NPVAL(IXTGPC)=NPVAL(IXTGPC)+1
       IF(FIELD(3).GT.C0) THEN
       NPVAL0(IXTGPC)=NPVAL0(IXTGPC)+1
       ENDIF
      GO TO 600
 5750 CONTINUE
! ARC COEFFICIENTS
      IF(IC1517.LT.1.OR.IC1517.GT.MXDEGA) GOTO 600
      IF(IC1820.GT.IC1517 .OR. IC1820.GT.MXORDA) GOTO 600
      IF(FIELD(3).GT.C0) NPVAL(IXGPCA)=NPVAL(IXGPCA)+1
      IF(FIELD(3).GT.C0) NPVAL0(IXGPCA)=NPVAL0(IXGPCA)+1
      GOTO 600
!*********************************************************************
! ** GCOFCT **                                             * GCOFCT **
!*********************************************************************
 5760 CONTINUE
      NTIMEC=NTIMEC+1
      ITPGRV=1
      GOTO 600
!*********************************************************************
! ** GCOEFS **                                             * GCOEFS **
!*********************************************************************
 5800 CONTINUE
      IF(IC1517.LT.1.OR.IC1517.GT.MXDEGG) GOTO 600
      IF(IC1820.GT.IC1517 .OR. IC1820.GT.MXORDG .OR. IC1820.EQ.0)       &
     &     GOTO 600
      IF(.NOT.LGLOBL) GO TO 5850
      IF(ITPGRV.EQ.1) GOTO 5810
! GLOBAL COEFFICIENTS
      IF(FIELD(3).GT.C0) NPVAL0(IXGPS)=NPVAL0(IXGPS)+1
      GO TO 600
 5810 CONTINUE
       NPVAL(IXTGPS)=NPVAL(IXTGPS)+1
       IF(FIELD(3).GT.C0) THEN
       NPVAL0(IXTGPS)=NPVAL0(IXTGPS)+1
       ENDIF
      GO TO 600
 5850 CONTINUE
! ARC COEFFICIENTS
      IF(FIELD(3).GT.C0) NPVAL(IXGPSA)=NPVAL(IXGPSA)+1
      IF(FIELD(3).GT.C0) NPVAL0(IXGPSA)=NPVAL0(IXGPSA)+1
      GOTO 600
!*********************************************************************
! ** GCOFST **                                             * GCOFST **
!*********************************************************************
 5855 CONTINUE
      NTIMES=NTIMES+1
      ITPGRV=1
      GOTO 600
!*********************************************************************
! ** GMSUN  **                                             * GMSUN  **
!*********************************************************************
 5860 CONTINUE
      NPVAL(IXGMSN)= 1
      IF (FIELD(2).GT.0.D0) NPVAL0(IXGMSN)= 1
      GOTO 600

!*********************************************************************
! ** GPSBXW **                                             * GPSBXW **
!*********************************************************************
 5865 CONTINUE
      NGPSID=NGPSID+1
      CALL GPSBLOCK(IC1824,ISVN,IPRN,IBLK)
      CALL FNDNUM(IC1824,ISATID,NSATID,IRET)
!DEP
      IF(IRET.GT.0) THEN
       IF(IRET.GT.100) THEN
       WRITE(6,*)' TERMINATION IN RD50A2 ,BOX-WING LOGICAL EXCEEDS 100'
       STOP
       ENDIF
      LGPBOXW(IRET)=.TRUE.
      ENDIF
!DEP
      INDEXX=IRET*1000+IFIELD(1)
      IGPSID(IRET)=IC1824
      IGPSBL(IRET)=IBLK
!     WRITE(6,*)' dbg IGPSID ',IGPSID(IRET),IGPSBL(IRET),IRET
      IGPSIND(NGPSID)=INDEXX
!     WRITE(6,*)' dbg IGPSIND ',IGPSIND(NGPSID)
      NPVAL(IXGPSBW)=IGPSBW
!     WRITE(6,*)' dbg NPVAL ',NPVAL(IXGPSBW)
      NPVAL0(IXGPSBW)=IGPSBW
!     WRITE(6,*)' dbg NPVAL0 ',NPVAL0(IXGPSBW)
      GOTO 600
!*********************************************************************
! ** GRIDS  **                                             * GRIDS  **
!*********************************************************************
 5890 CONTINUE
      READ(IUNT50,30000) CARDID,CARDH
      IF(CARDID.EQ.GLBOPT(NDXGRE)) GO TO 600
      NCTGRD=NCTGRD+1
      GOTO 5890
!*********************************************************************
! ** GRVTIM **                                             * GRVTIM **
!*********************************************************************
 5900 CONTINUE
      NPVAL(IXGPCT)=NCDT+NCPD*3
      NPVAL(IXGPST)=NSDT+NSPD*3
      NPVAL0(IXGPCT)=NCDTA+NCPDA*2
      NPVAL0(IXGPST)=NSDTA+NSPDA*2
      IC7=IFIELD(1)
      IC8=IFIELD(2)
      GOTO(5910,5920,5930,5940,5950), IC8
          GOTO 600
 5910 CONTINUE
      INDGRV=(IC7*10000000+IC8*1000000+IC1517*1000+IC1820)*10
      IGRV=IGRV+1
      IGTSRT(IGRV)=INDGRV
      IF(FIELD(2).LE.0) GOTO 600
         IGRVA=IGRVA+1
         IGTSRA(IGRVA)=INDGRV
      GOTO 600
 5920 CONTINUE
      IF(IC2122.EQ.0)IC2122=1
      DO 5925 I=1,3
      INDGRV=(IC7*10000000+(IC8-1+I)*1000000+IC1517*1000+IC1820)*10+    &
     &        IC2122
      IGRV=IGRV+1
      IGTSRT(IGRV)=INDGRV
 5925 END DO
      GOTO 600
 5930 CONTINUE
      IF(IC2122.EQ.0)IC2122=1
      DO 5935 I=1,2
      INDGRV=(IC7*10000000+(IC8-2+I)*1000000+IC1517*1000+IC1820)*10+    &
     &        IC2122
      CALL FNDNUM(INDGRV,IGTSRT,IGRV,IRET)
      IF (IRET .EQ. 0) THEN
          WRITE(6,83000)
          WRITE(6,83500) IC7,IC8,IC1517,IC1820,FIELD(2),FIELD(3)
          STOP 16
      ENDIF
      IGRVA=IGRVA+1
      IGTSRA(IGRVA)=INDGRV
 5935 END DO
      GOTO 600
 5940 CONTINUE
      DO 5945 I=1,4
      INDGRV=(IC7*10000000+(IC8-4+I)*1000000+IC1517*1000+IC1820)*10+    &
     &        IC2122
      IGRV=IGRV+1
      IGTSRT(IGRV)=INDGRV
 5945 END DO
      GOTO 600
 5950 CONTINUE
      DO 5955 I=1,3
      INDGRV=(IC7*10000000+(IC8-5+I)*1000000+IC1517*1000+IC1820)*10+    &
     &        IC2122
      IGRVA=IGRVA+1
      IGTSRA(IGRVA)=INDGRV
 5955 END DO
      GOTO 600
!*********************************************************************
! ** GTPEND**                                             * GTPEND **
!*********************************************************************
 5960 CONTINUE
      ITPGRV=0
      GOTO 600
!*********************************************************************
! ** HRATEF **                                             * HRATEF **
!*********************************************************************
 5970 CONTINUE
      ISHR=ISHR+1
      ISATH=INT(FIELD(1)+0.000005)
      CALL FNDNUM(ISATH,ISATHR,NSATHR,IRET)
      IF(IRET.EQ.0)  ISATHR(ISHR)=ISATH
      GOTO 600
!*********************************************************************
! ** IAU200**                                             * IAU200 **
!*********************************************************************
 5975 CONTINUE
      LNIAU=.TRUE.
      GOTO 600
!*********************************************************************
! ** INTCOM**                                             * INTCOM **
!*********************************************************************
 5980 CONTINUE
      IF(IC78.EQ.0)LINT(1)=.TRUE.
      IF(IC78.EQ.1)LINT(2)=.TRUE.
      IF(IC910.EQ.0) GOTO 60960
      LCASE(IC910)=.TRUE.
      ISTDRG=FIELD(1)
      IENDRG=FIELD(2)
      GOTO 600
!*********************************************************************
! ** NETCON**                                             * NETCON  **
!*********************************************************************
 5990 CONTINUE
      IF(IC78.EQ.11) THEN
      TRANET(1,1)=FIELD(1)
      TRANET(2,1)=FIELD(2)
      TRANET(3,1)=FIELD(3)
      ENDIF
      IF(IC78.EQ.12) THEN
      TRANET(1,2)=FIELD(1)
      TRANET(2,2)=FIELD(2)
      TRANET(3,2)=FIELD(3)
      ENDIF
      IF(IC78.EQ.21) THEN
      ROTNET(1,1)=FIELD(1)
      ROTNET(2,1)=FIELD(2)
      ROTNET(3,1)=FIELD(3)
      ENDIF
      IF(IC78.EQ.22) THEN
      ROTNET(1,2)=FIELD(1)
      ROTNET(2,2)=FIELD(2)
      ROTNET(3,2)=FIELD(3)
      ENDIF
      IF(IC78.EQ.31) THEN
      ROTQUA(1,1)=FIELD(1)
      ROTQUA(2,1)=FIELD(2)
      ROTQUA(3,1)=FIELD(3)
      ENDIF
      IF(IC78.EQ.32) THEN
      ROTQUA(1,2)=FIELD(1)
      ROTQUA(2,2)=FIELD(2)
      ROTQUA(3,2)=FIELD(3)
      ENDIF
      GOTO 600
!*********************************************************************
! ** POLKF **                                             * POLKF  **
!*********************************************************************
 6000 CONTINUE
      NPVAL(IXKF)=1
      IF(FIELD(2).NE.0.0D0) NPVAL0(IXKF)=1
      GOTO 600
!*********************************************************************
! ** GXPAND **                                             * GXPAND **
!*********************************************************************
 6100 CONTINUE
      IGC=NPVAL0(IXGPC)
      IGS=NPVAL0(IXGPS)
      CALL GRVEXP(IC1114,IC1517,IC1820,IC2124,DUM ,DUM ,IDUM,           &
     & IDUM,IDUM,DUM,DUM,DUM,0,IGC,IGS)
      NPVAL0(IXGPC)=IGC
      NPVAL0(IXGPS)=IGS
      GO TO 600
!*********************************************************************
! ** H2LOVE **                                             * H2LOVE **
!*********************************************************************
 6600 CONTINUE
      IF(FIELD(2).NE.C0) THEN
         NPVAL0(IXH2LV)=1
         NPVAL0(IXL2LV)=NSETDP-1
      ENDIF
      GOTO 600
!*********************************************************************
! ** IONCOR **                                             * IONCOR **
!*********************************************************************
 6700 CONTINUE
!  COMPUTE THE STARTING AND ENDING DATES IN THE FORM YYMM FOR
!  IONOSPHERIC COEFFICEINTS
!
! COMPUTE STARTING DATE
      IYMD=IRUNB
      IYYMM=IYMD/100
      IYY=IYMD/10000
      IMM=MOD(IYYMM,100)
      IDD=MOD(IYMD,100)
! IF THE DAY IS LESS THAN 15 INCLUDE COEFFICIENT DATA FOR PREVIOUS MONTH
! SET MONTH OF STARTING DATE TO PREVIOUS MONTH
      IF(IDD.LT.15) THEN
         IMM=IMM-1
         IF(IMM.EQ.0) THEN
         IMM=12
         IYY=IYY-1
         ENDIF
      ENDIF
      IONYMS=IYY*100+IMM
! COMPUTE ENDING DATE
      IYMD=IRUNE
      IYYMM=IYMD/100
      IYY=IYMD/10000
      IMM=MOD(IYYMM,100)
      IDD=MOD(IYMD,100)
! IF THE DAY IS GREATER THAN OR EQUAL 15 INCLUDE COEFFICIENT DATA FOR
! NEXT MONTH. SET MONTH OF ENDING DATE TO NEXT MONTH
      IF(IDD.GE.15) THEN
         IMM=IMM+1
         IF(IMM.GT.12) THEN
         IMM=1
         IYY=IYY+1
         ENDIF
      ENDIF
      IONYME=IYY*100+IMM
! COMPUTE NUMBER OF MONTHS TO BE SPANNED BY IONOSPHERIC COEFFICIENTS
      NUMYRS=IONYME/100-IONYMS/100
      NMNTHS=12*NUMYRS - MOD(IONYMS,100) + MOD(IONYME,100) + 1
! COMPUTE ACTUAL NUMBER OF MONTHS OF IONOSPHERIC COEFFICIENT DATA
! TO BE STORED IN DYNAMIC ARRAYS WHERE COEFFICIENT DATA FOR THE SAME
! MONTH IN DIFFERENT YEARS IS IDENTICAL
      NMDATA=NMNTHS
      IF(NMNTHS.GT.12) NMDATA=12
! COMPUTE NUMBER OF COEFFICIENTS TO BE STORED IN DYNAMIC ARRAYS
      NFM3CF=441*2*NMDATA
      NF2CF=988*2*NMDATA
! SET IURSI TO 1 TO SELECT URSI F2 COEFFICIENTS OR 0
! TO SELECT CCIR F2 COEFFICIENTS.
      IURSI=IC78/10
! SET INTERP TO TYPE OF INTERPOLATION SELECTED
! 1 INDICATES LOGARITHMIC INTERPOLATION
! 0 INDICATES LINEAR INTERPOLATION
      INTERP=MOD(IC78,10)
! SAVE STEPSIZE OF INTEGRATION FOR PROFILES.
      STEPSZ=FIELD(1)
      GOTO 600
!*********************************************************************
! ** L2LOVE **                                             * L2LOVE **
!*********************************************************************
 6800 CONTINUE
      IF(FIELD(2).NE.C0) THEN
         NPVAL0(IXH2LV)=1
         NPVAL0(IXL2LV)=NSETDP-1
      ENDIF
      GOTO 600
!*********************************************************************
! ** LINK  **                                              * LINK   **
!*********************************************************************
 6810 CONTINUE
      ICLINK=ICLINK+1
      GOTO 600
!*********************************************************************
! ** LNSTHR **                                             * LNSTHR **
!*********************************************************************
 6850 CONTINUE
      IF(IFIELD(1).EQ.1) THEN
      NPVAL(IXLNTM)=NPVAL(IXLNTM)+1
      IF(FIELD(2).NE.0) NPVAL0(IXLNTM)=NPVAL0(IXLNTM)+1
      ELSEIF(IFIELD(1).EQ.2) THEN
      NPVAL(IXLNTA)=NPVAL(IXLNTA)+1
      IF(FIELD(2).NE.0) NPVAL0(IXLNTA)=NPVAL0(IXLNTA)+1
      ELSE
      WRITE(6,*)' EXECUTION TERMINATED AT RD50A2 , THE LNSTHR OPTION '
      WRITE(6,*)' NEEDS PARAMETER SPECIFICATION ON COLUMN 7          '
      ENDIF
      GOTO 600
!*********************************************************************
! ** LOCALG **                                             * LOCALG **
!*********************************************************************
 6900 CONTINUE
      ICUTLG=IC1517
      NPVAL (IXLOCG)=NPVAL (IXLOCG)+1
      IF(FIELD(4) .GT.0.D0) THEN
      NPVAL0(IXLOCG)=NPVAL0(IXLOCG)+1
      ENDIF
      READ(IUNT50,71100) CRD2
      IF(CRD2.NE.BLNK) GOTO 60600
      GOTO 600
!*********************************************************************
! ** LRARC **                                             * LRARC **
!*********************************************************************
 6950 CONTINUE
      IF(IC2324.EQ.1) NSARAL=1
      IF(IC2324.EQ.1) GO TO 599
!     GOTO 599
!  Note:  This option is currently set up to handle just one satellite.
      NLRARC = 1
      NLRAIN = IC78
      NLRAD1 = IC910
      NLRAD2 = IC1112
      NLRAST = IC1314
      NLRAPT = NLRAIN*NLRAD1*NLRAD2*NLRAST
599   CONTINUE
      GOTO 600
!*********************************************************************
!** MBIAS **                                               * MBIAS ***
!*********************************************************************
 7000 JX=1
      DO 7005 I=1,2
 7005 IF(CDNAME.EQ.BIAS(I)) JX=JX+I
      IF(JX.GT.1) GOTO 7050
      IF(     LGLOBL) NPVAL (IXBISG)=NPVAL (IXBISG)+1
      IF(     LGLOBL) NPVAL0(IXBISG)=NPVAL0(IXBISG)+1
      IF(.NOT.LGLOBL) GOTO 7020
!
      IF(FIELD(2).EQ.C0.OR.FIELD(3).EQ.C0.OR.FIELD(4).EQ.C0)            &
     &     GOTO 7010
      NBIASG=NBIASG+1
      NXBIAM=MBIASK+NBIASG
      GOTO 7050
 7010 CONTINUE
! CARD IGNORED IF A GLOBAL MBIAS CARD IS MISSING TIME OR SIGMAS
      WRITE(IUNT06,80702)
      WRITE(IUNT06,80701) CDNAME,IC78,IC910,IC1112,IC1314,              &
     &   IC1517,FA3,IC2122,IC2324,FIELD
      GOTO 600
! ARC MBIAS CARD
7020  CONTINUE
      IF(IC1517.EQ.801) GO TO 7021
      IF(FIELD(2).EQ.C0.OR.FIELD(3).EQ.C0) GOTO 7040
7021  CONTINUE
      IF(FIELD(4).EQ.C0) GOTO 7030
      IF(IC1517.NE.801) NBIASA=NBIASA+1
      IF(IC1517.NE.801) NBCDT =NBCDT+1
      NXBIAM=MBIASK+MBIASG+NBCDT
      GO TO 7050
! NO  SIGMAS
 7030 CONTINUE
      IF(IC1517.NE.801) NBIASK=NBIASK+1
      IF(IC1517.NE.801) NBIASA=NBIASA+1
      NXBIAM=NBIASK
      GO TO 7050
! NO TIMES ON MBIAS CARD IGNORE
 7040 CONTINUE
      WRITE(IUNT06,80703)
      WRITE(IUNT06,80701) CDNAME,IC78,IC910,IC1112,IC1314,              &
     &   IC1517,FA3,IC2122,IC2324,FIELD
      GO TO 600
!
 7050 NDX=NXBIAM
! SKIP FOR BIAS 801
!
      IF(IC1517.EQ.801) GOTO 7051

!     ....check validity of start and stop times
!
      IF( FIELD(2) .GT. C0 ) CALL CHKTM1( FIELD(2), 'MBIAS   ' )
      IF( FIELD(3) .GT. C0 ) CALL CHKTM1( FIELD(3), 'MBIAS   ' )
!
      NBISTA(JX,NDX)=IC714
      NBISAT(JX,NDX)=IC1824
      IF(JX.GT.1) GO TO 600
      IF(IC1517.EQ.0) THEN
       READ(IUNT50,71150,END=60000) CDNAME,IC710
       IF(CDNAME.NE.OPTION(78)) THEN
       GO TO 60987
       ELSE
       NBITYP(NDX)=IC710
       ENDIF
      GO TO 7051
      ENDIF
      NBITYP (NDX   )=IC1517
! NEW SPLINE TYPE BIASES
      IF(IC1517.EQ.304.OR.IC1517.EQ.501.OR.IC1517.EQ.502.OR.&
     &IC1517.EQ.503) THEN
      NBISAT(JX,NDX)=0
      INODE=IC1820
      IPARA=IC2124/10
      IDEGR=IC2124-IPARA*10
      NBIDEG(JX,NDX)=IDEGR
      NBINOD(JX,NDX)=INODE
      NBNPRM(JX,NDX)=IPARA
      ENDIF
!
      IF(NBITYP(NDX).EQ.999)NBISAT(JX,NDX)=ISATID(NSATID)
!
 7051 CONTINUE
! STORE BASELINE STATIONS
      IF(IC1517.EQ.800) THEN
      ISTBSL(1,NDX)=IC714
      IPREV=NDX
      ENDIF
      IF(IC1517.EQ.801) ISTBSL(2,IPREV)=IC714
!     if(ic1517.eq.800) write(6,*)' dbg ISTBSL 800 ',ISTBSL(1,NDX),NDX
!     if(ic1517.eq.801) write(6,*)' dbg  801 ',ISTBSL(2,IPREV),IPREV
      IF(IC1517.EQ.801) GOTO 600
      IAD1=0
      TEMP=MOD(FIELD(2),1.D0)
      IF(TEMP.GE.0.5D0) IAD1=1
      CALL RIYMDH(FIELD(2),IJXYMD,IJXHMS)
      CALL YMDTIS(IJXYMD,IJXHMS,MJDSEC)
      NBTIM1 (NDX   )=MJDSEC +IAD1
      IAD1=0
      TEMP=MOD(FIELD(3),1.D0)
      IF(TEMP.GE.0.5D0) IAD1=1
      CALL RIYMDH(FIELD(3),IJXYMD,IJXHMS)
      CALL YMDTIS(IJXYMD,IJXHMS,MJDSEC)
      NBTIM2 (NDX   )=MJDSEC
      BIBIAS(NDX   )=FIELD(1)
      BISIGM(NDX   )=FIELD(4)
      GOTO 600
!*********************************************************************
! ** MBIASM **                                            * MBIASM ***
!*********************************************************************
 7052 CONTINUE
      ITYP=IC78*100+IC910
      IF(ITYP.GT.0) THEN
      NBITYP(NDX)=ITYP
      ENDIF
      ITYP=IC1517
      IF(ITYP.GT.0) THEN
      NBATYP(NDX)=ITYP
      ENDIF
      GO TO 600
!*********************************************************************
! ** MLTARC **                                            * MLTARC ****
!*********************************************************************
 7055 CONTINUE
      LAUNIT=IFIELD(1).GT.0
      LREWND=IFIELD(2).GT.0
      GOTO 600
!*********************************************************************
! ** NORMPT **                                            * NORMPT ****
!*********************************************************************
 7060 CONTINUE
      LNPT17=IC1517.GT.0
      IF(LNPT17) NH1VOC=IC1517
      IF(IC1820.GT.10.AND.IC1820.LT.101) MAXBUF=IC1820+1
      GOTO 600
!*********************************************************************
! ** NUTATE **                                            * NUTATE ***
!*********************************************************************
 7065 CONTINUE
      IF (IFIELD(1).GT.0) THEN

         INUTA=INUTA+1

! CONVERT TIME TO MJDSEC
         TIME=FIELD(1)
         IYMMDD=TIME
         FFF   =TIME-IYMMDD
         FFF   =C24D0*FFF
         IH    =FFF
         FFF   =FFF-IH
         FFF   =C60D0*FFF
         IM    =FFF
         FFF   =FFF-IM
         FFF   =FFF*C60D0
         IS    =FFF
         SEC   =FFF
         FFF   =FFF-IS
         IHMS  =10000*IH+100*IM+IS
         IHM   =100*IH + IM
         CALL CHKTM2(IYMMDD,IHM,SEC,'NUTATE  ')
         IF(LBDTM) CALL WBDTM
         CALL YMDTIS(IYMMDD,IHMS,ISEC)
         TIME  =ISEC+FFF

! SAVE TIME OF MIDPOINT OF INTERVAL
         DNUTMD(INUTA) = TIME
!         write(6,*) "RD50A2: DNUTMD(INUTA) ,", DNUTMD(INUTA)

! READ SECOND CARD OF THE NUTATE SET AND CREATE FIELD VALUES
         READ(IUNT50,71000,END=60000) CDNAME,IC78,IC910,IC1112,   &
     &     IC1314,IC1517,FA3,IC2122,IC2324,FIELD
         CALL A3TOI6(FA3,I6,IC1820)
         CALL MAKFLD

         IF(CDNAME.NE.BLNK) GOTO 60701

! SAVE DURATION OF NUTATION INTERVAL(IN SECONDS)
! IF INTERVAL IS ENTERED IN DAYS IC2324=0 OTHERWISE INTERVAL IS IN HOURS
!      write(6,*) "RD50A2: DNUTMD(INUTA) ,", DNUTMD(INUTA)

         IF(IC2324.EQ.0) THEN
           DNUTIN(INUTA)=FIELD(1)*SECDAY
         ELSE
           DNUTIN(INUTA)=FIELD(1)*SECHR
         ENDIF

         write(6,*) "RD50A2: DNUTIN(INUTA) , ", DNUTIN(INUTA), INUTA
         write(6,*) "RD50A2: DNUTMD(INUTA) ,", DNUTMD(INUTA), INUTA

!IF IFIELD(1) is 2 corrections are applied so set LSPNUT=.TRUE. as well
! as parameter adjustments

         IF (IFIELD(1) .EQ. 2) LSPNUT=.TRUE.

!SET NPVAL AND NPVAL0

         NPVAL(IXDPSI) = NNUT
         NPVAL(IXEPST) = NNUT
         NPVAL0(IXDPSI) = NNUTAA
         NPVAL0(IXEPST) = NNUTAA

         write(6,*) "RD50A2: NPVAL NPVAL0:", NPVAL(IXDPSI),        &
     &      NPVAL0(IXDPSI),NPVAL(IXEPST),NPVAL0(IXEPST)

      ELSE

         LSPNUT=.TRUE.
         GOTO 600

      ENDIF
      GOTO 600
!*********************************************************************
! ** OLOAD  **                                            * OLOAD  ****
!*********************************************************************
 7070 CONTINUE
      NTOLMD=NTOLMD+1
      LAJOL(NTOLMD)=.FALSE.
      IDIR=3
      IF(IFIELD(2).GT.0.AND.IFIELD(2).LT.4) IDIR=IFIELD(2)
      ISIT=IC1114
      IFRQ=IC1824*10
      XNUMOL(NTOLMD)=DBLE(IDIR)*C1D11+DBLE(ISIT)*C1D7+DBLE(IFRQ)
      IF(FIELD(3).GT.C0.OR.FIELD(4).GT.C0) LAJOL(NTOLMD)=.TRUE.
      GOTO 600
!*********************************************************************
! ** OPVLBI**                                            * OPVLBI ****
!*********************************************************************
7071  CONTINUE
      JJ=0
      DO IJ=1,NVOPT
      READ(IUNT50,84000)CDNAME,INDV,VSTRING
      JJ=JJ+1
      VLB_STR(JJ)=VSTRING
!     write(6,*)'dbg  DEBUGGING STRINGS'
!     write(6,31313) VLB_STR(JJ)
!31313 format(4x,a64)
      ENDDO
      GOTO 600
!*********************************************************************
! ** ORBFIL **                                            * ORBFIL ****
!*********************************************************************
 7100 CONTINUE
      NTRAJC=NTRAJC+1
      GOTO 600
!
!*********************************************************************
!** OFFSET **                                             * OFFSET ***
!*********************************************************************
 7250 CONTINUE
! SKIP OVER ALL CARDS EXCEPT OFFSET AND OFFSET1
      IF(IFIELD(1).GT.1) GOTO 600
      NOFFST=NOFFST+1
      WRITE(47,71001) CARDH
      IF(LIONC) THEN
      IF(FIELD(1).EQ.ZERO)THEN
       LFRQOF=.FALSE.
         WRITE(6,83730)NOFFST
      ENDIF
      ENDIF
      GOTO 600
!*********************************************************************
!** OTCOEF                                               ** OTCOEF ***
!*********************************************************************
 7350 CONTINUE
      NPVAL(IXOTPS)=NPVAL(IXOTPS)+1
      NPVAL(IXOTPC)=NPVAL(IXOTPC)+1
      NOTPRF=NOTPRF+1
      IF(FIELD(3).NE.0.OR.FIELD(4).NE.0) THEN
      NPVAL0(IXOTPS)=NPVAL0(IXOTPS)+1
      NPVAL0(IXOTPC)=NPVAL0(IXOTPC)+1
      ENDIF
      DO 7360 J=1,15
      IF(IC78.EQ.INDC(J)) THEN
      NUMCON(J)=NUMCON(J)+1
      IF(FIELD(3).NE.0.OR.FIELD(4).NE.0) THEN
      NESCON(J)=NESCON(J)+1
      ENDIF
      ENDIF
 7360 END DO
      GOTO 600
!*********************************************************************
!** OTMOD                                                ** OTMOD  ***
!*********************************************************************
 7400 CONTINUE
      IF(IC78.EQ.1)THEN
      LPRDES=.TRUE.
      ENDIF
      LOTMOD=.TRUE.
      GOTO 600
!*********************************************************************
!** OTIDES ** OTIDEN                              OTIDEN ** OTIDES ***
!*********************************************************************
 7300 CONTINUE
      NTIDE=NTIDE+1
      NOT=NOT+1
      NPVAL(IXOTDE)=NPVAL(IXOTDE)+2
      IDN(NTIDE)=IC1824
      IF(FIELD(3).NE.C0.OR.FIELD(4).NE.C0) GO TO 7310
      NOTUN=NOTUN+1
!      write(6,*) 'rd50a2: not, ntide, notun, npval(IXOTDE) ',
!     &                    not, ntide, notun, npval(IXOTDE)
      GO TO 600
 7310 CONTINUE
      NOTADJ=NOTADJ+1
      NPVAL0(IXOTDE)=NPVAL0(IXOTDE)+2
      GOTO 600
!*********************************************************************
!** PANEL  **                                             * PANEL  ***
!*********************************************************************
 7450 CONTINUE
! FIND LOCATION IN SATELLITE ARRAY OF THIS SATELLITE
      CALL FNDNUM(IC1824,ISATID,NSATID,ISAT)
      IF(ISAT.EQ.0) GO TO 60650

      IC9=(IC910/10)+0.9D0
      IC10=IC910-IC9

! CHECK FOR DUPLICATE PANEL NUMBER CARDS
      INDEXX=ISAT*1000+IC1112*10+IC910/10
      GO TO (7451,7452,7453,7454,7455,7456,7457,7458,7459,7460),IC1314
 7451 CALL FNDNUM(INDEXX,IFACE,NMSLAB,IRET)
      IF(IRET.EQ.0) THEN
!     THE CARD IS UNIQUE, INCREMENT PARAMETER ARRAY
!     INCREMENT NPVAL BASED UPON PARAMETER TYPE
         NMSLAB=NMSLAB+1
         IFACE(NMSLAB)=INDEXX
         NPVAL(IXAREA)=NPVAL(IXAREA)+1
         NPVAL(IXSPRF)=NPVAL(IXSPRF)+1
         NPVAL(IXDFRF)=NPVAL(IXDFRF)+1
         NPVAL(IXEMIS)=NPVAL(IXEMIS)+1
         NPVAL(IXTMPA)=NPVAL(IXTMPA)+1
         NPVAL(IXTMPC)=NPVAL(IXTMPC)+1
         NPVAL(IXTIMD)=NPVAL(IXTIMD)+1
         NPVAL(IXTIMF)=NPVAL(IXTIMF)+1
         NPVAL(IXTHTX)=NPVAL(IXTHTX)+1
         NPANEL(ISAT)=NPANEL(ISAT)+1
! COMPUTE NUMBER OF MOVEABLE PANELS FOR EACH SATELLITE
         IF(IC910.NE.0) NMOVE(ISAT)=NMOVE(ISAT)+1
         GO TO 600
      ELSE
!     DUPLICATE CARD FOUND
         WRITE(6,88000) CDNAME,IC910,IC1112,IC1314,IC1824,FIELD(1),     &
     &                  FIELD(2), FIELD(3)
         STOP
      ENDIF
 7452 CALL FNDNUM(INDEXX,IPAREA,NAREPT,IRETA)
!     IF ZERO, PARAMETER TYPE CARD IS UNIQUE
      IF (IRETA .EQ. 0) THEN
!        IF SIGMA .NE. ZERO INCREMENT NPVAL0 ARRAY
         IF(FIELD(2).NE.C0)THEN
            NAREPT=NAREPT+1
            NPVAL0(IXAREA)=NPVAL0(IXAREA)+1
            NARADJ(ISAT)=NARADJ(ISAT)+1
            IPAREA(NAREPT)=INDEXX
         ENDIF
      ELSE
!     DUPLICATE PARAMETER TYPE CARD
         WRITE(6,88000) CDNAME,IC910,IC1112,IC1314,IC1824,FIELD(1),     &
     &                  FIELD(2), FIELD(3)
         STOP
      ENDIF
      GO TO 600
 7453 CALL FNDNUM(INDEXX,IPSPRF,NSPRPT,IRETA)
!     IF ZERO, PARAMETER TYPE CARD IS UNIQUE
      IF (IRETA .EQ. 0) THEN
         IF(FIELD(2).NE.C0) THEN
            NSPRPT=NSPRPT+1
            NPVAL0(IXSPRF)=NPVAL0(IXSPRF)+1
            NSPADJ(ISAT)=NSPADJ(ISAT)+1
            IPSPRF(NSPRPT)=INDEXX
         ENDIF
      ELSE
!     DUPLICATE PARAMETER TYPE CARD
         WRITE(6,88000) CDNAME,IC910,IC1112,IC1314,IC1824,FIELD(1),     &
     &                  FIELD(2), FIELD(3)
         STOP
      ENDIF
      GO TO 600
 7454 CALL FNDNUM(INDEXX,IPDFRF,NDFRPT,IRETA)
!     IF ZERO, PARAMETER TYPE CARD IS UNIQUE
      IF (IRETA .EQ. 0) THEN
         IF(FIELD(2).NE.C0) THEN
            NDFRPT=NDFRPT+1
            NPVAL0(IXDFRF)=NPVAL0(IXDFRF)+1
            NDFADJ(ISAT)=NDFADJ(ISAT)+1
            IPDFRF(NDFRPT)=INDEXX
         ENDIF
      ELSE
!     DUPLICATE PARAMETER TYPE CARD
         WRITE(6,88000) CDNAME,IC910,IC1112,IC1314,IC1824,FIELD(1),     &
     &                  FIELD(2), FIELD(3)
         STOP
      ENDIF
      GO TO 600
 7455 CALL FNDNUM(INDEXX,IPEMIS,NEMIPT,IRETA)
!     IF ZERO, PARAMETER TYPE CARD IS UNIQUE
      IF (IRETA .EQ. 0) THEN
         IF(FIELD(2).NE.C0) THEN
            NEMIPT=NEMIPT+1
            NPVAL0(IXEMIS)=NPVAL0(IXEMIS)+1
            NEMADJ(ISAT)=NEMADJ(ISAT)+1
            IPEMIS(NEMIPT)=INDEXX
         ENDIF
      ELSE
!     DUPLICATE PARAMETER TYPE CARD
         WRITE(6,88000) CDNAME,IC910,IC1112,IC1314,IC1824,FIELD(1),     &
     &                  FIELD(2), FIELD(3)
         STOP
      ENDIF
      GO TO 600
 7456 CALL FNDNUM(INDEXX,IPTMPA,NTMAPT,IRETA)
!     IF ZERO, PARAMETER TYPE CARD IS UNIQUE
      IF (IRETA .EQ. 0) THEN
         IF(FIELD(2).NE.C0) THEN
            NTMAPT=NTMAPT+1
            NPVAL0(IXTMPA)=NPVAL0(IXTMPA)+1
            NTAADJ(ISAT)=NTAADJ(ISAT)+1
            IPTMPA(NTMAPT)=INDEXX
         ENDIF
      ELSE
!     DUPLICATE PARAMETER TYPE CARD
         WRITE(6,88000) CDNAME,IC910,IC1112,IC1314,IC1824,FIELD(1),     &
     &                  FIELD(2), FIELD(3)
         STOP
      ENDIF
      GO TO 600
 7457 CALL FNDNUM(INDEXX,IPTMPC,NTMCPT,IRETA)
!     IF ZERO, PARAMETER TYPE CARD IS UNIQUE
      IF (IRETA .EQ. 0) THEN
         IF(FIELD(2).NE.C0) THEN
            NTMCPT=NTMCPT+1
            NPVAL0(IXTMPC)=NPVAL0(IXTMPC)+1
            NTCADJ(ISAT)=NTCADJ(ISAT)+1
            IPTMPC(NTMCPT)=INDEXX
         ENDIF
      ELSE
!     DUPLICATE PARAMETER TYPE CARD
         WRITE(6,88000) CDNAME,IC910,IC1112,IC1314,IC1824,FIELD(1),     &
     &                  FIELD(2), FIELD(3)
         STOP
      ENDIF
      GO TO 600
 7458 CALL FNDNUM(INDEXX,IPTIMD,NTMDPT,IRETA)
!     IF ZERO, PARAMETER TYPE CARD IS UNIQUE
      IF (IRETA .EQ. 0) THEN
         IF(FIELD(2).NE.C0) THEN
            NTMDPT=NTMDPT+1
            NPVAL0(IXTIMD)=NPVAL0(IXTIMD)+1
            NTDADJ(ISAT)=NTDADJ(ISAT)+1
            IPTIMD(NTMDPT)=INDEXX
         ENDIF
      ELSE
!     DUPLICATE PARAMETER TYPE CARD
         WRITE(6,88000) CDNAME,IC910,IC1112,IC1314,IC1824,FIELD(1),     &
     &                  FIELD(2), FIELD(3)
         STOP
      ENDIF
      GO TO 600
 7459 CALL FNDNUM(INDEXX,IPTIMF,NTMFPT,IRETA)
!     IF ZERO, PARAMETER TYPE CARD IS UNIQUE
      IF (IRETA .EQ. 0) THEN
         IF(FIELD(2).NE.C0) THEN
            NTMFPT=NTMFPT+1
            NPVAL0(IXTIMF)=NPVAL0(IXTIMF)+1
            NTFADJ(ISAT)=NTFADJ(ISAT)+1
            IPTIMF(NTMFPT)=INDEXX
         ENDIF
      ELSE
!     DUPLICATE PARAMETER TYPE CARD
         WRITE(6,88000) CDNAME,IC910,IC1112,IC1314,IC1824,FIELD(1),     &
     &                  FIELD(2), FIELD(3)
         STOP
      ENDIF
      GO TO 600
 7460 CALL FNDNUM(INDEXX,IPTHTX,NTHXPT,IRETA)
!     IF ZERO, PARAMETER TYPE CARD IS UNIQUE
      IF (IRETA .EQ. 0) THEN
         IF(FIELD(2).NE.C0) THEN
            NTHXPT=NTHXPT+1
            NPVAL0(IXTHTX)=NPVAL0(IXTHTX)+1
            NTXADJ(ISAT)=NTXADJ(ISAT)+1
            IPTHTX(NTHXPT)=INDEXX
         ENDIF
      ELSE
!     DUPLICATE PARAMETER TYPE CARD
         WRITE(6,88000) CDNAME,IC910,IC1112,IC1314,IC1824,FIELD(1),     &
     &                  FIELD(2), FIELD(3)
         STOP
      ENDIF
      GO TO 600
!
!*********************************************************************
!** PLATE  **                                             * PLATE  ***
!*********************************************************************
 7500 CONTINUE
      IF(IC78.EQ.-1)     NDEFOP=2
      IF(IC78.EQ.-3)     NDEFOP=3
      IF(IC78.EQ.-2)     NPLATE= MAX(NPLATE,NUVPLT+1)
      IF(IC78.LE.NUMPLT) NPLATE= MAX(NPLATE,NUMPLT+1)
      IF(IC78.GT.NUMPLT) NPLATE= MAX(NPLATE+1,NUMPLT+1)
      GO TO 600
!*********************************************************************
!** PLATIM **                                             * PLATIM ***
!*********************************************************************
 7550 CONTINUE
      DO 7560 I=1,4
      IF(FIELD(I) .GT. C0) NPLTMS=NPLTMS+1
 7560 END DO
      GO TO 600
!*********************************************************************
!** PLNGLF **                                             * PLNGLF ***
!*********************************************************************
 7570 CONTINUE
      NPLN=NPLN+1
      NPVAL(IXPLNF)=NFTOT
      NPVAL0(IXPLNF)=NFTOT
      IF(NPLN.GT.NFTOT) THEN
      WRITE(6,*)' END IN RD50A2/ PROBLEM WITH PLNGLF '
      STOP
      ENDIF
      GO TO 600
!*********************************************************************
!** PLNSRF **                                             * PLNSRF ***
!*********************************************************************
 7580 CONTINUE
      GO TO 600
!*********************************************************************
! ** POLE   **                                             * POLE   **
!*********************************************************************
 7600 CONTINUE
      IYMD=FIELD(1)
      IF(IYMD.LE.491231)IYMD=IYMD+1000000
      IYMDH=FIELD(1)*100
      IF(IYMDH.LT.50010100)IYMDH=IYMDH+100000000
      IHOUR=IYMDH-IYMD*100
      IHM=IHOUR*100
      CALL CHKTM2(IYMD,IHM,0.D0,'POLE    ')
      IF(IHOUR.GT.24) GOTO 60970
      IBIHH=(IBIH*100)+IBIHHR
      JBIHH=(JBIH*100)+JBIHHR
      IF(IYMDH.GE.IBIHH.AND.IYMDH.LE.JBIHH) GOTO 7610
      GOTO 600
 7610 CONTINUE
      CALL DIFF(IBIH,0,IYMD,0,NDAYS,NSEC)
      IHOURS=(NDAYS*24) + (IHOUR - IBIHHR)
      IND=IHOURS/IBHINT
      IF(IFIELD(1).EQ.0) IFIELD(1)=7
      IF(MOD(IFIELD(1),2).GT.0)     AA1(KXP   +IND)=FIELD(2)
      IF((MOD(IFIELD(1),4)/2).GT.0) AA1(KYP   +IND)=FIELD(3)
      IF((IFIELD(1)/4).GT.0)        AA1(KA1UT1+IND)=FIELD(4)
      GO TO 600
!*********************************************************************
!** POLEUT **                                             * POLEUT ***
!*********************************************************************
 7700 IPOLE=IPOLE+1
! CONVERT TIME TO MJDSEC
      TIME=FIELD(1)
      IYMMDD=TIME
      FFF   =TIME-IYMMDD
      FFF   =C24D0*FFF
      IH    =FFF
      FFF   =FFF-IH
      FFF   =C60D0*FFF
      IM    =FFF
      FFF   =FFF-IM
      FFF   =FFF*C60D0
      IS    =FFF
      SEC   =FFF
      FFF   =FFF-IS
      IHMS  =10000*IH+100*IM+IS
      IHM   =100*IH + IM
      CALL CHKTM2(IYMMDD,IHM,SEC,'POLEUT  ')
      IF(LBDTM) CALL WBDTM
      CALL YMDTIS(IYMMDD,IHMS,ISEC)
      DELT=TDIF(4,3,IYMMDD,IHMS,AA1(KA1UTC))+ETA1
      TIME  =ISEC+FFF+DELT
! SAVE TIME OF MID POINT OF INTERVAL
      DPSR(IPOLE)=TIME
! SET INDPI=1 IF THIS INTERVAL IS ADJUSTED - INDPI IS CHANGED IN POLORD
      IF(IFIELD(1).GT.0) INDPI(IPOLE)=1
! NPVAL AND NPVAL0 OF IXPOLX,IXPOLY AND IXUT1 ARE SET IN POLORD AFTER
! THE TOTAL NUMBER OF POLE INTERVALS(INCLUDING GENERATED INTERVALS)
! IS CALCULATED
      READ(IUNT50,71000,END=60000) CDNAME,IC78,IC910,IC1112,IC1314,     &
     &   IC1517,FA3,IC2122,IC2324,FIELD
      CALL A3TOI6(FA3,I6,IC1820)
      CALL MAKFLD
      IF(CDNAME.NE.BLNK) GOTO 60700
! SAVE DURATION OF POLE INTERVAL(IN SECONDS)
! IF INTERVAL IS ENTERED IN DAYS IC2324=0 OTHERWISE INTERVAL IS IN HOURS
      IF(IC2324.EQ.0) THEN
      POLINT(IPOLE)=FIELD(1)*SECDAY
      ELSE
      POLINT(IPOLE)=FIELD(1)*SECHR
      ENDIF
      IF(IFIELD(1) .NE.2 .AND. IFIELD(1) .NE.3) GOTO 7710
      READ(IUNT50,71100) CRD2
      IF(CRD2.NE.BLNK) GOTO 60700
! READ SIGMAS FOR EOP RATES
 7710 CONTINUE
      IF(IFIELD(1) .NE.4) GOTO 600
      READ(IUNT50,71100) CRD2
      IF(CRD2.NE.BLNK) GOTO 60700
      GOTO 600
!*********************************************************************
!** PBIAS **                                               * PBIAS ***
!*********************************************************************
 8000 JX=1
      DO 8005 I=1,2
 8005 IF(CDNAME.EQ.PBIAS(I)) JX=JX+I
      IF(JX.GT.1) GOTO 8060
      NBCDP=NBCDP+1
      NXBIAP=MBIASK+MBIASG+MBCDT+NBCDP
!
 8060 NDX=NXBIAP
!
!     ....check validity of start and stop times
!
      IF( FIELD(2) .GT. C0 ) CALL CHKTM1( FIELD(2), 'PBIAS   ' )
      IF( FIELD(3) .GT. C0 ) CALL CHKTM1( FIELD(3), 'PBIAS   ' )
!
      NBISTA(JX,NDX)=IC714
      NBISAT(JX,NDX)=IC1824
      IF(JX .GT. 1) GO TO 600
      IF(IC1517.EQ.0) THEN
       READ(IUNT50,71150,END=60000) CDNAME,IC710
       IF(CDNAME.NE.OPTION(79)) THEN
       GO TO 60987
       ELSE
       NBITYP(NDX)=IC710
       ENDIF
      GO TO 8061
      ENDIF
      NBITYP (NDX   )=IC1517
 8061 CONTINUE
      CALL RIYMDH(FIELD(2),IJXYMD,IJXHMS)
! IF NO TIME IS ENTERED ON CARD (ASKING FOR PASS-BY-PASS BIASES FOR
!  ENTIRE ARC), THEN SET TIMES AS BEGINNING OF ARC-1DAY
      IF(FIELD(2).EQ.C0) THEN
         MJDSEC=IARCT1-86400
      ELSE
         CALL YMDTIS(IJXYMD,IJXHMS,MJDSEC)
      ENDIF
      NBTIM1 (NDX   )=MJDSEC
!
! IF NO TIME IS ENTERED ON CARD (ASKING FOR PASS-BY-PASS BIASES FOR
!  ENTIRE ARC), THEN SET TIMES AS STOP OF ARC+1DAY
      CALL RIYMDH(FIELD(3),IJXYMD,IJXHMS)
!     IF(IJXYMD.LT.250101) IJXYMD=991230
      IF(FIELD(3).EQ.C0) THEN
         MJDSEC=IARCT2+86400
      ELSE
         CALL YMDTIS(IJXYMD,IJXHMS,MJDSEC)
      ENDIF
      NBTIM2 (NDX   )=MJDSEC
      BIBIAS(NDX   )=FIELD(1)
      BISIGM(NDX   )=FIELD(4)
      GOTO 600
!*********************************************************************
! PBIASM **                                                * PBIASM **
!*********************************************************************
 8070 CONTINUE
      NBITYP(NDX)=IC78*100+IC910
      GO TO 600
!*********************************************************************
! PLANET **                                                * PLANET **
!*********************************************************************
 8500 CONTINUE
      IF(IC2122.GT.0)IMRNUT=IC2122
! IFIELD(17) IS FOR PLANETARY CONTANT OPTION:
!        VENUS: 0-1989, 1-1991, 2-2000
!        MARS : 4=2001
!        Mercury: 6=2011, 7=2000
      IF(IFIELD(17) .EQ.1.AND.IC1114.EQ.200) CVENUS=1.D0
      IF(IFIELD(17) .EQ.2.AND.IC1114.EQ.200) CVENUS=2.D0
      IF(IFIELD(17) .EQ.4.AND.IC1114.EQ.400) CMARS =1.D0
      IF(IFIELD(17) .EQ.5.AND.IC1114.EQ.400) CMARS =2.D0
      IF(IFIELD(17) .EQ.7.AND.IC1114.EQ.100) CMERC =1.D0
      IF(IFIELD(17) .EQ.6.AND.IC1114.EQ.100) CMERC =2.D0
! If orbiting Mercury and option not set, default is 2011
      IF(IFIELD(17) .EQ.0.AND.IC1114.EQ.100) CMERC =2.D0
! IFIELD(18) IS FOR LUNAR LIBRATION OPTION: 0-EXISTING in 2E
      IF(IFIELD(18) .EQ.1) CLIBMN=1.D0
!     IF(IFIELD(1) .EQ.0) LPGRAV=.FALSE.
      IF(IFIELD(1).GT.0) IPLNZ(ICBDCF)=IFIELD(1)
      IF(IFIELD(3) .GT. 0 ) GO TO 8550
      IF(IFIELD(4).LE.0) CALL BDPT(IC1114,3)
      IF(IFIELD(4).LE.0) CALL BDPT(IC1114,4)
      IF(IFIELD(4).LE.0) CALL BDPT(IC1114,5)
      IF(IPLNET(ICBDCF).EQ.IC1114.AND.LGLOBL) GO TO 3510
      IF(IPLNET(ICBDCF).EQ.IC1114.AND..NOT.LGLOBL) GO TO 3555
      GOTO 600
 8550 CONTINUE
      IF(IFIELD(3).NE.1) GO TO 8600
      IF(IC1114.NE.IPLNET(ICBDCF)) GOTO 60980
      IF(FIELD(1).GT.C0) NPVAL0(IXGM  )=NPVAL0(IXGM  )+1
      IF(FIELD(2).GT.C0) NPVAL0(IXSMA )=NPVAL0(IXSMA )+1
      IF(FIELD(3).GT.C0) NPVAL0(IXFLTP)=NPVAL0(IXFLTP)+1
      IF(FIELD(4).GT.C0) NPVAL0(IXFLTE)=NPVAL0(IXFLTE)+1
      GOTO 600
 8600 IF(IFIELD(3) .NE. 4) GO TO 8650
      NPVAL(IXPLTP)=NPVAL(IXPLTP)+3
      GOTO 600
 8650 IF(IFIELD(3) .NE. 5) GO TO 8700
      NPVAL0(IXPLTP)=NPVAL0(IXPLTP)+3
      GOTO 600
 8700 IF(IFIELD(3) .NE. 6) GO TO 8750
      NPVAL(IXPLTV)=NPVAL(IXPLTV)+3
      GOTO 600
 8750 IF(IFIELD(3) .NE. 7) GO TO 600
      NPVAL0(IXPLTV)=NPVAL0(IXPLTV)+3
      GOTO 600
!*********************************************************************
!  PLANOR **                                               * PLANOR **
!*********************************************************************
16000 CONTINUE
!
!  WILL ADJUST ALL PLANOR PARAMETERS WITH SIGMAS DEFINED ON THE
!  APPROPRIATE PLANOR CARD, IF SIGMAS ARE NOT SPECIFIED, THEY WILL
!  BE 10D-20 (PARAMETERS FIXED)
!
      IND17=IC1517

      IF(IND17.LE.1)  THEN
      NPVAL(IXXTRO)=NXTRAC
      ELSEIF(IND17.EQ.2)  THEN
      NPVAL(IXXTRO)=NXTRAC+NXTRAC2
      ENDIF

      IF(LPLNRA.AND.IND17.LE.1) NPVAL0(IXXTRO)=NXTRAC
      IF(LPLNRA.AND.IND17.EQ.2) NPVAL0(IXXTRO)=NXTRAC+NXTRAC2
! CASE OF A BINARY ASTEROID NXALLC REMAINS THE SAME (NUMBER OF PERIODS)
      IF(LPLNRA.AND.IND17.LE.1) NXALLC=((NXTRAC-NMINRT-7)/2)
      IF(LPLNRA.AND.IND17.EQ.2) NXALLC2=((NXTRAC2-NMINRT2-7)/2)
      IF(.NOT.LASTR(2).AND.LBINAST) NPVAL(IXXTRO)=NPVAL(IXXTRO)+6
      IF(.NOT.LASTR(2).AND.LBINAST) NPVAL0(IXXTRO)=NPVAL0(IXXTRO)+6
      GOTO 600
!*********************************************************************
! PLMOON **                                                * PLMOON **
!*********************************************************************
 8751 CONTINUE
! IF THE CENTRAL BODY IS THE EARTH OR THE EARTH'S MOON AND THERE IS A
! PLMOON CARD PRESENT THEN TERMINATE THE RUN (ALSO FOR SUN)
      ICBFST=IPLNET(ICBDCF)/100
      IF((ICBFST.EQ.3).OR.(ICBFST.EQ.99)) GOTO 60980
! IF THE MOON IS NOT ORBITING THE CENTRAL BODY OF THE RUN THEN TERMINATE
      IPMFST=IC1114/100
      IF(IPMFST.NE.ICBFST) GOTO 60982
! LOAD NPVAL AND NPVAL0 ARRAYS
      NPVAL(IXPMGM)=NPVAL(IXPMGM) + 1
!     NPVAL(IXPMJ2)=NPVAL(IXPMJ2) + 1
      IF(FIELD(3).NE.C0) THEN
       NPVAL0(IXPMGM)=NPVAL0(IXPMGM) + 1
       NMOONA=NPVAL0(IXPMGM)
       IMNNUM(NMOONA,2)=IC1114
      ENDIF
!     IF(FIELD(4).NE.C0)
!      NPVAL0(IXPMJ2)=NPVAL0(IXPMJ2) + 1
!      NMOONA=NPVAL0(IXPMJ2)
!      IMNNUM(NMOONA,3)=IC1114
!     ENDIF
! IF MORE THAN 5 MOONS HAVE BEEN SELECTED THEN TERMINATE THE RUN
      NMOON=NPVAL(IXPMGM)
      IF(NMOON.GT.5) GOTO 60984
! LOAD MOON NUMBER IN MOON NUMBER ARRAY AND TEST TO SEE IF 2 IDENTICAL
! MOONS HAVE BEEN SELECTED
      DO 8752 INDX=1,NMOON
      IF(IC1114.EQ.IMNNUM(INDX,1)) GOTO 60986
 8752 END DO
      IMNNUM(NMOON,1)=IC1114
      GOTO 600
!
!*********************************************************************
! PLNEPH **                                                * PLNEPH **
!*********************************************************************
 8755 CONTINUE
!  *** GET AND TEST BODY ID FROM OPTION CARD ****
      IC912=IC910*100+IC1112
      CALL FNDNUM(IC912,IPLNET,21,IRID)
      IF (IRID.NE.ICBDGM.AND.IRID.NE.ITBDGM) GOTO 600
!  ***  TEST THE ELEMENT INDICATOR  ****
      IF (IC1314.LT.1.AND.IC1314.GT.6) THEN
      WRITE(IUNT06,*) '  INCORRECT INPUT FOR PLNEPH / CARD IGNORED '
      GOTO 600
      END IF
!  ***  CODE FOR CENTRAL BODY CASE  ****
      IF (IRID.EQ.ICBDGM) THEN
      IC2124=IC2122*100+IC2324
      IF (IC2124.EQ.ZERO.AND.FIELD(1).EQ.ZERO) GOTO 8760
!  LOAD REQUESTED EPOCH INTO COMMON BLOCK /COREPH/
      IMMDD=FIELD(1)/1000000
      IYYMD=IC2124*10000+IMMDD
      IFLD1=FIELD(1)
      IHMS=MOD(IFLD1,1000000)
      FFF=FIELD(1)-IFLD1
      CALL YMDTIS(IYYMD,IHMS,ISEC)
      IC2D=MOD(IC2124,100)
      IYMD2D=IC2D*10000+IMMDD
      IF (ABS(DBLE(IYMD2D)-YMD1).LT.0.001D0)  THEN
      TDIF2=EPAUT1(1)+EPAUT1(2)*(DAYS1-EPAUT1(3))
      ELSE
      TDIF2=EPAUT2(1)+EPAUT2(2)*(DAYS2-EPAUT2(3))
      END IF
!
      DELT=TDIF2+ETA1
      TIME=ISEC+FFF+DELT
      ITIME=TIME
      EMJDS0(1)=ITIME
      EFSEC0(1)=TIME-ITIME
!
 8760 BODYID(1)=IRID
      ECORR(1)=ONE
      IF (NPVAL(IXEPHC).EQ.C0) NPVAL(IXEPHC)=6
      SGMEBC(IC1314)=FIELD(3)
      IF (FIELD(3).NE.C0) NPVAL0(IXEPHC)=NPVAL0(IXEPHC)+1
      ELSE
!  ***   CODE FOR TRACKING BODY CASE   ****
      IC2124=IC2122*100+IC2324
      IF (IC2124.EQ.ZERO.AND.FIELD(1).EQ.ZERO) GOTO 8770
!  LOAD REQUESTED EPOCH INTO COMMON BLOCK /COREPH/
      IMMDD=FIELD(1)/1000000
      IYYMD=IC2124*10000+IMMDD
      IFLD1=FIELD(1)
      IHMS=MOD(IFLD1,10000)
      FFF=FIELD(1)-IFLD1
      CALL YMDTIS(IYYMD,IHMS,ISEC)
      IC2D=MOD(IC2124,100)
      IYMD2D=IC2D*10000+IMMDD
      IF (ABS(DBLE(IYMD2D)-YMD1).LT.0.001D0)  THEN
      TDIF2=EPAUT1(1)+EPAUT1(2)*(DAYS1-EPAUT1(3))
      ELSE
      TDIF2=EPAUT2(1)+EPAUT2(2)*(DAYS2-EPAUT2(3))
      END IF
!
      DELT=TDIF2+ETA1
      TIME=ISEC+FFF+DELT
      ITIME=TIME
      EMJDS0(2)=ITIME
      EFSEC0(2)=TIME-ITIME
!
 8770 BODYID(2)=IRID
      ECORR(2)=ONE
      IF (NPVAL(IXEPHT).EQ.C0) NPVAL(IXEPHT)=NPVAL(IXEPHT)+6
      SGMEBC(6+IC1314)=FIELD(3)
      IF (FIELD(3).NE.C0) NPVAL0(IXEPHT)=NPVAL0(IXEPHT)+1
      END IF
      GOTO 600
!
!*********************************************************************
! QUAPOS **                                                * QUAPOS **
!*********************************************************************
 8800 CONTINUE
      NQUA=0
 8810 READ(IUNT50,71050,END=60000) CDNAME,IC910,IC1112,IC1314,          &
     &   IC1516,IC1824,FIELD
      IF(CDNAME.EQ.ENDQUA)GOTO 600
      IF(CDNAME.EQ.QUAVEL)GOTO 8820
      IDQ=IC910*1000000+IC1112*10000+IC1314*100+IC1516
      IDQP=IDQ
!     IF(IDQ.EQ.0)GOTO ERROR
      NQUA=NQUA+1
      IQUAID(NQUA)=IDQ
      IF(FIELD(3).GT.0.D0.OR.FIELD(4).GT.0.D0) THEN
      NPVAL0(IXVLBI)=1
      LQUADJ(NQUA)=.TRUE.
      ELSE
      LQUADJ(NQUA)=.FALSE.
      ENDIF
      GOTO 8810
 8820 CONTINUE
      IDQ=IC910*1000000+IC1112*10000+IC1314*100+IC1516
      IF(IDQ.NE.IDQP) THEN
      WRITE(6,*)' QUASAR ID FOR VELOCITY DISAGREES WITH POSITION ID '
      WRITE(6,*)' EXECUTION TERMINATING IN RD50A2 '
      STOP 16
      ENDIF
      IF(FIELD(3).GT.0.D0.OR.FIELD(4).GT.0.D0) THEN
      NPVAL0(IXVLBV)=1
      LQVADJ(NQUA)=.TRUE.
      ELSE
      LQVADJ(NQUA)=.FALSE.
      ENDIF
      GOTO 8810
!*********************************************************************
! RAYTID **                                                * RAYTID **
!*********************************************************************
 8900 CONTINUE
      LRAY=.TRUE.
      IFBUFL=2000000
      GOTO 600
!*********************************************************************
! RELPPN **                                                * RELPPN **
!*********************************************************************
 8910 CONTINUE
      NPVAL(IXRELP)=2
      IF(FIELD(2).GT.0.D0.AND.FIELD(4).GT.0.D0) THEN
      NPVAL0(IXRELP)=2
      ENDIF
      GOTO 600
!*********************************************************************
! REFSYS **                                                * REFSYS **
!*********************************************************************
 9000 READ(IUNT50,71200,END=60100) CDNAME,MREFSY,IRYMD
      IF(MREFSY.NE.0) GOTO 9100
      IF(CDNAME.NE.REFSYS) GO TO 60200
 9100 CONTINUE
!** SATPAR ** SLAVE (OPTIONAL) ** EPOCH ** ELEMS1 ** ELEMS2
! SATPAR
!     READ(IUNT50,71300,END=60100) CDNAME,I7,IFIELD(3),IFIELD(6),IC1824
      READ(IUNT50,71300,END=60100) CDNAME,I7,IFIELD(3),IFIELD(6),       &
     &IFIELD(8),IC1824
!      write(6,*)CDNAME,I7,IFIELD(3),IFIELD(6),IFIELD(8),IC1824

      IF(CDNAME.NE.SATPAR) GO TO 60200
      IFIELD(1)=I7
 9500 NSATID=NSATID+1
      IF(IFIELD(1).LE.0) IUNT15=-15
!12
      IF(IFIELD(3).EQ.0) GOTO 9600
      DO I=1,10
      IF(IFIELD(3).EQ.IND1(I)) IDSATS(I,1)=IC1824
      IF(IFIELD(3).EQ.IND2(I)) IDSATS(I,2)=IC1824
!     WRITE(6,*)' dbg RD50A2 ',IDSATS(I,1),IDSATS(I,2),I
      ENDDO

 9600 CONTINUE
!12
      NSATA=NSATID
      NSETA=NSETA+1
      ISATID(NSATID)=IC1824
      ISETN(NSATID)=NSETA
      NPVAL(IXSATP)=NPVAL(IXSATP)+6
      NPVAL0(IXSATP)=NPVAL0(IXSATP)+6
      LEAEPC=.FALSE.
      LTAEPC=.FALSE.
!
! EXTERNAL ATTITUDE INFORMATION LOADING
!
      IF((IFIELD(6).EQ.9).AND.(LEXATA)) THEN
       CALL FNDNUM(IC1824,II1(JEASID),NEASAT,IEANDX)
! debug extatt
!      print *,'rd50a2: satpar: ieandx,neasat: ',ieandx,neasat
! debug extatt
       IF((IEANDX.EQ.0).OR.(IEANDX.GT.NEASAT)) GOTO 61010
       LL1(JEAFIL+IEANDX-1)=.TRUE.
       LEAEPC=.TRUE.
! NOTE: do not disturb IEANDX, it is used later in external attitude loa
      ENDIF
!
! EXTERNAL THERMAL ACCEL INFORMATION LOADING
!
! IFIELD(8) = col. 14

      IF((IFIELD(8).EQ.1).AND.(LEXTHC)) THEN
       CALL FNDNUM(IC1824,II1(JTASID),NTASAT,ITANDX)
       IF((ITANDX.EQ.0).OR.(ITANDX.GT.NTASAT)) GOTO 61011
       LL1(JTAFIL+ITANDX-1)=.TRUE.
       LTAEPC=.TRUE.
       ! NOTE: do not disturb ITANDX, it is used later in
       ! external thermal acceleration  loading
      ENDIF
! EPOCH OR SLAVE
      READ(IUNT50,71600,END=60100) CDNAME,IYMD1,IHM1,SEC1,              &
     &                    IYMD2,IHM2,SEC2,IYMD3,IHM3,SEC3

!71600 FORMAT(BZ,A6,14X,I6,I4,D10.3,I6,I4,D10.3,I6,I4,D10.3)

      IEPSTP=IYMD3
      IF(CDNAME.NE.EPOCH.AND.CDNAME.NE.SLAVE) GO TO 60200
      IF(CDNAME.EQ.SLAVE) GOTO 9700
! ** EPOCH **
      IF(IYMD3.EQ.0) GOTO 60300
      IHMS  =IHM1*100
      CALL CHKTM2(IYMD1,IHM1,SEC1,'EPOCH   ')
      CALL YMDTIS(IYMD1,IHMS,IT1   )
      IT1   =IT1   +SEC1
! CHECK HERE THE TIMES FOR A TETHERED SYSTEM
      IF(LTETHR) THEN
       IF(IT1CMT.EQ.0) THEN
       IT1CMT=IT1
       ELSE
         IF(IT1CMT.NE.IT1) THEN
         WRITE(6,*)' EXECUTION TERMINATING IN RD50A2: '
         WRITE(6,*)' EPOCH TIMES FOR THE CM AND TETHER SHOULD BE EQUAL '
         STOP 16
         ENDIF
       ENDIF
      ENDIF
! NOTE: do not disturb IT1, IYMD1, IHM1, and SEC1 they are used later fo
!       external attitude loading in EPOCH card
      IT2=IT1
      IF(IYMD2 .LT. 500101) GO TO 9650
      IHMS  =IHM2*100
      CALL CHKTM2(IYMD2,IHM2,SEC2,'EPOCH   ')
      CALL YMDTIS(IYMD2,IHMS,IT2   )
      IT2   =IT2   +SEC2
 9650 CONTINUE
      IHMS  =IHM3*100
      CALL CHKTM2(IYMD3,IHM3,SEC3,'EPOCH   ')
      CALL YMDTIS(IYMD3,IHMS,IT3   )
      IT3   =IT3   +SEC3
! NOTE: do not disturb IT3, IYMD3, IHM3, and SEC3 they are used later fo
!       external attitude loading in EPOCH card
!CC   IDATAB= MIN(IDATAB,IT1,IT2)
      IF(YARTYP.EQ.1.D0) IT2=IT2-14400
      IDATAB= MIN(IDATAB,IT2)
      IDATAE= MAX(IDATAE,IT3 )
      IARCT1= MIN(IARCT1,IT1,IT2)
      IARCT2=IDATAE
!
! EXTERNAL ATTITUDE INFORMATION LOADING
!
!
      IF(LEAEPC) THEN
! load epoch et start mjdsec and fsec
       ITX=IT1
       IHMX=IHM1
       IYMDX=IYMD1
       SECX=SEC1
       IF(IT2.LT.IT1) THEN
       ITX=IT2
         IHMX=IHM2
         IYMDX=IYMD2
         SECX=SEC2
       ENDIF
       IHMSX=IHMX*100
       DT=TDIF(7,3,IYMDX,IHMSX,AA1(KA1UTC))
       IDT=DT
       ITMP=SECX
       EAFSEC=SECX+(DT-DBLE(IDT))-DBLE(ITMP)
       IEASEC=EAFSEC
       EAFSEC=EAFSEC-DBLE(IEASEC)
! debug extatt
!      print *,'rd50a2: loading epoch start times for extatt'
!      print *,'rd50a2: epoch: dt,idt,sec1,itmp: ',dt,idt,sec1,itmp
!      print *,'rd50a2: ieasec,eafsec: ',ieasec,eafsec
!      print *,'rd50a2: it1+idt+ieasec,it1: ',it1+idt+ieasec,it1
! debug extatt
       II1(JEAESB+IEANDX-1)=ITX+IDT+IEASEC
       AA1(JEAEFB+IEANDX-1)=EAFSEC
! load epoch et stop mjdsec and fsec
       IHMS3=IHM3*100
       DT=TDIF(7,3,IYMD3,IHMS3,AA1(KA1UTC))
       IDT=DT
       ITMP=SEC3
       EAFSEC=SEC3+(DT-DBLE(IDT))-DBLE(ITMP)
       IEASEC=EAFSEC
       EAFSEC=EAFSEC-DBLE(IEASEC)
! debug extatt
!      print *,'rd50a2: loading epoch stop times for extatt'
!      print *,'rd50a2: epoch: dt,idt,sec3,itmp: ',dt,idt,sec3,itmp
!      print *,'rd50a2: ieasec,eafsec: ',ieasec,eafsec
!      print *,'rd50a2: it3+idt+ieasec,it3: ',it3+idt+ieasec,it3
! debug extatt
       II1(JEAESE+IEANDX-1)=IT3+IDT+IEASEC
       AA1(JEAEFE+IEANDX-1)=EAFSEC
      ENDIF
!
! EXTERNAL THERMAL ACCELERATION INFORMATION LOADING
!
!
      IF(LTAEPC) THEN
! load epoch et start mjdsec and fsec

!      ITX=IT1
!      IHMX=IHM1
!      IYMDX=IYMD1
!      SECX=SEC1
!      IF(IT2.LT.IT1) THEN
!      ITX=IT2
!        IHMX=IHM2
!        IYMDX=IYMD2
!        SECX=SEC2
!      ENDIF
!      IHMSX=IHMX*100
!      DT=TDIF(7,3,IYMDX,IHMSX,AA1(KA1UTC))
!      IDT=DT
!      ITMP=SECX
!      EAFSEC=SECX+(DT-DFLOAT(IDT))-DFLOAT(ITMP)
!      IEASEC=EAFSEC
!      EAFSEC=EAFSEC-DFLOAT(IEASEC)
!      II1(JTAESB+ITANDX-1)=ITX+IDT+IEASEC
!      AA1(JTAEFB+ITANDX-1)=EAFSEC
       ITT=IT1
       SECT=SEC1
       if(IT2.lt.IT1) ITT=IT2
       if(SEC2.lt.SEC1) SECT=SEC2
       II1(JTAESB+ITANDX-1)=ITT
       AA1(JTAEFB+ITANDX-1)=SECT
! load epoch et stop mjdsec and fsec
!      IHMS3=IHM3*100
!      DT=TDIF(7,3,IYMD3,IHMS3,AA1(KA1UTC))
!      IDT=DT
!      ITMP=SEC3
!      EAFSEC=SEC3+(DT-DFLOAT(IDT))-DFLOAT(ITMP)
!      IEASEC=EAFSEC
!      EAFSEC=EAFSEC-DFLOAT(IEASEC)
!      II1(JTAESE+ITANDX-1)=IT3+IDT+IEASEC
!      AA1(JTAEFE+ITANDX-1)=EAFSEC
       II1(JTAESE+ITANDX-1)=IT3
       AA1(JTAEFE+ITANDX-1)=SEC3
      ENDIF
!
!
! SELF SHADOWING BEGIN
      IF(NSHSAT.GT.0) THEN
        CALL FNDNUM(IC1824,IDSASH,NSHSAT,ISLF)
        IF(ISLF.NE.0) THEN
          SFSTAT=AA1(JSSDST+  (ISLF-1)*3)
          SFSTOP=AA1(JSSDST+1+(ISLF-1)*3)
          SFSTEP=AA1(JSSDST+2+(ISLF-1)*3)
! CHECK THE START TIME
! NOTE SINCE THE SELF SHADOWING IS FOR FORCE MODEL
! GEODYN TYPICALLY REQUIRES THE START TIME IS 10 MINTUES EARLIER THAN
! THE EPOCH START TIME TO COVER THE PERIOD FOR INTEGRATION
          ITSFST=IT2-600.D0
          IF(SFSTAT.GT.ITSFST) THEN
           WRITE(6,*) 'EXTERNAL SHADOWING FILE FOR SATELLITE ',IC1824,&
     &      ' DOES NOT COVER REQUIRED TIMES'
           STOP
          ENDIF
          NDT=INT((ITSFST-SFSTAT)/SFSTEP)
          AA1(JSSDST+(ISLF-1)*3)=SFSTAT+NDT*SFSTEP
! CHECK STOP TIME
          ITSFSP=IT3+600.D0
          IF(SFSTOP.LT.ITSFSP) THEN
          WRITE(6,*) 'EXTERNAL SHADOWING FILE FOR SATELLITE ',IC1824,&
     &     ' DOES NOT COVER REQUIRED TIMES'
          STOP
          ENDIF
          SFSTOP=ITSFSP+0.1D0
          NSHRCD(ISLF)=INT((SFSTOP-AA1(JSSDST+(ISLF-1)*3))/SFSTEP)+2
          AA1(JSSDST+1+(ISLF-1)*3)=AA1(JSSDST+(ISLF-1)*3)+           &
     &                              (NSHRCD(ISLF)-1)*SFSTEP
        ENDIF
      ENDIF
! SELF SHADOWING END
!
!
!
!
! EXTERNAL CGMASS start
!
!
      !write(6,'(A,1x,I6)') 'rd50a2: NEXCG ', NEXCG
!
!
      IF( NEXCG.GT.0 ) THEN
!
          CALL FNDNUM(IC1824,II1(JIDEXC),II1(JNEXCG),IEXCG)
!
!
          IF(IEXCG.NE.0) THEN
!
              !write(6,'(/A)') 'rd50a2: EXTERNAL CGMASS FILE SECTION '
              !write(6,'(A,1x,I6)') 'rd50a2: NEXCG ', NEXCG
              !write(6,'(A,1x,I6)') 'rd50a2: IEXCG ', IEXCG
!
              CGSTAT=AA1(JXCGST+IEXCG-1)
              CGDT  =AA1(JXCGDT+IEXCG-1)
              CGSTOP=CGSTAT+CGDT*(II1(JNREXC+IEXCG-1)-1)
!
              !write(6,*) 'rd50a2: CGSTAT, CGSTOP, CGDT ', &
              !                    CGSTAT, CGSTOP, CGDT
!
              !write(6,'(A,1x,F17.4)') 'rd50a2: ET CGSTAT ', CGSTAT
              !write(6,'(A,1x,F17.4)') 'rd50a2: ET CGSTOP ', CGSTOP
              !write(6,'(A,1x,F17.4)') 'rd50a2: CGDT   ', CGDT
              !write(6,'(A,1x,I12  )') 'rd50a2: utc IT2  ', IT2
              !write(6,'(A,1x,I12  )') 'rd50a2: utc IT3  ', IT3
!
              !write(6,'(A,2(1x,I10)  )') &
              !      'rd50a2: IYMD2, IHM2*100 ',  IYMD2, IHM2*100
!
              !write(6,'(A,1x,F10.6   )') &
              !      'rd50a2: TDIF(7,3,IYMD2,IHM2*100,AA1(KA1UTC)) ', &
              !               TDIF(7,3,IYMD2,IHM2*100,AA1(KA1UTC))
!
              !write(6,'(A)') 'rd50a2: check the start time '
!
              ! CHECK THE START TIME
!
              it2_et = it2 + TDIF(7,3,IYMD2,IHM2*100,AA1(KA1UTC))  !jjm
!
              !write(6,'(A,2(1x,I12)  )') &
              !      'rd50a2: it2, it2_et ', it2, it2_et
!
              !orig IF( CGSTAT .GT. IT2 ) THEN
              IF( CGSTAT .GT. IT2_et ) THEN     ! jjm
                  WRITE(6,*) &
                    'rd50a2:EXTERNAL CGMASS FILE FOR SATELLITE ',&
                           IC1824,&
                         ' DOES NOT COVER REQUIRED TIMES'
                  STOP 'r50a2: bad cgmass file start'
              ENDIF
!
              ! why +2 ?  jjm
              !!!!NDT=INT((IT2-CGSTAT)/CGDT)+2 ! orig
              !write(6,'(A,1x,I10)') 'rd50a2: NDT ', NDT
!
              NDT=INT(( IT2_et - CGSTAT)/CGDT) + 1
!
              !write(6,'(A,1x,I10)') 'rd50a2: NDT ', NDT
!
              AA1(JXCGST+IEXCG-1)=CGSTAT+NDT*CGDT
!
              !write(6,'(A,1x,F17.4)') &
              !      'rd50a2: new start time  AA1(JXCGST+IEXCG-1)', &
              !                               AA1(JXCGST+IEXCG-1)
!
              ! CHECK STOP TIME
!
              !write(6,'(A)') 'rd50a2: check the stop  time '
!
              !orig IF( CGSTOP.LT. IT3+1.D0 ) THEN ! orig
              it3_et = it3 + TDIF(7,3,IYMD3,IHM3*100,AA1(KA1UTC))  !jjm
!
              IF( CGSTOP.LT. IT3_et +1.D0 ) THEN
                  WRITE(6,*)  &
                     'rd50a2:EXTERNAL CGMASS FILE FOR SATELLITE ',&
                        IC1824,&
                        ' DOES NOT COVER REQUIRED TIMES'
                  STOP 'r50a2: bad cgmass file stop'
!
              ENDIF
!
              !CGSTOP=IT3+1.D0  ! orig
              !write(6,'(A,1x,F17.4)') &
              !           'rd50a2: orig  CTSTOP ', CGSTOP
!
              CGSTOP=IT3_et+1.D0
!
              !write(6,'(A,1x,F17.4)') &
              !      'rd50a2: jjm  CTSTOP ', CGSTOP
!
              ! why +4 ?  jjm
              !II1(JNREXC+IEXCG-1) = &                       !orig
              !     INT((CGSTOP-AA1(JXCGST+IEXCG-1))/CGDT)+4 !orig
              !write(6,'(A,1x,I10)') &
              !   'rd50a2:orig  II1(JNREXC+IEXCG-1) ', &
              !                 II1(JNREXC+IEXCG-1)
!
              II1(JNREXC+IEXCG-1) = &                       ! jjm
                   INT((CGSTOP-AA1(JXCGST+IEXCG-1))/CGDT)+1 ! jjm
!
              !write(6,'(A,1x,I10)') &
              !      'rd50a2: jjm  num records &
              !                &II1(JNREXC+IEXCG-1) ', &
              !                 II1(JNREXC+IEXCG-1)
!
              ! SAVE THE NUMBER OF RECORDS FOR MEMORY ALLOCATION
!
              NRCDCG(IEXCG)=II1(JNREXC+IEXCG-1)
!
              !write(6,'(A,1x,I10/)') &
              !      'rd50a2:  number of records in &
              !        &cgmass file NRCDCG(IEXCG) ', NRCDCG(IEXCG)
!
!
         ENDIF !  IEXCG.NE.0
      ENDIF    !  NEXCG.GT.0
!
!
! EXTERNAL CGMASS end
!
!
!
!
!     ....SET DEFAULT FOR DYNAMIC POLAR MOTION TO IARCT1
!
      DPMEP = IARCT1
!
      GO TO 10020
! ** SLAVE **
 9700 CONTINUE
!     FIND LOCATION IN SATID ARRAY OF MASTER SATELLITE FOR THIS SLAVE
      IMASTS=MOD(IYMD1,1000)*10000+IHM1
      CALL FNDNUM(IMASTS,ISATID,NSATID,IRET)
      IF(IRET.EQ.0) GO TO 60900
      ISETN(NSATID)=ISETN(IRET)
      NSETA=NSETA-1
!** ELEMS1 **
10020 READ(IUNT50,71100,END=60100) CDNAME
      IF(CDNAME.NE.ELEMS1) GO TO 60200
!** ELEMS2 **
      READ(IUNT50,71100,END=60100) CDNAME
      IF(CDNAME.NE.ELEMS2) GO TO 60200
      GO TO 600
!*********************************************************************
! ** ROCK4  *                                              * ROCK4  **
!*********************************************************************
10021 CONTINUE
      IDS=IDS+1
      IDRCK4(IDS)=FIELD(1)
      GO TO 600
!*********************************************************************
! ** SCBODY *                                              * SCBODY **
!*********************************************************************
10025 CONTINUE
      ! INCREASE THE BODY ID BY ONE SO THAT IT WORKS WITH THE INTGCB
      ! CARD.  THE INTGCB CARD USES SLOT 12, SO START EXTERNAL
      ! EPHEMERIS BODIES AT 13.
       IF (LASTSN) THEN
           IC910 = IC910 + 1
       END IF
       IF (LBINAST) THEN
           IC910 = IC910 + 1
       END IF
      IND=MOD(IC78,10)*100+IC910
      IC1117=IC1112*100000+IC1314*1000+IC1517
      DO I=1,11
      IF(IC1117.EQ.IPLNET(I)) THEN
      IP=IC1117
      IF(IP.GE.301) IP=IP+100
      IREPL(IND)=IP/100
      ENDIF
      ENDDO
      IF(IFIELD(1).GT.0) IPLNZ(ICBDCF)=IFIELD(1)
      IF(IFIELD(18) .GT. 0 ) GO TO 10026
      IC7=IC78/10
      IC8=IC78-IC7*10
      ICSC=IC8*100+IC910
      IF(ICSC.EQ.100) ICSC=1001
      IF(ICSC.EQ.200) ICSC=2001
      IF(ICSC.EQ.300) ICSC=3001
      IF(ICSC.EQ.400) ICSC=4001
      IF(ICSC.EQ.500) ICSC=5001
      IF(ICSC.EQ.600) ICSC=6001
      IF(ICSC.EQ.700) ICSC=7001
      IF(ICSC.EQ.800) ICSC=8001
      IF(ICSC.EQ.900) ICSC=9001
      IF(IFIELD(18).LE.0) CALL BDPT(ICSC,3)
      IF(IFIELD(18).LE.0) CALL BDPT(ICSC,4)
      IF(IFIELD(18).LE.0) CALL BDPT(ICSC,5)
      GOTO 10027
10026 CONTINUE
      IF(FIELD(1).GT.C0) NPVAL0(IXGM  )=NPVAL0(IXGM  )+1
      IF(FIELD(2).GT.C0) NPVAL0(IXSMA )=NPVAL0(IXSMA )+1
      IF(FIELD(3).GT.C0) NPVAL0(IXFLTP)=NPVAL0(IXFLTP)+1
      IF(FIELD(4).GT.C0) NPVAL0(IXFLTE)=NPVAL0(IXFLTE)+1
10027 CONTINUE
! FILL UP PARAMETER ESTIMATION ARRAYS
      GOTO 600
!*********************************************************************
! ** SELECT/DELETE OPTION *                                * SELECT **
!*********************************************************************
10500 CONTINUE
!     ....found DATA card so set flag LSLFLG to .FALSE.
!     ....if you find a SELECT card after reading a DATA card,
!     ....set flag LSLFLG to .TRUE.
      LSLFLG=.FALSE.
10505 CONTINUE
      LOBS=.TRUE.
! METDAT,DELETE AND(SELECT,SIGMA,OBSCOR,PREPRO) CARDS
      READ(IUNT50,71400,END=60100) CDNAME,IF1,IF2,IF3,IF4,IF5,RF1,IF6,  &
     &     IF7,RF2,IF8,IF9,RF3
      IF(CDNAME.EQ.ENDARC) GO TO 4000
      IF0=0
      DO 10510 I=1,6
      IF(CDNAME.EQ.SELCDS(I)) IF0=I
10510 END DO
!     ....found SELECT card so set flag LSLFLG to .TRUE.
      IF(IF0.EQ.1) LSLFLG=.TRUE.
      IF(IF0.EQ.0) GOTO 60400
      IF(IF0.NE.1.AND.IF0.NE.2.AND.IF0.NE.6) GOTO 10515
! CALCULATE TIMES
      IF(IF6.EQ.0) GOTO 10515
      ISEC=RF2
      IHMS=IF7*100+ISEC
      CALL CHKTM3(IF6,IF7,RF2,SELCDS(IF0))
      CALL YMDTIS(IF6,IHMS,IRES)
      IF6=IRES
      RF2=RF2-DBLE(ISEC)
      ISEC=RF3
      IHMS=IF9*100+ISEC
      CALL CHKTM3(IF8,IF9,RF3,SELCDS(IF0))
      CALL YMDTIS(IF8,IHMS,IRES)
      IF8=IRES
      RF3=RF3-ISEC
10515 CONTINUE
      IF(CDNAME.EQ.XMETDT) GO TO 10520
      IF(CDNAME.EQ.DELETE) GO TO 10540
! CARD MUST BE A SELECT,SIGMA,OBSCOR OR PREPRO CARD
      NSEL=NSEL+1
      NDX=NSEL
      GO TO 10575
!****  METDAT ****
10520 NMETDT=NMETDT+1
      NDX=MAXSEL+MAXDEL+NMETDT
      IH=DBLE(IF5)/C10D0 +C0P5
      IT=DBLE(IF4)/C10D0+C0P5
      IP=RF1*C100D0+C0P5
      RF1=DBLE(IH)+CPRESS*DBLE(IP)+CTEMP*DBLE(IT)
      GO TO 10575
!**** DELETE ****
10540 NDEL=NDEL+1
      NDX=MAXSEL+NDEL
      GO TO 10575
!**** SIGMA  **** IF EDITING SIGMA = 0, SET EDIT SIGMA=SIGMA
10575 CONTINUE
      IF(IF0.NE.4) GOTO 10580
      IF(RF2.EQ.C0) RF2=RF1
!**** FILL CARD ****
10580 CONTINUE
      IF(CDNAME.EQ.SELCDS(1).AND.RF1.GT.0.D0) THEN
      IF3=INT(RF1)
      ENDIF
      IF(CDNAME.EQ.SELCDS(2).AND.RF1.GT.0.D0) THEN
      IF3=INT(RF1)
      ENDIF
      IF(CDNAME.EQ.SELCDS(4).AND.IF5.GT.0) THEN
      IF3=IF5
      ENDIF

      IF(CDNAME.EQ.SELCDS(4)) THEN
       ISIGOV(NDX)=IF6
!       write(6,*) "RD50A2: ISIGOV(NDX) :", ISIGOV(NDX), NDX
      ENDIF

      IF(CDNAME.EQ.SELCDS(6).AND.IF5.GT.0) THEN
      IF3=IF5
      ENDIF
      ISTA(NDX)  =IF1
      ICONFG(NDX)=IF2
      ITYPE(NDX) =IF3
      ISATCD(NDX)=IF4
      IMODLO(NDX)=IF5
      MJDS1(NDX) =IF6
      IPSW1(NDX) =IF7
      MJDS2(NDX) =IF8
      IPSW2(NDX) =IF9
      F1(NDX)    =RF1
      F2(NDX)    =RF2
      F3(NDX)    =RF3
      NAMCRD(NDX)=IF0
      GOTO 10505
!**********************************************************************
!** SIMDAT **                                              ** SIMDAT **
!**********************************************************************
10650 CONTINUE
      LSIMDT=.TRUE.
      LOBS=.TRUE.
      LSDATA=.FALSE.
      ISREAD=5
      IF(IC78.EQ.1)LSDATA=.TRUE.
      IF(LSDATA.AND.LVOPTC)GO TO 60990
      IF(IC910.GT.0)ISREAD=17
      IF(LSDATA)CALL RD17A2(IARC,ISREAD)
      GO TO 600
!*********************************************************************
! SOLRAD **                                                * SOLRAD **
! ********************************************************************
10700 CONTINUE
!
      NUCL=NUCL+1
      IC9=(IC910/10)+0.9D0
      IC10=IC910-IC9*10
      IC11=(IC1112/10)+0.9D0
      IF(IC9.EQ.1) THEN
        LJBUS(NUCL)=.TRUE.
        IUCLSAT(NUCL)=IC1824
      ENDIF
      IF(IC9.EQ.2) LUGFO=.TRUE.
      IF(IC9.EQ.3) LENVI=.TRUE.
      IF(IC10.EQ.1) LJPAN(NUCL)=.TRUE.
      IF(IC11.EQ.1) LJTRR(NUCL)=.TRUE.
!     write(6,*)' dbg RD50A2 ',LJBUS,LJPAN,LJTRR,IC9,IC10,IC11,IC910
!     FIND CURRENT SATELLITE IN SATELLITE ID ARRAY
      CALL FNDNUM(IC1824,ISATID,NSATID,ISAT)
      IF(ISAT.EQ.0) GO TO 60650
!
! TEST SIGMA
      IBEG=IARCT1
      IEND=IARCT2
      IF(FIELD(3).EQ.C0) GOTO 10720
         IBEG=IDATAB
         IEND=IDATAE
10720 CONTINUE
      IF(FIELD(2).LE.C0) GOTO 10730
!
!     ....check validity of end time for solrad
!
      CALL CHKTM1( FIELD(2), 'SOLRAD  ' )
!
! ** BREAK UP FIELD 2 **
      CALL RIYMDH(FIELD(2),I1YMD,I1HMS)
      CALL YMDTIS(I1YMD,I1HMS,I1SEC)
! eliminate cards with times prior to the start time of the run
      IF(I1SEC.LT.IBEG) GOTO 600
! if previous satellite id is not equal to current sat id reset lsrtmx
! to false so that first time that exceeds the end time will
! be accepted for the current satellite.
      IF(IPIDSR.NE.IC1824)LSRTMX=.FALSE.
! accept the first time that exceeds the end time (LSRTMX=.FALSE.)
! reject all other times that exceed the end time (LSRTMX=.TRUE.)
      IF(LSRTMX.AND.(I1SEC.GT.IEND)) GOTO 600
! set flag to tell that the first time beyond the end time was found
      IF(I1SEC.GT.IEND) LSRTMX=.TRUE.
! save value of satellite id
      IPIDSR=IC1824
10730 CONTINUE
      NIC8=IFIELD(2)+1
      NIC8= MIN(3,NIC8)
      IORFRC(2,ISAT)= MAX(IORFRC(2,ISAT),NIC8)
      IF(FIELD(2).GT.C0) GOTO 10705
!  SOLRAD CARD IS NOT TIME DEPENDENT
      IBASPD(2,ISAT)=IORFRC(2,ISAT)
      IF(FIELD(3).NE.C0) LAFRC(NIC8,2,ISAT)=.TRUE.
      GOTO 600
!     ** TIME DEPENDENT **
10705 CONTINUE
      IPDFRC(2,ISAT)=IPDFRC(2,ISAT)+1
      IF(FIELD(3).NE.C0) LAFRC(4,2,ISAT)=.TRUE.
      IF(FIELD(3).NE.C0) IPDADJ(2,ISAT)=IPDADJ(2,ISAT)+1
      GOTO 600
!*********************************************************************
! SOLTAB **                                                * SOLTAB **
! ********************************************************************
11000 CONTINUE
      NSRA=IC1114+IC1517
11010 CONTINUE
      READ(IUNT50,71100,END=60100) CDNAME
      IF(CDNAME.NE.FIN) GO TO 11000
      GOTO 600
!*********************************************************************
! SSCOEF **                                                * SSCOEF **
! ********************************************************************
11250 CONTINUE
      LSSCOF = .TRUE.
! PERFORM QUALITY CHECKS
! VERIFY INCLUSION OF SSTOPO CARD
      IF(.NOT. LSTOPO) THEN
       WRITE(6,81000)
       STOP
      ENDIF
!
! VERIFY EXCLUSION OF SSTPRD & SSTTIM CARDS
      IF(LSTPRD .OR. LSTTIM) THEN
       WRITE(6,81100)
       STOP
      ENDIF
!
! VERIFY SPECIFIED DEGREE IS WITHIN BOUNDS
      IF(IC1517.LT.0.OR.IC1517.GT.MDEGEO) THEN
       WRITE (6,81200)
       WRITE (6,81300)
      STOP
      ENDIF
!
! VERIFY SPECIFIED ORDER IS WITHIN BOUNDS
      IF(IC1820.GT.IC1517 .OR. IC1820.GT.MORGEO) THEN
       WRITE (6,81400)
       WRITE (6,81500)
      STOP
      ENDIF
!
! INCREMENT NUMBER OF PARAMETERS & SET POINTERS
! CBAR TERM
      IF(FIELD(1).NE.C0 .OR. FIELD(3).NE.C0) THEN
      NPVAL(IXSSTC)=NPVAL(IXSSTC)+1
      INDSST=1*100000000+IC1517*1000+IC1820
      ISSTPT(NPVAL(IXSSTC)+NPVAL(IXSSTS))=INDSST
      IF(FIELD(3).GT.C0) THEN
       NPVAL0(IXSSTC)=NPVAL0(IXSSTC)+1
       ISSTPA(NPVAL0(IXSSTC)+NPVAL0(IXSSTS))=INDSST
      ENDIF
      ENDIF
!
! SBAR TERM
      IF(FIELD(2).NE.C0 .OR. FIELD(4).NE.C0) THEN
      NPVAL(IXSSTS)=NPVAL(IXSSTS)+1
      INDSST=200000000+IC1517*1000+IC1820
      ISSTPT(NPVAL(IXSSTS)+NPVAL(IXSSTC))=INDSST
      IF(FIELD(4).GT.C0) THEN
        NPVAL0(IXSSTS)=NPVAL0(IXSSTS)+1
        ISSTPA(NPVAL0(IXSSTC)+NPVAL0(IXSSTS))=INDSST
      ENDIF
      ENDIF
      GOTO 600
!*********************************************************************
! SSTMOD **                                                * SSTMOD **
! ********************************************************************
11300 CONTINUE
      LPRINT=.FALSE.
      WRITE(FILNAM,FMT='(A6)') 'SSTCOF'
      LSSTMO=.TRUE.
      EDBOUN=FIELD(4)
      SSTWT=FIELD(2)
      IUNT=IC910
      ISSTMD=IC1314
      LPRINT=(IC1517.GT.0)
       CALL RDCTMD(IUNT,1,IXSSTF,IC1112,IC1314,FILNAM,FIELD,LPRINT)
      GO TO 600
!*********************************************************************
! SSTOPO **                                                * SSTOPO **
! ********************************************************************
11750 CONTINUE
      IF(ICBDCF.NE.3)IBDTOP=1
      GOTO 600
!*********************************************************************
!  SSTPRD **                                               * SSTPRD **
!*********************************************************************
11800 CONTINUE
      LSTPRD = .TRUE.
      IC7=IFIELD(1)
      IC8=IFIELD(2)
      IC9=IFIELD(3)
! PERFORM QUALITY CHECKS
! VERIFY INCLUSION OF SSTOPO CARD
      IF(.NOT. LSTOPO) THEN
       WRITE(6,81600)
       STOP
      ENDIF
!
! VERIFY EXCLUSION OF SSCOEF CARD
      IF(LSSCOF) THEN
       WRITE(6,81700)
       STOP
      ENDIF
!
! VERIFY INCLUSION OF COEFFICIENT TYPE INDICATOR
      IF(IC8 .NE. 1 .AND. IC8 .NE. 2 ) THEN
       WRITE (6,81800)
       WRITE (6,81900) IC8
      STOP
      ENDIF
!
! VERIFY SPECIFIED DEGREE IS WITHIN BOUNDS
      IF(IC1517.LT.0.OR.IC1517.GT.MDEGEO) THEN
       WRITE (6,82000)
       WRITE (6,81300)
      STOP
      ENDIF
!
! VERIFY SPECIFIED ORDER IS WITHIN BOUNDS
      IF(IC1820.GT.IC1517 .OR. IC1820.GT.MORGEO) THEN
       WRITE (6,82100)
       WRITE (6,81500)
      STOP
      ENDIF
!
! VERIFY APRIORI VALUES SPECIFIED FOR BOTH A&B TERMS
      IF(FIELD(1).EQ.C0 .AND. FIELD(3).EQ.C0 .OR.                       &
     &   FIELD(2).EQ.C0 .AND. FIELD(4).EQ.C0) THEN
       WRITE(6,82150)
       STOP
      ENDIF
!
! SET NUMBER OF PARAMETERS
      IF(IC8 .EQ. 1) THEN
! Aci TERM
        NPVAL(IXSSTC)=NPVAL(IXSSTC)+1
        INDSST=IC8*100000000+20000000+IC9*1000000+IC1517*1000+IC1820
        ISSTPT(NPVAL(IXSSTC)+NPVAL(IXSSTS))=INDSST
! ADJ. Aci
        IF(FIELD(3).GT.C0) THEN
         NPVAL0(IXSSTC)=NPVAL0(IXSSTC)+1
         ISSTPA(NPVAL0(IXSSTC)+NPVAL0(IXSSTS))=INDSST
        ENDIF
! Bci TERM
        NPVAL(IXSSTC)=NPVAL(IXSSTC)+1
        INDSST=IC8*100000000+30000000+IC9*1000000+IC1517*1000+IC1820
        ISSTPT(NPVAL(IXSSTC)+NPVAL(IXSSTS))=INDSST
! ADJ. Bci
        IF(FIELD(4).GT.C0) THEN
         NPVAL0(IXSSTC)=NPVAL0(IXSSTC)+1
         ISSTPA(NPVAL0(IXSSTC)+NPVAL0(IXSSTS))=INDSST
        ENDIF
!
      GOTO 600
      ENDIF
!
      IF(IC8.EQ.2) THEN
! Asi TERM
        NPVAL(IXSSTS)=NPVAL(IXSSTS)+1
        INDSST=IC8*100000000+20000000+IC9*1000000+IC1517*1000+IC1820
        ISSTPT(NPVAL(IXSSTS)+NPVAL(IXSSTC))=INDSST
! ADJ. Asi
        IF(FIELD(3).GT.C0) THEN
         NPVAL0(IXSSTS)=NPVAL0(IXSSTS)+1
         ISSTPA(NPVAL0(IXSSTC)+NPVAL0(IXSSTS))=INDSST
        ENDIF
! Bsi TERM
        NPVAL(IXSSTS)=NPVAL(IXSSTS)+1
        INDSST=IC8*100000000+30000000+IC9*1000000+IC1517*1000+IC1820
        ISSTPT(NPVAL(IXSSTC)+NPVAL(IXSSTS))=INDSST
! ADJ. Bsi
        IF(FIELD(4).GT.C0) THEN
         NPVAL0(IXSSTS)=NPVAL0(IXSSTS)+1
         ISSTPA(NPVAL0(IXSSTC)+NPVAL0(IXSSTS))=INDSST
        ENDIF
      ENDIF
!
      GOTO 600
!*********************************************************************
!  SSTTIM **                                               * SSTTIM **
!*********************************************************************
11900 CONTINUE
      LSTTIM = .TRUE.
      IC8=IFIELD(2)
! PERFORM QUALITY CHECKS
! VERIFY INCLUSION OF SSTOPO CARD
      IF(.NOT. LSTOPO) THEN
       WRITE(6,82200)
       STOP
      ENDIF
!
! VERIFY EXCLUSION OF SSCOEF CARD
      IF(LSSCOF) THEN
       WRITE(6,82300)
       STOP
      ENDIF
!
! VERIFY INCLUSION OF COEFFICIENT TYPE INDICATOR
      IF(IC8 .NE. 1 .AND. IC8 .NE. 2 ) THEN
       WRITE (6,82400)
       WRITE (6,81900) IC8
      STOP
      ENDIF
!
! VERIFY SPECIFIED DEGREE IS WITHIN BOUNDS
      IF(IC1517.LT.0.OR.IC1517.GT.MDEGEO) THEN
       WRITE (6,82500)
       WRITE (6,81300)
      STOP
      ENDIF
!
! VERIFY SPECIFIED ORDER IS WITHIN BOUNDS
      IF(IC1820.GT.IC1517 .OR. IC1820.GT.MORGEO) THEN
       WRITE (6,82600)
       WRITE (6,81500)
      STOP
      ENDIF
!
! SET NUMBER OF PARAMETERS FOR MEAN TERM
      IF(FIELD(1).NE.C0 .OR. FIELD(3).NE.C0) THEN
! CBAR TERM
       IF(IC8 .EQ. 1) THEN
          NPVAL(IXSSTC)=NPVAL(IXSSTC)+1
          INDSST=IC8*100000000+IC1517*1000+IC1820
          ISSTPT(NPVAL(IXSSTC)+NPVAL(IXSSTS))=INDSST
          IF(FIELD(3).GT.C0) THEN
           NPVAL0(IXSSTC)=NPVAL0(IXSSTC)+1
           ISSTPA(NPVAL0(IXSSTC)+NPVAL0(IXSSTS))=INDSST
          ENDIF
!
       ELSE
! SBAR TERM
          NPVAL(IXSSTS)=NPVAL(IXSSTS)+1
          INDSST=IC8*100000000+IC1517*1000+IC1820
          ISSTPT(NPVAL(IXSSTC)+NPVAL(IXSSTS))=INDSST
          IF(FIELD(3).GT.C0) THEN
           NPVAL0(IXSSTS)=NPVAL0(IXSSTS)+1
           ISSTPA(NPVAL0(IXSSTC)+NPVAL0(IXSSTS))=INDSST
          ENDIF
       ENDIF
      ENDIF
!
! SET NUMBER OF PARAMETERS FOR RATE TERM
      IF(FIELD(2).NE.C0 .OR. FIELD(4).NE.C0) THEN
! CDOT TERM
       IF(IC8 .EQ. 1) THEN
          NPVAL(IXSSTC)=NPVAL(IXSSTC)+1
          INDSST=IC8*100000000+10000000+IC1517*1000+IC1820
          ISSTPT(NPVAL(IXSSTC)+NPVAL(IXSSTS))=INDSST
          IF(FIELD(4).GT.C0) THEN
           NPVAL0(IXSSTC)=NPVAL0(IXSSTC)+1
           ISSTPA(NPVAL0(IXSSTC)+NPVAL0(IXSSTS))=INDSST
          ENDIF
!
       ELSE
! SDOT TERM
          NPVAL(IXSSTS)=NPVAL(IXSSTS)+1
          INDSST=IC8*100000000+10000000+IC1517*1000+IC1820
          ISSTPT(NPVAL(IXSSTC)+NPVAL(IXSSTS))=INDSST
          IF(FIELD(4).GT.C0) THEN
           NPVAL0(IXSSTS)=NPVAL0(IXSSTS)+1
           ISSTPA(NPVAL0(IXSSTC)+NPVAL0(IXSSTS))=INDSST
          ENDIF
       ENDIF
      ENDIF
      GOTO 600
!*********************************************************************
!  STAPOS **                                               * STAPOS **
!*********************************************************************
12000 CONTINUE
! SET NUMBER OF ADJUSTED STATIONS TO 1 - THIS WILL BE CHANGED IN MAIN2
! TO NSTA FOR PASS 2 ALLOCATIONS AND CHANGED TO THE CORRECT VALUE IN
! OPTSTA DURING PASS 3
      LCONAJ=.FALSE.
      IF(IFIELD(1).GT.0) NPVAL0(IXSTAP)=1
      IF(IFIELD(2).GT.0) GO TO 12050
! READ STATION GEODETICS FILE
      ICARDS=0
12030 READ(IUNT16,71500,END=12040) CDNAME,IOFF,ISTA1,ISITOL
      IF(CDNAME.EQ.OPTION(17)) GO TO 12030
      IF(CDNAME.EQ.ENDSTA ) GO TO 12040
      DO 12035 I=1,NSTACD
      IF(CDNAME.EQ.STACDS(I)) GOTO 12030
12035 END DO
      ICARDS=ICARDS+1
      IVLBAS(ICARDS)=ISTA1
! LOAD ORBINF STATION POSITIONS
      IF(ICARDS.GT.NORBNF)  GO TO 12030
      NSTA=ICARDS
      IBNSTA(ICARDS)=ISTA1
      INFSTA(ICARDS)=ISTA1
!     write(6,*) 'rd50a2: icards, ista1, infsta(icards) ',
!    1                    icards, ista1, infsta(icards)
      GOTO 12030
!
12040 REWIND IUNT16
12050 READ(IUNT50,71500,END=60100) CDNAME,IOFF,ISTA1,ISITOL
!     write(6,fmt='(1x,2a)')
!    1'rd50a2: read station card cdname =  ', cdname
      IF(CDNAME.EQ.ENDSTA) GOTO 600
      DO 12060 I=1,NSTACD
      ICARDS=I
      IF(CDNAME.EQ.STACDS(I)) GOTO                                      &
     &   (12070,12080,12090,12100,12110,12120,12130,12140,12150,        &
     &    12160,12170,12180,12190,12200),I
12060 END DO
! STATION COORDINATE CARD
!     write(6,*) 'rd50a2: below 12060 station coordinate card'
!     write(6,*) 'rd50a2: lconaj ',lconaj
!
! LOAD IBNSTA IN CASE OF SIMULATED DATA
!
! AT THIS POINT CHECK WHETHER OR NOT ALL STATIONS FROM UNIT 17
! ARE INCLUDED IN THE TRACKING COMPLEMENT
      IF(ISITOL.GT.0) NSITES=NSITES+1
      IF(.NOT.LSDATA) GOTO 12064
      CALL FNDNUM(ISTA1,IBNSTA,NSTA,IPTR)
      IF(IPTR.NE.0) GOTO 12064
      NSTA=NSTA+1
      IBNSTA(NSTA)=ISTA1
      GOTO 12050
12064 CONTINUE
!
! LOAD ALL CONSTRAINED STATIONS
!
      IF(.NOT.LCONAJ) GOTO 12065
      CALL FNDNUM(ISTA1,IBNSTA,NSTA,IPTR)
      IF(IPTR.NE.0) GOTO 12065
      NSTA=NSTA+1
      IBNSTA(NSTA)=ISTA1
!     write(6,*) 'rd50a2: nsta  , ista1, infsta(nsta) ',
!    1                    nsta, ista1, infsta(nsta)
12065 CONTINUE
      NSTARD=NSTARD+1
      ISTARD(NSTARD)=ISTA1
      GOTO 12050
! ADJUSTED
12070 CONTINUE
      NPVAL0(IXSTAP)=1
      GOTO 12050
! CORREL
12080 CONTINUE
      GOTO 12050
! CONSTADJ
12090 CONTINUE
      LCONAJ=.TRUE.
      GOTO 12050
! CONSTEND
12100 CONTINUE
      LCONAJ=.FALSE.
      GOTO 12050
! FIXED
12110 CONTINUE
      LCONAJ=.FALSE.
      GOTO 12050
! GEODETIC
12120 CONTINUE
      GOTO 12050
! EXTRAGEO
12130 CONTINUE
      GOTO 12050
! ELCUTOFF
12140 CONTINUE
      GOTO 12050
! INSTRMNT
12150 CONTINUE
!     ....if options 6,7 or 8, count times and stations in file
      if ( ioff .gt. 5 ) then
!      write(6,*) 'rd50a2: call kntsta'
       call KNTSTA( NSTNUM, NSTIME )
!      write(6,*) 'rd50a2: NSTNUM, NSTIME ',NSTNUM, NSTIME
      endif
      GOTO 12050
! STAVEL
12160 CONTINUE
      GOTO 12050
! TIMVEL
12170 CONTINUE
      GOTO 12050
! SIGVEL
12180 CONTINUE
! SET NUMBER OF ADJUSTED STAVEL  TO 1 - THIS WILL BE CHANGED IN MAIN2
! TO       FOR PASS 2 ALLOCATIONS AND CHANGED TO THE CORRECT VALUE IN
! OPTSTA DURING PASS 3
      NPVAL0(IXSTAV)=1
      GOTO 12050
! STATL2
12190 CONTINUE
! SET NUMBER OF ADJUSTED STATL2 TO 1 - THIS WILL BE CHANGED in MAIN2
! TO       FOR PASS 2 ALLOCATIONS AND CHANGED TO THE CORRECT VALUE IN
! OPTSTA DURING PASS 3
      NPVAL0(IXSTL2)=1
      GOTO 12050
! STATH2
12200 CONTINUE
! SET NUMBER OF ADJUSTED STATH2  TO 1 - THIS WILL BE CHANGED IN MAIN2
! TO       FOR PASS 2 ALLOCATIONS AND CHANGED TO THE CORRECT VALUE IN
! OPTSTA DURING PASS 3
      NPVAL0(IXSTH2)=1
      GOTO 12050
!*********************************************************************
! ** STEP **                                               ** STEP  **
!*********************************************************************
12500 CONTINUE
! DETERMINE IF WRITING OUT INTEGRATION CAPABILITY IS ON
      INTOUT=IC1314
      IF(INTOUT.GT.0) NINTOT=NINTOT+1
      ISTEP=MINSH
      FSTEP=MINSH
      IORD=MAXSOR
      IF(FIELD(1).GT.C0) THEN
          ISTEP=FIELD(1)+1.D-6
          FSTEP=FIELD(1)
      END IF
      IF(LTETHR) THEN
       IF(ISTPCM.EQ.0) THEN
       ISTPCM=ISTEP
       ELSE
        IF(ISTEP.GT.ISTPCM) THEN
        WRITE(6,*)' EXECUTION TERMINATING IN RD50A2: '
        WRITE(6,*)' STEPSIZE FOR TETHER SATELLITE SHOULD BE LESS THAN '
        WRITE(6,*)' OR EQUAL TO THE CENTER OF MASS STEPSIZE '
        STOP 16
        ENDIF
       ENDIF
      ENDIF

! CHECK FOR SMALLER STEP SIZE OF VARIABLE TEP SIZE INTEGRATION
      IF(FIELD(3).GT.C0) THEN
      RR=FIELD(1)/FIELD(3)
      KK=FIELD(1)/FIELD(3)
      QQ=DBLE(KK)
      IF(QQ.NE.RR) THEN
      WRITE(6,*) ' RATIO OF LARGE TO SMALL STEP SIZE IS NOT AN INTEGER '
      WRITE(6,*) ' CORRECT THE STEP CARD AND  RESUBMIT/ TERMINATING IN '&
     &          ,'RD50A2'
      STOP 16
      ENDIF
      ENDIF

! LOAD EXTERNAL THERMAL ACCEL INFORMATION
      IF(LEXTHC) THEN
        CALL FNDNUM(IC1824,II1(JTASID),NTASAT,ITANDX)
        IF((ITANDX.GT.0).AND.(ITANDX.LE.NTASAT)) THEN
          IF(LL1(JTAFIL+ITANDX-1)) AA1(JTASTP+ITANDX-1)=FIELD(1)
        ENDIF
      ENDIF


! LOAD EXTERNAL ATTITUDE INFORMATION
! debug extatt
!      print *,'rd50a2: step: lexata: ',lexata
! debug extatt
      IF(LEXATA) THEN
       CALL FNDNUM(IC1824,II1(JEASID),NEASAT,IEANDX)
! debug extatt
!      print *,'rd50a2: step: ic1824,ieandx: ',ic1824,ieandx
! debug extatt
      IF((IEANDX.GT.0).AND.(IEANDX.LE.NEASAT)) THEN
! debug extatt
!      print *,'rd50a2:step:ll1(jeafil+ieandx-1):',ll1(jeafil+ieandx-1)
!      print *,'rd50a2: step: field(1): ',field(1)
! debug extatt
         IF(LL1(JEAFIL+IEANDX-1)) AA1(JEASTP+IEANDX-1)=FIELD(1)
        ENDIF
      ENDIF
!
!     IF(IC1112.GT.0) IORD=IC1112
      IF(IC78.GT.0) IORD=IC78
      FSTEPV=FSTEP
      IORDV=IORD
      IF(FIELD(2).GT.C0) FSTEPV=FIELD(2)
      IF(IC910.GT.0) IORDV=IC910
!
      NSTEPS=( MAX(IORD,IORDV)-1)*2
      NH1=NSTEPS-(IORD-1)
      IF(NH1VOC.GT.NH1) NH1=NH1VOC
      IXTIMB=FSTEP*NH1
      NXTIMB= MIN(IXTIMB,NXTIMB)
!
      NSTEPV=(IORDV-1)*2
      NH1=NSTEPV-(IORDV-1)
      IF(NH1VOC.GT.NH1) NH1=NH1VOC
      IXTIMB=FSTEPV*NH1
      NXTIMB= MIN(IXTIMB,NXTIMB)
      GO TO 600
!*********************************************************************
!  J2SUN  **                                               * J2SUN  **
!*********************************************************************
12550 CONTINUE
      NPVAL(IXJ2SN)= 1
      IF (FIELD(2).GT.0.D0) NPVAL0(IXJ2SN)= 1
      GOTO 600
!*********************************************************************
!  SURDEN **                                               * SURDEN **
!*********************************************************************
12600 CONTINUE
      GOTO 600
!*********************************************************************
!  TARGET **                                               * TARGET **
!*********************************************************************
12610 CONTINUE
         NTARG=NTARG+1
         NPVAL(IXTARG)=NPVAL(IXTARG)+3
      GOTO 600
!*********************************************************************
!  TARSIG **                                               * TARSIG **
!*********************************************************************
12650 CONTINUE
         NATARG=NATARG+1
         IF(FIELD(1).GT.C0) NPVAL0(IXTARG)=NPVAL0(IXTARG)+1
         IF(FIELD(2).GT.C0) NPVAL0(IXTARG)=NPVAL0(IXTARG)+1
         IF(FIELD(3).GT.C0) NPVAL0(IXTARG)=NPVAL0(IXTARG)+1
      GOTO 600
!*********************************************************************
!  TELEM  **                                               * TELEM  **
!*********************************************************************
12680 CONTINUE
      NTELEM=NTELEM+1
      GOTO 600
!*********************************************************************
!  THRDRG **                                               * THRDRG **
!*********************************************************************
12700 CONTINUE
      I2ND=IC78/10
      IF(I2ND.EQ.1.OR.I2ND.EQ.0) THEN
         NPVAL(IXTHDR)=NPVAL(IXTHDR)+2
       GO TO 600
      ENDIF
      IF(I2ND.NE.2) GO TO 600
!     ....adjustment of spin axis direction requested  - DDR 11/92
      IF(NSATA.GT.1.OR.NARCS.GT.1) GO TO 61000
      IF(FIELD(3).GT.C0) NPVAL0(IXTHDR)=NPVAL0(IXTHDR)+1
      IF(FIELD(4).GT.C0) NPVAL0(IXTHDR)=NPVAL0(IXTHDR)+1
      IF(NPVAL0(IXTHDR).NE.2) GO TO 61005
       GO TO 600
!*********************************************************************
!  TIDES  **                                               * TIDES  **
!*********************************************************************
13000 CONTINUE
! NO LONGER VALID IF STATEMENT
!     IF(IC78.NE.20.AND.IC78.NE.21.AND.IC78.NE.30) GO TO 600
      IF(IC78.GT.0) THEN
!   THIS IS THE OLD SETUP
      LOLDST=.TRUE.
      ENDIF
      IF(.NOT.LOLDST) GOTO 13025
      NPVAL(IXTIDE)=3
      IF(FIELD(2).LE.C0) GO TO 600
      NPVAL0(IXTIDE)=NPVAL0(IXTIDE)+1
      NSTADJ=NSTADJ+1
! SET OFFSET TO INSURE PROPER ORDERING OF TIDES (K2,K3,K2 PHASE)
      IOFF=1
      IF(IC78.EQ.21) IOFF=3
      IF(IC78.EQ.30) IOFF=2
      KTIDA(IOFF)=1
      ICNT=0
      DO 13020 J=1,3
      IF(KTIDA(J).EQ.0) GO TO 13020
      ICNT=ICNT+1
      KTIDA(J)=ICNT
13020 END DO
      GOTO 600
13025 CONTINUE
      NPVAL(IXTIDE)=0
      IF(IC1112.LE.0.OR.IC2122.LE.0) THEN
      WRITE(6,*)' PLEASE SPECIFY BOTH FORCING AND RECEIVING DEGREE AND '
      WRITE(6,*)' ORDER FOR TIDES , EXECUTION TERMINATING IN RD50A2  '
      STOP 16
      ENDIF
! NEW SCHEME FOR STANDARD TIDES
      NPVAL(IXTIDE)=20
      IF(LALLST) NPVAL0(IXTIDE)=NPVAL(IXTIDE)
      IF(LALLST) NSTADJ=20
      IF(FIELD(3).LE.C0.AND.FIELD(4).LE.C0) GO TO 600
      LALLST=.TRUE.
      GOTO 600
!*********************************************************************
!  TOPATT **                                               * TOPATT **
!*********************************************************************
13100 CONTINUE
! SPLIT START TIME
      CALL RIYMDH(FIELD(1),JYMD,JHMS)
! SPLIT STOP TIME
      CALL RIYMDH(FIELD(2),NYMD,NHMS)
! CONVERT START AND STOP TIME OF YAW STEERING TO MJDSECS
      CALL YMDTIS(JYMD,JHMS,JSEC)
      CALL YMDTIS(NYMD,NHMS,MSEC)
! ELIMINATE CARDS COMPLETELY OUT OF RANGE OF RUN
      IF(((JSEC.LT.IARCT1).AND.(MSEC.LT.IARCT1)) .OR.                   &
     & ((JSEC.GT.IARCT2).AND.(MSEC.GT.IARCT2))) THEN
        GOTO 600
      ELSE
        IF(IC910.NE.50) THEN
         NMTPAT=NMTPAT+1
         NOVRID=1
        ELSE
         NMTPAT=NMTPAT+1
         NGCATT=1
        ENDIF
      ENDIF
! FILL ITPATS ARRAY WITH UNIQUE SAT IDS
      IF(NMTPAT.EQ.1) THEN
        J=1
        ITPATS(1)=IC1824
      ELSE
        CALL FNDNUM(IC1824,ITPATS,NSATTP,IRET)
        IF(IRET.EQ.0) THEN
          J=J+1
          ITPATS(J)=IC1824
        ELSE
          CONTINUE
        ENDIF
      ENDIF

      GOTO 600
!*********************************************************************
!  TOPBIA (TATBIA)                                         * TOPBIA **
!*********************************************************************
13200 CONTINUE
! COUNT TOPBIA(TATBIA) CARDS
      NTPBIA=NTPBIA+1
      GOTO 600
!*********************************************************************
!  TSTLOV(TOPLOV))                                 TSTLOV(TOPLOV )
!*********************************************************************
13300 CONTINUE
      NISLV =NISLV +1
      ISLVID(NISLV)=IC1824
      NK=NISLV-1
      DO 13310 K=1,NK
!
      IF(ISLVID(NISLV).EQ.ISLVID(K))THEN
      NISLV=NISLV-1
      GOTO 13302
      ENDIF
13310 END DO
      WRITE(90,*)'RD50A2**NISLV,ISLVID*',NISLV,(ISLVID(J),J=1,NISLV)
13302 GOTO 600
!*********************************************************************
!  VLIGHT **                                               * VLIGHT **
!*********************************************************************
14000 CONTINUE
      NPVAL(IXVLIT)=1
      IF(FIELD(3).GT.C0) NPVAL0(IXVLIT)=1
      GOTO 600
!*********************************************************************
!  VECOPT **                                               * VECOPT **
!*********************************************************************
15000 CONTINUE
      LVOPTC=.TRUE.
      IF(IC1517.GT.0.AND..NOT.LNPT17) NH1VOC=IC1517
      IF(IFIELD(1).GT.0) LNPNM=.TRUE.
      IF(IFIELD(1).GE.2) LPART=.TRUE.
      NUN=IUNTP2-IUNTP1+1
      NUN= MIN(NUN,20)
      IF(IC910.GT.0) NUN= MIN(NUN,IC910)
      IUNTP2=IUNTP1+NUN-1
! NEED 2500000 ADDITIONAL WORDS OF CORE FOR EXTENDED VIRT. MEM.
! ALLOCATIONS DONE IN INTERFACE FILE ROUTINES, AND LOCAL ARRAYS,
! COMMON BLOCKS, LOCAL VARIABLES
      IF(FIELD(1).GT.0) MAXLP=FIELD(1) - 2500000
      IF(FIELD(4).GT.C0) ISIZPF=FIELD(4)+C1DM4
      GOTO 600
!**********************************************************************
!  YARKOV
!*********************************************************************
15500 CONTINUE
      NYACRD=NYACRD+1
! YARMOD=1 Apply tha fast spinning model
      IF(IC78.EQ.0) THEN
       YARTYP=1.D0
       YARMOD=1.D0
      ENDIF
      IF(IC78.EQ.10) THEN
       YARTYP=2.D0
       YARMOD=1.D0
      ENDIF
      IF(IC78.EQ.1) THEN
       YARTYP=1.D0
       YARMOD=2.D0
      ENDIF
      IF(IC78.EQ.11) THEN
       YARTYP=2.D0
       YARMOD=2.D0
      ENDIF

      AYAR=FIELD(1)
      TAU =FIELD(2)
      GOTO 600
!**********************************************************************
!  YAWBIA                                                  * YAWBIA **
!*********************************************************************
18000 CONTINUE
! COUNT YAWBIA CARDS
      IYAWBS=IYAWBS+1
      IYWSID(IYAWBS) = IC1824
      GOTO 600
!*********************************************************************
!  YAWPOL **                                               * YAWPOL **
!*********************************************************************
17000 CONTINUE
      CALL PASYAW(NCRDUM)
      GOTO 600
!*********************************************************************
! NORMAL END OF FILE - REWIND UNIT 50
60000 REWIND IUNT50
! CALCULATE NXTIMB IF NECESSARY
      IF(NXTIMB.LT.999999999) RETURN
      NSTEPS=(MAXSOR-1)*2
      NH1=NSTEPS-(MAXSOR-1)
      IF(NH1VOC.GT.NH1) NH1=NH1VOC
      NXTIMB=MINSH*NH1
      RETURN
! UNEXPECTED END OF FILE
60100 WRITE(IUNT06,80000) OPTION(ICARD)
      WRITE(IUNT06,89000)
      STOP 16
!
60200 WRITE(IUNT06,80200) CDNAME
      WRITE(IUNT06,89000)
      STOP 16
! ILLEGAL DATE ON EPOCH CARD
60300 WRITE(IUNT06,80300) CDNAME,IYMD1,IYMD2,IYMD3
      WRITE(IUNT06,89000)
      STOP 16
! ILLEGAL CARD IN ARC SUBGROUP
60400 WRITE(IUNT06,80400) CDNAME,IF1,IF2,IF3,IF4,IF5,RF1,IF6,IF7,RF2,   &
     &     IF8,IF9,RF3
      WRITE(IUNT06,89000)
      STOP 16
60600 WRITE(IUNT06,80600) CRD2
      WRITE(IUNT06,89000)
      STOP 16
60650 WRITE(IUNT06,80650) IARC,CDNAME,IC1824
      WRITE(IUNT06,89000)
      STOP 16
!
60700 WRITE(IUNT06,80700) CRD2
      WRITE(IUNT06,89000)
      STOP 16
!
60701 WRITE(IUNT06,80711) CRD2
      WRITE(IUNT06,89000)
      STOP 16
!
60800 WRITE(IUNT06,80800) IYMD
      WRITE(IUNT06,89000)
      STOP 16
! INCORRECT MASTER/SLAVE SATELLITE COMBINATION
60900 WRITE(IUNT06,80900) IC1824,IMASTS
      WRITE(IUNT06,89000)
      STOP 16
60950 WRITE(IUNT06,80920)
      STOP 16
60960 WRITE(IUNT06,80930)
      STOP 16
60970 WRITE(IUNT06,80935)
      STOP 16
60980 WRITE(IUNT06,80945)
      STOP 16
60982 WRITE(IUNT06,80952)
      STOP 16
60984 WRITE(IUNT06,80954)
      STOP 16
60986 WRITE(IUNT06,80956)
      STOP 16
60987 WRITE(IUNT06,80957)
      STOP 16
60990 WRITE(IUNT06,83510)
      STOP 16
60995 WRITE(IUNT06,83600)
      STOP 16
61000 WRITE(IUNT06,83700)
      STOP 16
61005 WRITE(IUNT06,83705)
      STOP 16
61010 WRITE(IUNT06,83710)
      STOP 16
61011 WRITE(IUNT06,83711)
      STOP 16
61020 WRITE(IUNT06,83740) CDNAME
      WRITE(IUNT06,89000)
      STOP 16
! FORMATS
30000 FORMAT(BZ,A8,A72)
71000 FORMAT(BZ,A6,4I2,I3,3A1,2I2,D20.8,D15.3,D13.1,D8.1)
71001 FORMAT(BZ,A80)
71050 FORMAT(BZ,A8,3I2,I2,1X,I7,D20.8,D15.3,D13.1,D8.1)
71100 FORMAT(BZ,A6)
71150 FORMAT(BZ,A6,I4)
71200 FORMAT(BZ,A6,4X,I1,9X,I6)
!71300 FORMAT(BZ,A6,I1,1X,I1,2X,I1,5X,I7)
71300 FORMAT(BZ,A6,I1,1X,I1,2X,I1,1X,I1,3X,I7)
71400 FORMAT(BZ,A6,I8,I1,I2,I7,I6,D10.3,2(I6,I4,D10.3))
!C71500 FORMAT(BZ,A8,4X,I8)
71500 FORMAT(BZ,A8,I2,2X,I8,46X,I4)
71600 FORMAT(BZ,A6,14X,I6,I4,D10.3,I6,I4,D10.3,I6,I4,D10.3)
71700 FORMAT(///)
80000 FORMAT(5X,'UNEXPECTED END OF FILE ENCOUNTERED WHILE SEARCHING',   &
     &   ' FOR ',A8/5X,'OR RELATED SUBGROUP CARDS')
80200 FORMAT(5X,'CARD ',A8,' DOES NOT BELONG IN SATPAR SUBGROUP')
80300 FORMAT(5X,'CARD ',A8,3(14X,I6),5X,'HAS ILLEGAL DATE')
80400 FORMAT(5X,'CARD ',A6,I1,I2,I7,I6,D10.3,2(I6,I4,D10.3),2X,'DOES',  &
     &   ' NOT BELONG IN ARC SUBGROUP')
80600 FORMAT(5X,'CARD ',A8,' DOES NOT BELONG IN LOCALG SUBGROUP')
80650 FORMAT(1X,'ARC NUMBER ',I3,' CARD NAME ',A8, 'HAS AN INVALID ',   &
     & 'SATELLITE ID',I10)
80700 FORMAT(5X,'CARD ',A8,' DOES NOT BELONG IN POLEUT SUBGROUP')
80711 FORMAT(5X,'CARD ',A8,' DOES NOT BELONG IN NUTATE SUBGROUP')
80701 FORMAT(5X,A6,4I2,I3,3A1,2I2,D20.8,D15.3,D13.1,D8.1)
80702 FORMAT(5X,'MBIAS CARD IGNORED -- TIMES OR SIGMA NOT SPECIFIED')
80703 FORMAT(5X,'MBIAS CARD IGNORED -- TIMES NOT SPECIFIED')
80725 FORMAT(1X,'RD50A2 - DELAY CARD IGNORED AS NEITHER SATELLITE',     &
     &     ' NOR STATION IS SPECIFIED',/,1X,'DELAY ',1X,I8,1X,I3,1X,    &
     &     I7,1X,4D20.12,/,1X,'EXECUTION CONTINUING')
80800 FORMAT(5X,'CARD FLUX HAS AN INVALID DATE: ',I8)
80900 FORMAT(5X,'SLAVE CARD FOLLOWING SATPAR CARD WITH SATID= ',I7,     &
     & 'HAS INVALID MASTER SATELLITE ID',I8)
88000 FORMAT(5X,'EXECUTION TERMINATING IN RD50A2: ',                    &
     &          'DUPLICATE INPUT CARD: ',A6,I1,I2,I3,I7,D20.8,D15.3,    &
     &           D13.1//)
89000 FORMAT(5X,'EXECUTION TERMINATING IN SUBROUTINE RD50A2')
80920 FORMAT(' JACCHIA 65 MODEL IS NO LONGER SUPPORTED BY GEODYN')
80950 FORMAT(' *** ABNORMAL TERMINATION IN SUBROUTINE RD50A2 ***'/,     &
     & ' THE PLMOON OPTION IS INVALID WHEN THE CENTRAL BODY IS THE ',   &
     & ' EARTH, THE EARTH''S MOON OR THE SUN')
80952 FORMAT(' *** ABNORMAL TERMINATION IN SUBROUTINE RD50A2 ***'/,     &
     & ' THE PLMOON OPTION IS REQUESTED FOR A MOON THAT IS NOT ',       &
     & ' ORBITING THE CENTRAL BODY')
80954 FORMAT(' *** ABNORMAL TERMINATION IN SUBROUTINE RD50A2 ***'/,     &
     & ' THE MAXIMUM NUMBER OF MOONS ALLOWED FOR THE PLMOON OPTION ',   &
     & ' (5) HAS BEEN EXCEEDED')
80956 FORMAT(' *** ABNORMAL TERMINATION IN SUBROUTINE RD50A2 ***'/,     &
     & ' TWO OR MORE PLMOON CARDS HAVE REQUESTED OPTIONS FOR THE ',     &
     & ' SAME MOON NUMBER')
80957 FORMAT(' *** ABNORMAL TERMINATION IN SUBROUTINE RD50A2 ***'/,     &
     & ' MEASUREMENT TYPE FOR BIAS CARD WAS NOT SPECIFIED ',            &
     & ' USE EBIASM MBIASM PBIASM CARD FOR 3 DIGIT MEASUREMENT TYPES')
81000 FORMAT(' SSCOEF USED WITHOUT REQUIRED SSTOPO CARD (RD50A2)')
81100 FORMAT(' BOTH SSCOEF & EITHER SSTPRD OR SSTTIM CARDS ARE USED ')
81200 FORMAT(' ERROR ON SSCOEF CARD, COLUMN 15-17, IN RD50A2')
81300 FORMAT(' COEFFICIENT DEGREE <0 OR >MAX DEG SET ON SSTOPO')
81400 FORMAT(' ERROR ON SSCOEF CARD, COLUMN 18-20, IN RD50A2 ')
81500 FORMAT(' COEFFICIENT ORDER OUT OF BOUNDS')
81600 FORMAT(' SSTPRD USED WITHOUT REQUIRED SSTOPO CARD (RD50A2)')
81700 FORMAT(' ERROR:  BOTH SSTPRD & SSCOEF CARDS USED (RD50A2)')
81800 FORMAT(' ERROR ON SSTPRD CARD, COLUMN 8 IN RD50A2')
81900 FORMAT(' COEFFICIENT TYPE INDICATOR SET IMPROPERLY AS ', I1)
82000 FORMAT(' ERROR ON SSTPRD CARD, COLUMN 15-17, IN RD50A2 ' )
82100 FORMAT(' ERROR ON SSTPRD CARD, COLUMN 18-20, IN RD50A2 ')
82150 FORMAT(' ERROR ON SSTPRD CARD, CANNOT HAVE ZERO VALUE FOR BOTH',  &
     &       ' APRIORI AND SIGMA TERMS.  MUST DEFINE BOTH A&B TERMS.')
82200 FORMAT(' SSTTIM USED WITHOUT REQUIRED SSTOPO CARD (RD50A2)')
82300 FORMAT(' ERROR:  BOTH SSTTIM & SSCOEF CARDS USED (RD50A2)')
82400 FORMAT(' ERROR ON SSTTIM CARD, COLUMN 8 IN RD50A2')
82500 FORMAT(' ERROR ON SSTTIM CARD, COLUMN 15-17, IN RD50A2 ')
82600 FORMAT(' ERROR ON SSTTIM CARD, COLUMN 18-20, IN RD50A2 ')
80930 FORMAT(' SUBROUTINE RD50A2: SPECIFY CASE FOR THE ',               &
     & ' INTERCOMPARISON ON THE INTCOM CARD')
80935 FORMAT(' SUBROUTINE RD50A2: NUMBER OF HOURS ON THE POLE CARD',    &
     & ' DATE EXCEEDS 24 HOURS ')
80940 FORMAT(1X,'THE MAXIMUM NUMBER OF EBIAS GROUPS WAS EXCEEDED. '/    &
     &   1X,' MAX NUMBER ALLOWED ',I4,' GROUPS USED IN THIS RUN',4I4/   &
     &   1X,' EBIAS CARD NUMBER THAT EXCEEDED MAX GROUP ',I4 /          &
     &   1X,' EBIAS TYPE THAT WAS REJECTED ',I4)
80945 FORMAT(' SUBROUTINE RD50A2: EXECUTION TERMINATING BECAUSE GM',    &
     & ' ADJUSTMENT IS NOT FOR THE CENTRAL BODY')
83000 FORMAT(1X,' GRVTIM CARD SPECIFYING APRIORI VALUES FOR PERIODIC '/ &
     &   1X,' TERMS DOES NOT PRECEED THIS SIGMA CARD.  STOP IN RD50A2')
83500 FORMAT(' GRVTIM',2I1,6X,2I3,20X,D15.3,D15.3)
83510 FORMAT(1X,' SUBROUTINE RD50A2: EXECUTION TERMINATING BECAUSE '/   &
     &   1X,' VECOPT OPTION WAS REQUESTED FOR SIM. DATA GENERATION')
83600 FORMAT(1X,'EXECUTION TERMINATING IN RD50A2 BECAUSE DATA '/        &
     &   1X,'SELECTION SUBGROUP CONTAINS NO SELECT CARDS. A SELECT '/   &
     &   1X,'CARD IS REQUIRED FOR THIS SUBGROUP')
83700 FORMAT(1X,'EXECUTION TERMINATING IN RD50A2 BECAUSE OF AN '/       &
     &   1X,'ATTEMPT TO ADJUST THERMAL DRAG SPIN AXIS IN A MULTI '/     &
     &   1X,'ARC OR MULTI SATELLITE RUN')
83705 FORMAT(1X,'EXECUTION TERMINATING IN RD50A2 BECAUSE OF AN'/        &
     &   1X,'ATTEMPT TO ADJUST SATELLITE SPIN AXIS WITHOUT '/           &
     &   1X,'ADJUSTING BOTH ORIENTATION ANGLES')
83710 FORMAT(1X,'EXECUTION TERMINATING IN RD50A2. UNABLE TO FIND'/      &
     &   1X,'REQUESTED EXTATT SATID IN EXTERNAL ATTITUDE FILE')
83711 FORMAT(1X,'EXECUTION TERMINATING IN RD50A2. UNABLE TO FIND'/      &
     &   1X,'REQUESTED THMACC SATID IN EXTERNAL THERMAL ACCEL FILE')
83715 FORMAT(1X,'EXECUTION TERMINATING IN RD50A2 BECAUSE OF '/          &
     &   1X,'INCORRECT USE OF ALTIME CARD.  CHECK ALBEDO CARD FOR '/    &
     &   1X,'MODEL INDICATOR.')
83720 FORMAT(1X,'EXECUTION TERMINATING IN RD50A2 BECAUSE '/             &
     &   1X,' ALTIME OPTION CARDS OMITTED.  CHECK ALBEDO CARD FOR '/    &
     &   1X,'MODEL INDICATOR.')
83730 FORMAT(/,1X,'WARNING: APPLICATION OF THE IONOSPHERIC MODEL IR-95',&
     &'HAS BEEN REQUESTED BUT THE',/,' FREQUENCY SUPPLIED BY OFFSET ',  &
     &'CARD #',I2,' IS ZERO. THIS IMPLIES THAT GEODYN WILL',/,'COMPUTE',&
     &'THE FREQUENCIES PER LINK REQUIRED FROM INFORMATION PROVIDED ON ',&
     &'THE DATA.')
83740 FORMAT(5X,'CARD ',A8,' DOES NOT BELONG IN ACCLRM SUBGROUP')
84000 FORMAT(BZ,A6,1X,I1,2X,A64)
      END
